<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc | 0raN9e's Blog</title><meta name=keywords content="Misc"><meta name=description content='Misc
æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€)
æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai
def solve():
    timings = [
        1.110270, 0.924169, 1.139244, 0.670085, 0.915054, 1.154452, 0.224613, 0.329060,
        0.774615, 0.279617, 0.954166, 0.430143, 0.414914, 1.224826, 1.310686, 1.265828,
        0.110950, 1.225669, 1.404647, 0.575287, 1.455927, 0.975492, 0.305642, 0.835893,
        1.245893, 0.569651, 1.060266, 0.149129, 0.844243, 1.294104, 0.079101, 0.914897,
        1.025389, 0.270495, 0.225577, 0.654189, 1.385665, 0.755860, 0.450597, 0.950750,
        0.839268, 1.015624, 0.895000, 0.794687, 1.064966, 1.200042, 0.559413, 0.980588,
        0.525959, 0.514992, 0.629261, 0.489585, 1.089786, 0.880690, 1.374392, 0.789075,
        0.814771, 1.455273, 1.050996, 0.234891, 1.074220, 0.099300, 1.319762, 0.935773,
        0.454985, 0.425895, 0.704892, 1.095786, 1.165433, 1.295589, 0.749113, 0.885320,
        1.244904, 0.659642, 0.635889, 0.435427, 0.520476, 0.870549, 0.890145, 1.125522,
        1.064915, 0.399210, 0.865873
    ]

    class LFSR:
        def __init__(self):
            self.lfsr = 0x92

        def step(self):
            bit = ((self.lfsr >> 0) ^ (self.lfsr >> 2) ^ (self.lfsr >> 3) ^ (self.lfsr >> 4)) & 1
            self.lfsr = (self.lfsr >> 1) | (bit << 7)
            return self.lfsr

    machine = LFSR()
    flag = ""
    inv_31 = pow(31, -1, 256)

    print(f"{&#39;Time&#39;:<12} | {&#39;Ops&#39;:<5} | {&#39;Char&#39;:<5}")
    print("-" * 30)

    for t in timings:
        ops = round(t / 0.005)

        if ops % 2 == 0:
            base_ops = ops - 10
        else:
            base_ops = ops - 10 - 30

        val = ((base_ops - 85) * inv_31) & 0xFF

        k = machine.step()
        char_code = val ^ k
        char = chr(char_code)

        flag += char
        # æ‰“å°æ—¶é—´å¯¹åº”å…³ç³»
        print(f"{t:<12.6f} | {ops:<5} | {char:<5}")

    print("-" * 30)
    print(f"[+]Recovered: \n{flag}")


if __name__ == "__main__":
    solve()
'><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/ctf/qwnt2025/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/ctf/qwnt2025/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/ctf/qwnt2025/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc"><meta property="og:description" content='Misc æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€) æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai
def solve(): timings = [ 1.110270, 0.924169, 1.139244, 0.670085, 0.915054, 1.154452, 0.224613, 0.329060, 0.774615, 0.279617, 0.954166, 0.430143, 0.414914, 1.224826, 1.310686, 1.265828, 0.110950, 1.225669, 1.404647, 0.575287, 1.455927, 0.975492, 0.305642, 0.835893, 1.245893, 0.569651, 1.060266, 0.149129, 0.844243, 1.294104, 0.079101, 0.914897, 1.025389, 0.270495, 0.225577, 0.654189, 1.385665, 0.755860, 0.450597, 0.950750, 0.839268, 1.015624, 0.895000, 0.794687, 1.064966, 1.200042, 0.559413, 0.980588, 0.525959, 0.514992, 0.629261, 0.489585, 1.089786, 0.880690, 1.374392, 0.789075, 0.814771, 1.455273, 1.050996, 0.234891, 1.074220, 0.099300, 1.319762, 0.935773, 0.454985, 0.425895, 0.704892, 1.095786, 1.165433, 1.295589, 0.749113, 0.885320, 1.244904, 0.659642, 0.635889, 0.435427, 0.520476, 0.870549, 0.890145, 1.125522, 1.064915, 0.399210, 0.865873 ] class LFSR: def __init__(self): self.lfsr = 0x92 def step(self): bit = ((self.lfsr >> 0) ^ (self.lfsr >> 2) ^ (self.lfsr >> 3) ^ (self.lfsr >> 4)) & 1 self.lfsr = (self.lfsr >> 1) | (bit << 7) return self.lfsr machine = LFSR() flag = "" inv_31 = pow(31, -1, 256) print(f"{&#39;Time&#39;:<12} | {&#39;Ops&#39;:<5} | {&#39;Char&#39;:<5}") print("-" * 30) for t in timings: ops = round(t / 0.005) if ops % 2 == 0: base_ops = ops - 10 else: base_ops = ops - 10 - 30 val = ((base_ops - 85) * inv_31) & 0xFF k = machine.step() char_code = val ^ k char = chr(char_code) flag += char # æ‰“å°æ—¶é—´å¯¹åº”å…³ç³» print(f"{t:<12.6f} | {ops:<5} | {char:<5}") print("-" * 30) print(f"[+]Recovered: \n{flag}") if __name__ == "__main__": solve() '><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-30T00:00:00+00:00"><meta property="article:tag" content="Misc"><meta name=twitter:card content="summary"><meta name=twitter:title content="ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc"><meta name=twitter:description content='Misc
æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€)
æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai
def solve():
    timings = [
        1.110270, 0.924169, 1.139244, 0.670085, 0.915054, 1.154452, 0.224613, 0.329060,
        0.774615, 0.279617, 0.954166, 0.430143, 0.414914, 1.224826, 1.310686, 1.265828,
        0.110950, 1.225669, 1.404647, 0.575287, 1.455927, 0.975492, 0.305642, 0.835893,
        1.245893, 0.569651, 1.060266, 0.149129, 0.844243, 1.294104, 0.079101, 0.914897,
        1.025389, 0.270495, 0.225577, 0.654189, 1.385665, 0.755860, 0.450597, 0.950750,
        0.839268, 1.015624, 0.895000, 0.794687, 1.064966, 1.200042, 0.559413, 0.980588,
        0.525959, 0.514992, 0.629261, 0.489585, 1.089786, 0.880690, 1.374392, 0.789075,
        0.814771, 1.455273, 1.050996, 0.234891, 1.074220, 0.099300, 1.319762, 0.935773,
        0.454985, 0.425895, 0.704892, 1.095786, 1.165433, 1.295589, 0.749113, 0.885320,
        1.244904, 0.659642, 0.635889, 0.435427, 0.520476, 0.870549, 0.890145, 1.125522,
        1.064915, 0.399210, 0.865873
    ]

    class LFSR:
        def __init__(self):
            self.lfsr = 0x92

        def step(self):
            bit = ((self.lfsr >> 0) ^ (self.lfsr >> 2) ^ (self.lfsr >> 3) ^ (self.lfsr >> 4)) & 1
            self.lfsr = (self.lfsr >> 1) | (bit << 7)
            return self.lfsr

    machine = LFSR()
    flag = ""
    inv_31 = pow(31, -1, 256)

    print(f"{&#39;Time&#39;:<12} | {&#39;Ops&#39;:<5} | {&#39;Char&#39;:<5}")
    print("-" * 30)

    for t in timings:
        ops = round(t / 0.005)

        if ops % 2 == 0:
            base_ops = ops - 10
        else:
            base_ops = ops - 10 - 30

        val = ((base_ops - 85) * inv_31) & 0xFF

        k = machine.step()
        char_code = val ^ k
        char = chr(char_code)

        flag += char
        # æ‰“å°æ—¶é—´å¯¹åº”å…³ç³»
        print(f"{t:<12.6f} | {ops:<5} | {char:<5}")

    print("-" * 30)
    print(f"[+]Recovered: \n{flag}")


if __name__ == "__main__":
    solve()
'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"http://blog.0ran9e.cn/posts/ctf/"},{"@type":"ListItem","position":3,"name":"ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc","item":"http://blog.0ran9e.cn/posts/ctf/qwnt2025/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc","name":"ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc","description":"Misc æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€) æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai\ndef solve(): timings = [ 1.110270, 0.924169, 1.139244, 0.670085, 0.915054, 1.154452, 0.224613, 0.329060, 0.774615, 0.279617, 0.954166, 0.430143, 0.414914, 1.224826, 1.310686, 1.265828, 0.110950, 1.225669, 1.404647, 0.575287, 1.455927, 0.975492, 0.305642, 0.835893, 1.245893, 0.569651, 1.060266, 0.149129, 0.844243, 1.294104, 0.079101, 0.914897, 1.025389, 0.270495, 0.225577, 0.654189, 1.385665, 0.755860, 0.450597, 0.950750, 0.839268, 1.015624, 0.895000, 0.794687, 1.064966, 1.200042, 0.559413, 0.980588, 0.525959, 0.514992, 0.629261, 0.489585, 1.089786, 0.880690, 1.374392, 0.789075, 0.814771, 1.455273, 1.050996, 0.234891, 1.074220, 0.099300, 1.319762, 0.935773, 0.454985, 0.425895, 0.704892, 1.095786, 1.165433, 1.295589, 0.749113, 0.885320, 1.244904, 0.659642, 0.635889, 0.435427, 0.520476, 0.870549, 0.890145, 1.125522, 1.064915, 0.399210, 0.865873 ] class LFSR: def __init__(self): self.lfsr = 0x92 def step(self): bit = ((self.lfsr \u0026gt;\u0026gt; 0) ^ (self.lfsr \u0026gt;\u0026gt; 2) ^ (self.lfsr \u0026gt;\u0026gt; 3) ^ (self.lfsr \u0026gt;\u0026gt; 4)) \u0026amp; 1 self.lfsr = (self.lfsr \u0026gt;\u0026gt; 1) | (bit \u0026lt;\u0026lt; 7) return self.lfsr machine = LFSR() flag = \u0026#34;\u0026#34; inv_31 = pow(31, -1, 256) print(f\u0026#34;{\u0026#39;Time\u0026#39;:\u0026lt;12} | {\u0026#39;Ops\u0026#39;:\u0026lt;5} | {\u0026#39;Char\u0026#39;:\u0026lt;5}\u0026#34;) print(\u0026#34;-\u0026#34; * 30) for t in timings: ops = round(t / 0.005) if ops % 2 == 0: base_ops = ops - 10 else: base_ops = ops - 10 - 30 val = ((base_ops - 85) * inv_31) \u0026amp; 0xFF k = machine.step() char_code = val ^ k char = chr(char_code) flag += char # æ‰“å°æ—¶é—´å¯¹åº”å…³ç³» print(f\u0026#34;{t:\u0026lt;12.6f} | {ops:\u0026lt;5} | {char:\u0026lt;5}\u0026#34;) print(\u0026#34;-\u0026#34; * 30) print(f\u0026#34;[+]Recovered: \\n{flag}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: solve() ","keywords":["Misc"],"articleBody":"Misc æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€) æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai\ndef solve(): timings = [ 1.110270, 0.924169, 1.139244, 0.670085, 0.915054, 1.154452, 0.224613, 0.329060, 0.774615, 0.279617, 0.954166, 0.430143, 0.414914, 1.224826, 1.310686, 1.265828, 0.110950, 1.225669, 1.404647, 0.575287, 1.455927, 0.975492, 0.305642, 0.835893, 1.245893, 0.569651, 1.060266, 0.149129, 0.844243, 1.294104, 0.079101, 0.914897, 1.025389, 0.270495, 0.225577, 0.654189, 1.385665, 0.755860, 0.450597, 0.950750, 0.839268, 1.015624, 0.895000, 0.794687, 1.064966, 1.200042, 0.559413, 0.980588, 0.525959, 0.514992, 0.629261, 0.489585, 1.089786, 0.880690, 1.374392, 0.789075, 0.814771, 1.455273, 1.050996, 0.234891, 1.074220, 0.099300, 1.319762, 0.935773, 0.454985, 0.425895, 0.704892, 1.095786, 1.165433, 1.295589, 0.749113, 0.885320, 1.244904, 0.659642, 0.635889, 0.435427, 0.520476, 0.870549, 0.890145, 1.125522, 1.064915, 0.399210, 0.865873 ] class LFSR: def __init__(self): self.lfsr = 0x92 def step(self): bit = ((self.lfsr \u003e\u003e 0) ^ (self.lfsr \u003e\u003e 2) ^ (self.lfsr \u003e\u003e 3) ^ (self.lfsr \u003e\u003e 4)) \u0026 1 self.lfsr = (self.lfsr \u003e\u003e 1) | (bit \u003c\u003c 7) return self.lfsr machine = LFSR() flag = \"\" inv_31 = pow(31, -1, 256) print(f\"{'Time':\u003c12} | {'Ops':\u003c5} | {'Char':\u003c5}\") print(\"-\" * 30) for t in timings: ops = round(t / 0.005) if ops % 2 == 0: base_ops = ops - 10 else: base_ops = ops - 10 - 30 val = ((base_ops - 85) * inv_31) \u0026 0xFF k = machine.step() char_code = val ^ k char = chr(char_code) flag += char # æ‰“å°æ—¶é—´å¯¹åº”å…³ç³» print(f\"{t:\u003c12.6f} | {ops:\u003c5} | {char:\u003c5}\") print(\"-\" * 30) print(f\"[+]Recovered: \\n{flag}\") if __name__ == \"__main__\": solve() ä¹‹åæ²¡æ€è·¯æ— èƒ½ç‹‚æ€’äº†ä¸€å¤©\nå®˜æ–¹hintçš„å†…å®¹æ˜¯ModR/M\nå·²çŸ¥ç»™çš„chalçš„elfæ–‡ä»¶å°±è¯´åŠ å¯†è„šæœ¬ç›´æ¥åœ¨linuxç¯å¢ƒç¼–è¯‘çš„ï¼Œå°è¯•åç¼–è¯‘æœªæ‰¾åˆ°å¯åˆ©ç”¨çš„å†…å®¹ï¼Œåˆ©ç”¨aiæ£€ç´¢ä¿¡æ¯ModR/Mï¼Œé—®äº†éšå†™å¾—åˆ°äº†ä¸€ä¸ªé¡¹ç›®\nwoodruffw/steg86: Hiding messages in x86 programs using semantic duals\nçŒœæµ‹å¯èƒ½æ˜¯ï¼Œè£…ä¸€ä¸‹ç¯å¢ƒ\nå¾—åˆ°äº†è¿™ä¸ªå†…å®¹ï¼ŒæŠŠå¯†æ–‡å’Œå­—ç¬¦è¡¨æ‰”ä¸ªai\nVim ç¼–è¾‘å™¨è¿›è¡Œå®æ“ä½œéªŒè¯çš„ä¸€ä¸ªé¢˜ç›®\næ ‡å‡†çš„ç»å¯†å‹ç¼©(ä¸‰è¡€) é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œ\nç®€å•çš„tcpåˆ†æå‘ç°æ˜¯æœ‰pngçš„hexæµçš„\ntshark -r capture.pcapng -Y \"tcp\" -T fields -e data \u003e1.txt ç„¶åæå–å‡ºæ‰€æœ‰çš„å›¾ç‰‡\nimport binascii import re def extract_pngs(input_file): with open(input_file, 'r') as f: lines = f.readlines() reassembled_hex_string = \"\" for line in lines: line = line.strip() if not line: continue try: payload_bytes = binascii.unhexlify(line) payload_str = payload_bytes.decode('utf-8') if re.match(r'^[0-9a-fA-F]+$', payload_str): reassembled_hex_string += payload_str except (UnicodeDecodeError, binascii.Error): continue try: full_binary = binascii.unhexlify(reassembled_hex_string) except binascii.Error: print(\"Error converting reassembled string to binary. Check data integrity.\") return png_signature = b'\\x89PNG\\r\\n\\x1a\\n' parts = full_binary.split(png_signature) count = 0 for i, part in enumerate(parts): if i == 0: continue png_data = png_signature + part iend_marker = b'IEND' iend_index = png_data.find(iend_marker) if iend_index != -1: end_of_file = iend_index + 4 + 4 png_data = png_data[:end_of_file] filename = f'extracted_{count}.png' with open(filename, 'wb') as out: out.write(png_data) print(f'[+] Extracted: {filename}') count += 1 extract_pngs('1.txt') æå–å‡ºæ¥å‘ç°æ˜¯1kbè§„åˆ™çš„å›¾ç‰‡ï¼Œçœ‹ä¸å‡ºä»»ä½•åå ‚ï¼Œäºæ˜¯æ”¾å¼ƒ(ä¸­é€”ä¸‰ä¸ªå°æ—¶å»çœ‹äº†å…¶ä»–çš„)\næœ€ç»ˆè¿˜æ˜¯å›å½’pngçš„ï¼Œå°è¯•äº†\npngcheck extracted_* 30å¼ å›¾ç‰‡éƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸”éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œé‚£ä¹ˆå°±æ˜¯æœç€pngæƒ³ï¼Œç¿»äº†ç¿»lunaticå¸ˆå‚…çš„åšå®¢ï¼Œæ£€ç´¢åˆ°äº†å¯èƒ½æ˜¯idatéšå†™ï¼Œæ‰‹åŠ¨è°ƒæ•´ä¸€ä¸‹\nè¶…ç»éœ‡æ’¼ï¼ŒæŠŠ30æ¡ä¿¡æ¯éƒ½æå–å‡ºæ¥ï¼Œæœ€åçš„ä¿¡æ¯æ˜¯\nConnection established. Hey, you online? Itâ€™s been a while since we last talked.\rYeah, Iâ€™m here. Busy as always. Feels like the days are getting shorter.\rTell me about it. I barely have time to sleep lately. Between maintenance logs and incident reports, Iâ€™m drowning.\rSounds rough. Iâ€™ve been buried in audits myself. Every time I finish one, another pops up.\rClassic. Sometimes I wonder if the machines are easier to deal with than the people.\rNo kidding. At least machines donâ€™t ask pointless questions.\rTrue. Anyway, before I forgetâ€”howâ€™s that side project you were working on? The one you wouldnâ€™t shut up about months ago.\rStill aliveâ€¦ barely. Progress is slow, but steady. You know meâ€”I donâ€™t give up easily.\rGood. I hope it pays off one day.\rThanks. Alrightâ€¦ Iâ€™m guessing you didnâ€™t ping me just to chat?\rWell, half of it was. Itâ€™s been a while. But yesâ€”I do have something for you today. Before sending the core cipher, Iâ€™ll transmit an encrypted archive first. It contains a sample text and the decryption rules. Okay. Whatâ€™s special about this sample text?\rAndâ€¦ inside the sample text, I used my favorite Herobrine legendâ€”you know the one I always bring up.\rOf course I know. The hidden original text from that weird old site, right?\rWhat can I sayâ€”old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password.\rGot it. So if I can decrypt the sample, the real one should be straightforward.\rExactly. Send the sample when ready.\rIâ€™m ready. Go ahead.\rUEsDBBQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJAAAAcnVsZXMudHh07XuRBFDbojGKhAz59VaKEpwD6/rKaZnqUxf+NMH0rybWrAMPewZ/yGyLrMKQjNIcEbPAxjmP5oTh8fP77Vi1wnFwzN37BmrQ9SCkC27FC/xeqbgw/HWcDpgzsEoiNpqT9ZThrbAScyg5syfJmNactjelNVBLAwQUAAEACACGOXhbpdvG1ysBAAAVAgAACgAAAHNhbXBsZS50eHTA1fy4cMLZwZkTI1mEk88yOXy9rmbTbCNBQOo9hqKQPK6vjZVo9aCtTVflmkKYGV99+51qXbinmG7WGik5UvLJk9MKRosThBCDMHrmjibOCzjzNELwEgEyX8DjqJkSc8pIFwj+oRM3bb4i0GtRxbwqgsxCtgwiKdCVoXVdetN7RKLIQ7DD+Huv/ZptNdd0yRNHis9LEA3loB+IHZ+dK7IknqPh4lYF8JwAjx5/wwp0YAM6Bcec7uAvk6B5t1pEztm1rLl8TjniVz5/bBUTo1LjUXnar/pnm1NvE9EAuxz/s6b+O8/ew7/A4ItdNJGzDudh6YULfiV3pCTXFIbR4GCe4LwkohWZIlAjysA+zLRrgkTDoB10vWdNGdfoBAlLRoUdZ95mS7X5/bXV41BLAQI/ABQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJACQAAAAAAAAAIAAAAAAAAABydWxlcy50eHQKACAAAAAAAAEAGABIv3f82lzcAQAAAAAAAAAAAAAAAAAAAABQSwECPwAUAAEACACGOXhbpdvG1ysBAAAVAgAACgAkAAAAAAAAACAAAACaAAAAc2FtcGxlLnR4dAoAIAAAAAAAAQAYAFP0sZjOXNwBAAAAAAAAAAAAAAAAAAAAAFBLBQYAAAAAAgACALcAAADtAQAAAAA=\rgot it. Decryptingâ€¦ yeah, it works.\rGood. That means the channel is stable.\rAlright. Whenever youâ€™re ready, send the real thing.\rThe core cipher will be transmitted through our secret channel. You remember how to decrypt it, right?\rOf course. Iâ€™ve got the procedure ready. Start when youâ€™re ready.\rDone. Core cipher fully received. Integrity verifiedâ€”no corruption.\rSame to you. And heyâ€¦ nice talking again.\rAgreed. Take care.\rGood. Keep things quiet for the next few days.\rYeah. Letâ€™s not wait so long next time.\rYou too. ä¸­é—´çš„è§£ç å¯ä»¥æ‹¿åˆ°å‹ç¼©åŒ…\nä¸€çœ¼æ˜æ–‡æ”»å‡»ï¼Œè¿™é‡Œå›å½’æ–‡æœ¬\nOkay. Whatâ€™s special about this sample text?\rAndâ€¦ inside the sample text, I used my favorite Herobrine legendâ€”you know the one I always bring up.\rOf course I know. The hidden original text from that weird old site, right?\rWhat can I sayâ€”old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password. é‚£ä¹ˆsample.txtå°±æ˜¯éœ€è¦ç¤¾å·¥çš„åœ°æ–¹ï¼Œæ‰¾åˆ°å¯¹åº”æ–‡æœ¬å†…å®¹\nHim.Html | Minecraft CreepyPasta Wiki | Fandom\nè¿™é‡Œå°±æ˜¯æ‹·æ‰“aiè¿›è¡Œç½‘é¡µç¤¾å·¥æ‰¾åˆ°äº†å¯¹åº”å†…å®¹\nHim.HTML was a website that a Steve face with realistic eyes and a jumble of numbers and letters. When sorted it said this: It has been reported that some victims of torture, during the act, would retreat into a fantasy world from which they could not WAKE UP. In this catatonic state, the victim lived in a world just like their normal one, except they weren't being tortured. The only way that they realized they needed to WAKE UP was a note they found in their fantasy world. It would tell them about their condition, and tell them to WAKE UP. Even then, it would often take months until they were ready to discard their fantasy world and PLEASE WAKE UP. æ–‡ä»¶å¤§å°ç•¥æœ‰å‡ºè·¯ï¼Œæœ€ç»ˆçš„å†…å®¹æ˜¯\nIt has been reported that some victims of torture, during the act, would retreat into a fantasy world from which they could not WAKE UP. In this catatonic state, the victim lived in a world just like their normal one, except they weren't being tortured. The only way that they realized they needed to WAKE UP was a note they found in their fantasy world. It would tell them about their condition, and tell them to WAKE UP. Even then, it would often take months until they were ready to discard their fantasy world and PLEASE WAKE UP. è¿™é‡Œåˆ©ç”¨7zåˆ¶ä½œå‹ç¼©åŒ…\nåˆ©ç”¨ARCHPRè¿›è¡Œæ”»å‡»è§£å‹åŒæ—¶å¾—åˆ°å¯†é’¥\n[ b47e923c 5aeb49a7 a3cd7af0 ] ruleæ–‡æœ¬çš„å†…å®¹æ˜¯\n1.you need to calc the md5 of port to decrypt the core data.\r2.The cipher I put in the zip, in segments, has been deflated. ç„¶ååˆé™·å…¥äº†æ·±æ€\nå¤§è‡´çš„æ€è·¯åˆ©ç”¨å¯¹åº”çš„ç«¯å£çš„MD5ä½œä¸ºkeyè§£å¯†å†…å®¹\ntshark -r capture.pcapng -T fields -e tcp.srcport -e tcp.dstport -e tcp.payload \u003e1.txt ä»”ç»†åˆ†æä¸€ä¸‹å†…å®¹(è¿™é‡Œæœ‰ç‚¹è„‘ç‹äº‰éœ¸)ï¼Œå‘ç°ç«¯å£30012-30091ä¹‹é—´çš„åŒºåˆ«ä¸å‰é¢pngä¼ è¾“çš„å†…å®¹ï¼Œæ‹¼æ¥èµ·æ¥æ˜¯ä¹±ç ï¼Œå°è¯•å‘ç°æ˜¯AESåŠ å¯†\né‚£ä¹ˆå°±å¯ä»¥å†™ä¸ªè„šæœ¬æå–å‡ºæ‰€æœ‰çš„å‹ç¼©åŒ…äº†\nimport sys import hashlib from Crypto.Cipher import AES def aes_ecb_decrypt(key_utf8, cipher_hex): \"\"\" ä½¿ç”¨ UTF-8 ç¼–ç çš„å¯†é’¥å­—ç¬¦ä¸²è¿›è¡Œ AES ECB è§£å¯† key_utf8: æ™®é€šå­—ç¬¦ä¸²ï¼ˆå¦‚MD5çš„hexç»“æœï¼‰ cipher_hex: åå…­è¿›åˆ¶å¯†æ–‡å­—ç¬¦ä¸² \"\"\" key_bytes = key_utf8.encode('utf-8') # ç›´æ¥è½¬æˆå­—èŠ‚ cipher_bytes = bytes.fromhex(cipher_hex) # å¯†æ–‡hexè½¬å­—èŠ‚ cipher = AES.new(key_bytes, AES.MODE_ECB) plaintext = cipher.decrypt(cipher_bytes) return plaintext def unpad(s): \"\"\"å»é™¤ PKCS7 å¡«å……\"\"\" padding_len = s[-1] if padding_len \u003c 1 or padding_len \u003e 16: return s return s[:-padding_len] def parse_traffic_data(filename): results = {} try: with open(filename, 'r', encoding='utf-8') as f: lines = f.readlines() print(f\"è¯»å–æ–‡ä»¶: {filename}, å…± {len(lines)} è¡Œ\\n\") for i, line in enumerate(lines, 1): line = line.strip() if not line: continue parts = line.split() if len(parts) \u003c 3: continue try: src_port = int(parts[0]) if 30012 \u003c= src_port \u003c= 30091: hex_data = parts[2] if src_port not in results: results[src_port] = [] results[src_port].append(hex_data) except ValueError: continue print(f\"æ‰¾åˆ° {len(results)} ä¸ªç«¯å£çš„æ•°æ®\\n\") print(\"=\" * 70) # è§£å¯†å¹¶ä¿å­˜ for port in sorted(results.keys()): encrypted_hex = ''.join(results[port]) decrypt_and_save(port, encrypted_hex) print(\"=\" * 70) except FileNotFoundError: print(f\"é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ {filename}\") except Exception as e: print(f\"é”™è¯¯: {type(e).__name__}: {str(e)}\") import traceback traceback.print_exc() def decrypt_and_save(port, encrypted_hex): \"\"\"è§£å¯†å•ä¸ªç«¯å£çš„æ•°æ®å¹¶ä¿å­˜ä¸º ZIP\"\"\" try: print(f\"\\nç«¯å£: {port}\") # 1. ç«¯å£å· â†’ MD5 â†’ hexå­—ç¬¦ä¸²ä½œä¸ºå¯†é’¥ port_str = str(port) md5_hash = hashlib.md5(port_str.encode('utf-8')).hexdigest() key_utf8 = md5_hash # MD5çš„hexç»“æœä½œä¸ºUTF-8å­—ç¬¦ä¸²å¯†é’¥ print(f\"ç«¯å£å­—ç¬¦ä¸²: '{port_str}'\") print(f\"MD5å¯†é’¥ (hex): {key_utf8}\") print(f\"å¯†é’¥é•¿åº¦: {len(key_utf8)} å­—ç¬¦\") # 2. è§£å¯† print(f\"å¯†æ–‡é•¿åº¦: {len(encrypted_hex)} å­—ç¬¦ ({len(encrypted_hex) // 2} å­—èŠ‚)\") decrypted = aes_ecb_decrypt(key_utf8, encrypted_hex) print(f\"è§£å¯†åé•¿åº¦: {len(decrypted)} å­—èŠ‚\") # 3. å»é™¤å¡«å…… decrypted = unpad(decrypted) print(f\"å»å¡«å……åé•¿åº¦: {len(decrypted)} å­—èŠ‚\") # 4. æ£€æŸ¥ ZIP æ–‡ä»¶å¤´ if decrypted[:4] == b'PK\\x03\\x04': print(\"âœ“ æ£€æµ‹åˆ° ZIP æ–‡ä»¶å¤´\") else: print(f\"âš  å‰4å­—èŠ‚: {decrypted[:4].hex()} (ZIPåº”ä¸º 504b0304)\") # 5. ä¿å­˜ä¸º ZIP æ–‡ä»¶ output_filename = f\"{port}.zip\" with open(output_filename, 'wb') as f: f.write(decrypted) print(f\"âœ“ æˆåŠŸä¿å­˜: {output_filename}\") except Exception as e: print(f\"âœ— è§£å¯†ç«¯å£ {port} å¤±è´¥: {type(e).__name__}: {str(e)}\") import traceback traceback.print_exc() if __name__ == \"__main__\": target_file = '1.txt' if len(sys.argv) \u003e 1: target_file = sys.argv[1] print(\"=\" * 70) print(\"AES æµé‡æ•°æ®è§£å¯†å·¥å…·\") print(\"=\" * 70) print() parse_traffic_data(target_file) å¾—åˆ°å¯¹åº”çš„å‹ç¼©åŒ…ï¼Œè¿™é‡Œä»”ç»†åˆ†æå‹ç¼©åŒ…é‡Œçš„å†…å®¹æ˜¯4å­—èŠ‚ï¼Œåº”è¯¥æ˜¯CRCçˆ†ç ´,æœ‰ä¸å¯è§å­—ç¬¦å‚è€ƒlunaticå¸ˆå‚…çš„è„šæœ¬\nimport os import zipfile import binascii class CRC32Reverse: def __init__(self, crc32, length, tbl=bytes(range(256)), poly=0xEDB88320, accum=0): self.char_set = set(tbl) self.crc32 = crc32 self.length = length self.poly = poly self.accum = accum self.table = [] self.table_reverse = [] def init_tables(self, poly, reverse=True): for i in range(256): for j in range(8): if i \u0026 1: i \u003e\u003e= 1 i ^= poly else: i \u003e\u003e= 1 self.table.append(i) if reverse: for i in range(256): found = [j for j in range(256) if self.table[j] \u003e\u003e 24 == i] self.table_reverse.append(tuple(found)) def calc(self, data, accum=0): accum = ~accum for b in data: accum = self.table[(accum ^ b) \u0026 0xFF] ^ ((accum \u003e\u003e 8) \u0026 0x00FFFFFF) accum = ~accum return accum \u0026 0xFFFFFFFF def find_reverse(self, desired, accum): solutions = set() accum = ~accum stack = [(~desired,)] while stack: node = stack.pop() for j in self.table_reverse[(node[0] \u003e\u003e 24) \u0026 0xFF]: if len(node) == 4: a = accum data = [] node = node[1:] + (j,) for i in range(3, -1, -1): data.append((a ^ node[i]) \u0026 0xFF) a \u003e\u003e= 8 a ^= self.table[node[i]] solutions.add(tuple(data)) else: stack.append(((node[0] ^ self.table[j]) \u003c\u003c 8,) + node[1:] + (j,)) return solutions def dfs(self, length, outlist=[b'']): if length == 0: return outlist tmp_list = [item + bytes([x]) for item in outlist for x in self.char_set] return self.dfs(length - 1, tmp_list) def run_reverse(self): self.init_tables(self.poly) desired = self.crc32 accum = self.accum result_list = [] if self.length \u003e= 4: patches = self.find_reverse(desired, accum) for item in self.dfs(self.length - 4): patch = list(item) patches = self.find_reverse(desired, self.calc(patch, accum)) for last4 in patches: patch.extend(last4) if self.calc(patch, accum) == desired: result_list.append(bytes(patch)) else: for item in self.dfs(self.length): if self.calc(item) == desired: result_list.append(bytes(item)) return result_list def crc32_reverse(crc32, length, char_set=bytes(range(256)), poly=0xEDB88320, accum=0): return CRC32Reverse(crc32, length, char_set, poly, accum).run_reverse() def scan_zip_crc(dirname, output_bin=\"output.bin\", brute_length=4): results = [] for root, dirs, files in os.walk(dirname): for fname in files: if fname.lower().endswith(\".zip\"): zip_path = os.path.abspath(os.path.join(root, fname)) zip_path = zip_path.replace(\"\\\\\", \"/\") print(f\"[+] å‘ç°å‹ç¼©åŒ…ï¼š{zip_path}\") try: with zipfile.ZipFile(zip_path) as z: for info in z.infolist(): crc = info.CRC print(f\" â†’ æ–‡ä»¶å¤´ï¼š{info.filename} CRC32={crc:08X}\") res = crc32_reverse(crc, brute_length) print(f\" é€†æ¨å¾—åˆ° {len(res)} æ¡ç»“æœ\") results.extend(res) except Exception as e: print(f\"[-] æ— æ³•è¯»å– ZIPï¼š{zip_path}, é”™è¯¯ï¼š{e}\") # å†™å…¥ bin with open(output_bin, \"wb\") as f: for r in results: f.write(r) print(f\"[+] å·²å†™å…¥ {len(results)} æ¡ç»“æœ â†’ {output_bin}\") if __name__ == \"__main__\": scan_zip_crc(\".\", output_bin=\"final_output.bin\", brute_length=4) ç„¶åæ ¹æ®ä¸€å¼€å§‹çš„æç¤ºdeflatedäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬inflateä¸€ä¸‹ï¼Œæ“ä¸ªè„šæœ¬å¾—åˆ°äº†\nimport zlib with open(\"final_output.bin\", \"rb\") as f: data = f.read() all_out = b\"\" # å‡è®¾æ¯å—æ˜¯ 4 å­—èŠ‚ for i in range(0, len(data), 4): block = data[i:i+4] try: # raw deflate è§£å‹ out = zlib.decompress(block, wbits=-15) all_out += out except Exception: pass # æœ‰äº›ç»„åˆå¯èƒ½ä¸æ˜¯çœŸæ­£çš„ deflate æ•°æ® # æœ€ç»ˆæ‹¼æ¥æˆä¸€å¥è¯ try: print(all_out.decode()) # å¦‚æœæ˜¯ ASCII/UTF-8 æ–‡æœ¬ except UnicodeDecodeError: print(all_out) # å¦‚æœåŒ…å«éæ–‡æœ¬å­—èŠ‚ï¼Œç›´æ¥æ‰“å° bytes å¾—åˆ°äº†ä¸€ä¸ªhashçš„å€¼\nåˆ†æä¸€ä¸‹hashï¼Œç®—æ˜¯zipCryptoçš„ç‰¹æ€§ï¼Œé‡Œé¢æ–‡æœ¬å†…å®¹è¾ƒçŸ­ï¼Œåœ¨è¿›è¡Œhashè½¬å‚¨çš„æ—¶å€™ä¼šå°†å†…å®¹å…¨éƒ¨æ”¾å…¥åˆ°hashä¸­è¿›è¡ŒåŠ å¯†ï¼Œä»å¼€å§‹çš„æ–‡æœ¬èŠå¤©å¾—çŸ¥ï¼Œè¿™è¾¹çš„å¯†é’¥å¯ä»¥è¿›è¡Œå¤ç”¨ï¼Œåœ¨å·²çŸ¥hashå’Œkeyåå¯ä»¥hashåæ¨å‹ç¼©åŒ…å¾—åˆ°flagçš„å†…å®¹ï¼Œè„šæœ¬å¦‚ä¸‹\nimport binascii import zlib from typing import Tuple, Optional class ZipCrypto: CRC32_POLYNOMIAL = 0xEDB88320 MAGIC_MULT = 134775813 MAGIC_ADD = 1 def __init__(self, key0: int, key1: int, key2: int): self.keys = [key0, key1, key2] self.crc_table = self._build_crc_table() def _build_crc_table(self) -\u003e list: table = [] for i in range(256): crc = i for _ in range(8): if crc \u0026 1: crc = (self.CRC32_POLYNOMIAL ^ (crc \u003e\u003e 1)) \u0026 0xFFFFFFFF else: crc = (crc \u003e\u003e 1) \u0026 0xFFFFFFFF table.append(crc) return table def _crc32(self, old_crc: int, byte: int) -\u003e int: return (self.crc_table[(old_crc ^ byte) \u0026 0xFF] ^ (old_crc \u003e\u003e 8)) \u0026 0xFFFFFFFF def _update_keys(self, plaintext_byte: int): self.keys[0] = self._crc32(self.keys[0], plaintext_byte) self.keys[1] = (self.keys[1] + (self.keys[0] \u0026 0xFF)) \u0026 0xFFFFFFFF self.keys[1] = (self.keys[1] * self.MAGIC_MULT + self.MAGIC_ADD) \u0026 0xFFFFFFFF self.keys[2] = self._crc32(self.keys[2], (self.keys[1] \u003e\u003e 24) \u0026 0xFF) def _decrypt_byte(self) -\u003e int: temp = (self.keys[2] | 3) \u0026 0xFFFFFF return ((temp * (temp ^ 1)) \u003e\u003e 8) \u0026 0xFF def decrypt(self, ciphertext: bytes) -\u003e bytes: plaintext = bytearray() for cipher_byte in ciphertext: keystream_byte = self._decrypt_byte() plain_byte = cipher_byte ^ keystream_byte self._update_keys(plain_byte) plaintext.append(plain_byte) return bytes(plaintext) def extract_encrypted_data(pkzip_hash: str) -\u003e Optional[bytes]: clean = pkzip_hash.replace(\"$pkzip$\", \"\").replace(\"$/pkzip$\", \"\").strip() parts = clean.split('*') hex_data = max( (p for p in parts if all(c in '0123456789abcdefABCDEF' for c in p)), key=len, default=\"\" ) if not hex_data: return None try: return binascii.unhexlify(hex_data) except binascii.Error: return None def try_decompress(data: bytes) -\u003e Tuple[bool, bytes]: try: # -15 è¡¨ç¤º raw deflateï¼ˆä¸å« zlib å¤´ï¼‰ decompressed = zlib.decompress(data, -15) return True, decompressed except zlib.error: return False, data def display_result(data: bytes, label: str = \"å†…å®¹\"): print(f\"\\n{'=' * 60}\") print(f\"[{label}]\") print('=' * 60) try: text = data.decode('utf-8') print(text) except UnicodeDecodeError: print(f\"Raw: {repr(data)}\") print(f\"Hex: {binascii.hexlify(data).decode()}\") print('=' * 60) def main(): TARGET_HASH = \"$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$\" K0 = 0xb47e923c K1 = 0x5aeb49a7 K2 = 0xa3cd7af0 print(\"ZIP Crypto è§£å¯†å·¥å…·\") print(f\"å¯†é’¥çŠ¶æ€: K0={hex(K0)}, K1={hex(K1)}, K2={hex(K2)}\") encrypted = extract_encrypted_data(TARGET_HASH) if encrypted is None: print(\"\\n[é”™è¯¯] æ— æ³•ä» hash ä¸­æå–åŠ å¯†æ•°æ®\") return print(f\"\\n[*] æå–åˆ° {len(encrypted)} å­—èŠ‚åŠ å¯†æ•°æ®\") print(f\" å‰ 20 å­—èŠ‚: {binascii.hexlify(encrypted[:20]).decode()}...\") crypto = ZipCrypto(K0, K1, K2) decrypted = crypto.decrypt(encrypted) if len(decrypted) \u003c= 12: print(\"\\n[é”™è¯¯] è§£å¯†æ•°æ®è¿‡çŸ­ï¼ˆéœ€è¦ \u003e12 å­—èŠ‚ï¼‰\") return actual_data = decrypted[12:] print(f\"[*] ç§»é™¤åŠ å¯†å¤´åå‰©ä½™ {len(actual_data)} å­—èŠ‚\") display_result(actual_data, \"è§£å¯†å†…å®¹ (Stored)\") is_compressed, final_data = try_decompress(actual_data) if is_compressed: print(\"\\n[!] æ£€æµ‹åˆ° DEFLATE å‹ç¼©æ•°æ®\") display_result(final_data, \"è§£å‹åå†…å®¹\") else: print(\"\\n[*] æ•°æ®æœªå‹ç¼©ï¼ˆä½¿ç”¨ Stored æ–¹æ³•ï¼‰\") if __name__ == \"__main__\": main() è¿”ç’å½’çœŸ(ä¸€è¡€) ç»™çš„å‹ç¼©åŒ…å¼€å¤´æœ‰æç¤ºhashisk3y\nè¿™é‡Œç›´æ¥ä¼ªåŠ å¯†è§£å‹å¾—åˆ°å›¾ç‰‡ï¼Œåˆ©ç”¨foremostè¿›è¡Œåˆ†ç¦»å¾—åˆ°dmp,åˆ©ç”¨é¡¹ç›®\nPaperBack\nè¿›è¡Œåˆ†ç¦»æ‹¿åˆ°æ–‡æœ¬å†…å®¹ï¼Œè¿™é‡Œæ˜¯23å­—èŠ‚ï¼Œå¡äº†ä¸€ä¼šï¼Œæœ€åæ˜¯çŒœæµ‹æ˜¯RC4ï¼Œå°†å¯èƒ½çš„hashå€¼éƒ½è¿è¡Œä¸‹æ¥ï¼Œç›´æ¥æ‰”ä¸ªaiåˆ†æå¾—åˆ°flag\nimport base64 import binascii # 1. å¯†æ–‡ cipher_b64 = \"jNX+xu2QKBm23AUlwClt+3xDkQcJGjM=\" cipher_data = base64.b64decode(cipher_b64) # 2. å¯†é’¥æ±  (æ¥æºäºä½ æä¾›çš„æ–‡ä»¶ Hash) # æ ¼å¼: (æè¿°, MD5 Hexå­—ç¬¦ä¸²) candidates = [ (\"Hint String (hashisk3y)\", \"298e85501e91238426e2e542d9925232\"), # MD5(\"hashisk3y\") (\"00000000.jpg\", \"001a62ee54d1c28a8b769ab5499011cb\"), (\"00000698.bmp\", \"5166b497bb66913fc0e23fd82980538f\"), (\"image.jpg\", \"652365effd5138036c26382004b8d6bd\"), (\"è¿”ç’å½’çœŸ.zip\", \"369f792f2edf63102fe12e1951ec899f\") ] # RC4 å®ç° def rc4(data, key): # ç¡®ä¿ key æ˜¯ bytes if isinstance(key, str): key = key.encode() S = list(range(256)) j = 0 out = [] # KSA for i in range(256): j = (j + S[i] + key[i % len(key)]) % 256 S[i], S[j] = S[j], S[i] # PRGA i = j = 0 for char in data: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] out.append(char ^ S[(S[i] + S[j]) % 256]) return bytes(out) print(f\"--- å¼€å§‹ RC4 æ‰¹é‡çˆ†ç ´ (å°è¯• {len(candidates) * 2} ç§ç»„åˆ) ---\") found = False for label, md5_hex in candidates: # æ–¹å¼ A: å¯†é’¥å°±æ˜¯ 32ä½çš„ Hex å­—ç¬¦ä¸² (ä¾‹å¦‚ \"001a...\") key_str = md5_hex res_a = rc4(cipher_data, key_str) # æ–¹å¼ B: å¯†é’¥æ˜¯ Hex è½¬æ¢åçš„ 16ä½ åŸå§‹å­—èŠ‚ (ä¾‹å¦‚ \\x00\\x1a...) try: key_bytes = binascii.unhexlify(md5_hex) res_b = rc4(cipher_data, key_bytes) except: res_b = b\"\" # æ£€æŸ¥ç»“æœ A try: text_a = res_a.decode('utf-8') if \"flag\" in text_a.lower() or \"ctf\" in text_a.lower(): print(f\"\\nğŸ”¥ğŸ”¥ğŸ”¥ [SUCCESS] æ‰¾åˆ° Flag! ğŸ”¥ğŸ”¥ğŸ”¥\") print(f\"æ¥æº: {label}\") print(f\"å¯†é’¥ç±»å‹: Hex String (32 chars)\") print(f\"Key : {key_str}\") print(f\"Flag: {text_a}\") found = True break except: pass # è§£ç å¤±è´¥è¯´æ˜ä¸æ˜¯ flag # æ£€æŸ¥ç»“æœ B try: text_b = res_b.decode('utf-8') if \"flag\" in text_b.lower() or \"ctf\" in text_b.lower(): print(f\"\\nğŸ”¥ğŸ”¥ğŸ”¥ [SUCCESS] æ‰¾åˆ° Flag! ğŸ”¥ğŸ”¥ğŸ”¥\") print(f\"æ¥æº: {label}\") print(f\"å¯†é’¥ç±»å‹: Raw Bytes (16 bytes)\") print(f\"Key (Hex): {md5_hex}\") print(f\"Flag: {text_b}\") found = True break except: pass if not found: print(\"æœªèƒ½è§£å‡ºåŒ…å« 'flag' å­—æ ·çš„ç»“æœã€‚\") print(\"è°ƒè¯•è¾“å‡º (çœ‹çœ‹æœ‰æ²¡æœ‰ç±»ä¼¼ flag çš„ä¹±ç ):\") # æ‰“å°ä¸€ä¸‹ hashisk3y çš„ç»“æœçœ‹çœ‹æ ·å­ print(f\"Try 1: {rc4(cipher_data, candidates[0][1]).decode('utf-8', 'ignore')}\") çŒ«å’ªç”µå°(ä¸€è¡€) é¢˜ç›®ç»™äº†ä¸€ä¸ªå›¾ç‰‡å’Œä¸€ä¸ªwav\nå›¾ç‰‡é‡Œé¢åº”è¯¥æœ‰ä¸œè¥¿ï¼Œåˆ†æä¸€ä¸‹lsbéšå†™ï¼Œæå–å‡ºæ¥\nå»æ‰å¼€å¤´fffeå¾—åˆ°å›¾ç‰‡\nwavç”¨010åˆ†æåé¢æœ‰ä¸€ä¸ªå·¨å¤§çš„å‹ç¼©åŒ…ï¼Œåˆ†ç¦»å‡ºæ¥ã€‚\næ ¹æ®æ–‡ä»¶å¤¹çš„æç¤ºï¼Œä»¥åŠå°è¯•å‘ç°1.wavä¸æ˜¯sstvåè”æƒ³åˆ°æ˜¯æ— çº¿ç”µçš„éŸ³é¢‘\né—®aiæœ‰å“ªäº›å·¥å…·å¯ä»¥è¿›è¡Œå°è¯•\nå¾—åˆ°äº†part1 R77YM30W1SFUN\nè¿™ä¸ªå¯†ç å¯ä»¥è§£å‹å¾—åˆ°2.wav\n2.wavæ˜¯ä¸ªå¾ˆæ‚çš„éŸ³ï¼ŒåŒå£°é“\n# è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯ï¼šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹æ˜¯ (é€šé“1 - é€šé“2) sox 2.wav -c 1 recovered.wav remix 1v0.5 2v-0.5 ä½†è¿˜æ˜¯æ‚éŸ³\nå›å¤´çœ‹äº†ä¸€ä¸‹æ–‡ä»¶çš„hz\nfile 2.wav 2.wav: MBWF/RF64 audio, stereo 2400000 Hz è·‘å‡ºä¸ªè„šæœ¬\nimport numpy as np from scipy.io import wavfile from scipy.signal import resample_poly, decimate def auto_tune_and_demod(filename): print(f\"[*] æ­£åœ¨è¯»å–é«˜é‡‡æ ·ç‡æ–‡ä»¶ {filename} (å¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´)...\") fs, data = wavfile.read(filename) # ç¡®ä¿æ˜¯æµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ– data = data.astype(np.float32) data /= np.max(np.abs(data)) # ç»„åˆæˆ IQ ä¿¡å· # æ³¨æ„ï¼šè§†ä¸åŒè®¾å¤‡ï¼ŒQ å¯èƒ½éœ€è¦åè½¬ã€‚å¦‚æœå¬ä¸æ¸…ï¼Œå¯ä»¥æŠŠä¸‹è¡Œæ”¹ä¸º data[:, 0] - 1j * data[:, 1] iq = data[:, 0] + 1j * data[:, 1] print(f\"[*] åŸå§‹é‡‡æ ·ç‡: {fs} Hz. æ­£åœ¨å¯»æ‰¾æœ€å¼ºä¿¡å·é¢‘ç‡...\") # 1. å¯»æ‰¾æœ€å¼ºé¢‘ç‡ (FFT) # å–ä¸­é—´ä¸€æ®µæ ·æœ¬åˆ†æï¼Œé¿å…å¤´éƒ¨å°¾éƒ¨å™ªéŸ³ n_fft = 1024 * 16 start = len(iq) // 2 slice_iq = iq[start: start + n_fft] spectrum = np.fft.fftshift(np.fft.fft(slice_iq)) freqs = np.fft.fftshift(np.fft.fftfreq(len(slice_iq), 1 / fs)) # å¿½ç•¥ DC (0Hz) é™„è¿‘çš„å³°å€¼ï¼Œå› ä¸ºé‚£é€šå¸¸æ˜¯ç¡¬ä»¶ç›´æµåç½® dc_mask = (np.abs(freqs) \u003e 2000) valid_indices = np.where(dc_mask) peak_idx = valid_indices[0][np.argmax(np.abs(spectrum)[valid_indices])] target_freq = freqs[peak_idx] print(f\"[!] é”å®šæœ€å¼ºä¿¡å·é¢‘ç‡: {target_freq:.2f} Hz\") # 2. ç§»é¢‘ (Frequency Shift) # å°†ç›®æ ‡é¢‘ç‡ç§»åŠ¨åˆ° 0 Hz print(\"[*] æ­£åœ¨è°ƒè° (ç§»é¢‘)...\") t = np.arange(len(iq)) / fs shifted_iq = iq * np.exp(-1j * 2 * np.pi * target_freq * t) # 3. é™é‡‡æ · (Decimation) # ç›®æ ‡æ˜¯ 48kHz éŸ³é¢‘ï¼Œæ‰€ä»¥é™é‡‡æ ·å› å­ = 2.4M / 48k = 50 target_fs = 48000 decimation_factor = int(fs / target_fs) print(f\"[*] æ­£åœ¨é™é‡‡æ · (å› å­: {decimation_factor})...\") # ä½¿ç”¨ decimate è¿›è¡Œä½é€šæ»¤æ³¢ + æŠ½å– # complex=True å¤„ç†å¤æ•° downsampled_iq = decimate(shifted_iq, decimation_factor, ftype='fir') # 4. NFM è§£è°ƒ print(\"[*] æ­£åœ¨è¿›è¡Œ NFM è§£è°ƒ...\") phase = np.angle(downsampled_iq) audio = np.diff(np.unwrap(phase)) # ä¿å­˜ out_name = \"final_decoded.wav\" audio = audio / np.max(np.abs(audio)) * 32767 wavfile.write(out_name, target_fs, audio.astype(np.int16)) print(f\"[+] æˆåŠŸï¼å·²ä¿å­˜ä¸º: {out_name}\") print(\"[!] è¯·æ’­æ”¾è¯¥æ–‡ä»¶ï¼Œå¦‚æœæ˜¯äººå£°/æ‹¨å·å£°ï¼ŒFlagå°±åœ¨å…¶ä¸­ï¼\") if __name__ == \"__main__\": auto_tune_and_demod(\"2.wav\") å‘ç°ä¸­é—´æ˜¯æœ‰ç±»ä¼¼sstvçš„ä¸œè¥¿çš„ï¼Œç”¨å·¥å…·è·‘çœ‹çœ‹\næ˜¯å›¾ç‰‡ä¸è¿‡éœ€è¦å»å™ªå•Š\nç„¶åå†™äº†ä¸€ä¸ªç¨å¾®èƒ½çœ‹åˆ°ä¸€ç‚¹çš„\nimport numpy as np from scipy.io import wavfile from scipy.signal import resample_poly, decimate, butter, lfilter def butter_bandpass(lowcut, highcut, fs, order=5): nyq = 0.5 * fs low = lowcut / nyq high = highcut / nyq b, a = butter(order, [low, high], btype='band') return b, a def butter_bandpass_filter(data, lowcut, highcut, fs, order=5): b, a = butter_bandpass(lowcut, highcut, fs, order=order) y = lfilter(b, a, data) return y def auto_tune_and_demod(filename): print(f\"[*] æ­£åœ¨è¯»å–é«˜é‡‡æ ·ç‡æ–‡ä»¶ {filename} ...\") fs, data = wavfile.read(filename) # è½¬ä¸ºæµ®ç‚¹å¹¶å½’ä¸€åŒ– data = data.astype(np.float32) data /= np.max(np.abs(data)) # ç»„åˆæˆ IQ ä¿¡å· iq = data[:, 0] + 1j * data[:, 1] print(f\"[*] åŸå§‹é‡‡æ ·ç‡: {fs} Hz. æ­£åœ¨å¯»æ‰¾æœ€å¼ºä¿¡å·é¢‘ç‡...\") # 1. å¯»æ‰¾æœ€å¼ºé¢‘ç‡ n_fft = 1024 * 16 start = len(iq) // 2 slice_iq = iq[start: start + n_fft] spectrum = np.fft.fftshift(np.fft.fft(slice_iq)) freqs = np.fft.fftshift(np.fft.fftfreq(len(slice_iq), 1 / fs)) # å¿½ç•¥ DC é™„è¿‘çš„å™ªéŸ³ dc_mask = (np.abs(freqs) \u003e 2000) valid_indices = np.where(dc_mask) peak_idx = valid_indices[0][np.argmax(np.abs(spectrum)[valid_indices])] target_freq = freqs[peak_idx] print(f\"[!] é”å®šæœ€å¼ºä¿¡å·é¢‘ç‡: {target_freq:.2f} Hz\") # 2. ç§»é¢‘ print(\"[*] æ­£åœ¨è°ƒè° (ç§»é¢‘)...\") t = np.arange(len(iq)) / fs shifted_iq = iq * np.exp(-1j * 2 * np.pi * target_freq * t) # 3. é™é‡‡æ · target_fs = 48000 decimation_factor = int(fs / target_fs) print(f\"[*] æ­£åœ¨é™é‡‡æ · (å› å­: {decimation_factor})...\") downsampled_iq = decimate(shifted_iq, decimation_factor, ftype='fir') # 4. NFM è§£è°ƒ print(\"[*] æ­£åœ¨è¿›è¡Œ NFM è§£è°ƒ...\") phase = np.angle(downsampled_iq) audio = np.diff(np.unwrap(phase)) # 5. SSTV ä¸“ç”¨å»å™ª (å¸¦é€šæ»¤æ³¢ 1100Hz - 2500Hz) print(\"[*] æ­£åœ¨åº”ç”¨ SSTV ä¸“ç”¨æ»¤æ³¢å™¨ (1100Hz - 2500Hz)...\") audio_filtered = butter_bandpass_filter(audio, 1100, 2500, target_fs, order=6) # ä¿å­˜ out_name = \"final_sstv_clean.wav\" # é‡æ–°å½’ä¸€åŒ– audio_filtered = audio_filtered / np.max(np.abs(audio_filtered)) * 32000 wavfile.write(out_name, target_fs, audio_filtered.astype(np.int16)) print(f\"[+] æˆåŠŸï¼å·²ç”Ÿæˆå¹²å‡€çš„ SSTV éŸ³é¢‘: {out_name}\") print(\"[!] æç¤º: è§£ç æ—¶å¦‚æœå›¾ç‰‡è¿˜æ˜¯æ–œçš„ï¼Œè¯·å°è¯•åœ¨è½¯ä»¶é‡Œè°ƒæ•´ 'Slant Correction' æˆ– 'Auto Slant'ã€‚\") if __name__ == \"__main__\": auto_tune_and_demod(\"2.wav\") å‡ºçš„æ—¶å€™è¯•äº†å¥½å‡ æ¬¡ï¼Œæœ€ååº”è¯¥æ˜¯2nd part _C4T9L1V3S\nflag{Ci4l10~R77YM30W1SFUN_C4T9L1V3S} åè¯ èµ›ä¸­è¿˜ç ”å­¦äº†ä¸€ä¸‹webå±‚å±‚åŠ ç ï¼Œn4clå¸ˆå‚…payloadä¸€ç©¿ä¸‰å¤ªå¼ºäº†ï¼Œå¯æƒœ3.2è¿‡äºæ¶å¿ƒã€‚\nä¸»åŠæ–¹è¿‡äºå¯Œè£•ï¼Œçº¿ä¸‹æ¯”èµ›ä½“æ„Ÿæœ€å¥½çš„ä¸€é›†ï¼Œå’Œå¾ˆå¤šSUçš„ä¼™ä¼´è§é¢çº¦é¥­äº†ã€‚è¿™é‡Œè¿˜æ˜¯å®£ä¼ ä¸€æ³¢ï¼Œæ¬¢è¿å„ä½æœ‰æ„åŠ å…¥æˆ˜é˜Ÿçš„å¸ˆå‚…ä»¬æŠ•é€’ç®€å†åˆ°SUsu-teamã€‚æˆ˜é˜Ÿé‡‡ç”¨çš„æ˜¯candidateè¿‡æ¸¡è€ƒå¯Ÿçš„æœºåˆ¶ï¼Œè¿›å…¥æˆ‘ä»¬çš„Discordæ‰“å‡ å‘¨ä¹‹åè€ƒå¯Ÿè½¬æ­£(é—®äº†ä¸€ä¸‹å¤„åœ¨candidateçš„å¸ˆå‚…ä»¬èµ·åˆè§‰å¾—æˆ‘ä»¬å¯èƒ½å®¡æ ¸æ¯”è¾ƒä¸¥ï¼Œé—¹å¤§è¯¯ä¼šäº†)ï¼Œç¥SUå…¨å¹´èµ·é£ï¼Œå¶å°”æ‘¸é±¼ã€‚\n","wordCount":"6043","inLanguage":"zh-cn","datePublished":"2025-11-30T00:00:00Z","dateModified":"2025-11-30T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/ctf/qwnt2025/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=é¦–é¡µ><span>é¦–é¡µ</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=æœç´¢><span>æœç´¢</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=å…³äº><span>å…³äº</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=å‹é“¾><span>å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-11-30 00:00:00 +0000 UTC'>November 30, 2025</span>&nbsp;Â·&nbsp;<span>13 min</span><h1 class=post-title>ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h1 id=misc>Misc</h1><h2 id=æ³„æ¼çš„æ—¶é—´ä¸ç”µç ä¸‰è¡€>æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€)</h2><p>æŠŠlogå’Œchalçš„åŠ å¯†è„šæœ¬ç›´æ¥æ‰”ç»™ai</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>():
</span></span><span style=display:flex><span>    timings <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1.110270</span>, <span style=color:#ae81ff>0.924169</span>, <span style=color:#ae81ff>1.139244</span>, <span style=color:#ae81ff>0.670085</span>, <span style=color:#ae81ff>0.915054</span>, <span style=color:#ae81ff>1.154452</span>, <span style=color:#ae81ff>0.224613</span>, <span style=color:#ae81ff>0.329060</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.774615</span>, <span style=color:#ae81ff>0.279617</span>, <span style=color:#ae81ff>0.954166</span>, <span style=color:#ae81ff>0.430143</span>, <span style=color:#ae81ff>0.414914</span>, <span style=color:#ae81ff>1.224826</span>, <span style=color:#ae81ff>1.310686</span>, <span style=color:#ae81ff>1.265828</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.110950</span>, <span style=color:#ae81ff>1.225669</span>, <span style=color:#ae81ff>1.404647</span>, <span style=color:#ae81ff>0.575287</span>, <span style=color:#ae81ff>1.455927</span>, <span style=color:#ae81ff>0.975492</span>, <span style=color:#ae81ff>0.305642</span>, <span style=color:#ae81ff>0.835893</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1.245893</span>, <span style=color:#ae81ff>0.569651</span>, <span style=color:#ae81ff>1.060266</span>, <span style=color:#ae81ff>0.149129</span>, <span style=color:#ae81ff>0.844243</span>, <span style=color:#ae81ff>1.294104</span>, <span style=color:#ae81ff>0.079101</span>, <span style=color:#ae81ff>0.914897</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1.025389</span>, <span style=color:#ae81ff>0.270495</span>, <span style=color:#ae81ff>0.225577</span>, <span style=color:#ae81ff>0.654189</span>, <span style=color:#ae81ff>1.385665</span>, <span style=color:#ae81ff>0.755860</span>, <span style=color:#ae81ff>0.450597</span>, <span style=color:#ae81ff>0.950750</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.839268</span>, <span style=color:#ae81ff>1.015624</span>, <span style=color:#ae81ff>0.895000</span>, <span style=color:#ae81ff>0.794687</span>, <span style=color:#ae81ff>1.064966</span>, <span style=color:#ae81ff>1.200042</span>, <span style=color:#ae81ff>0.559413</span>, <span style=color:#ae81ff>0.980588</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.525959</span>, <span style=color:#ae81ff>0.514992</span>, <span style=color:#ae81ff>0.629261</span>, <span style=color:#ae81ff>0.489585</span>, <span style=color:#ae81ff>1.089786</span>, <span style=color:#ae81ff>0.880690</span>, <span style=color:#ae81ff>1.374392</span>, <span style=color:#ae81ff>0.789075</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.814771</span>, <span style=color:#ae81ff>1.455273</span>, <span style=color:#ae81ff>1.050996</span>, <span style=color:#ae81ff>0.234891</span>, <span style=color:#ae81ff>1.074220</span>, <span style=color:#ae81ff>0.099300</span>, <span style=color:#ae81ff>1.319762</span>, <span style=color:#ae81ff>0.935773</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0.454985</span>, <span style=color:#ae81ff>0.425895</span>, <span style=color:#ae81ff>0.704892</span>, <span style=color:#ae81ff>1.095786</span>, <span style=color:#ae81ff>1.165433</span>, <span style=color:#ae81ff>1.295589</span>, <span style=color:#ae81ff>0.749113</span>, <span style=color:#ae81ff>0.885320</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1.244904</span>, <span style=color:#ae81ff>0.659642</span>, <span style=color:#ae81ff>0.635889</span>, <span style=color:#ae81ff>0.435427</span>, <span style=color:#ae81ff>0.520476</span>, <span style=color:#ae81ff>0.870549</span>, <span style=color:#ae81ff>0.890145</span>, <span style=color:#ae81ff>1.125522</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1.064915</span>, <span style=color:#ae81ff>0.399210</span>, <span style=color:#ae81ff>0.865873</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LFSR</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self):
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x92</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>step</span>(self):
</span></span><span style=display:flex><span>            bit <span style=color:#f92672>=</span> ((self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>^</span> (self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>^</span> (self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>^</span> (self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>4</span>)) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>lfsr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>|</span> (bit <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>lfsr
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    machine <span style=color:#f92672>=</span> LFSR()
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    inv_31 <span style=color:#f92672>=</span> pow(<span style=color:#ae81ff>31</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>256</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;Time&#39;</span><span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;12</span><span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;Ops&#39;</span><span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;5</span><span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;Char&#39;</span><span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> timings:
</span></span><span style=display:flex><span>        ops <span style=color:#f92672>=</span> round(t <span style=color:#f92672>/</span> <span style=color:#ae81ff>0.005</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ops <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            base_ops <span style=color:#f92672>=</span> ops <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            base_ops <span style=color:#f92672>=</span> ops <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        val <span style=color:#f92672>=</span> ((base_ops <span style=color:#f92672>-</span> <span style=color:#ae81ff>85</span>) <span style=color:#f92672>*</span> inv_31) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        k <span style=color:#f92672>=</span> machine<span style=color:#f92672>.</span>step()
</span></span><span style=display:flex><span>        char_code <span style=color:#f92672>=</span> val <span style=color:#f92672>^</span> k
</span></span><span style=display:flex><span>        char <span style=color:#f92672>=</span> chr(char_code)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        flag <span style=color:#f92672>+=</span> char
</span></span><span style=display:flex><span>        <span style=color:#75715e># æ‰“å°æ—¶é—´å¯¹åº”å…³ç³»</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>t<span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;12.6f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span>ops<span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;5</span><span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span>char<span style=color:#e6db74>:</span><span style=color:#e6db74>&lt;5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+]Recovered: </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>flag<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    solve()
</span></span></code></pre></div><p><img alt=2025-11-28123536 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28123536.png></p><p><del>ä¹‹åæ²¡æ€è·¯æ— èƒ½ç‹‚æ€’äº†ä¸€å¤©</del></p><p>å®˜æ–¹hintçš„å†…å®¹æ˜¯ModR/M</p><p>å·²çŸ¥ç»™çš„chalçš„elfæ–‡ä»¶å°±è¯´åŠ å¯†è„šæœ¬ç›´æ¥åœ¨linuxç¯å¢ƒç¼–è¯‘çš„ï¼Œå°è¯•åç¼–è¯‘æœªæ‰¾åˆ°å¯åˆ©ç”¨çš„å†…å®¹ï¼Œåˆ©ç”¨aiæ£€ç´¢ä¿¡æ¯ModR/Mï¼Œé—®äº†éšå†™å¾—åˆ°äº†ä¸€ä¸ªé¡¹ç›®</p><p><a href=https://github.com/woodruffw/steg86>woodruffw/steg86: Hiding messages in x86 programs using semantic duals</a></p><p>çŒœæµ‹å¯èƒ½æ˜¯ï¼Œè£…ä¸€ä¸‹ç¯å¢ƒ</p><p><img alt=2025-11-28091510 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28091510.png></p><p>å¾—åˆ°äº†è¿™ä¸ªå†…å®¹ï¼ŒæŠŠå¯†æ–‡å’Œå­—ç¬¦è¡¨æ‰”ä¸ªai</p><p><img alt=2025-11-28123949 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28123949.png></p><p>Vim ç¼–è¾‘å™¨è¿›è¡Œå®æ“ä½œéªŒè¯çš„ä¸€ä¸ªé¢˜ç›®</p><h2 id=æ ‡å‡†çš„ç»å¯†å‹ç¼©ä¸‰è¡€>æ ‡å‡†çš„ç»å¯†å‹ç¼©(ä¸‰è¡€)</h2><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œ</p><p>ç®€å•çš„tcpåˆ†æå‘ç°æ˜¯æœ‰pngçš„hexæµçš„</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>tshark -r capture.pcapng -Y <span style=color:#e6db74>&#34;tcp&#34;</span> -T fields -e data &gt;<span style=color:#ae81ff>1</span>.txt
</span></span></code></pre></div><p>ç„¶åæå–å‡ºæ‰€æœ‰çš„å›¾ç‰‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> binascii
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_pngs</span>(input_file):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(input_file, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        lines <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    reassembled_hex_string <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> line:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            payload_bytes <span style=color:#f92672>=</span> binascii<span style=color:#f92672>.</span>unhexlify(line)
</span></span><span style=display:flex><span>            payload_str <span style=color:#f92672>=</span> payload_bytes<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> re<span style=color:#f92672>.</span><span style=color:#66d9ef>match</span>(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;^[0-9a-fA-F]+$&#39;</span>, payload_str):
</span></span><span style=display:flex><span>                reassembled_hex_string <span style=color:#f92672>+=</span> payload_str
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> (<span style=color:#a6e22e>UnicodeDecodeError</span>, binascii<span style=color:#f92672>.</span>Error):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        full_binary <span style=color:#f92672>=</span> binascii<span style=color:#f92672>.</span>unhexlify(reassembled_hex_string)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> binascii<span style=color:#f92672>.</span>Error:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Error converting reassembled string to binary. Check data integrity.&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    png_signature <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x89</span><span style=color:#e6db74>PNG</span><span style=color:#ae81ff>\r\n\x1a\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    parts <span style=color:#f92672>=</span> full_binary<span style=color:#f92672>.</span>split(png_signature)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i, part <span style=color:#f92672>in</span> enumerate(parts):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> i <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        png_data <span style=color:#f92672>=</span> png_signature <span style=color:#f92672>+</span> part
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        iend_marker <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;IEND&#39;</span>
</span></span><span style=display:flex><span>        iend_index <span style=color:#f92672>=</span> png_data<span style=color:#f92672>.</span>find(iend_marker)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> iend_index <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            end_of_file <span style=color:#f92672>=</span> iend_index <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>            png_data <span style=color:#f92672>=</span> png_data[:end_of_file]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;extracted_</span><span style=color:#e6db74>{</span>count<span style=color:#e6db74>}</span><span style=color:#e6db74>.png&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> out:
</span></span><span style=display:flex><span>                out<span style=color:#f92672>.</span>write(png_data)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;[+] Extracted: </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>            count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>extract_pngs(<span style=color:#e6db74>&#39;1.txt&#39;</span>)
</span></span></code></pre></div><p>æå–å‡ºæ¥å‘ç°æ˜¯1kbè§„åˆ™çš„å›¾ç‰‡ï¼Œçœ‹ä¸å‡ºä»»ä½•åå ‚ï¼Œ<del>äºæ˜¯æ”¾å¼ƒ(ä¸­é€”ä¸‰ä¸ªå°æ—¶å»çœ‹äº†å…¶ä»–çš„)</del></p><p>æœ€ç»ˆè¿˜æ˜¯å›å½’pngçš„ï¼Œå°è¯•äº†</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pngcheck extracted_*
</span></span></code></pre></div><p>30å¼ å›¾ç‰‡éƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸”éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œé‚£ä¹ˆå°±æ˜¯æœç€pngæƒ³ï¼Œç¿»äº†ç¿»lunaticå¸ˆå‚…çš„åšå®¢ï¼Œæ£€ç´¢åˆ°äº†å¯èƒ½æ˜¯idatéšå†™ï¼Œæ‰‹åŠ¨è°ƒæ•´ä¸€ä¸‹</p><p><img alt=2025-11-27184405 loading=lazy src=/posts/ctf/qwnt2025/2025-11-27184405.png></p><p>è¶…ç»éœ‡æ’¼ï¼ŒæŠŠ30æ¡ä¿¡æ¯éƒ½æå–å‡ºæ¥ï¼Œæœ€åçš„ä¿¡æ¯æ˜¯</p><pre tabindex=0><code>Connection established. Hey, you online? Itâ€™s been a while since we last talked.
Yeah, Iâ€™m here. Busy as always. Feels like the days are getting shorter.
Tell me about it. I barely have time to sleep lately. Between maintenance logs and incident reports, Iâ€™m drowning.
Sounds rough. Iâ€™ve been buried in audits myself. Every time I finish one, another pops up.
Classic. Sometimes I wonder if the machines are easier to deal with than the people.
No kidding. At least machines donâ€™t ask pointless questions.
True. Anyway, before I forgetâ€”howâ€™s that side project you were working on? The one you wouldnâ€™t shut up about months ago.
Still aliveâ€¦ barely. Progress is slow, but steady. You know meâ€”I donâ€™t give up easily.
Good. I hope it pays off one day.
Thanks. Alrightâ€¦ Iâ€™m guessing you didnâ€™t ping me just to chat?
Well, half of it was. Itâ€™s been a while. But yesâ€”I do have something for you today. Before sending the core cipher, Iâ€™ll transmit an encrypted archive first. It contains a sample text and the decryption rules.     
Okay. Whatâ€™s special about this sample text?
Andâ€¦ inside the sample text, I used my favorite Herobrine legendâ€”you know the one I always bring up.
Of course I know. The hidden original text from that weird old site, right?
What can I sayâ€”old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password.
Got it. So if I can decrypt the sample, the real one should be straightforward.
Exactly. Send the sample when ready.
Iâ€™m ready. Go ahead.
UEsDBBQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJAAAAcnVsZXMudHh07XuRBFDbojGKhAz59VaKEpwD6/rKaZnqUxf+NMH0rybWrAMPewZ/yGyLrMKQjNIcEbPAxjmP5oTh8fP77Vi1wnFwzN37BmrQ9SCkC27FC/xeqbgw/HWcDpgzsEoiNpqT9ZThrbAScyg5syfJmNactjelNVBLAwQUAAEACACGOXhbpdvG1ysBAAAVAgAACgAAAHNhbXBsZS50eHTA1fy4cMLZwZkTI1mEk88yOXy9rmbTbCNBQOo9hqKQPK6vjZVo9aCtTVflmkKYGV99+51qXbinmG7WGik5UvLJk9MKRosThBCDMHrmjibOCzjzNELwEgEyX8DjqJkSc8pIFwj+oRM3bb4i0GtRxbwqgsxCtgwiKdCVoXVdetN7RKLIQ7DD+Huv/ZptNdd0yRNHis9LEA3loB+IHZ+dK7IknqPh4lYF8JwAjx5/wwp0YAM6Bcec7uAvk6B5t1pEztm1rLl8TjniVz5/bBUTo1LjUXnar/pnm1NvE9EAuxz/s6b+O8/ew7/A4ItdNJGzDudh6YULfiV3pCTXFIbR4GCe4LwkohWZIlAjysA+zLRrgkTDoB10vWdNGdfoBAlLRoUdZ95mS7X5/bXV41BLAQI/ABQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJACQAAAAAAAAAIAAAAAAAAABydWxlcy50eHQKACAAAAAAAAEAGABIv3f82lzcAQAAAAAAAAAAAAAAAAAAAABQSwECPwAUAAEACACGOXhbpdvG1ysBAAAVAgAACgAkAAAAAAAAACAAAACaAAAAc2FtcGxlLnR4dAoAIAAAAAAAAQAYAFP0sZjOXNwBAAAAAAAAAAAAAAAAAAAAAFBLBQYAAAAAAgACALcAAADtAQAAAAA=
got it. Decryptingâ€¦ yeah, it works.
Good. That means the channel is stable.
Alright. Whenever youâ€™re ready, send the real thing.
The core cipher will be transmitted through our secret channel. You remember how to decrypt it, right?
Of course. Iâ€™ve got the procedure ready. Start when youâ€™re ready.
Done. Core cipher fully received. Integrity verifiedâ€”no corruption.
Same to you. And heyâ€¦ nice talking again.
Agreed. Take care.
Good. Keep things quiet for the next few days.
Yeah. Letâ€™s not wait so long next time.
You too.
</code></pre><p>ä¸­é—´çš„è§£ç å¯ä»¥æ‹¿åˆ°å‹ç¼©åŒ…</p><p><img alt=2025-11-27184642 loading=lazy src=/posts/ctf/qwnt2025/2025-11-27184642.png></p><p>ä¸€çœ¼æ˜æ–‡æ”»å‡»ï¼Œè¿™é‡Œå›å½’æ–‡æœ¬</p><pre tabindex=0><code>Okay. Whatâ€™s special about this sample text?
Andâ€¦ inside the sample text, I used my favorite Herobrine legendâ€”you know the one I always bring up.
Of course I know. The hidden original text from that weird old site, right?
What can I sayâ€”old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password.
</code></pre><p>é‚£ä¹ˆsample.txtå°±æ˜¯éœ€è¦ç¤¾å·¥çš„åœ°æ–¹ï¼Œæ‰¾åˆ°å¯¹åº”æ–‡æœ¬å†…å®¹</p><p><a href=https://minecraftcreepypasta.fandom.com/wiki/Him.Html>Him.Html | Minecraft CreepyPasta Wiki | Fandom</a></p><p>è¿™é‡Œå°±æ˜¯æ‹·æ‰“aiè¿›è¡Œç½‘é¡µç¤¾å·¥æ‰¾åˆ°äº†å¯¹åº”å†…å®¹</p><pre tabindex=0><code>Him.HTML was a website that a Steve face with realistic eyes and a jumble of numbers and letters. When sorted it said this: It has been reported that some victims of torture, during the act, would retreat into a fantasy world from which they could not WAKE UP. In this catatonic state, the victim lived in a world just like their normal one, except they weren&#39;t being tortured. The only way that they realized they needed to WAKE UP was a note they found in their fantasy world. It would tell them about their condition, and tell them to WAKE UP. Even then, it would often take months until they were ready to discard their fantasy world and PLEASE WAKE UP.
</code></pre><p>æ–‡ä»¶å¤§å°ç•¥æœ‰å‡ºè·¯ï¼Œæœ€ç»ˆçš„å†…å®¹æ˜¯</p><pre tabindex=0><code>It has been reported that some victims of torture, during the act, would retreat into a fantasy world from which they could not WAKE UP. In this catatonic state, the victim lived in a world just like their normal one, except they weren&#39;t being tortured. The only way that they realized they needed to WAKE UP was a note they found in their fantasy world. It would tell them about their condition, and tell them to WAKE UP. Even then, it would often take months until they were ready to discard their fantasy world and PLEASE WAKE UP.
</code></pre><p>è¿™é‡Œåˆ©ç”¨7zåˆ¶ä½œå‹ç¼©åŒ…</p><p><img alt=2025-11-27185222 loading=lazy src=/posts/ctf/qwnt2025/2025-11-27185222.png></p><p>åˆ©ç”¨ARCHPRè¿›è¡Œæ”»å‡»è§£å‹åŒæ—¶å¾—åˆ°å¯†é’¥</p><pre tabindex=0><code>[ b47e923c 5aeb49a7 a3cd7af0 ]
</code></pre><p>ruleæ–‡æœ¬çš„å†…å®¹æ˜¯</p><pre tabindex=0><code>1.you need to calc the md5 of port to decrypt the core data.
2.The cipher I put in the zip, in segments, has been deflated.
</code></pre><p><del>ç„¶ååˆé™·å…¥äº†æ·±æ€</del></p><p>å¤§è‡´çš„æ€è·¯åˆ©ç”¨å¯¹åº”çš„ç«¯å£çš„MD5ä½œä¸ºkeyè§£å¯†å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span> tshark -r capture.pcapng -T fields -e tcp.srcport -e tcp.dstport -e tcp.payload &gt;<span style=color:#ae81ff>1</span>.txt
</span></span></code></pre></div><p>ä»”ç»†åˆ†æä¸€ä¸‹å†…å®¹(è¿™é‡Œæœ‰ç‚¹è„‘ç‹äº‰éœ¸)ï¼Œå‘ç°ç«¯å£30012-30091ä¹‹é—´çš„åŒºåˆ«ä¸å‰é¢pngä¼ è¾“çš„å†…å®¹ï¼Œæ‹¼æ¥èµ·æ¥æ˜¯ä¹±ç ï¼Œå°è¯•å‘ç°æ˜¯AESåŠ å¯†</p><p><img alt=2025-11-27145000 loading=lazy src=/posts/ctf/qwnt2025/2025-11-27145000.png></p><p>é‚£ä¹ˆå°±å¯ä»¥å†™ä¸ªè„šæœ¬æå–å‡ºæ‰€æœ‰çš„å‹ç¼©åŒ…äº†</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>aes_ecb_decrypt</span>(key_utf8, cipher_hex):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ä½¿ç”¨ UTF-8 ç¼–ç çš„å¯†é’¥å­—ç¬¦ä¸²è¿›è¡Œ AES ECB è§£å¯†
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    key_utf8: æ™®é€šå­—ç¬¦ä¸²ï¼ˆå¦‚MD5çš„hexç»“æœï¼‰
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    cipher_hex: åå…­è¿›åˆ¶å¯†æ–‡å­—ç¬¦ä¸²
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    key_bytes <span style=color:#f92672>=</span> key_utf8<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)  <span style=color:#75715e># ç›´æ¥è½¬æˆå­—èŠ‚</span>
</span></span><span style=display:flex><span>    cipher_bytes <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(cipher_hex)  <span style=color:#75715e># å¯†æ–‡hexè½¬å­—èŠ‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key_bytes, AES<span style=color:#f92672>.</span>MODE_ECB)
</span></span><span style=display:flex><span>    plaintext <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>decrypt(cipher_bytes)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> plaintext
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>unpad</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;å»é™¤ PKCS7 å¡«å……&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    padding_len <span style=color:#f92672>=</span> s[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> padding_len <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>or</span> padding_len <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>16</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> s
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s[:<span style=color:#f92672>-</span>padding_len]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>parse_traffic_data</span>(filename):
</span></span><span style=display:flex><span>    results <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            lines <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;è¯»å–æ–‡ä»¶: </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>, å…± </span><span style=color:#e6db74>{</span>len(lines)<span style=color:#e6db74>}</span><span style=color:#e6db74> è¡Œ</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i, line <span style=color:#f92672>in</span> enumerate(lines, <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> line:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            parts <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(parts) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                src_port <span style=color:#f92672>=</span> int(parts[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#ae81ff>30012</span> <span style=color:#f92672>&lt;=</span> src_port <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>30091</span>:
</span></span><span style=display:flex><span>                    hex_data <span style=color:#f92672>=</span> parts[<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> src_port <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> results:
</span></span><span style=display:flex><span>                        results[src_port] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    results[src_port]<span style=color:#f92672>.</span>append(hex_data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;æ‰¾åˆ° </span><span style=color:#e6db74>{</span>len(results)<span style=color:#e6db74>}</span><span style=color:#e6db74> ä¸ªç«¯å£çš„æ•°æ®</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;=&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>70</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># è§£å¯†å¹¶ä¿å­˜</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> port <span style=color:#f92672>in</span> sorted(results<span style=color:#f92672>.</span>keys()):
</span></span><span style=display:flex><span>            encrypted_hex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(results[port])
</span></span><span style=display:flex><span>            decrypt_and_save(port, encrypted_hex)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;=&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>70</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>FileNotFoundError</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;é”™è¯¯: </span><span style=color:#e6db74>{</span>type(e)<span style=color:#f92672>.</span>__name__<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>str(e)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#f92672>import</span> traceback
</span></span><span style=display:flex><span>        traceback<span style=color:#f92672>.</span>print_exc()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt_and_save</span>(port, encrypted_hex):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;è§£å¯†å•ä¸ªç«¯å£çš„æ•°æ®å¹¶ä¿å­˜ä¸º ZIP&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>ç«¯å£: </span><span style=color:#e6db74>{</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 1. ç«¯å£å· â†’ MD5 â†’ hexå­—ç¬¦ä¸²ä½œä¸ºå¯†é’¥</span>
</span></span><span style=display:flex><span>        port_str <span style=color:#f92672>=</span> str(port)
</span></span><span style=display:flex><span>        md5_hash <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5(port_str<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>        key_utf8 <span style=color:#f92672>=</span> md5_hash  <span style=color:#75715e># MD5çš„hexç»“æœä½œä¸ºUTF-8å­—ç¬¦ä¸²å¯†é’¥</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ç«¯å£å­—ç¬¦ä¸²: &#39;</span><span style=color:#e6db74>{</span>port_str<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;MD5å¯†é’¥ (hex): </span><span style=color:#e6db74>{</span>key_utf8<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å¯†é’¥é•¿åº¦: </span><span style=color:#e6db74>{</span>len(key_utf8)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—ç¬¦&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 2. è§£å¯†</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å¯†æ–‡é•¿åº¦: </span><span style=color:#e6db74>{</span>len(encrypted_hex)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—ç¬¦ (</span><span style=color:#e6db74>{</span>len(encrypted_hex) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74> å­—èŠ‚)&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        decrypted <span style=color:#f92672>=</span> aes_ecb_decrypt(key_utf8, encrypted_hex)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;è§£å¯†åé•¿åº¦: </span><span style=color:#e6db74>{</span>len(decrypted)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—èŠ‚&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 3. å»é™¤å¡«å……</span>
</span></span><span style=display:flex><span>        decrypted <span style=color:#f92672>=</span> unpad(decrypted)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å»å¡«å……åé•¿åº¦: </span><span style=color:#e6db74>{</span>len(decrypted)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—èŠ‚&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 4. æ£€æŸ¥ ZIP æ–‡ä»¶å¤´</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> decrypted[:<span style=color:#ae81ff>4</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;PK</span><span style=color:#ae81ff>\x03\x04</span><span style=color:#e6db74>&#39;</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;âœ“ æ£€æµ‹åˆ° ZIP æ–‡ä»¶å¤´&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âš  å‰4å­—èŠ‚: </span><span style=color:#e6db74>{</span>decrypted[:<span style=color:#ae81ff>4</span>]<span style=color:#f92672>.</span>hex()<span style=color:#e6db74>}</span><span style=color:#e6db74> (ZIPåº”ä¸º 504b0304)&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 5. ä¿å­˜ä¸º ZIP æ–‡ä»¶</span>
</span></span><span style=display:flex><span>        output_filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(output_filename, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>            f<span style=color:#f92672>.</span>write(decrypted)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âœ“ æˆåŠŸä¿å­˜: </span><span style=color:#e6db74>{</span>output_filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âœ— è§£å¯†ç«¯å£ </span><span style=color:#e6db74>{</span>port<span style=color:#e6db74>}</span><span style=color:#e6db74> å¤±è´¥: </span><span style=color:#e6db74>{</span>type(e)<span style=color:#f92672>.</span>__name__<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>str(e)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#f92672>import</span> traceback
</span></span><span style=display:flex><span>        traceback<span style=color:#f92672>.</span>print_exc()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    target_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1.txt&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        target_file <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;=&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>70</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;AES æµé‡æ•°æ®è§£å¯†å·¥å…·&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;=&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>70</span>)
</span></span><span style=display:flex><span>    print()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    parse_traffic_data(target_file)
</span></span></code></pre></div><p>å¾—åˆ°å¯¹åº”çš„å‹ç¼©åŒ…ï¼Œè¿™é‡Œä»”ç»†åˆ†æå‹ç¼©åŒ…é‡Œçš„å†…å®¹æ˜¯4å­—èŠ‚ï¼Œåº”è¯¥æ˜¯CRCçˆ†ç ´,æœ‰ä¸å¯è§å­—ç¬¦å‚è€ƒlunaticå¸ˆå‚…çš„è„šæœ¬</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> binascii
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CRC32Reverse</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, crc32, length, tbl<span style=color:#f92672>=</span>bytes(range(<span style=color:#ae81ff>256</span>)), poly<span style=color:#f92672>=</span><span style=color:#ae81ff>0xEDB88320</span>, accum<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>char_set <span style=color:#f92672>=</span> set(tbl)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>crc32 <span style=color:#f92672>=</span> crc32
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>length <span style=color:#f92672>=</span> length
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>poly <span style=color:#f92672>=</span> poly
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>accum <span style=color:#f92672>=</span> accum
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>table <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>table_reverse <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>init_tables</span>(self, poly, reverse<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> i <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                    i <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                    i <span style=color:#f92672>^=</span> poly
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    i <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>table<span style=color:#f92672>.</span>append(i)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> reverse:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>                found <span style=color:#f92672>=</span> [j <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>) <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>table[j] <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>24</span> <span style=color:#f92672>==</span> i]
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>table_reverse<span style=color:#f92672>.</span>append(tuple(found))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calc</span>(self, data, accum<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>        accum <span style=color:#f92672>=</span> <span style=color:#f92672>~</span>accum
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> data:
</span></span><span style=display:flex><span>            accum <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>table[(accum <span style=color:#f92672>^</span> b) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>] <span style=color:#f92672>^</span> ((accum <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x00FFFFFF</span>)
</span></span><span style=display:flex><span>        accum <span style=color:#f92672>=</span> <span style=color:#f92672>~</span>accum
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> accum <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_reverse</span>(self, desired, accum):
</span></span><span style=display:flex><span>        solutions <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>        accum <span style=color:#f92672>=</span> <span style=color:#f92672>~</span>accum
</span></span><span style=display:flex><span>        stack <span style=color:#f92672>=</span> [(<span style=color:#f92672>~</span>desired,)]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> stack:
</span></span><span style=display:flex><span>            node <span style=color:#f92672>=</span> stack<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>table_reverse[(node[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>24</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>]:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> len(node) <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>                    a <span style=color:#f92672>=</span> accum
</span></span><span style=display:flex><span>                    data <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>                    node <span style=color:#f92672>=</span> node[<span style=color:#ae81ff>1</span>:] <span style=color:#f92672>+</span> (j,)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>                        data<span style=color:#f92672>.</span>append((a <span style=color:#f92672>^</span> node[i]) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>)
</span></span><span style=display:flex><span>                        a <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>                        a <span style=color:#f92672>^=</span> self<span style=color:#f92672>.</span>table[node[i]]
</span></span><span style=display:flex><span>                    solutions<span style=color:#f92672>.</span>add(tuple(data))
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    stack<span style=color:#f92672>.</span>append(((node[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>^</span> self<span style=color:#f92672>.</span>table[j]) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>8</span>,) <span style=color:#f92672>+</span> node[<span style=color:#ae81ff>1</span>:] <span style=color:#f92672>+</span> (j,))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> solutions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dfs</span>(self, length, outlist<span style=color:#f92672>=</span>[<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>]):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> length <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> outlist
</span></span><span style=display:flex><span>        tmp_list <span style=color:#f92672>=</span> [item <span style=color:#f92672>+</span> bytes([x]) <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> outlist <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>char_set]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>dfs(length <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, tmp_list)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_reverse</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>init_tables(self<span style=color:#f92672>.</span>poly)
</span></span><span style=display:flex><span>        desired <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>crc32
</span></span><span style=display:flex><span>        accum <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>accum
</span></span><span style=display:flex><span>        result_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>length <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>            patches <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>find_reverse(desired, accum)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>dfs(self<span style=color:#f92672>.</span>length <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>                patch <span style=color:#f92672>=</span> list(item)
</span></span><span style=display:flex><span>                patches <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>find_reverse(desired, self<span style=color:#f92672>.</span>calc(patch, accum))
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> last4 <span style=color:#f92672>in</span> patches:
</span></span><span style=display:flex><span>                    patch<span style=color:#f92672>.</span>extend(last4)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>calc(patch, accum) <span style=color:#f92672>==</span> desired:
</span></span><span style=display:flex><span>                        result_list<span style=color:#f92672>.</span>append(bytes(patch))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>dfs(self<span style=color:#f92672>.</span>length):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>calc(item) <span style=color:#f92672>==</span> desired:
</span></span><span style=display:flex><span>                    result_list<span style=color:#f92672>.</span>append(bytes(item))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result_list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>crc32_reverse</span>(crc32, length, char_set<span style=color:#f92672>=</span>bytes(range(<span style=color:#ae81ff>256</span>)), poly<span style=color:#f92672>=</span><span style=color:#ae81ff>0xEDB88320</span>, accum<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> CRC32Reverse(crc32, length, char_set, poly, accum)<span style=color:#f92672>.</span>run_reverse()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>scan_zip_crc</span>(dirname, output_bin<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;output.bin&#34;</span>, brute_length<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    results <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> root, dirs, files <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>walk(dirname):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> fname <span style=color:#f92672>in</span> files:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> fname<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#34;.zip&#34;</span>):
</span></span><span style=display:flex><span>                zip_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(root, fname))
</span></span><span style=display:flex><span>                zip_path <span style=color:#f92672>=</span> zip_path<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+] å‘ç°å‹ç¼©åŒ…ï¼š</span><span style=color:#e6db74>{</span>zip_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(zip_path) <span style=color:#66d9ef>as</span> z:
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> info <span style=color:#f92672>in</span> z<span style=color:#f92672>.</span>infolist():
</span></span><span style=display:flex><span>                            crc <span style=color:#f92672>=</span> info<span style=color:#f92672>.</span>CRC
</span></span><span style=display:flex><span>                            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;  â†’ æ–‡ä»¶å¤´ï¼š</span><span style=color:#e6db74>{</span>info<span style=color:#f92672>.</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74> CRC32=</span><span style=color:#e6db74>{</span>crc<span style=color:#e6db74>:</span><span style=color:#e6db74>08X</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            res <span style=color:#f92672>=</span> crc32_reverse(crc, brute_length)
</span></span><span style=display:flex><span>                            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;    é€†æ¨å¾—åˆ° </span><span style=color:#e6db74>{</span>len(res)<span style=color:#e6db74>}</span><span style=color:#e6db74> æ¡ç»“æœ&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            results<span style=color:#f92672>.</span>extend(res)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[-] æ— æ³•è¯»å– ZIPï¼š</span><span style=color:#e6db74>{</span>zip_path<span style=color:#e6db74>}</span><span style=color:#e6db74>, é”™è¯¯ï¼š</span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># å†™å…¥ bin</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(output_bin, <span style=color:#e6db74>&#34;wb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> results:
</span></span><span style=display:flex><span>            f<span style=color:#f92672>.</span>write(r)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+] å·²å†™å…¥ </span><span style=color:#e6db74>{</span>len(results)<span style=color:#e6db74>}</span><span style=color:#e6db74> æ¡ç»“æœ â†’ </span><span style=color:#e6db74>{</span>output_bin<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    scan_zip_crc(<span style=color:#e6db74>&#34;.&#34;</span>, output_bin<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;final_output.bin&#34;</span>, brute_length<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>)
</span></span></code></pre></div><p>ç„¶åæ ¹æ®ä¸€å¼€å§‹çš„æç¤ºdeflatedäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬inflateä¸€ä¸‹ï¼Œæ“ä¸ªè„šæœ¬å¾—åˆ°äº†</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> zlib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;final_output.bin&#34;</span>, <span style=color:#e6db74>&#34;rb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>all_out <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># å‡è®¾æ¯å—æ˜¯ 4 å­—èŠ‚</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(data), <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    block <span style=color:#f92672>=</span> data[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># raw deflate è§£å‹</span>
</span></span><span style=display:flex><span>        out <span style=color:#f92672>=</span> zlib<span style=color:#f92672>.</span>decompress(block, wbits<span style=color:#f92672>=-</span><span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>        all_out <span style=color:#f92672>+=</span> out
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>  <span style=color:#75715e># æœ‰äº›ç»„åˆå¯èƒ½ä¸æ˜¯çœŸæ­£çš„ deflate æ•°æ®</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># æœ€ç»ˆæ‹¼æ¥æˆä¸€å¥è¯</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    print(all_out<span style=color:#f92672>.</span>decode())  <span style=color:#75715e># å¦‚æœæ˜¯ ASCII/UTF-8 æ–‡æœ¬</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>UnicodeDecodeError</span>:
</span></span><span style=display:flex><span>    print(all_out)  <span style=color:#75715e># å¦‚æœåŒ…å«éæ–‡æœ¬å­—èŠ‚ï¼Œç›´æ¥æ‰“å° bytes</span>
</span></span></code></pre></div><p>å¾—åˆ°äº†ä¸€ä¸ªhashçš„å€¼</p><p>åˆ†æä¸€ä¸‹hashï¼Œç®—æ˜¯zipCryptoçš„ç‰¹æ€§ï¼Œé‡Œé¢æ–‡æœ¬å†…å®¹è¾ƒçŸ­ï¼Œåœ¨è¿›è¡Œhashè½¬å‚¨çš„æ—¶å€™ä¼šå°†å†…å®¹å…¨éƒ¨æ”¾å…¥åˆ°hashä¸­è¿›è¡ŒåŠ å¯†ï¼Œä»å¼€å§‹çš„æ–‡æœ¬èŠå¤©å¾—çŸ¥ï¼Œè¿™è¾¹çš„å¯†é’¥å¯ä»¥è¿›è¡Œå¤ç”¨ï¼Œåœ¨å·²çŸ¥hashå’Œkeyåå¯ä»¥hashåæ¨å‹ç¼©åŒ…å¾—åˆ°flagçš„å†…å®¹ï¼Œè„šæœ¬å¦‚ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> binascii
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Tuple, Optional
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ZipCrypto</span>:
</span></span><span style=display:flex><span>    CRC32_POLYNOMIAL <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xEDB88320</span>
</span></span><span style=display:flex><span>    MAGIC_MULT <span style=color:#f92672>=</span> <span style=color:#ae81ff>134775813</span>
</span></span><span style=display:flex><span>    MAGIC_ADD <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, key0: int, key1: int, key2: int):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>keys <span style=color:#f92672>=</span> [key0, key1, key2]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>crc_table <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_build_crc_table()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_build_crc_table</span>(self) <span style=color:#f92672>-&gt;</span> list:
</span></span><span style=display:flex><span>        table <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>            crc <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> crc <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                    crc <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>CRC32_POLYNOMIAL <span style=color:#f92672>^</span> (crc <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    crc <span style=color:#f92672>=</span> (crc <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>            table<span style=color:#f92672>.</span>append(crc)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> table
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_crc32</span>(self, old_crc: int, byte: int) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (self<span style=color:#f92672>.</span>crc_table[(old_crc <span style=color:#f92672>^</span> byte) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>] <span style=color:#f92672>^</span> (old_crc <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>)) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_update_keys</span>(self, plaintext_byte: int):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_crc32(self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>0</span>], plaintext_byte)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> (self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>)) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> self<span style=color:#f92672>.</span>MAGIC_MULT <span style=color:#f92672>+</span> self<span style=color:#f92672>.</span>MAGIC_ADD) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFF</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_crc32(self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>2</span>], (self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>24</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_decrypt_byte</span>(self) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>        temp <span style=color:#f92672>=</span> (self<span style=color:#f92672>.</span>keys[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>|</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFF</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ((temp <span style=color:#f92672>*</span> (temp <span style=color:#f92672>^</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(self, ciphertext: bytes) <span style=color:#f92672>-&gt;</span> bytes:
</span></span><span style=display:flex><span>        plaintext <span style=color:#f92672>=</span> bytearray()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> cipher_byte <span style=color:#f92672>in</span> ciphertext:
</span></span><span style=display:flex><span>            keystream_byte <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_decrypt_byte()
</span></span><span style=display:flex><span>            plain_byte <span style=color:#f92672>=</span> cipher_byte <span style=color:#f92672>^</span> keystream_byte
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>_update_keys(plain_byte)
</span></span><span style=display:flex><span>            plaintext<span style=color:#f92672>.</span>append(plain_byte)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> bytes(plaintext)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_encrypted_data</span>(pkzip_hash: str) <span style=color:#f92672>-&gt;</span> Optional[bytes]:
</span></span><span style=display:flex><span>    clean <span style=color:#f92672>=</span> pkzip_hash<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;$pkzip$&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;$/pkzip$&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    parts <span style=color:#f92672>=</span> clean<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;*&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    hex_data <span style=color:#f92672>=</span> max(
</span></span><span style=display:flex><span>        (p <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> parts <span style=color:#66d9ef>if</span> all(c <span style=color:#f92672>in</span> <span style=color:#e6db74>&#39;0123456789abcdefABCDEF&#39;</span> <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> p)),
</span></span><span style=display:flex><span>        key<span style=color:#f92672>=</span>len,
</span></span><span style=display:flex><span>        default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> hex_data:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> binascii<span style=color:#f92672>.</span>unhexlify(hex_data)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> binascii<span style=color:#f92672>.</span>Error:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>try_decompress</span>(data: bytes) <span style=color:#f92672>-&gt;</span> Tuple[bool, bytes]:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># -15 è¡¨ç¤º raw deflateï¼ˆä¸å« zlib å¤´ï¼‰</span>
</span></span><span style=display:flex><span>        decompressed <span style=color:#f92672>=</span> zlib<span style=color:#f92672>.</span>decompress(data, <span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>, decompressed
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> zlib<span style=color:#f92672>.</span>error:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>, data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>display_result</span>(data: bytes, label: str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;å†…å®¹&#34;</span>):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;=&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[</span><span style=color:#e6db74>{</span>label<span style=color:#e6db74>}</span><span style=color:#e6db74>]&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;=&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        text <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>        print(text)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>UnicodeDecodeError</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Raw: </span><span style=color:#e6db74>{</span>repr(data)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hex: </span><span style=color:#e6db74>{</span>binascii<span style=color:#f92672>.</span>hexlify(data)<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;=&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    TARGET_HASH <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    K0 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xb47e923c</span>
</span></span><span style=display:flex><span>    K1 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x5aeb49a7</span>
</span></span><span style=display:flex><span>    K2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xa3cd7af0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;ZIP Crypto è§£å¯†å·¥å…·&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å¯†é’¥çŠ¶æ€: K0=</span><span style=color:#e6db74>{</span>hex(K0)<span style=color:#e6db74>}</span><span style=color:#e6db74>, K1=</span><span style=color:#e6db74>{</span>hex(K1)<span style=color:#e6db74>}</span><span style=color:#e6db74>, K2=</span><span style=color:#e6db74>{</span>hex(K2)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    encrypted <span style=color:#f92672>=</span> extract_encrypted_data(TARGET_HASH)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> encrypted <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[é”™è¯¯] æ— æ³•ä» hash ä¸­æå–åŠ å¯†æ•°æ®&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[*] æå–åˆ° </span><span style=color:#e6db74>{</span>len(encrypted)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—èŠ‚åŠ å¯†æ•°æ®&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;    å‰ 20 å­—èŠ‚: </span><span style=color:#e6db74>{</span>binascii<span style=color:#f92672>.</span>hexlify(encrypted[:<span style=color:#ae81ff>20</span>])<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    crypto <span style=color:#f92672>=</span> ZipCrypto(K0, K1, K2)
</span></span><span style=display:flex><span>    decrypted <span style=color:#f92672>=</span> crypto<span style=color:#f92672>.</span>decrypt(encrypted)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(decrypted) <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>12</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[é”™è¯¯] è§£å¯†æ•°æ®è¿‡çŸ­ï¼ˆéœ€è¦ &gt;12 å­—èŠ‚ï¼‰&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    actual_data <span style=color:#f92672>=</span> decrypted[<span style=color:#ae81ff>12</span>:]
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] ç§»é™¤åŠ å¯†å¤´åå‰©ä½™ </span><span style=color:#e6db74>{</span>len(actual_data)<span style=color:#e6db74>}</span><span style=color:#e6db74> å­—èŠ‚&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    display_result(actual_data, <span style=color:#e6db74>&#34;è§£å¯†å†…å®¹ (Stored)&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    is_compressed, final_data <span style=color:#f92672>=</span> try_decompress(actual_data)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> is_compressed:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[!] æ£€æµ‹åˆ° DEFLATE å‹ç¼©æ•°æ®&#34;</span>)
</span></span><span style=display:flex><span>        display_result(final_data, <span style=color:#e6db74>&#34;è§£å‹åå†…å®¹&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[*] æ•°æ®æœªå‹ç¼©ï¼ˆä½¿ç”¨ Stored æ–¹æ³•ï¼‰&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p><img alt=2025-11-28173456 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28173456.png></p><h2 id=è¿”ç’å½’çœŸä¸€è¡€>è¿”ç’å½’çœŸ(ä¸€è¡€)</h2><p>ç»™çš„å‹ç¼©åŒ…å¼€å¤´æœ‰æç¤ºhashisk3y</p><p>è¿™é‡Œç›´æ¥ä¼ªåŠ å¯†è§£å‹å¾—åˆ°å›¾ç‰‡ï¼Œåˆ©ç”¨foremostè¿›è¡Œåˆ†ç¦»å¾—åˆ°dmp,åˆ©ç”¨é¡¹ç›®</p><p><a href=https://ollydbg.de/Paperbak/>PaperBack</a></p><p>è¿›è¡Œåˆ†ç¦»æ‹¿åˆ°æ–‡æœ¬å†…å®¹ï¼Œè¿™é‡Œæ˜¯23å­—èŠ‚ï¼Œå¡äº†ä¸€ä¼šï¼Œæœ€åæ˜¯çŒœæµ‹æ˜¯RC4ï¼Œå°†å¯èƒ½çš„hashå€¼éƒ½è¿è¡Œä¸‹æ¥ï¼Œç›´æ¥æ‰”ä¸ªaiåˆ†æå¾—åˆ°flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> binascii
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. å¯†æ–‡</span>
</span></span><span style=display:flex><span>cipher_b64 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;jNX+xu2QKBm23AUlwClt+3xDkQcJGjM=&#34;</span>
</span></span><span style=display:flex><span>cipher_data <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(cipher_b64)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. å¯†é’¥æ±  (æ¥æºäºä½ æä¾›çš„æ–‡ä»¶ Hash)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># æ ¼å¼: (æè¿°, MD5 Hexå­—ç¬¦ä¸²)</span>
</span></span><span style=display:flex><span>candidates <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;Hint String (hashisk3y)&#34;</span>, <span style=color:#e6db74>&#34;298e85501e91238426e2e542d9925232&#34;</span>),  <span style=color:#75715e># MD5(&#34;hashisk3y&#34;)</span>
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;00000000.jpg&#34;</span>, <span style=color:#e6db74>&#34;001a62ee54d1c28a8b769ab5499011cb&#34;</span>),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;00000698.bmp&#34;</span>, <span style=color:#e6db74>&#34;5166b497bb66913fc0e23fd82980538f&#34;</span>),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;image.jpg&#34;</span>, <span style=color:#e6db74>&#34;652365effd5138036c26382004b8d6bd&#34;</span>),
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;è¿”ç’å½’çœŸ.zip&#34;</span>, <span style=color:#e6db74>&#34;369f792f2edf63102fe12e1951ec899f&#34;</span>)
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RC4 å®ç°</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rc4</span>(data, key):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç¡®ä¿ key æ˜¯ bytes</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> isinstance(key, str):
</span></span><span style=display:flex><span>        key <span style=color:#f92672>=</span> key<span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    S <span style=color:#f92672>=</span> list(range(<span style=color:#ae81ff>256</span>))
</span></span><span style=display:flex><span>    j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    out <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># KSA</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> S[i] <span style=color:#f92672>+</span> key[i <span style=color:#f92672>%</span> len(key)]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        S[i], S[j] <span style=color:#f92672>=</span> S[j], S[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># PRGA</span>
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> data:
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> S[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        S[i], S[j] <span style=color:#f92672>=</span> S[j], S[i]
</span></span><span style=display:flex><span>        out<span style=color:#f92672>.</span>append(char <span style=color:#f92672>^</span> S[(S[i] <span style=color:#f92672>+</span> S[j]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> bytes(out)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;--- å¼€å§‹ RC4 æ‰¹é‡çˆ†ç ´ (å°è¯• </span><span style=color:#e6db74>{</span>len(candidates) <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74> ç§ç»„åˆ) ---&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>found <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> label, md5_hex <span style=color:#f92672>in</span> candidates:
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ–¹å¼ A: å¯†é’¥å°±æ˜¯ 32ä½çš„ Hex å­—ç¬¦ä¸² (ä¾‹å¦‚ &#34;001a...&#34;)</span>
</span></span><span style=display:flex><span>    key_str <span style=color:#f92672>=</span> md5_hex
</span></span><span style=display:flex><span>    res_a <span style=color:#f92672>=</span> rc4(cipher_data, key_str)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ–¹å¼ B: å¯†é’¥æ˜¯ Hex è½¬æ¢åçš„ 16ä½ åŸå§‹å­—èŠ‚ (ä¾‹å¦‚ \x00\x1a...)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        key_bytes <span style=color:#f92672>=</span> binascii<span style=color:#f92672>.</span>unhexlify(md5_hex)
</span></span><span style=display:flex><span>        res_b <span style=color:#f92672>=</span> rc4(cipher_data, key_bytes)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        res_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ£€æŸ¥ç»“æœ A</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        text_a <span style=color:#f92672>=</span> res_a<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;flag&#34;</span> <span style=color:#f92672>in</span> text_a<span style=color:#f92672>.</span>lower() <span style=color:#f92672>or</span> <span style=color:#e6db74>&#34;ctf&#34;</span> <span style=color:#f92672>in</span> text_a<span style=color:#f92672>.</span>lower():
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>ğŸ”¥ğŸ”¥ğŸ”¥ [SUCCESS] æ‰¾åˆ° Flag! ğŸ”¥ğŸ”¥ğŸ”¥&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;æ¥æº: </span><span style=color:#e6db74>{</span>label<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å¯†é’¥ç±»å‹: Hex String (32 chars)&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Key : </span><span style=color:#e6db74>{</span>key_str<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Flag: </span><span style=color:#e6db74>{</span>text_a<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            found <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>  <span style=color:#75715e># è§£ç å¤±è´¥è¯´æ˜ä¸æ˜¯ flag</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ£€æŸ¥ç»“æœ B</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        text_b <span style=color:#f92672>=</span> res_b<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;flag&#34;</span> <span style=color:#f92672>in</span> text_b<span style=color:#f92672>.</span>lower() <span style=color:#f92672>or</span> <span style=color:#e6db74>&#34;ctf&#34;</span> <span style=color:#f92672>in</span> text_b<span style=color:#f92672>.</span>lower():
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>ğŸ”¥ğŸ”¥ğŸ”¥ [SUCCESS] æ‰¾åˆ° Flag! ğŸ”¥ğŸ”¥ğŸ”¥&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;æ¥æº: </span><span style=color:#e6db74>{</span>label<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å¯†é’¥ç±»å‹: Raw Bytes (16 bytes)&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Key (Hex): </span><span style=color:#e6db74>{</span>md5_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Flag: </span><span style=color:#e6db74>{</span>text_b<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            found <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> found:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;æœªèƒ½è§£å‡ºåŒ…å« &#39;flag&#39; å­—æ ·çš„ç»“æœã€‚&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;è°ƒè¯•è¾“å‡º (çœ‹çœ‹æœ‰æ²¡æœ‰ç±»ä¼¼ flag çš„ä¹±ç ):&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ‰“å°ä¸€ä¸‹ hashisk3y çš„ç»“æœçœ‹çœ‹æ ·å­</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Try 1: </span><span style=color:#e6db74>{</span>rc4(cipher_data, candidates[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>])<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>, <span style=color:#e6db74>&#39;ignore&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p><img alt=2025-11-28125207 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28125207.png></p><h2 id=çŒ«å’ªç”µå°ä¸€è¡€>çŒ«å’ªç”µå°(ä¸€è¡€)</h2><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªå›¾ç‰‡å’Œä¸€ä¸ªwav</p><p><img alt=2025-11-28133936 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28133936.png></p><p>å›¾ç‰‡é‡Œé¢åº”è¯¥æœ‰ä¸œè¥¿ï¼Œåˆ†æä¸€ä¸‹lsbéšå†™ï¼Œæå–å‡ºæ¥</p><p><img alt=2025-11-28164835 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28164835.png></p><p>å»æ‰å¼€å¤´fffeå¾—åˆ°å›¾ç‰‡</p><p><img alt=1 loading=lazy src=/posts/ctf/qwnt2025/%E7%8C%AB%E5%92%AA%E7%94%B5%E5%8F%B0.png></p><p><img alt=2025-11-28165227 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28165227.png></p><hr><p>wavç”¨010åˆ†æåé¢æœ‰ä¸€ä¸ªå·¨å¤§çš„å‹ç¼©åŒ…ï¼Œåˆ†ç¦»å‡ºæ¥ã€‚</p><p>æ ¹æ®æ–‡ä»¶å¤¹çš„æç¤ºï¼Œä»¥åŠå°è¯•å‘ç°1.wavä¸æ˜¯sstvåè”æƒ³åˆ°æ˜¯æ— çº¿ç”µçš„éŸ³é¢‘</p><p>é—®aiæœ‰å“ªäº›å·¥å…·å¯ä»¥è¿›è¡Œå°è¯•</p><p><img alt=2025-11-28153035 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28153035.png></p><p><img alt=2025-11-28152910 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28152910.png></p><p>å¾—åˆ°äº†part1 <code>R77YM30W1SFUN</code></p><p>è¿™ä¸ªå¯†ç å¯ä»¥è§£å‹å¾—åˆ°2.wav</p><p>2.wavæ˜¯ä¸ªå¾ˆæ‚çš„éŸ³ï¼ŒåŒå£°é“</p><p><img alt=2025-11-28153304 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28153304.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯ï¼šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹æ˜¯ (é€šé“1 - é€šé“2)</span>
</span></span><span style=display:flex><span>sox 2.wav -c <span style=color:#ae81ff>1</span> recovered.wav remix 1v0.5 2v-0.5
</span></span></code></pre></div><p>ä½†è¿˜æ˜¯æ‚éŸ³</p><p>å›å¤´çœ‹äº†ä¸€ä¸‹æ–‡ä»¶çš„hz</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>file 2.wav
</span></span><span style=display:flex><span>2.wav: MBWF/RF64 audio, stereo <span style=color:#ae81ff>2400000</span> Hz
</span></span></code></pre></div><p><img alt=2025-11-28153715 loading=lazy src=/posts/ctf/qwnt2025/2025-11-2853715.png></p><p>è·‘å‡ºä¸ªè„šæœ¬</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.io <span style=color:#f92672>import</span> wavfile
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.signal <span style=color:#f92672>import</span> resample_poly, decimate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>auto_tune_and_demod</span>(filename):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] æ­£åœ¨è¯»å–é«˜é‡‡æ ·ç‡æ–‡ä»¶ </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74> (å¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´)...&#34;</span>)
</span></span><span style=display:flex><span>    fs, data <span style=color:#f92672>=</span> wavfile<span style=color:#f92672>.</span>read(filename)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç¡®ä¿æ˜¯æµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–</span>
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>float32)
</span></span><span style=display:flex><span>    data <span style=color:#f92672>/=</span> np<span style=color:#f92672>.</span>max(np<span style=color:#f92672>.</span>abs(data))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç»„åˆæˆ IQ ä¿¡å·</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ³¨æ„ï¼šè§†ä¸åŒè®¾å¤‡ï¼ŒQ å¯èƒ½éœ€è¦åè½¬ã€‚å¦‚æœå¬ä¸æ¸…ï¼Œå¯ä»¥æŠŠä¸‹è¡Œæ”¹ä¸º data[:, 0] - 1j * data[:, 1]</span>
</span></span><span style=display:flex><span>    iq <span style=color:#f92672>=</span> data[:, <span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>j <span style=color:#f92672>*</span> data[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] åŸå§‹é‡‡æ ·ç‡: </span><span style=color:#e6db74>{</span>fs<span style=color:#e6db74>}</span><span style=color:#e6db74> Hz. æ­£åœ¨å¯»æ‰¾æœ€å¼ºä¿¡å·é¢‘ç‡...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. å¯»æ‰¾æœ€å¼ºé¢‘ç‡ (FFT)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># å–ä¸­é—´ä¸€æ®µæ ·æœ¬åˆ†æï¼Œé¿å…å¤´éƒ¨å°¾éƒ¨å™ªéŸ³</span>
</span></span><span style=display:flex><span>    n_fft <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    start <span style=color:#f92672>=</span> len(iq) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    slice_iq <span style=color:#f92672>=</span> iq[start: start <span style=color:#f92672>+</span> n_fft]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    spectrum <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftshift(np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fft(slice_iq))
</span></span><span style=display:flex><span>    freqs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftshift(np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftfreq(len(slice_iq), <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> fs))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¿½ç•¥ DC (0Hz) é™„è¿‘çš„å³°å€¼ï¼Œå› ä¸ºé‚£é€šå¸¸æ˜¯ç¡¬ä»¶ç›´æµåç½®</span>
</span></span><span style=display:flex><span>    dc_mask <span style=color:#f92672>=</span> (np<span style=color:#f92672>.</span>abs(freqs) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2000</span>)
</span></span><span style=display:flex><span>    valid_indices <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>where(dc_mask)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    peak_idx <span style=color:#f92672>=</span> valid_indices[<span style=color:#ae81ff>0</span>][np<span style=color:#f92672>.</span>argmax(np<span style=color:#f92672>.</span>abs(spectrum)[valid_indices])]
</span></span><span style=display:flex><span>    target_freq <span style=color:#f92672>=</span> freqs[peak_idx]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[!] é”å®šæœ€å¼ºä¿¡å·é¢‘ç‡: </span><span style=color:#e6db74>{</span>target_freq<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> Hz&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. ç§»é¢‘ (Frequency Shift)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># å°†ç›®æ ‡é¢‘ç‡ç§»åŠ¨åˆ° 0 Hz</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[*] æ­£åœ¨è°ƒè° (ç§»é¢‘)...&#34;</span>)
</span></span><span style=display:flex><span>    t <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>arange(len(iq)) <span style=color:#f92672>/</span> fs
</span></span><span style=display:flex><span>    shifted_iq <span style=color:#f92672>=</span> iq <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>exp(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>j <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>pi <span style=color:#f92672>*</span> target_freq <span style=color:#f92672>*</span> t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 3. é™é‡‡æ · (Decimation)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç›®æ ‡æ˜¯ 48kHz éŸ³é¢‘ï¼Œæ‰€ä»¥é™é‡‡æ ·å› å­ = 2.4M / 48k = 50</span>
</span></span><span style=display:flex><span>    target_fs <span style=color:#f92672>=</span> <span style=color:#ae81ff>48000</span>
</span></span><span style=display:flex><span>    decimation_factor <span style=color:#f92672>=</span> int(fs <span style=color:#f92672>/</span> target_fs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] æ­£åœ¨é™é‡‡æ · (å› å­: </span><span style=color:#e6db74>{</span>decimation_factor<span style=color:#e6db74>}</span><span style=color:#e6db74>)...&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># ä½¿ç”¨ decimate è¿›è¡Œä½é€šæ»¤æ³¢ + æŠ½å–</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># complex=True å¤„ç†å¤æ•°</span>
</span></span><span style=display:flex><span>    downsampled_iq <span style=color:#f92672>=</span> decimate(shifted_iq, decimation_factor, ftype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fir&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 4. NFM è§£è°ƒ</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[*] æ­£åœ¨è¿›è¡Œ NFM è§£è°ƒ...&#34;</span>)
</span></span><span style=display:flex><span>    phase <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>angle(downsampled_iq)
</span></span><span style=display:flex><span>    audio <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>diff(np<span style=color:#f92672>.</span>unwrap(phase))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ä¿å­˜</span>
</span></span><span style=display:flex><span>    out_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;final_decoded.wav&#34;</span>
</span></span><span style=display:flex><span>    audio <span style=color:#f92672>=</span> audio <span style=color:#f92672>/</span> np<span style=color:#f92672>.</span>max(np<span style=color:#f92672>.</span>abs(audio)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>32767</span>
</span></span><span style=display:flex><span>    wavfile<span style=color:#f92672>.</span>write(out_name, target_fs, audio<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>int16))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+] æˆåŠŸï¼å·²ä¿å­˜ä¸º: </span><span style=color:#e6db74>{</span>out_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[!] è¯·æ’­æ”¾è¯¥æ–‡ä»¶ï¼Œå¦‚æœæ˜¯äººå£°/æ‹¨å·å£°ï¼ŒFlagå°±åœ¨å…¶ä¸­ï¼&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    auto_tune_and_demod(<span style=color:#e6db74>&#34;2.wav&#34;</span>)
</span></span></code></pre></div><p>å‘ç°ä¸­é—´æ˜¯æœ‰ç±»ä¼¼sstvçš„ä¸œè¥¿çš„ï¼Œç”¨å·¥å…·è·‘çœ‹çœ‹</p><p><img alt=2025-11-28154949 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28154949.png></p><p>æ˜¯å›¾ç‰‡ä¸è¿‡éœ€è¦å»å™ªå•Š</p><p>ç„¶åå†™äº†ä¸€ä¸ªç¨å¾®èƒ½çœ‹åˆ°ä¸€ç‚¹çš„</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.io <span style=color:#f92672>import</span> wavfile
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.signal <span style=color:#f92672>import</span> resample_poly, decimate, butter, lfilter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>butter_bandpass</span>(lowcut, highcut, fs, order<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    nyq <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> fs
</span></span><span style=display:flex><span>    low <span style=color:#f92672>=</span> lowcut <span style=color:#f92672>/</span> nyq
</span></span><span style=display:flex><span>    high <span style=color:#f92672>=</span> highcut <span style=color:#f92672>/</span> nyq
</span></span><span style=display:flex><span>    b, a <span style=color:#f92672>=</span> butter(order, [low, high], btype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;band&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> b, a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>butter_bandpass_filter</span>(data, lowcut, highcut, fs, order<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    b, a <span style=color:#f92672>=</span> butter_bandpass(lowcut, highcut, fs, order<span style=color:#f92672>=</span>order)
</span></span><span style=display:flex><span>    y <span style=color:#f92672>=</span> lfilter(b, a, data)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>auto_tune_and_demod</span>(filename):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] æ­£åœ¨è¯»å–é«˜é‡‡æ ·ç‡æ–‡ä»¶ </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74> ...&#34;</span>)
</span></span><span style=display:flex><span>    fs, data <span style=color:#f92672>=</span> wavfile<span style=color:#f92672>.</span>read(filename)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># è½¬ä¸ºæµ®ç‚¹å¹¶å½’ä¸€åŒ–</span>
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>float32)
</span></span><span style=display:flex><span>    data <span style=color:#f92672>/=</span> np<span style=color:#f92672>.</span>max(np<span style=color:#f92672>.</span>abs(data))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç»„åˆæˆ IQ ä¿¡å·</span>
</span></span><span style=display:flex><span>    iq <span style=color:#f92672>=</span> data[:, <span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>j <span style=color:#f92672>*</span> data[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] åŸå§‹é‡‡æ ·ç‡: </span><span style=color:#e6db74>{</span>fs<span style=color:#e6db74>}</span><span style=color:#e6db74> Hz. æ­£åœ¨å¯»æ‰¾æœ€å¼ºä¿¡å·é¢‘ç‡...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. å¯»æ‰¾æœ€å¼ºé¢‘ç‡</span>
</span></span><span style=display:flex><span>    n_fft <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    start <span style=color:#f92672>=</span> len(iq) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    slice_iq <span style=color:#f92672>=</span> iq[start: start <span style=color:#f92672>+</span> n_fft]
</span></span><span style=display:flex><span>    spectrum <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftshift(np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fft(slice_iq))
</span></span><span style=display:flex><span>    freqs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftshift(np<span style=color:#f92672>.</span>fft<span style=color:#f92672>.</span>fftfreq(len(slice_iq), <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> fs))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¿½ç•¥ DC é™„è¿‘çš„å™ªéŸ³</span>
</span></span><span style=display:flex><span>    dc_mask <span style=color:#f92672>=</span> (np<span style=color:#f92672>.</span>abs(freqs) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2000</span>)
</span></span><span style=display:flex><span>    valid_indices <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>where(dc_mask)
</span></span><span style=display:flex><span>    peak_idx <span style=color:#f92672>=</span> valid_indices[<span style=color:#ae81ff>0</span>][np<span style=color:#f92672>.</span>argmax(np<span style=color:#f92672>.</span>abs(spectrum)[valid_indices])]
</span></span><span style=display:flex><span>    target_freq <span style=color:#f92672>=</span> freqs[peak_idx]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[!] é”å®šæœ€å¼ºä¿¡å·é¢‘ç‡: </span><span style=color:#e6db74>{</span>target_freq<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> Hz&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. ç§»é¢‘</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[*] æ­£åœ¨è°ƒè° (ç§»é¢‘)...&#34;</span>)
</span></span><span style=display:flex><span>    t <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>arange(len(iq)) <span style=color:#f92672>/</span> fs
</span></span><span style=display:flex><span>    shifted_iq <span style=color:#f92672>=</span> iq <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>exp(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>j <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>pi <span style=color:#f92672>*</span> target_freq <span style=color:#f92672>*</span> t)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 3. é™é‡‡æ ·</span>
</span></span><span style=display:flex><span>    target_fs <span style=color:#f92672>=</span> <span style=color:#ae81ff>48000</span>
</span></span><span style=display:flex><span>    decimation_factor <span style=color:#f92672>=</span> int(fs <span style=color:#f92672>/</span> target_fs)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[*] æ­£åœ¨é™é‡‡æ · (å› å­: </span><span style=color:#e6db74>{</span>decimation_factor<span style=color:#e6db74>}</span><span style=color:#e6db74>)...&#34;</span>)
</span></span><span style=display:flex><span>    downsampled_iq <span style=color:#f92672>=</span> decimate(shifted_iq, decimation_factor, ftype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fir&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 4. NFM è§£è°ƒ</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[*] æ­£åœ¨è¿›è¡Œ NFM è§£è°ƒ...&#34;</span>)
</span></span><span style=display:flex><span>    phase <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>angle(downsampled_iq)
</span></span><span style=display:flex><span>    audio <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>diff(np<span style=color:#f92672>.</span>unwrap(phase))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 5. SSTV ä¸“ç”¨å»å™ª (å¸¦é€šæ»¤æ³¢ 1100Hz - 2500Hz)</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[*] æ­£åœ¨åº”ç”¨ SSTV ä¸“ç”¨æ»¤æ³¢å™¨ (1100Hz - 2500Hz)...&#34;</span>)
</span></span><span style=display:flex><span>    audio_filtered <span style=color:#f92672>=</span> butter_bandpass_filter(audio, <span style=color:#ae81ff>1100</span>, <span style=color:#ae81ff>2500</span>, target_fs, order<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ä¿å­˜</span>
</span></span><span style=display:flex><span>    out_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;final_sstv_clean.wav&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># é‡æ–°å½’ä¸€åŒ–</span>
</span></span><span style=display:flex><span>    audio_filtered <span style=color:#f92672>=</span> audio_filtered <span style=color:#f92672>/</span> np<span style=color:#f92672>.</span>max(np<span style=color:#f92672>.</span>abs(audio_filtered)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>32000</span>
</span></span><span style=display:flex><span>    wavfile<span style=color:#f92672>.</span>write(out_name, target_fs, audio_filtered<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>int16))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+] æˆåŠŸï¼å·²ç”Ÿæˆå¹²å‡€çš„ SSTV éŸ³é¢‘: </span><span style=color:#e6db74>{</span>out_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;[!] æç¤º: è§£ç æ—¶å¦‚æœå›¾ç‰‡è¿˜æ˜¯æ–œçš„ï¼Œè¯·å°è¯•åœ¨è½¯ä»¶é‡Œè°ƒæ•´ &#39;Slant Correction&#39; æˆ– &#39;Auto Slant&#39;ã€‚&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    auto_tune_and_demod(<span style=color:#e6db74>&#34;2.wav&#34;</span>)
</span></span></code></pre></div><p><img alt=2025-11-28155414 loading=lazy src=/posts/ctf/qwnt2025/2025-11-28155414.png></p><p>å‡ºçš„æ—¶å€™è¯•äº†å¥½å‡ æ¬¡ï¼Œæœ€ååº”è¯¥æ˜¯2nd part <code>_C4T9L1V3S</code></p><pre tabindex=0><code>flag{Ci4l10~R77YM30W1SFUN_C4T9L1V3S}
</code></pre><h1 id=åè¯>åè¯</h1><p>èµ›ä¸­è¿˜ç ”å­¦äº†ä¸€ä¸‹webå±‚å±‚åŠ ç ï¼Œn4clå¸ˆå‚…payloadä¸€ç©¿ä¸‰å¤ªå¼ºäº†ï¼Œå¯æƒœ3.2è¿‡äºæ¶å¿ƒã€‚</p><p>ä¸»åŠæ–¹è¿‡äºå¯Œè£•ï¼Œçº¿ä¸‹æ¯”èµ›ä½“æ„Ÿæœ€å¥½çš„ä¸€é›†ï¼Œå’Œå¾ˆå¤šSUçš„ä¼™ä¼´è§é¢çº¦é¥­äº†ã€‚è¿™é‡Œè¿˜æ˜¯å®£ä¼ ä¸€æ³¢ï¼Œæ¬¢è¿å„ä½æœ‰æ„åŠ å…¥æˆ˜é˜Ÿçš„å¸ˆå‚…ä»¬æŠ•é€’ç®€å†åˆ°SU<a href="https://forms.office.com/pages/responsepage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAO__of7UVlUQkYyQVNOWjVBVkxHSlFVT1ZZU0w5RTNWTC4u&amp;route=shorturl">su-team</a>ã€‚æˆ˜é˜Ÿé‡‡ç”¨çš„æ˜¯candidateè¿‡æ¸¡è€ƒå¯Ÿçš„æœºåˆ¶ï¼Œè¿›å…¥æˆ‘ä»¬çš„Discordæ‰“å‡ å‘¨ä¹‹åè€ƒå¯Ÿè½¬æ­£(é—®äº†ä¸€ä¸‹å¤„åœ¨candidateçš„å¸ˆå‚…ä»¬èµ·åˆè§‰å¾—æˆ‘ä»¬å¯èƒ½å®¡æ ¸æ¯”è¾ƒä¸¥ï¼Œé—¹å¤§è¯¯ä¼šäº†)ï¼Œç¥SUå…¨å¹´èµ·é£ï¼Œå¶å°”æ‘¸é±¼ã€‚</p></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">ç›®å½•</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>ç›®å½•</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">Ã—</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#misc>Misc</a><ul><li><a href=#æ³„æ¼çš„æ—¶é—´ä¸ç”µç ä¸‰è¡€>æ³„æ¼çš„æ—¶é—´ä¸ç”µç (ä¸‰è¡€)</a></li><li><a href=#æ ‡å‡†çš„ç»å¯†å‹ç¼©ä¸‰è¡€>æ ‡å‡†çš„ç»å¯†å‹ç¼©(ä¸‰è¡€)</a></li><li><a href=#è¿”ç’å½’çœŸä¸€è¡€>è¿”ç’å½’çœŸ(ä¸€è¡€)</a></li><li><a href=#çŒ«å’ªç”µå°ä¸€è¡€>çŒ«å’ªç”µå°(ä¸€è¡€)</a></li></ul></li><li><a href=#åè¯>åè¯</a></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://blog.0ran9e.cn/posts/ctf/buuctf-web/><span class=title>Â«</span><br><span>Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»</span>
</a><a class=next href=http://blog.0ran9e.cn/posts/ctf/rctf2025/><span class=title>Â»</span><br><span>RCTF2025-Misc</span></a></nav></article></main><footer class=footer><span>Â© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>Â· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>Â· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer><button id=tocToggleBtn type=button aria-label="Toggle Table of Contents">æ”¶èµ·</button>
<script>(function(){const s=document.querySelector("article.post-single > details.toc"),e=document.getElementById("tocToggleBtn");if(!s||!e){e&&(e.style.display="none");return}const t="toc_hidden",n=()=>{const n=localStorage.getItem(t)==="1";document.documentElement.classList.toggle("toc-hidden",n),e.textContent=n?"ç›®å½•":"æ”¶èµ·"};e.addEventListener("click",()=>{const e=!document.documentElement.classList.contains("toc-hidden");localStorage.setItem(t,e?"1":"0"),n()}),n()})()</script><script>(function(){const t=document.getElementById("theme-toggle");if(!t)return;const s="pref-theme",e=document.documentElement,n=t=>{const n=t==="dark";e.classList.toggle("dark",n);try{localStorage.setItem(s,t)}catch{}e.style.display="none",e.offsetHeight,e.style.display=""},o=()=>{let e=null;try{e=localStorage.getItem(s)}catch{}if(e==="dark"||e==="light")return n(e);window.matchMedia&&n(matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")};t.dataset.boundTheme||(t.addEventListener("click",()=>{const t=e.classList.contains("dark");n(t?"light":"dark")}),t.dataset.boundTheme="1"),o()})()</script></body></html>